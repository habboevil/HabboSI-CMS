import{u as o,v as t,w as c,x as zl,y as $l,z as Kl,D as Xn,H as Xl,J as G,K as Fr,L as is,N as Hh,O as Wh,Q as ot,U as jh,V as Ql,W as qh,X as Ud,Y as At,Z as Yh,_ as zh,$ as $h,a0 as In,a1 as En,a2 as Kh,a3 as wo,a4 as Fd,a5 as Vd,a6 as Gd,a7 as Xh,a8 as Qh,a9 as Bd,aa as Jh,ab as Zh,ac as Hd,ad as wl,ae as Jl,af as eg,ag as tg,ah as Mc,ai as Zl,aj as ec,ak as Wd,al as ng,am as rg,an as sg,ao as xc,ap as ag,aq as ig,ar as og,as as lg}from"./vendor-c281daa5.js";import{N as ds,a as Ar,H as za,M as ve,T as pn,R as te,b as Qe,A as Xs,c as sn,G as cg,d as Q,D as ug,C as rn,e as dg,f as Me,g as mg,h as Fi,i as Kn,j as Dr,k as tc,l as Vi,E as hg,m as Uc,n as Dn,o as Aa,p as ut,F as Mi,q as Da,S as $a,r as ua,s as gg,t as jd,u as Pa,v as fg,w as pg,x as Ig,y as Gi,z as Un,B as Tr,O as qd,V as Tt,I as jo,P as ea,J as Mt,K as jn,U as Eg,L as Cg,Q as qo,W as Yd,X as zn,Y as _g,Z as bg,_ as Ng,$ as Sg,a0 as vg,a1 as Tg,a2 as wg,a3 as Rg,a4 as Og,a5 as yg,a6 as kg,a7 as Ag,a8 as zd,a9 as Dg,aa as Pg,ab as Lg,ac as Mg,ad as xg,ae as Ug,af as Fg,ag as Vg,ah as Gg,ai as Bg,aj as Hg,ak as Wg,al as jg,am as qg,an as Rl,ao as Yg,ap as $d,aq as zg,ar as $g,as as Kg,at as Xg,au as Qg,av as Jg,aw as Zg,ax as ef,ay as tf,az as nf,aA as rf,aB as sf,aC as af,aD as Kd,aE as of,aF as lf,aG as cf,aH as Fc,aI as uf,aJ as df,aK as mf,aL as Ro,aM as hf,aN as gf,aO as Xd,aP as ff,aQ as pf,aR as Bi,aS as Dt,aT as Ka,aU as Qd,aV as Jd,aW as If,aX as Ef,aY as Cf,aZ as _f,a_ as bf,a$ as Nf,b0 as Sf,b1 as vf,b2 as nc,b3 as ma,b4 as Zd,b5 as Vc,b6 as Tf,b7 as wf,b8 as Rf,b9 as Of,ba as yf,bb as kf,bc as Af,bd as Df,be as Pf,bf as Lf,bg as Mf,bh as xf,bi as Uf,bj as Ff,bk as Vf,bl as Gf,bm as Bf,bn as Hf,bo as Wf,bp as jf,bq as qf,br as Yf,bs as zf,bt as $f,bu as Kf,bv as Xf,bw as Qf,bx as Jf,by as Zf,bz as ep,bA as em,bB as Ol,bC as tp,bD as tm,bE as np,bF as rp,bG as sp,bH as ap,bI as ip,bJ as op,bK as lp,bL as cp,bM as up,bN as dp,bO as mp,bP as hp,bQ as gp,bR as fp,bS as pp,bT as Ip,bU as Ep,bV as Cp,bW as _p,bX as bp,bY as Np,bZ as Sp,b_ as vp,b$ as Tp,c0 as wp,c1 as Rp,c2 as Op,c3 as yp,c4 as kp,c5 as Ap,c6 as Dp,c7 as Pp,c8 as Lp,c9 as Mp,ca as nm,cb as rm,cc as Hi,cd as xp,ce as Up,cf as La,cg as sm,ch as ft,ci as Fp,cj as Vp,ck as Gp,cl as Bp,cm as Hp,cn as Wp,co as jp,cp as qp,cq as Yp,cr as zp,cs as $p,ct as Yo,cu as Kp,cv as Xp,cw as Qp,cx as Jp,cy as Zp,cz as eI,cA as Gc,cB as tI,cC as nI,cD as Is,cE as rI,cF as sI,cG as _n,cH as ht,cI as aI,cJ as iI,cK as oI,cL as oi,cM as Yn,cN as _e,cO as lI,cP as Lt,cQ as cI,cR as uI,cS as dI,cT as mI,cU as hI,cV as gI,cW as fI,cX as pI,cY as II,cZ as EI,c_ as CI,c$ as _I,d0 as bI,d1 as NI,d2 as SI,d3 as vI,d4 as TI,d5 as yl,d6 as wI,d7 as RI,d8 as OI,d9 as am,da as yI,db as kI,dc as Bc,dd as AI,de as DI,df as PI,dg as LI,dh as kl,di as MI,dj as xI,dk as UI,dl as FI,dm as li,dn as Hc,dp as VI,dq as GI,dr as BI,ds as HI,dt as im,du as WI,dv as om,dw as jI,dx as lm,dy as qI,dz as YI,dA as zI,dB as $I,dC as Wc,dD as yn,dE as cm,dF as Al,dG as lr,dH as jc,dI as qc,dJ as gt,dK as zr,dL as KI,dM as XI,dN as QI,dO as JI,dP as zo,dQ as ZI,dR as Yc,dS as zc,dT as eE,dU as $o,dV as Ko,dW as tE,dX as um,dY as nE,dZ as rE,d_ as dm,d$ as sE,e0 as aE,e1 as iE,e2 as oE,e3 as lE,e4 as cE,e5 as uE,e6 as dE,e7 as Xo,e8 as mE,e9 as hE,ea as gE,eb as fE,ec as pE,ed as IE,ee as mm,ef as EE,eg as CE,eh as _E,ei as bE,ej as NE,ek as ha,el as SE,em as vE,en as TE,eo as wE,ep as $c,eq as RE,er as OE,es as yE,et as kE,eu as AE,ev as DE,ew as Kc,ex as PE,ey as LE,ez as ME,eA as xE,eB as UE,eC as FE,eD as VE,eE as GE,eF as BE,eG as HE,eH as hm,eI as WE,eJ as jE,eK as qE,eL as YE,eM as zE,eN as gm,eO as $E,eP as KE,eQ as XE,eR as QE,eS as JE,eT as ZE,eU as eC,eV as tC,eW as nC,eX as rC,eY as sC,eZ as aC,e_ as iC,e$ as oC,f0 as lC,f1 as cC,f2 as uC,f3 as rc,f4 as Xa,f5 as dC,f6 as Qo,f7 as mC,f8 as Xc,f9 as hC,fa as gC,fb as Zt,fc as fC,fd as pC,fe as IC,ff as EC,fg as CC,fh as _C,fi as bC,fj as NC,fk as SC,fl as vC,fm as TC,fn as wC,fo as RC,fp as OC,fq as yC,fr as kC,fs as sc,ft as Qc,fu as ac,fv as AC,fw as DC,fx as PC,fy as LC,fz as MC,fA as xC,fB as UC,fC as FC,fD as VC,fE as bn,fF as GC,fG as BC,fH as HC,fI as WC,fJ as jC,fK as qC,fL as YC,fM as zC,fN as $C,fO as KC,fP as XC,fQ as QC,fR as JC,fS as ZC,fT as e_,fU as t_,fV as n_,fW as r_,fX as Jc,fY as s_,fZ as a_,f_ as i_,f$ as o_,g0 as l_,g1 as c_,g2 as ci,g3 as Zc,g4 as u_,g5 as d_,g6 as ui,g7 as fm,g8 as m_,g9 as Jo,ga as h_,gb as g_,gc as f_,gd as pm,ge as p_,gf as I_,gg as E_,gh as C_,gi as __,gj as b_,gk as N_,gl as S_,gm as v_,gn as T_,go as w_,gp as R_,gq as O_,gr as ic,gs as y_,gt as eu,gu as k_,gv as A_,gw as D_,gx as Im,gy as P_,gz as L_,gA as M_,gB as x_,gC as U_,gD as F_,gE as V_,gF as G_,gG as B_,gH as H_,gI as W_,gJ as j_,gK as Em,gL as q_,gM as Cm,gN as Y_,gO as z_,gP as $_,gQ as K_,gR as vr,gS as Zo,gT as X_,gU as tu,gV as Q_,gW as J_,gX as oc,gY as _m,gZ as qn,g_ as Z_,g$ as eb,h0 as tb,h1 as bm,h2 as Nm,h3 as nb,h4 as rb,h5 as sb,h6 as Sm,h7 as ab,h8 as ib,h9 as ob,ha as lb,hb as cb,hc as ub,hd as db,he as mb,hf as hb,hg as gb,hh as fb,hi as di,hj as ct,hk as vm,hl as Qs,hm as Wi,hn as Tm,ho as wm,hp as Rm,hq as Om,hr as ym,hs as pb,ht as Ib,hu as Eb,hv as Cb,hw as _b,hx as bb,hy as Nb,hz as Sb,hA as vb,hB as nu,hC as tr,hD as mi}from"./nitro-renderer-b4dcabaa.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function pe(){return ds.instance}function pt(i){pe().addLinkEventTracker(i)}function St(){return pe().avatar}function ru(i){return St().structureData.getPalette(i)}function su(i){return St().structureData.getSetType(i)}function ga(){return pe().cameraManager}function Tb(){return pe().core}function wb(){return Tb().configuration}function Z(i){i=i.startsWith("event:")?i.substring(6):i,pe().createLinkEvent(i)}function Ma(){var i;return(i=pe())==null?void 0:i.communication}function X(i,e=null){return Ar.getValue(i,e)}function Dl(){var i;return(i=Ma())==null?void 0:i.connection}function km(){return pe().localization}const Rs=i=>{!i||!i.length||(i.startsWith("http")?za.openWebPage(i):Z(i))};function It(i){pe().removeLinkEventTracker(i)}function $(){return pe().roomEngine}let el=!1,hi=0,gi=0;const fi=(i,e=1)=>{const n=i.clientX,r=i.clientY;let s=i.type;switch(s===ve.MOUSE_CLICK&&(hi&&(gi=1,hi>=Date.now()-300&&gi++),hi=Date.now(),gi===2&&(el||(s=ve.DOUBLE_CLICK),gi=0,hi=null)),s){case ve.MOUSE_CLICK:break;case ve.DOUBLE_CLICK:break;case ve.MOUSE_MOVE:el=!0;break;case ve.MOUSE_DOWN:el=!1;break;case ve.MOUSE_UP:break;case ve.RIGHT_CLICK:break;default:return}$().dispatchMouseEvent(e,n,r,s,i.altKey,i.ctrlKey||i.metaKey,i.shiftKey,!1)};let tl=!1,pi=0,Ii=0;const Ei=(i,e=1,n=!1,r=!1,s=!1,a=!1)=>{let l=0,u=0;i.touches[0]?(l=i.touches[0].clientX,u=i.touches[0].clientY):i.changedTouches[0]&&(l=i.changedTouches[0].clientX,u=i.changedTouches[0].clientY);let d=i.type;switch(n&&(d=pn.TOUCH_LONG),(d===ve.MOUSE_CLICK||d===pn.TOUCH_END)&&(d=ve.MOUSE_CLICK,pi&&(Ii=1,pi>=Date.now()-300&&Ii++),pi=Date.now(),Ii===2&&(tl||(d=ve.DOUBLE_CLICK),Ii=0,pi=null)),d){case ve.MOUSE_CLICK:break;case ve.DOUBLE_CLICK:break;case pn.TOUCH_START:d=ve.MOUSE_DOWN,tl=!1;break;case pn.TOUCH_MOVE:d=ve.MOUSE_MOVE,tl=!0;break;case pn.TOUCH_END:d=ve.MOUSE_UP;break;case pn.TOUCH_LONG:d=ve.MOUSE_DOWN_LONG;break;default:return}d===pn.TOUCH_START&&$().dispatchMouseEvent(e,l,u,d,r,s,a,!1),$().dispatchMouseEvent(e,l,u,d,r,s,a,!1)};function Wt(i){if(!i||!i.model)return!1;const e=H().userId,n=i.model.getValue(te.FURNITURE_OWNER_ID);return e===n}function xa(i,e,n){return i?i.isRoomOwner||i.controllerLevel>=Qe.GUEST||H().isModerator||Wt($().getRoomObject(i.roomId,e,n)):!1}function Os(){return pe().roomSessionManager}function Es(i,e=null){Os().createSession(i,e)}function Rb(){const i=ys();return i?i.model.getValue(te.FIGURE_CAN_STAND_UP):Xs.POSTURE_STAND}function nl(){const i=ys();if(!i)return!1;const n=i.model.getValue(te.FIGURE_EFFECT);return!(n===29||n===30||n===185)}function H(){return pe().sessionDataManager}function Nn(){return X("hc.disabled",!1)?sn.VIP:H().clubLevel}const Rr=class Rr{};Rr.OKAY=0,Rr.MISSING_OFFER=1,Rr.FURNI_LIMIT_REACHED=2,Rr.NOT_IN_ROOM=3,Rr.NOT_ROOM_OWNER=4,Rr.GUILD_ROOM=5,Rr.VISITORS_IN_ROOM=6;let wr=Rr;class Ob{constructor(e,n,r){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=n,this._parent=r,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const so=class so{constructor(e,n,r,s,a,l=-1){this._pageId=e,this._layoutCode=n,this._localization=r,this._offers=s,this._acceptSeasonCurrencyAsCredits=a;for(const u of s)u.page=this;l===-1?this._mode=so.MODE_NORMAL:this._mode=l}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};so.MODE_NORMAL=0;let ji=so;const nt=class nt{};nt.DUCKET_INFO="ducket_info",nt.CREDITS="credits",nt.AVATAR_EFFECTS="avatar_effects",nt.HC_MEMBERSHIP="hc_membership",nt.CLUB_GIFTS="club_gifts",nt.LIMITED_SOLD="limited_sold",nt.PET_ACCESSORIES="pet_accessories",nt.TRAX_SONGS="trax_songs",nt.NEW_ADDITIONS="new_additions",nt.QUEST_SHELL="quest_shell",nt.QUEST_SNOWFLAKES="quest_snowflakes",nt.VAL_QUESTS="val_quests",nt.GUILD_CUSTOM_FURNI="guild_custom_furni",nt.GIFT_SHOP="gift_shop",nt.HORSE_STYLES="horse_styles",nt.HORSE_SHOE="horse_shoe",nt.SET_EASTER="set_easter",nt.ECOTRON_TRANSFORM="ecotron_transform",nt.LOYALTY_INFO="loyalty_info",nt.ROOM_BUNDLES="room_bundles",nt.ROOM_BUNDLES_MOBILE="room_bundles_mobile",nt.HABBO_CLUB_DESKTOP="habbo_club_desktop",nt.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";let qi=nt;class yb{constructor(e,n){this.breed=e,this.palettes=n}}const Or=class Or{};Or.NONE=0,Or.CONFIRM=1,Or.PURCHASE=2,Or.NO_CREDITS=3,Or.NO_POINTS=4,Or.SOLD_OUT=5,Or.FAILED=6;let $e=Or;const ao=class ao{};ao.NORMAL="NORMAL",ao.BUILDER="BUILDERS_CLUB";let Ln=ao;const kb=i=>"",Ab=i=>"",au=(i,e)=>{const n=i.get(e),r=[];if(n&&n.length)for(const s of n)s.isVisible&&r.push(s);return r},Am=(i,e,n,r)=>{if(n.isVisible&&n.pageId>0){let s=!1;const a=[n.pageName,n.localization].join(" ").toLowerCase().replace(/ /gi,"");if(a.indexOf(i)>-1&&(r.push(n),s=!0),!s){for(const l of e)if(a.indexOf(l)>=0){r.push(n);break}}}for(const s of n.children)Am(i,e,s,r)};function Db(i){if(!i.length)return 0;let e=i.length-1;for(;e>=0&&!isNaN(parseInt(i.charAt(e)));)e--;return e>0?parseInt(i.substring(e+1)):-1}function Pb(i,e){switch(i){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const n=[];for(const r of e){const s=$().getPetColorResult(i,r.paletteId);s&&(s.primaryColor===s.secondaryColor?n.push([s.primaryColor]):n.push([s.primaryColor,s.secondaryColor]))}return n}}}const rr=class rr{};rr.WALL="i",rr.FLOOR="s",rr.EFFECT="e",rr.HABBO_CLUB="h",rr.BADGE="b",rr.GAME_TOKEN="GAME_TOKEN",rr.PET="p",rr.ROBOT="r";let he=rr;const io=class io{constructor(e,n,r,s,a,l,u=!1,d=0,g=0){this._productType=e.toLowerCase(),this._productClassId=n,this._extraParam=r,this._productCount=s,this._productData=a,this._furnitureData=l,this._isUniqueLimitedItem=u,this._uniqueLimitedItemSeriesSize=d,this._uniqueLimitedItemsLeft=g}static stripAddonProducts(e){return e.length===1?e:e.filter(n=>n.productType!==he.BADGE&&n.productType!==he.EFFECT&&n.productClassId!==io.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(e=null,n=null){switch(this._productType){case he.FLOOR:return $().getFurnitureFloorIconUrl(this.productClassId);case he.WALL:{if(e&&this._furnitureData){let r="";switch(this._furnitureData.className){case"floor":r=["th",this._furnitureData.className,e.product.extraParam].join("_");break;case"wallpaper":r=["th","wall",e.product.extraParam].join("_");break;case"landscape":r=["th",this._furnitureData.className,(e.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(r!=="")return`${X("catalog.asset.url")}/${r}.png`}return $().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case he.EFFECT:return kb(this.productClassId);case he.HABBO_CLUB:return Ab(this.productClassId);case he.BADGE:return H().getBadgeUrl(this._extraParam);case he.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(e){this._extraParam=e}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(e){this._uniqueLimitedItemsLeft=e}};io.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let $r=io;const Ot=class Ot{constructor(e,n,r,s,a,l,u,d,g,m){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=e,this._localizationId=n,this._isRentOffer=r,this._priceInCredits=s,this._priceInActivityPoints=a,this._activityPointType=l,this._giftable=u,this._clubLevel=d,this._products=g,this._bundlePurchaseAllowed=m,this.setPricingModelForProducts(),this.setPricingType();for(const f of g)if(f.productType===he.BADGE){this._badgeCode=f.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(e){this._page=e}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const e=$r.stripAddonProducts(this._products);return e.length?e[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const e=Js(this._localizationId);return e?e.name:h(this._localizationId)}get localizationDescription(){const e=Js(this._localizationId);return e?e.description:h(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const e=$r.stripAddonProducts(this._products);e.length===1?e[0].productCount===1?this._pricingModel=Ot.PRICING_MODEL_SINGLE:this._pricingModel=Ot.PRICING_MODEL_MULTI:e.length>1?this._pricingModel=Ot.PRICING_MODEL_BUNDLE:this._pricingModel=Ot.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Ot.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Ot.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Ot.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Ot.PRICE_TYPE_NONE}clone(){const e=[],n=Js(this.localizationId);for(const s of this._products){const a=Pl(s.productClassId,s.productType);e.push(new $r(s.productType,s.productClassId,s.extraParam,s.productCount,n,a))}const r=new Ot(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,e,this.bundlePurchaseAllowed);return r.page=this.page,r}};Ot.PRICING_MODEL_UNKNOWN="pricing_model_unknown",Ot.PRICING_MODEL_SINGLE="pricing_model_single",Ot.PRICING_MODEL_MULTI="pricing_model_multi",Ot.PRICING_MODEL_BUNDLE="pricing_model_bundle",Ot.PRICING_MODEL_FURNITURE="pricing_model_furniture",Ot.PRICE_TYPE_NONE="price_type_none",Ot.PRICE_TYPE_CREDITS="price_type_credits",Ot.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints",Ot.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let xt=Ot;class Lb{constructor(e){this._furniData=e,this._product=new $r(this._furniData.type,this._furniData.id,this._furniData.customParams,1,Js(this._furniData.className),this._furniData)}activate(){L(new cg(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return xt.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const Mb=(i,e,n=null)=>{let r=null;switch(i.toLocaleLowerCase()){case he.FLOOR:r=$().getFurnitureFloorIconUrl(e);break;case he.WALL:r=$().getFurnitureWallIconUrl(e,n);break}return r};class xb{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}const oo=class oo{constructor(e,n,r,s,a,l,u,d,g=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=n,this._furniType=r,this._extraData=s,this._stuffData=a,this._price=l,this._status=u,this._averagePrice=d,this._offerCount=g}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}};oo.TYPE_FLOOR=1,oo.TYPE_WALL=2;let Ua=oo;const Vs=class Vs{};Vs.ONGOING=1,Vs.ONGOING_OWN=1,Vs.SOLD=2,Vs.EXPIRED=3;let Fa=Vs;const Ia=class Ia{};Ia.BY_ACTIVITY=1,Ia.BY_VALUE=2,Ia.ADVANCED=3;let Ht=Ia;class Dm{constructor(e,n){this._images=e,this._texts=n}getText(e){let n=this._texts[e]||"";return n&&n.length&&(n=n.replace(/\r\n|\r|\n/g,"<br />")),n}getImage(e){const n=this._images[e]||"";if(!n||!n.length)return null;let r=X("catalog.asset.image.url");return r=r.replace("%name%",n),r}}class Ub{constructor(e,n,r,s,a,l,u,d){this.roomId=e,this.objectId=n,this.category=r,this.wallLocation=s,this.x=a,this.y=l,this.direction=u,this.offer=d}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const Vn=class Vn{constructor(){this._requestType=Vn.REQUEST_TYPE_NONE}resetRequest(){this._requestType=Vn.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(e){this._requestType=Vn.REQUEST_TYPE_ID,this._requestById=e}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(e){this._requestType=Vn.REQUEST_TYPE_OFFER,this._requestedByOfferId=e}get requestByName(){return this._requestByName}set requestByName(e){this._requestType=Vn.REQUEST_TYPE_NAME,this._requestByName=e}};Vn.REQUEST_TYPE_NONE=0,Vn.REQUEST_TYPE_ID=1,Vn.REQUEST_TYPE_OFFER=2,Vn.REQUEST_TYPE_NAME=3;let ms=Vn;class Fb{constructor(e,n,r){this.searchValue=e,this.offers=n,this.filteredNodes=r}}function Pl(i,e){let n=null;switch(e.toLowerCase()){case he.FLOOR:n=H().getFloorItemData(i);break;case he.WALL:n=H().getWallItemData(i);break}return n}function Oo(i,e,n){const r=$().getRoomObject(i,e,n);if(!r)return;const s=r.model.getValue(te.FURNITURE_TYPE_ID);switch(n){case Q.FLOOR:return H().getFloorItemData(s);case Q.WALL:return H().getWallItemData(s)}return null}function Vb(){const i=ys();return i?i.model.getValue(te.FIGURE_POSTURE):Xs.POSTURE_STAND}function Js(i){return i?H().getProductData(i):null}function Te(){return Os().getSession(-1)}function Ll(){L(new ug)}function Cs(){return H().clubLevel>=sn.CLUB}function Ci(){return H().clubLevel>=sn.VIP}function Gb(i){const e=$().getRoomObject(Te().roomId,i,Q.FLOOR);if(!e||!e.model)return!1;const n=H().userId,r=e.model.getValue(te.FURNITURE_OWNER_ID);return n===r}function Bb(){const i=ys();return i?i.model.getValue(te.FIGURE_EFFECT)===77:!1}function Hb(i){Os().startSession(i)}const yo=()=>{Te()&&(Ll(),Os().removeSession(-1))};function ys(){const i=H().userId,e=$().activeRoomId,n=Q.UNIT,r=$().getTotalObjectsForManager(e,n);let s=0;for(;s<r;){const a=$().getRoomObjectByIndex(e,s,n);if(a){const l=Te().userDataManager.getUserDataByIndex(a.id);if(l&&l.webID===i)return a}s++}return null}const lc=(i,e,n,r=1)=>{const s=$().getRoomObjectBoundingRectangle(i,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},Pm=(i,e,n,r=1)=>{const s=$().getRoomObjectScreenLocation(i,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},Wb=(i,e,n=1)=>{const r=$(),s=r.activeRoomId;r.initializeRoomInstanceRenderingCanvas(s,n,i,e)};function jb(i){let e=!1;const n=$().getRoomObject(i.roomId,i.objectId,i.category);return n&&n.model.getValue(te.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,H().isModerator&&(e=!1)),e}function Us(i,e,n){$().processRoomObjectOperation(i,e,n)}function iu(i){$().setActiveRoomId(i)}const L=i=>Dl().send(i);class hn{static getAchievementBadgeCode(e){if(!e)return null;let n=e.badgeId;return e.finalLevel||(n=km().getPreviousLevelBadgeId(n)),n}static getAchievementCategoryImageUrl(e,n=null,r=!1){const s=X("achievements.images.url");let a=r?"achicon_":"achcategory_";return a+=e.code,n!==null&&(a+=`_${n>0?"active":"inactive"}`),s.replace("%image%",a)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.levelCount;return n}static getAchievementCategoryProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.finalLevel?r.level:r.level-1;return n}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let n=0;for(const r of e.achievements)r.unseen>0&&n++;return n}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const n=X("achievements.unseen.ignored"),r=e.badgeId.replace(/[0-9]/g,"");return n.indexOf(r)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class ou{constructor(e){this._code=e,this._achievements=[]}getProgress(){return hn.getAchievementCategoryProgress(this)}getMaxProgress(){return hn.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}const Gs=class Gs{};Gs.ACTION_SAVE="AEA_ACTION_SAVE",Gs.ACTION_CLEAR="AEA_ACTION_CLEAR",Gs.ACTION_RESET="AEA_ACTION_RESET",Gs.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";let nr=Gs;class qb{constructor(e,n=!1){this._partColor=e,this._isDisabled=n,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return rn.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class cc{constructor(e,n,r){this._selectedPartIndex=-1,this._name=e,this._parts=n,this._palettes=r,this._selectedPartIndex=-1}static defaultColorId(e,n){if(!e||!e.length)return-1;let r=0;for(;r<e.length;){const s=e[r];if(s.partColor&&s.partColor.clubLevel<=n)return s.partColor.id;r++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const n of e)n.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let n=0;for(;n<this._parts.length;){if(this._parts[n].id===e){this.selectPartIndex(n);return}n++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let n=0;for(;n<this._palettes.length;){const r=this.getPalette(n);if(r){let s=0;if(e.length>n)s=e[n];else{const l=r[0];l&&l.partColor&&(s=l.partColor.id)}let a=0;for(;a<r.length;){const l=r[a];l.partColor.id===s?(this._paletteIndexes[n]=a,l.isSelected=!0):l.isSelected=!1,a++}}n++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const n=this._parts[this._selectedPartIndex];n&&(n.isSelected=!1)}if(this._parts.length>e){const n=this._parts[e];if(n)return n.isSelected=!0,this._selectedPartIndex=e,n}return null}selectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[n],n),this._paletteIndexes[n]=e;const s=r[e];return s?(s.isSelected=!0,this.updatePartColors(),s):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return;const s=r[e];s&&(s.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const n=e[0];if(!n||!n.partColor)return null;const r=n.partColor.id,s=[];let a=0;for(;a<this._paletteIndexes.length;){const u=this._palettes[a];if(!(!u||u.length<=a))if(u.length>this._paletteIndexes[a]){const d=u[this._paletteIndexes[a]];d&&d.partColor?s.push(d.partColor.id):s.push(r)}else s.push(r);a++}const l=this.getCurrentPart();return l?s.slice(0,Math.max(l.maxColorIndex,1)):null}getSelectedColors(){const e=[];let n=0;for(;n<this._paletteIndexes.length;){const r=this.getSelectedColor(n);r?e.push(r.partColor):e.push(null),n++}return e}getSelectedColor(e){const n=this.getPalette(e);return!n||n.length<=this._paletteIndexes[e]?null:n[this._paletteIndexes[e]]}getSelectedColorId(e){const n=this.getSelectedColor(e);return n&&n.partColor?n.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const n of this._parts)n&&(n.partColors=e)}hasClubSelectionsOverLevel(e){let n=!1;const r=this.getSelectedColors();if(r){let a=0;for(;a<r.length;){const l=r[a];l&&l.clubLevel>e&&(n=!0),a++}}const s=this.getCurrentPart();if(s&&s.partSet){const a=s.partSet;a&&a.clubLevel>e&&(n=!0)}return n}hasInvalidSelectedItems(e){const n=this.getCurrentPart();if(!n)return!1;const r=n.partSet;if(!(!r||!r.isSellable))return e.indexOf(r.id)>-1}stripClubItemsOverLevel(e){const n=this.getCurrentPart();if(n&&n.partSet&&n.partSet.clubLevel>e){const s=this.selectPartIndex(0);return s&&!s.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const n=[],r=this.getSelectedColors(),s=this.getPalette(0);let a=!1;const l=cc.defaultColorId(s,e);if(l===-1)return!1;let u=0;for(;u<r.length;){const d=r[u];d?d.clubLevel>e?(n.push(l),a=!0):n.push(d.id):(n.push(l),a=!0),u++}return a&&this.selectColorIds(n),a}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}const Bs=class Bs{static getGender(e){switch(e){case be.MALE:case"m":case"M":e=be.MALE;break;case be.FEMALE:case"f":case"F":e=be.FEMALE;break;default:e=be.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,n){if(!e||!n||!this.CURRENT_FIGURE)return null;const r=[],s=[];let a=0;for(;a<this.MAX_PALETTES;)s.push([]),a++;const l=su(n);if(!l)return null;const u=ru(l.paletteID);if(!u)return null;let d=this.CURRENT_FIGURE.getColorIds(n);d||(d=[]);const g=new Array(d.length),m=this.clubItemsDimmed,f=Nn();for(const b of u.colors.getValues())if(b.isSelectable&&(m||f>=b.clubLevel)){let N=0;for(;N<this.MAX_PALETTES;){const T=f<b.clubLevel,y=new qb(b,T);s[N].push(y),N++}if(n!==be.FACE){let T=0;for(;T<d.length;)b.id===d[T]&&(g[T]=b),T++}}let I=[];if(m?I=St().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):I=St().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,f),I.indexOf(n)===-1){const b=new Yi(null,null,!1);b.isClear=!0,r.push(b)}const p=n!==be.FACE,_=l.partSets;for(a=_.length-1;a>=0;){const b=_.getWithIndex(a);let N=!1;if((b.gender===be.UNISEX||b.gender===this.CURRENT_FIGURE.gender)&&(N=!0),b.isSelectable&&N&&(m||f>=b.clubLevel)){const T=f<b.clubLevel;let y=!0;b.isSellable&&(y=this.hasFigureSetId(b.id)),y&&r.push(new Yi(b,g,p,T))}a--}for(r.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),a=0;a<this.MAX_PALETTES;)s[a].sort(this.colorSorter),a++;return new cc(n,r,s)}static clubSorter(e,n){const r=e.partSet?e.partSet.clubLevel:9999999999,s=n.partSet?n.partSet.clubLevel:9999999999,a=e.partSet?e.partSet.isSellable:!1,l=n.partSet?n.partSet.isSellable:!1;return a&&!l?1:l&&!a||r>s?-1:r<s?1:e.partSet.id>n.partSet.id?-1:e.partSet.id<n.partSet.id?1:0}static colorSorter(e,n){const r=e.partColor?e.partColor.clubLevel:-1,s=n.partColor?n.partColor.clubLevel:-1;return r<s?-1:r>s?1:e.partColor.index<n.partColor.index?-1:e.partColor.index>n.partColor.index?1:0}static noobSorter(e,n){const r=e.partSet?e.partSet.clubLevel:-1,s=n.partSet?n.partSet.clubLevel:-1,a=e.partSet?e.partSet.isSellable:!1,l=n.partSet?n.partSet.isSellable:!1;return a&&!l?1:l&&!a||r<s?-1:r>s?1:e.partSet.id<n.partSet.id?-1:e.partSet.id>n.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const n=su(e);if(!n)return-1;const r=ru(n.paletteID);if(!r)return-1;for(const s of r.colors.getValues())if(!(!s.isSelectable||Nn()<s.clubLevel))return s.id;return-1}static get clubItemsFirst(){return X("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return X("avatareditor.show.clubitems.dimmed",!0)}};Bs.MAX_PALETTES=2,Bs.CURRENT_FIGURE=null,Bs.FIGURE_SET_IDS=[],Bs.BOUND_FURNITURE_NAMES=[];let bt=Bs;const oe=class oe{constructor(){this._gender="M",this._direction=oe.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(e,n){this._data=new Map,this._colors=new Map,this._gender=n,this.parseFigureString(e),this.updateView()}parseFigureString(e){if(!e)return;const n=e.split(".");if(!(!n||!n.length))for(const r of n){const s=r.split("-");if(!s.length)continue;const a=s[0],l=parseInt(s[1]),u=[];let d=2;for(;d<s.length;)u.push(parseInt(s[d])),d++;u.length||u.push(0),this.savePartSetId(a,l,!1),this.savePartSetColourId(a,u,!1)}}getPartSetId(e){const n=this._data.get(e);return n!==void 0?n:-1}getColorIds(e){const n=this._colors.get(e);return n!==void 0?n:[bt.avatarSetFirstSelectableColor(e)]}getFigureString(){let e="";const n=[];for(const[s,a]of this._data.entries()){const l=this._colors.get(s);let u=s+"-"+a;if(l&&l.length){let d=0;for(;d<l.length;)u=u+("-"+l[d]),d++}n.push(u)}let r=0;for(;r<n.length;)e=e+n[r],r<n.length-1&&(e=e+"."),r++;return e}savePartData(e,n,r,s=!1){this.savePartSetId(e,n,s),this.savePartSetColourId(e,r,s)}savePartSetId(e,n,r=!0){switch(e){case oe.FACE:case oe.HAIR:case oe.HAT:case oe.HEAD_ACCESSORIES:case oe.EYE_ACCESSORIES:case oe.FACE_ACCESSORIES:case oe.SHIRT:case oe.JACKET:case oe.CHEST_ACCESSORIES:case oe.CHEST_PRINTS:case oe.TROUSERS:case oe.SHOES:case oe.TROUSER_ACCESSORIES:n>=0?this._data.set(e,n):this._data.delete(e);break}r&&this.updateView()}savePartSetColourId(e,n,r=!0){switch(e){case oe.FACE:case oe.HAIR:case oe.HAT:case oe.HEAD_ACCESSORIES:case oe.EYE_ACCESSORIES:case oe.FACE_ACCESSORIES:case oe.SHIRT:case oe.JACKET:case oe.CHEST_ACCESSORIES:case oe.CHEST_PRINTS:case oe.TROUSERS:case oe.SHOES:case oe.TROUSER_ACCESSORIES:this._colors.set(e,n);break}r&&this.updateView()}getFigureStringWithFace(e,n=!0){let r="";const s=[oe.FACE],a=[];for(const u of s){const d=this._colors.get(u);if(!d)continue;let g=this._data.get(u);u===oe.FACE&&n&&(g=e);let m=u+"-"+g;if(g>=0){let f=0;for(;f<d.length;)m=m+("-"+d[f]),f++}a.push(m)}let l=0;for(;l<a.length;)r=r+a[l],l<a.length-1&&(r=r+"."),l++;return r}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(e){this._direction=e,this.updateView()}set avatarEffectType(e){this._avatarEffectType=e}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(e){this._notifier=e}};oe.DEFAULT_DIRECTION=4,oe.MALE="M",oe.FEMALE="F",oe.UNISEX="U",oe.SCALE="h",oe.STD="std",oe.DEFAULT_FRAME="0",oe.FACE="hd",oe.HAIR="hr",oe.HAT="ha",oe.HEAD_ACCESSORIES="he",oe.EYE_ACCESSORIES="ea",oe.FACE_ACCESSORIES="fa",oe.JACKET="cc",oe.SHIRT="ch",oe.CHEST_ACCESSORIES="ca",oe.CHEST_PRINTS="cp",oe.TROUSERS="lg",oe.SHOES="sh",oe.TROUSER_ACCESSORIES="wa",oe.SET_TYPES=[oe.FACE,oe.HAIR,oe.HAT,oe.HEAD_ACCESSORIES,oe.EYE_ACCESSORIES,oe.FACE_ACCESSORIES,oe.JACKET,oe.SHIRT,oe.CHEST_ACCESSORIES,oe.CHEST_PRINTS,oe.TROUSERS,oe.SHOES,oe.TROUSERS];let be=oe;const sr=class sr{constructor(e,n,r=!0,s=!1){if(this._renderManager=St(),this._partSet=e,this._partColors=n,this._useColors=r,this._isDisabled=s,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,e){const a=e.parts;for(const l of a)this._maxColorIndex=Math.max(this._maxColorIndex,l.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const e=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(e)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(e,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const e=this._partSet.parts.concat().sort(this.sortByDrawOrder),n=new mg;for(const r of e){if(!r)continue;let s=null,a=0,l=!1;for(;!l&&a<sr.THUMB_DIRECTIONS.length;){const f=be.SCALE+"_"+be.STD+"_"+r.type+"_"+r.id+"_"+sr.THUMB_DIRECTIONS[a]+"_"+be.DEFAULT_FRAME;s=this._renderManager.getAssetByName(f),s&&s.texture?l=!0:a++}if(!l)continue;const u=s.offsetX,d=s.offsetY;let g=null;if(this._useColors&&r.colorLayerIndex>0){const f=this._partColors[r.colorLayerIndex-1];f&&(g=f)}const m=new Fi(s.texture);m.position.set(u,d),g&&(m.tint=g.rgb),n.addChild(m)}return n}updateThumbVisualization(){if(!this._isInitalized)return;let e=this._thumbContainer;e||(e=this.renderThumb()),e&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(e,.2),this._imageUrl=Kn.generateImageUrl(e),this.notify&&this.notify())}setAlpha(e,n){return e.filters=[sr.ALPHA_FILTER],e}sortByDrawOrder(e,n){const r=sr.DRAW_ORDER.indexOf(e.type),s=sr.DRAW_ORDER.indexOf(n.type);return r<s?-1:r>s?1:e.index<n.index?-1:e.index>n.index?1:0}resetFigure(e){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(e){this._partColors=e,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(e){this._thumbContainer=e,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(e){this._isClear=e}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}};sr.ALPHA_FILTER=new dg(.2),sr.THUMB_DIRECTIONS=[2,6,0,4,3,1],sr.DRAW_ORDER=[Me.LEFT_HAND_ITEM,Me.LEFT_HAND,Me.LEFT_SLEEVE,Me.LEFT_COAT_SLEEVE,Me.BODY,Me.SHOES,Me.LEGS,Me.CHEST,Me.CHEST_ACCESSORY,Me.COAT_CHEST,Me.CHEST_PRINT,Me.WAIST_ACCESSORY,Me.RIGHT_HAND,Me.RIGHT_SLEEVE,Me.RIGHT_COAT_SLEEVE,Me.HEAD,Me.FACE,Me.EYES,Me.HAIR,Me.HAIR_BIG,Me.FACE_ACCESSORY,Me.EYE_ACCESSORY,Me.HEAD_ACCESSORY,Me.HEAD_ACCESSORY_EXTRA,Me.RIGHT_HAND_ITEM];let Yi=sr;class ko{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const e of this._categories.values())e&&e.dispose();this._categories=new Map}addCategory(e){let n=this._categories.get(e);n||(n=bt.createCategory(this,e),n&&(this._categories.set(e,n),this.updateSelectionsFromFigure(e)))}updateSelectionsFromFigure(e){const n=this._categories.get(e);if(!n)return;const r=bt.CURRENT_FIGURE.getPartSetId(e);let s=bt.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s)}hasClubSelectionsOverLevel(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n&&n.hasClubSelectionsOverLevel(e))return!0;return!1}hasInvalidSelectedItems(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n.hasInvalidSelectedItems(e))return!0;return!1}stripClubItemsOverLevel(e){if(!this._categories)return!1;let n=!1;for(const[r,s]of this._categories.entries()){let a=!1;if(s.stripClubItemsOverLevel(e)&&(a=!0),s.stripClubColorsOverLevel(e)&&(a=!0),a){const l=s.getCurrentPart();l&&bt.CURRENT_FIGURE&&bt.CURRENT_FIGURE.savePartData(r,l.id,s.getSelectedColorIds(),!0),n=!0}}return n}stripInvalidSellableItems(){if(!this._categories)return!1;let e=!1;for(const[n,r]of this._categories.entries());return e}selectPart(e,n){const r=this._categories.get(e);if(!r)return;const s=r.selectedPartIndex;r.selectPartIndex(n);const a=r.getCurrentPart();if(a){if(a.isDisabled){r.selectPartIndex(s);return}this._maxPaletteCount=a.maxColorIndex,bt.CURRENT_FIGURE.savePartData(e,a.id,r.getSelectedColorIds(),!0)}}selectColor(e,n,r){const s=this._categories.get(e);if(!s)return;const a=s.getCurrentColorIndex(r);if(s.selectColorIndex(n,r),s.getSelectedColor(r).isDisabled){s.selectColorIndex(a,r);return}bt.CURRENT_FIGURE.savePartSetColourId(e,s.getSelectedColorIds(),!0)}getCategoryData(e){return this._isInitalized||this.init(),this._categories?this._categories.get(e):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(e){this._maxPaletteCount=e}get name(){return null}}class Yb extends ko{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(be.FACE),this._isInitalized=!0}selectColor(e,n,r){super.selectColor(e,n,r),this.updateSelectionsFromFigure(be.FACE)}updateSelectionsFromFigure(e){if(!this._categories||!bt.CURRENT_FIGURE)return;const n=this._categories.get(e);if(!n)return;const r=bt.CURRENT_FIGURE.getPartSetId(e);let s=bt.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s);for(const a of n.parts){const l=u=>{const d=bt.CURRENT_FIGURE.getFigureStringWithFace(a.id),g=St().createAvatarImage(d,tc.LARGE,null,{resetFigure:l,dispose:null,disposed:!1}),m=g.getImageAsSprite(Vi.HEAD);m&&(m.y=10,a.thumbContainer=m,setTimeout(()=>g.dispose(),0))};l()}}get canSetGender(){return!0}get name(){return Dr.GENERIC}}const Jt=i=>{if(i==null||typeof i!="object")return i;const e=new i.constructor;for(const n in i)i.hasOwnProperty(n)&&(e[n]=i[n]);return e};class an{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const n=e>>>0;return an.makeColorHex(n.toString(16).substring(2))}static int_to_8BitVals(e){const n=e>>24&255,r=e>>16&255,s=e>>8&255,a=e&255;return[n,r,s,a]}static eight_bitVals_to_int(e,n,r,s){return(e<<24)+(n<<16)+(r<<8)+(s|0)}static int2rgb(e){e>>>=0;const n=e&255,r=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,r,n,1].join(",")+")"}}const os=i=>{let e=Math.floor(i/86400),n=Math.floor(i%86400/3600),r=Math.floor(i%86400%3600/60),s=i%86400%3600%60;return e.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")},zi=i=>{try{JSON.parse(window.localStorage.getItem(i))}catch{return null}},uc=i=>{let e=pe().localization.getBadgeDesc(i);return(!e||!e.length)&&(e=`badge_desc_${i}`),e},Qa=i=>{let e=pe().localization.getBadgeName(i);return(!e||!e.length)&&(e=`badge_name_${i}`),e};function ta(i){return!i||isNaN(i)?"0":i.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function zb(i){if(!i||isNaN(i))return"0";let e=Math.abs(i);const n=Math.pow(10,1),r=i<0;let s="";const a=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const l of a){let u=e/l.value;if(u=Math.round(u*n)/n,u>=1){e=u,s=l.key;break}}return(r?"-":"")+e+s}function h(i,e=null,n=null){return pe().getLocalizationWithParameters(i,e,n)}const lo=class lo{};lo.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects",lo.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";let Va=lo;const Lm=(i,e)=>i.dispatchEvent(e),Ml=i=>Lm(pe().events,i),gr=new hg,Nt=i=>Lm(gr,i);let Mm=!1;const fr=i=>{Mm&&Ml(new Uc(Uc.PLAY_SOUND,i))},lu=[ve.MOUSE_CLICK],$b=()=>{const i=()=>lu.forEach(n=>window.removeEventListener(n,e)),e=n=>(Mm=!0)&&i();lu.forEach(n=>window.addEventListener(n,e))};$b();const rt=class rt{};rt.DEFAULT=1,rt.WALL_PAPER=2,rt.FLOOR=3,rt.LANDSCAPE=4,rt.POST_IT=5,rt.POSTER=6,rt.SOUND_SET=7,rt.TRAX_SONG=8,rt.PRESENT=9,rt.ECOTRON_BOX=10,rt.TROPHY=11,rt.CREDIT_FURNI=12,rt.PET_SHAMPOO=13,rt.PET_CUSTOM_PART=14,rt.PET_CUSTOM_PART_SHAMPOO=15,rt.PET_SADDLE=16,rt.GUILD_FURNI=17,rt.GAME_FURNI=18,rt.MONSTERPLANT_SEED=19,rt.MONSTERPLANT_REVIVAL=20,rt.MONSTERPLANT_REBREED=21,rt.MONSTERPLANT_FERTILIZE=22,rt.FIGURE_PURCHASABLE_SET=23;let ce=rt;class Ga{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(Dn()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new Ga(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class dc{constructor(e=-1,n=-1,r=null,s=null,a=-1){this._type=e,this._category=n,this._roomEngine=r,this._stuffData=s,this._extra=a,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new dc;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const n of this._items)if(n.id===e)return n;return null}getTradeItems(e){const n=[],r=this.getLastItem();if(!r)return n;let s=0,a=0;for(;a<this._items.length&&!(s>=e);){const l=this.getItemByIndex(a);!l.locked&&l.isTradable&&l.type===r.type&&(n.push(l),s++),a++}return n}push(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e.id){s=s.clone(),s.locked=!1,n.splice(r,1),n.push(s),this._items=n;return}r++}n.push(e),this._items=n,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let n=null;if(e.length>0){const r=e.length-1;n=e[r],e.splice(r,1)}return this._items=e,n}remove(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e)return n.splice(r,1),this._items=n,s;r++}return null}getTotalCount(){if(this._category===ce.POST_IT){let e=0,n=0;for(;n<this._items.length;){const r=this.getItemByIndex(n);e=e+parseInt(r.stuffData.getLegacyString()),n++}return e}return this._items.length}getUnlockedCount(){if(this.category===ce.POST_IT)return this.getTotalCount();let e=0,n=0;for(;n<this._items.length;)this.getItemByIndex(n).locked||e++,n++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let n=0;for(;n<e.length;){const r=e[n];if(r.locked){const s=r.clone();s.locked=!1,e[n]=s}n++}this._items=e}lockItemIds(e){const n=[...this._items];let r=0,s=!1;for(;r<n.length;){const a=n[r],l=e.indexOf(a.ref)>=0;if(a.locked!==l){s=!0;const u=a.clone();u.locked=l,n[r]=u}r++}return this._items=n,s}setName(){const e=this.getLastItem();if(!e){this._name="";return}let n="";switch(this._category){case ce.POSTER:n="poster_"+e.stuffData.getLegacyString()+"_name";break;case ce.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?n="wallItem.name."+e.type:n="roomItem.name."+e.type}this._name=h(n)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get items(){return this._items}set items(e){this._items=e}}const mc=(i,e,n,r=NaN)=>new dc(i,e,$(),n,r),Kb=(i,e,n)=>{const r=[];for(const a of i)a.type===e.type&&r.push(a);for(const a of r)if(a.getItemById(e.id))return a;const s=mc(e.type,e.category,e.stuffData,e.extra);return s.push(e),n?(s.hasUnseenItems=!0,i.unshift(s)):i.push(s),s},Xb=(i,e,n)=>{let r=null;for(const s of i)if(s.type===e.type&&s.isWallItem===e.isWallItem&&s.isGroupable)if(e.category===ce.POSTER){if(s.stuffData.getLegacyString()===e.stuffData.getLegacyString()){r=s;break}}else if(e.category===ce.GUILD_FURNI){if(e.stuffData.compare(s.stuffData)){r=s;break}}else{r=s;break}if(r){if(r.push(e),n){r.hasUnseenItems=!0;const s=i.indexOf(r);s>=0&&i.splice(s,1),i.unshift(r)}return r}return r=mc(e.type,e.category,e.stuffData,e.extra),r.push(e),n?(r.hasUnseenItems=!0,i.unshift(r)):i.push(r),r},cu=(i,e,n)=>{e.isGroupable?Xb(i,e,n):Kb(i,e,n)},Qb=(i,e,n,r)=>{if(e===1)return i;r[n]=i;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[l,u]of a)s.set(l,u);a.clear()}return r=null,s},Jb=i=>{const e=[];for(const n of i){let r=n.getTotalCount();n.category===ce.POST_IT&&(r=1);let s=0;for(;s<r;)e.push(n.getItemByIndex(s).id),s++}return e};let xm=!1,Um=-1;const Zb=()=>xm,Ja=i=>xm=i,na=()=>Um,Ao=i=>Um=i,Ba=()=>{na()!==-1&&($().cancelRoomObjectPlacement(),Ao(-1),Ja(!1))},xl=(i,e=!1)=>{const n=i.petData;if(!n)return!1;const r=Os().getSession(1);return!r||!r.isRoomOwner&&!r.allowPets?!1:(Z("inventory/hide"),$().processRoomObjectPlacement(Aa.INVENTORY,-n.id,Q.UNIT,ut.PET,n.figureData.figuredata)&&(Ao(n.id),Ja(!0)),!0)},ra=(i,e=!1)=>{if(!i||!i.getUnlockedCount())return!1;const n=i.getLastItem();if(!n)return!1;if(n.category===ce.FLOOR||n.category===ce.WALL_PAPER||n.category===ce.LANDSCAPE)return e||L(new Mi(n.id)),!1;{Z("inventory/hide");let r=0,s=!1;n.isWallItem?r=Q.WALL:r=Q.FLOOR,n.category===ce.POSTER?s=$().processRoomObjectPlacement(Aa.INVENTORY,n.id,r,n.type,n.stuffData.getLegacyString()):s=$().processRoomObjectPlacement(Aa.INVENTORY,n.id,r,n.type,n.extra.toString(),n.stuffData),s&&(Ao(n.ref),Ja(!0))}return!0},Ul=(i,e=!1)=>{const n=i.botData;if(!n)return!1;const r=Os().getSession(1);return!r||!r.isRoomOwner?!1:(Z("inventory/hide"),$().processRoomObjectPlacement(Aa.INVENTORY,-n.id,Q.UNIT,ut.RENTABLE_BOT,n.figure)&&(Ao(n.id),Ja(!0)),!0)},Br=class Br{};Br.FURNI=1,Br.RENTABLE=2,Br.PET=3,Br.BADGE=4,Br.BOT=5,Br.GAMES=6;let Ze=Br;const eN=i=>i.map(e=>e.petData.id),Fm=(i,e,n=!0)=>{const r={petData:i};return n?e.unshift(r):e.push(r),r},Vm=(i,e)=>{let n=0;for(;n<e.length;){const r=e[n];if(r&&r.petData.id===i)return na()===r.petData.id&&(Ba(),Z("inventory/open")),e.splice(n,1),r;n++}return null},tN=(i,e,n)=>{const r=eN(i),s=[],a=[];for(const l of e.keys())r.indexOf(l)===-1&&s.push(l);for(const l of r)!e.get(l)&&a.push(l);r.length;for(const l of a)Vm(l,i);for(const l of s){const u=e.get(l);u&&Fm(u,i,n(Ze.PET,u.id))}return i},nN=(i,e,n,r)=>{if(e===1)return i;r[n]=i;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[l,u]of a)s.set(l,u);a.clear()}return r=null,s},yr=class yr{};yr.TRADING_STATE_READY=0,yr.TRADING_STATE_RUNNING=1,yr.TRADING_STATE_COUNTDOWN=2,yr.TRADING_STATE_CONFIRMING=3,yr.TRADING_STATE_CONFIRMED=4,yr.TRADING_STATE_COMPLETED=5,yr.TRADING_STATE_CANCELLED=6;let _t=yr;class uu{constructor(e=-1,n="",r=new Da,s=0,a=0,l=!1,u=!1){this.userId=e,this.userName=n,this.userItems=r,this.itemCount=s,this.creditsCount=a,this.accepts=l,this.canTrade=u}}const Gn=class Gn{};Gn.ALERT_SCAM=0,Gn.HOTEL_TRADING_DISABLED=1,Gn.YOU_NOT_ALLOWED=2,Gn.THEY_NOT_ALLOWED=4,Gn.ROOM_DISABLED=6,Gn.YOU_OPEN=7,Gn.THEY_OPEN=8,Gn.ERROR_WHILE_COMMIT=9,Gn.THEY_CANCELLED=10;let en=Gn;const du=i=>{var e;return((e=H().getWallItemData(i))==null?void 0:e.isExternalImage)||!1},mu=i=>{const e=new Da;if(i.length)for(const r of i){const s=r.spriteId,a=r.category;let l=r.furniType+s;(!r.isGroupable||du(s))&&(l="itemid"+r.itemId),r.category===ce.POSTER?l=r.itemId+"poster"+r.stuffData.getLegacyString():r.category===ce.GUILD_FURNI&&(l="");let u=r.isGroupable&&!du(r.spriteId)?e.getValue(l):null;u||(u=mc(s,a,r.stuffData),e.add(l,u)),u.push(new Ga(r))}return e},rN=(i,e)=>{let n=i.toString();if(!(e instanceof $a))return n;let r=1;for(;r<5;)n=n+(","+e.getValue(r)),r++;return n};class xi{static getProductImageUrl(e,n,r){let s=null;switch(e){case ua.S:s=$().getFurnitureFloorIconUrl(n);break;case ua.I:this.getProductCategory(ua.I,n)===1&&(s=$().getFurnitureWallIconUrl(n,r));break}return s}static getProductCategory(e,n){if(e===ua.S)return 1;if(e===ua.I){if(n===3001)return ce.WALL_PAPER;if(n===3002)return ce.FLOOR;if(n===4057)return ce.LANDSCAPE}return 1}}class $i{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,n){const r=new Array(n);let s=e.length;const a=new Array(s);for(;n--;){var l=this.getRandomNumber(s);r[n]=e[l in a?a[l]:l],a[l]=--s in a?a[s]:s}return r}}const vt=new Map;vt.set("r","red");vt.set("b","blue");vt.set("g","green");vt.set("y","yellow");vt.set("w","white");vt.set("o","orange");vt.set("c","cyan");vt.set("br","brown");vt.set("pr","purple");vt.set("pk","pink");vt.set("red","red");vt.set("blue","blue");vt.set("green","green");vt.set("yellow","yellow");vt.set("white","white");vt.set("orange","orange");vt.set("cyan","cyan");vt.set("brown","brown");vt.set("purple","purple");vt.set("pink","pink");const sN=i=>i.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,n,r)=>n!=="&"||r!=="#"?(/[\u00A0-\u9999<>&]/.test(r)&&(r="&#"+r.charCodeAt(0)+";"),"&#"+n.charCodeAt(0)+";"+r):e),aN=i=>{let e="";if(i=sN(i),i.startsWith("@")&&i.indexOf("@",1)>-1){let n=null;for(;(n=/@[a-zA-Z]+@/g.exec(i))!==null;){const r=n[0].toString(),s=r.substr(1,r.length-2),a=i.replace(r,"");vt.has(s)?e='<span style="color: '+vt.get(s)+'">'+a+"</span>":e=a;break}}else e=i;return e},Gm=(i,e)=>window.localStorage.setItem(i,JSON.stringify(e)),Hr=class Hr{};Hr.CAMERA_SHUTTER="camera_shutter",Hr.CREDITS="credits",Hr.DUCKETS="duckets",Hr.MESSENGER_NEW_THREAD="messenger_new_thread",Hr.MESSENGER_MESSAGE_RECEIVED="messenger_message_received",Hr.MODTOOLS_NEW_TICKET="modtools_new_ticket";let pr=Hr;function iN(i){const e=i.parts;let n=0;for(const r of e)n=Math.max(n,r.colorLayerIndex);return n}function oN(i,e){return e=e.filter(n=>i.indexOf(n)===-1),[...i,...$i.getRandomElements(e,$i.getRandomNumber(e.length)+1)]}function lN(i,e,n=0,r=[]){if(!i)return null;const s=i.partSets.getValues().filter(a=>!a.isSelectable||a.gender!=="U"&&a.gender!==e||a.clubLevel>n||a.isSellable&&r.indexOf(a.id)===-1?null:a);return!s||!s.length?null:$i.getRandomElement(s)}function cN(i,e,n=0){if(!i)return[];const r=i.colors.getValues().filter(s=>!s.isSelectable||s.clubLevel>n?null:s);return!r||!r.length?null:$i.getRandomElements(r,iN(e))}function uN(i,e,n=0,r=[],s=[]){const a=St().structure,l=new gg(""),u=oN(a.getMandatorySetTypeIds(e,n),be.SET_TYPES);for(const d of s){const g=i.getPartSetId(d),m=i.getColorIds(d);l.updatePart(d,g,m)}for(const d of u){if(l.hasPartType(d))continue;const g=a.figureData.getSetType(d),m=lN(g,e,n,r);if(!m)continue;let f=[];m.isColorable&&(f=cN(a.figureData.getPalette(g.paletteID),m,n).map(I=>I.id)),l.updatePart(g.type,m.id,f)}return l.getFigureString()}class dN extends ko{init(){super.init(),this.addCategory(be.HAIR),this.addCategory(be.HAT),this.addCategory(be.HEAD_ACCESSORIES),this.addCategory(be.EYE_ACCESSORIES),this.addCategory(be.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return Dr.HEAD}}class mN extends ko{init(){super.init(),this.addCategory(be.TROUSERS),this.addCategory(be.SHOES),this.addCategory(be.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return Dr.LEGS}}class hN extends ko{init(){super.init(),this.addCategory(be.SHIRT),this.addCategory(be.CHEST_PRINTS),this.addCategory(be.JACKET),this.addCategory(be.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return Dr.TORSO}}const co=class co{};co.COLORMATRIX="colormatrix",co.COMPOSITE="composite";let Ha=co;class gN{constructor(e,n){this.texture=e,this.imageUrl=n}}class fN{constructor(e,n){this.effectName=e,this.thumbnailUrl=n}}class pN{constructor(e,n,r){this._productName=e,this._customImage=n,this._furnitureClassName=r}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}const Hs=class Hs{};Hs.STATE_UNLOCKED=1,Hs.STATE_LOCKED_AVAILABLE=2,Hs.STATE_LOCKED_EXPIRED=3,Hs.STATE_LOCKED_FUTURE=4;let Xt=Hs;const Ea=class Ea{};Ea.TYPE_CHAT=1,Ea.TYPE_ROOM_INFO=2,Ea.TYPE_IM=3;let $n=Ea;const Bm=()=>{const i=new Date;return`${i.getHours().toString().padStart(2,"0")}:${i.getMinutes().toString().padStart(2,"0")}`},hu=(i=0)=>{const e=i?new Date(Date.now()-i*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},Hm=i=>{if(!i||!i.length)return null;const e=i.split("/"),n=e[0],r=e[1],s=parseInt(e[2]);return{username:n,figure:r,userId:s}},Ws=class Ws{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus}};Ws.RELATIONSHIP_NONE=0,Ws.RELATIONSHIP_HEART=1,Ws.RELATIONSHIP_SMILE=2,Ws.RELATIONSHIP_BOBBA=3;let nn=Ws;const uo=class uo{};uo.GROUP_CHAT=0,uo.PRIVATE_CHAT=1;let sa=uo;const Ca=class Ca{};Ca.HIDDEN=0,Ca.SHOW=1,Ca.UNREAD=2;let hr=Ca;class gu{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class IN{constructor(e=0,n=0,r=0,s=[]){this.userFriendLimit=e,this.normalFriendLimit=n,this.extendedFriendLimit=r,this.categories=s}}const js=class js{constructor(e,n,r=0,s=null,a=0){this._type=a,this._senderId=e,this._message=n,this._secondsSinceSent=r,this._extraData=s,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}};js.CHAT=0,js.ROOM_INVITE=1,js.STATUS_NOTIFICATION=2,js.SECURITY_NOTIFICATION=3;let Pr=js;class EN{constructor(e,n=sa.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=n}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const _a=class _a{constructor(e){this._threadId=++_a.THREAD_ID,this._participant=e,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(e,n,r=0,s=null,a=0){const l=e<0&&s,u=l?Hm(s).userId:e,d=this.getLastGroup(u);if(!d)return;l&&(d.type=sa.GROUP_CHAT);const g=new Pr(e,n,r,s,a);return d.addChat(g),this._lastUpdated=new Date,this._unreadCount++,g}getLastGroup(e){let n=this._groups[this._groups.length-1];return n&&n.userId===e||(n=new EN(e),this._groups.push(n)),n}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};_a.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",_a.THREAD_ID=0;let Fl=_a;function Do(i=0){Z(i===0?"friends-messenger/toggle":`friends-messenger/${i}`)}const CN=()=>jd.RENDERER_VERSION,Wm=()=>"2.2.0";function Za(i){L(new Pa(i,!0))}function jm(i){Z(`groups/manage/${i}`)}function fu(i,e){Z(e?`group-members/${i}/${e}`:`group-members/${i}`)}const qs=class qs{constructor(e,n,r,s){this.type=e,this.key=n||0,this.color=r||0,this.position=s||4}get code(){return this.key===0&&this.type!==qs.BASE?null:qs.getCode(this.type,this.key,this.color,this.position)}static getCode(e,n,r,s){return e+(n<10?"0":"")+n+(r<10?"0":"")+r+s}};qs.BASE="b",qs.SYMBOL="s";let $t=qs;const ba=class ba{};ba.NOT_MEMBER=0,ba.MEMBER=1,ba.REQUEST_PENDING=2;let yt=ba;const Na=class Na{};Na.REGULAR=0,Na.EXCLUSIVE=1,Na.PRIVATE=2;let Cn=Na;const _N=i=>{L(i.favourite?new fg(i.groupId):new pg(i.groupId))},hc=i=>L(new Ig(i)),Et=class Et{};Et.NONE="NONE",Et.ERROR="ERROR",Et.REJECTED="REJECTED",Et.USER_CREATE="USER_CREATE",Et.USER_PENDING="USER_PENDING",Et.USER_ONGOING="USER_ONGOING",Et.USER_FEEDBACK="USER_FEEDBACK",Et.USER_NO_HELPERS="USER_NO_HELPERS",Et.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG",Et.USER_THANKS="USER_THANKS",Et.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED",Et.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU",Et.GUIDE_ACCEPT="GUIDE_ACCEPT",Et.GUIDE_ONGOING="GUIDE_ONGOING",Et.GUIDE_CLOSED="GUIDE_CLOSED",Et.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT",Et.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS",Et.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE",Et.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS",Et.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";let ke=Et;class pu{constructor(e,n){this._message=e,this._roomId=n}get message(){return this._message}get roomId(){return this._roomId}}class Iu{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}const Sa=class Sa{};Sa.ACTIVE="active",Sa.NONE="none",Sa.EXPIRED="expired";let ur=Sa;const bN="HC1",NN=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],SN=i=>{let e=null;return NN.forEach(n=>i.indexOf(n)>-1&&(e=n)),e||bN},mo=class mo{};mo.TOO_MANY_PENDING_CALLS_CODE=1,mo.HAS_ABUSIVE_CALL_CODE=2;let Ki=mo;const vN=i=>i===1?"useless":i===2?"abusive":"resolved",gs=class gs{};gs.SELECT_USER=0,gs.SELECT_CHATS=1,gs.SELECT_TOPICS=2,gs.INPUT_REPORT_MESSAGE=3,gs.REPORT_SUMMARY=4;let jt=gs;const ar=class ar{};ar.EMERGENCY=1,ar.GUIDE=2,ar.IM=3,ar.ROOM=4,ar.BULLY=6,ar.THREAD=7,ar.MESSAGE=8,ar.PHOTO=9;let Je=ar;const TN=i=>{switch(i){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"},Wr=class Wr{constructor(e,n,r,s,a){this._actionId=e,this._name=n,this._actionType=r,this._sanctionTypeId=s,this._actionLengthHours=a}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}};Wr.ALERT=1,Wr.MUTE=2,Wr.BAN=3,Wr.KICK=4,Wr.TRADE_LOCK=5,Wr.MESSAGE=6;let xe=Wr;const Bn=class Bn{};Bn.NONE=0,Bn.START_DOORBELL=1,Bn.START_PASSWORD=2,Bn.STATE_PENDING_SERVER=3,Bn.UPDATE_STATE=4,Bn.STATE_WAITING=5,Bn.STATE_NO_ANSWER=6,Bn.STATE_WRONG_PASSWORD=7,Bn.STATE_ACCEPTED=8;let Ve=Bn;const va=class va{};va.LIST=0,va.THUMBNAILS=1,va.FORCED_THUMBNAILS=2;let Vl=va;const wN=()=>{const i=[];for(let e=10;e<=100;e=e+10)i.push(e);return i},Eu=wN(),Ps=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function vn(i){L(new Gi(i,!1,!0))}const kr=class kr{};kr.DEFAULT="default",kr.MOTD="motd",kr.MODERATION="moderation",kr.EVENT="event",kr.NITRO="nitro",kr.SEARCH="search",kr.ALERT="alert";let me=kr;const Ta=class Ta{constructor(e,n=me.DEFAULT,r=null,s=null,a=null,l=null){Ta.ITEM_ID+=1,this._id=Ta.ITEM_ID,this._messages=e,this._alertType=n,this._clickUrl=r,this._clickUrlText=s,this._title=a,this._imageUrl=l}get id(){return this._id}get messages(){return this._messages}set alertType(e){this._alertType=e}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};Ta.ITEM_ID=-1;let Xi=Ta;const Pt=class Pt{};Pt.FRIENDOFFLINE="friendoffline",Pt.FRIENDONLINE="friendonline",Pt.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline",Pt.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline",Pt.ACHIEVEMENT="achievement",Pt.BADGE_RECEIVED="badge_received",Pt.INFO="info",Pt.RECYCLEROK="recyclerok",Pt.RESPECT="respect",Pt.CLUB="club",Pt.SOUNDMACHINE="soundmachine",Pt.PETLEVEL="petlevel",Pt.CLUBGIFT="clubgift",Pt.BUYFURNI="buyfurni",Pt.VIP="vip",Pt.ROOMMESSAGESPOSTED="roommessagesposted";let Kt=Pt;const wa=class wa{constructor(e,n=Kt.INFO,r=null,s=null){wa.ITEM_ID+=1,this._id=wa.ITEM_ID,this._message=e,this._notificationType=n,this._iconUrl=r,this._linkUrl=s}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};wa.ITEM_ID=-1;let Gl=wa;const Ra=class Ra{constructor(e,n,r,s,a,l,u){Ra.ITEM_ID+=1,this._id=Ra.ITEM_ID,this._confirmType=e,this._message=n,this._onConfirm=r,this._onCancel=s,this._confirmText=a,this._cancelText=l,this._title=u}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};Ra.ITEM_ID=-1;let Bl=Ra;const yc=class yc{};yc.DEFAULT="default";let Cu=yc;class gc{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const n=new gc;return n._credits=e._credits,n._activityPoints=e._activityPoints,n._clubDays=e._clubDays,n._clubPeriods=e._clubPeriods,n._isVIP=e._isVIP,n._pastClubDays=e._pastClubDays,n._pastVipDays=e._pastVipDays,n._isExpiring=e._isExpiring,n._minutesUntilExpiration=e._minutesUntilExpiration,n._minutesSinceLastModified=e._minutesSinceLastModified,n._lastUpdated=e._lastUpdated,n}get credits(){return this._credits}set credits(e){this._lastUpdated=Dn(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=Dn(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=Dn(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=Dn(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=Dn(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=Dn(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(Dn()-this._lastUpdated)/6e4,n=this._minutesUntilExpiration-e;return n>0?n:0}set minutesUntilExpiration(e){this._lastUpdated=Dn(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=Dn(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?sn.NO_CLUB:this.isVip?sn.VIP:sn.CLUB}}class ei extends Un{}const Oa=class Oa extends ei{constructor(e,n){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=n}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}};Oa.OFFER="RWPUW_OFFER",Oa.ERROR="RWPUW_ERROR",Oa.CONTENT="RWPUW_CONTENT";let Gr=Oa;const ho=class ho extends ei{constructor(e,n=0,r=0,s=0){super(e),this._hue=n,this._saturation=r,this._lightness=s}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};ho.PREVIEW="RWUBCPE_PREVIEW",ho.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";let qr=ho;const Ys=class Ys extends ei{constructor(e,n){super(Ys.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=e,this._userName=n}get chatMode(){return this._chatMode}get userName(){return this._userName}};Ys.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT",Ys.WHISPER="whisper",Ys.SHOUT="shout";let _s=Ys;const go=class go extends ei{constructor(e,n,r,s,a,l,u){super(go.UPDATE_CHAT),this._objectId=e,this._category=n,this._botId=r,this._chat=s,this._automaticChat=a,this._chatDelay=l,this._mixSentences=u}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};go.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let Qi=go;const kn=class kn extends ei{constructor(e,n,r,s){super(e),this._id=n,this._category=r,this._roomId=s}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}};kn.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED",kn.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED",kn.USER_REMOVED="RWUROE_USER_REMOVED",kn.FURNI_REMOVED="RWUROE_FURNI_REMOVED",kn.FURNI_ADDED="RWUROE_FURNI_ADDED",kn.USER_ADDED="RWUROE_USER_ADDED",kn.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER",kn.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT",kn.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION",kn.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";let Ue=kn;const kc=class kc{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}};kc.FURNI="IFI_FURNI";let Ns=kc;class qm{constructor(e,n,r,s,a,l=!1){this.roomIndex=e,this.category=n,this.id=r,this.name=s,this.userType=a,this.isFriend=l}}const Ac=class Ac{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}};Ac.PET_INFO="IPI_PET_INFO";let Ss=Ac;const Dc=class Dc{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}};Dc.RENTABLE_BOT="IRBI_RENTABLE_BOT";let vs=Dc;const ir=class ir{constructor(e){this.type=e,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===ir.OWN_USER}};ir.OWN_USER="IUI_OWN_USER",ir.PEER="IUI_PEER",ir.BOT="IUI_BOT",ir.TRADE_REASON_OK=0,ir.TRADE_REASON_SHUTDOWN=2,ir.TRADE_REASON_NO_TRADING=3,ir.DEFAULT_BOT_BADGE_ID="BOT";let Ct=ir;class Ls{static getObjectName(e,n){const r=Te();let s=-1,a=null,l=0;switch(n){case Q.FLOOR:case Q.WALL:{const u=$().getRoomObject(r.roomId,e,n);if(!u)break;if(u.type.indexOf("poster")===0)a=h("${poster_"+parseInt(u.type.replace("poster",""))+"_name}");else{let d=null;const g=u.model.getValue(te.FURNITURE_TYPE_ID);if(n===Q.FLOOR?d=H().getFloorItemData(g):n===Q.WALL&&(d=H().getWallItemData(g)),!d)break;s=d.id,a=d.name}break}case Q.UNIT:{const u=r.userDataManager.getUserDataByIndex(e);if(!u)break;s=u.webID,a=u.name,l=u.type;break}}return!a||!a.length?null:new qm(e,n,s,a,l)}static getFurniInfo(e,n){const r=Te(),s=new Ns(Ns.FURNI);s.id=e,s.category=n;const a=$().getRoomObject(r.roomId,e,n);if(!a)return;const l=a.model;l.getValue(Tr.INFOSTAND_EXTRA_PARAM)&&(s.extraParam=l.getValue(Tr.INFOSTAND_EXTRA_PARAM));const u=l.getValue(te.FURNITURE_DATA_FORMAT),d=qd.getData(u);d.initializeFromRoomObjectModel(l),s.stuffData=d;const g=a.type;if(g.indexOf("poster")===0){const p=parseInt(g.replace("poster",""));s.name=h("${poster_"+p+"_name}"),s.description=h("${poster_"+p+"_desc}")}else{const p=l.getValue(te.FURNITURE_TYPE_ID);let _=null;n===Q.FLOOR?_=H().getFloorItemData(p):n===Q.WALL&&(_=H().getWallItemData(p)),_&&(s.name=_.name,s.description=_.description,s.purchaseOfferId=_.purchaseOfferId,s.purchaseCouldBeUsedForBuyout=_.purchaseCouldBeUsedForBuyout,s.rentOfferId=_.rentOfferId,s.rentCouldBeUsedForBuyout=_.rentCouldBeUsedForBuyout,s.availableForBuildersClub=_.availableForBuildersClub,s.tileSizeX=_.tileSizeX,s.tileSizeY=_.tileSizeY)}g.indexOf("post_it")>-1&&(s.isStickie=!0);const m=l.getValue(te.FURNITURE_EXPIRY_TIME),f=l.getValue(te.FURNITURE_EXPIRTY_TIMESTAMP);s.expiration=m<0?m:Math.max(0,m-(Dn()-f)/1e3);let I=$().getRoomObjectImage(r.roomId,e,n,new Tt(180),64,null);(!I.data||I.data.width>140||I.data.height>200)&&(I=$().getRoomObjectImage(r.roomId,e,n,new Tt(180),1,null)),s.image=I.getImage(),s.isWallItem=n===Q.WALL,s.isRoomOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.isAnyRoomController=H().isModerator,s.ownerId=l.getValue(te.FURNITURE_OWNER_ID),s.ownerName=l.getValue(te.FURNITURE_OWNER_NAME),s.usagePolicy=l.getValue(te.FURNITURE_USAGE_POLICY);const C=l.getValue(te.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return C!==0&&(s.groupId=C),Wt(a)&&(s.isOwner=!0),s}static getUserInfo(e,n){const r=Te();let s=Ct.OWN_USER;n.webID!==H().userId&&(s=Ct.PEER);const a=new Ct(s);a.isSpectatorMode=r.isSpectator,a.name=n.name,a.motto=n.custom,a.achievementScore=n.activityPoints,a.webID=n.webID,a.roomIndex=n.roomIndex,a.userType=ut.USER;const l=$().getRoomObject(r.roomId,n.roomIndex,e);if(l&&(a.carryItem=l.model.getValue(te.FIGURE_CARRY_OBJECT)||0),s===Ct.OWN_USER&&(a.allowNameChange=H().canChangeName),a.amIOwner=r.isRoomOwner,a.isGuildRoom=r.isGuildRoom,a.roomControllerLevel=r.controllerLevel,a.amIAnyRoomController=H().isModerator,a.isAmbassador=H().isAmbassador,s===Ct.PEER){if(l){const g=l.model.getValue(te.FIGURE_FLAT_CONTROL);g!==null&&(a.targetRoomControllerLevel=g),a.canBeMuted=this.canBeMuted(a),a.canBeKicked=this.canBeKicked(a),a.canBeBanned=this.canBeBanned(a)}a.isIgnored=H().isUserIgnored(n.name),a.respectLeft=H().respectsLeft;const u=H().isSystemShutdown,d=r.tradeMode;if(u)a.canTrade=!1;else switch(d){case jo.ROOM_CONTROLLER_REQUIRED:{const g=a.roomControllerLevel!==Qe.NONE&&a.roomControllerLevel!==Qe.GUILD_MEMBER,m=a.targetRoomControllerLevel!==Qe.NONE&&a.targetRoomControllerLevel!==Qe.GUILD_MEMBER;a.canTrade=g||m;break}case jo.NO_TRADING:a.canTrade=!0;break;default:a.canTrade=!1;break}a.canTradeReason=Ct.TRADE_REASON_OK,u&&(a.canTradeReason=Ct.TRADE_REASON_SHUTDOWN),d!==jo.FREE_TRADING&&(a.canTradeReason=Ct.TRADE_REASON_NO_TRADING)}return a.groupId=n.groupId,a.groupBadgeId=H().getGroupBadge(a.groupId),a.groupName=n.groupName,a.badges=r.userDataManager.getUserBadges(n.webID),a.figure=n.figure,a}static getBotInfo(e,n){const r=Te(),s=new Ct(Ct.BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.userType=n.type;const a=$().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(te.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.isGuildRoom=r.isGuildRoom,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=H().isModerator,s.isAmbassador=H().isAmbassador,s.badges=[Ct.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getRentableBotInfo(e,n){const r=Te(),s=new vs(vs.RENTABLE_BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.ownerId=n.ownerId,s.ownerName=n.ownerName,s.botSkills=n.botSkills;const a=$().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(te.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=H().isModerator,s.badges=[Ct.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getPetInfo(e){const n=Te(),r=n.userDataManager.getPetData(e.id);if(!r)return;const s=new ea(r.figure);let a=null;s.typeId===Mt.MONSTERPLANT&&(e.level>=e.adultLevel?a="std":a="grw"+e.level);const l=e.ownerId===H().userId,u=new Ss(Ss.PET_INFO);return u.name=r.name,u.id=e.id,u.ownerId=e.ownerId,u.ownerName=e.ownerName,u.rarityLevel=e.rarityLevel,u.petType=s.typeId,u.petBreed=s.paletteId,u.petFigure=r.figure,u.posture=a,u.isOwner=l,u.roomIndex=r.roomIndex,u.level=e.level,u.maximumLevel=e.maximumLevel,u.experience=e.experience,u.levelExperienceGoal=e.levelExperienceGoal,u.energy=e.energy,u.maximumEnergy=e.maximumEnergy,u.happyness=e.happyness,u.maximumHappyness=e.maximumHappyness,u.respect=e.respect,u.respectsPetLeft=H().respectsPetLeft,u.age=e.age,u.saddle=e.saddle,u.rider=e.rider,u.breedable=e.breedable,u.fullyGrown=e.fullyGrown,u.dead=e.dead,u.rarityLevel=e.rarityLevel,u.skillTresholds=e.skillTresholds,u.canRemovePet=!1,u.publiclyRideable=e.publiclyRideable,u.maximumTimeToLive=e.maximumTimeToLive,u.remainingTimeToLive=e.remainingTimeToLive,u.remainingGrowTime=e.remainingGrowTime,u.publiclyBreedable=e.publiclyBreedable,(l||n.isRoomOwner||H().isModerator||n.controllerLevel>=Qe.GUEST)&&(u.canRemovePet=!0),u}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=Qe.GUILD_ADMIN:e.roomControllerLevel>=Qe.GUEST}static isValidSetting(e,n){const r=Te();if(!r.isPrivateRoom)return!1;const s=r.moderationSettings;let a=!1;return s&&(a=n(e,s)),a&&e.targetRoomControllerLevel<Qe.ROOM_OWNER}static canBeMuted(e){const n=(r,s)=>{switch(s.allowMute){case jn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Qe.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeKicked(e){const n=(r,s)=>{switch(s.allowKick){case jn.MODERATION_LEVEL_ALL:return!0;case jn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Qe.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeBanned(e){const n=(r,s)=>{switch(s.allowBan){case jn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Qe.ROOM_OWNER}};return this.isValidSetting(e,n)}}const Bt=class Bt{};Bt.GENERIC_SKILL=0,Bt.DRESS_UP=1,Bt.SETUP_CHAT=2,Bt.RANDOM_WALK=3,Bt.DANCE=4,Bt.CHANGE_BOT_NAME=5,Bt.SERVE_BEVERAGE=6,Bt.INCLIENT_LINK=7,Bt.NUX_PROCEED=8,Bt.CHANGE_BOT_MOTTO=9,Bt.NUX_TAKE_TOUR=10,Bt.NO_PICK_UP=12,Bt.NAVIGATOR_SEARCH=14,Bt.DONATE_TO_USER=24,Bt.DONATE_TO_ALL=25;let He=Bt;const fo=class fo{constructor(e=-1,n=-1,r=-1,s="",a="",l="",u=null,d=0,g=0,m=null,f=null){this.senderId=e,this.senderCategory=n,this.roomId=r,this.text=s,this.formattedText=a,this.username=l,this.location=u,this.type=d,this.styleId=g,this.imageUrl=m,this.color=f,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++fo.BUBBLE_COUNTER}get top(){return this._top}set top(e){this._top=e,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(e){this._left=e,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};fo.BUBBLE_COUNTER=0;let Hl=fo;const ya=class ya{};ya.CHAT_DEFAULT=0,ya.CHAT_WHISPER=1,ya.CHAT_SHOUT=2;let dr=ya;class _u{constructor(e=0,n=0,r=0,s=0){this.id=e,this.type=n,this.color=r,this.light=s}}const RN=(i,e,n,r=0)=>!(i.left+r+i.width<e.left+r||i.left+r>e.left+r+e.width||i.top+i.height<e.top+n||i.top>e.top+n+e.height),zs=class zs{static savePreset(e,n,r,s,a){Te().updateMoodlightData(e,n,r,s,a)}static changeState(){Te().toggleMoodlightState()}static previewDimmer(e,n,r){$().updateObjectRoomColor(Te().roomId,e,n,r)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*(100-0)/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}};zs.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0],zs.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"],zs.MIN_BRIGHTNESS=76,zs.MAX_BRIGHTNESS=255;let Pn=zs;const ON=130,yN=100,kN=130,AN=100,DN=130,PN=100,Ym=i=>{let e=0,n=0,r=0,s=0;for(;s<i.length;){switch(s%3){case 0:e=e+i.charCodeAt(s)*37;break;case 1:n=n+i.charCodeAt(s)*37;break;case 2:r=r+i.charCodeAt(s)*37;break}s++}return e=e%yN+ON,n=n%AN+kN,r=r%PN+DN,`rgb(${e},${n},${r})`},po=class po{static getMergedMannequinFigureContainer(e,n){const r=St().createFigureContainer(e),s=St().createFigureContainer(n);for(const a of this.MANNEQUIN_CLOTHING_PART_TYPES)r.removePart(a);for(const a of s.getPartTypeIds())r.updatePart(a,s.getPartSetId(a),s.getPartColorIds(a));return r}static transformAsMannequinFigure(e){for(const n of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(n)>=0||e.removePart(n);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}};po.MANNEQUIN_FIGURE=["hd",99999,[99998]],po.MANNEQUIN_CLOTHING_PART_TYPES=[Me.CHEST_ACCESSORY,Me.COAT_CHEST,Me.CHEST,Me.LEGS,Me.SHOES,Me.WAIST_ACCESSORY];let Zs=po;const Io=class Io{};Io.WATER=0,Io.LIGHT=1;let bu=Io;const Eo=class Eo{};Eo.POSTURE_STAND=0,Eo.POSTURE_SIT=1;let Ji=Eo;class Fs{constructor(e,n,r){this._id=e,this._category=n,this._name=r}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class LN{constructor(e,n,r,s,a,l,u){this.id=e,this.category=n,this.name=r,this.requestRoomObjectId=s,this.targetRoomObjectId=a,this.requestInventoryStripId=l,this.replace=u}}const Zi="0",zm="1",jr=class jr{};jr.UNSTARTED=-1,jr.ENDED=0,jr.PLAYING=1,jr.PAUSED=2,jr.BUFFERING=3,jr.CUED=5;let Yr=jr;function on(i){L(new Eg(i))}const ti=i=>{const e=Math.floor(i/2);return i%2?(e+.5).toString():e.toString()},Ye=class Ye{};Ye.TOGGLE_FURNI_STATE=0,Ye.RESET=1,Ye.SET_FURNI_STATE=3,Ye.MOVE_FURNI=4,Ye.GIVE_SCORE=6,Ye.CHAT=7,Ye.TELEPORT=8,Ye.JOIN_TEAM=9,Ye.LEAVE_TEAM=10,Ye.CHASE=11,Ye.FLEE=12,Ye.MOVE_AND_ROTATE_FURNI=13,Ye.GIVE_SCORE_TO_PREDEFINED_TEAM=14,Ye.TOGGLE_TO_RANDOM_STATE=15,Ye.MOVE_FURNI_TO=16,Ye.GIVE_REWARD=17,Ye.CALL_ANOTHER_STACK=18,Ye.KICK_FROM_ROOM=19,Ye.MUTE_USER=20,Ye.BOT_TELEPORT=21,Ye.BOT_MOVE=22,Ye.BOT_TALK=23,Ye.BOT_GIVE_HAND_ITEM=24,Ye.BOT_FOLLOW_AVATAR=25,Ye.BOT_CHANGE_FIGURE=26,Ye.BOT_TALK_DIRECT_TO_AVTR=27;let Xe=Ye;const ze=class ze{};ze.STATES_MATCH=0,ze.FURNIS_HAVE_AVATARS=1,ze.ACTOR_IS_ON_FURNI=2,ze.TIME_ELAPSED_MORE=3,ze.TIME_ELAPSED_LESS=4,ze.USER_COUNT_IN=5,ze.ACTOR_IS_IN_TEAM=6,ze.HAS_STACKED_FURNIS=7,ze.STUFF_TYPE_MATCHES=8,ze.STUFFS_IN_FORMATION=9,ze.ACTOR_IS_GROUP_MEMBER=10,ze.ACTOR_IS_WEARING_BADGE=11,ze.ACTOR_IS_WEARING_EFFECT=12,ze.NOT_STATES_MATCH=13,ze.FURNI_NOT_HAVE_HABBO=14,ze.NOT_ACTOR_ON_FURNI=15,ze.NOT_USER_COUNT_IN=16,ze.NOT_ACTOR_IN_TEAM=17,ze.NOT_HAS_STACKED_FURNIS=18,ze.NOT_FURNI_IS_OF_TYPE=19,ze.NOT_STUFFS_IN_FORMATION=20,ze.NOT_ACTOR_IN_GROUP=21,ze.NOT_ACTOR_WEARS_BADGE=22,ze.NOT_ACTOR_WEARING_EFFECT=23,ze.DATE_RANGE_ACTIVE=24,ze.ACTOR_HAS_HANDITEM=25;let tt=ze;const Nu=i=>`${i.getFullYear()}/${("0"+(i.getMonth()+1)).slice(-2)}/${("0"+i.getDate()).slice(-2)} ${("0"+i.getHours()).slice(-2)}:${("0"+i.getMinutes()).slice(-2)}`,$s=class $s{};$s.STUFF_SELECTION_OPTION_NONE=0,$s.STUFF_SELECTION_OPTION_BY_ID=1,$s.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2,$s.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;let le=$s;const MN=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,xN=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
    }
}`;class UN extends Cg{constructor(e,n){super(MN,xN),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=e,this.color=n}get lineColor(){return this._lineColor}set lineColor(e){const n=this.uniforms.lineColor;typeof e=="number"?(rn.hex2rgb(e,n),this._lineColor=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._lineColor=rn.rgb2hex(n))}get color(){return this._color}set color(e){const n=this.uniforms.color;typeof e=="number"?(rn.hex2rgb(e,n),this._color=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._color=rn.rgb2hex(n))}}const An=class An{static show(e){An.applySelectionShader(An.getRoomObject(e))}static hide(e){An.clearSelectionShader(An.getRoomObject(e))}static clearSelectionShaderFromFurni(e){for(const n of e)An.clearSelectionShader(An.getRoomObject(n))}static applySelectionShaderToFurni(e){for(const n of e)An.applySelectionShader(An.getRoomObject(n))}static getRoomObject(e){const n=$();return n.getRoomObject(n.activeRoomId,e,Q.FLOOR)}static applySelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.blendMode!==1&&(r.filters=[An._selectionShader])}static clearSelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.filters=[]}};An._selectionShader=new UN([1,1,1],[.6,.6,.6]);let bs=An;const aa="	",zt=class zt{};zt.AVATAR_SAYS_SOMETHING=0,zt.AVATAR_WALKS_ON_FURNI=1,zt.AVATAR_WALKS_OFF_FURNI=2,zt.EXECUTE_ONCE=3,zt.TOGGLE_FURNI=4,zt.EXECUTE_PERIODICALLY=6,zt.AVATAR_ENTERS_ROOM=7,zt.GAME_STARTS=8,zt.GAME_ENDS=9,zt.SCORE_ACHIEVED=10,zt.COLLISION=11,zt.EXECUTE_PERIODICALLY_LONG=12,zt.BOT_REACHED_STUFF=13,zt.BOT_REACHED_AVATAR=14;let Yt=zt;const P=i=>{const{ref:e=null,innerRef:n=null,display:r=null,fit:s=!1,fitV:a=!1,grow:l=!1,shrink:u=!1,fullWidth:d=!1,fullHeight:g=!1,overflow:m=null,position:f=null,float:I=null,pointer:C=!1,visible:p=null,textColor:_=null,classNames:E=[],className:b="",style:N={},children:T=null,...y}=i,R=o.useMemo(()=>{const D=[];return r&&r.length&&D.push("d-"+r),(s||d)&&D.push("w-100"),(s||g)&&D.push("h-100"),a&&D.push("vw-100","vh-100"),l&&D.push("flex-grow-1"),u&&D.push("flex-shrink-0"),m&&D.push("overflow-"+m),f&&D.push("position-"+f),I&&D.push("float-"+I),C&&D.push("cursor-pointer"),p!==null&&D.push(p?"visible":"invisible"),_&&D.push("text-"+_),E.length&&D.push(...E),D},[r,s,a,l,u,d,g,m,f,I,C,p,_,E]),O=o.useMemo(()=>{let D=R.join(" ");return b.length&&(D+=" "+b),D.trim()},[R,b]),F=o.useMemo(()=>{let D={};return Object.keys(N).length&&(D={...D,...N}),D},[N]);return t("div",{ref:n,className:O,style:F,...y,children:T})},$m=o.createContext({isCssGrid:!1}),FN=i=>t($m.Provider,{value:i.value,children:i.children}),VN=()=>o.useContext($m),ne=i=>{const{inline:e=!1,gap:n=2,maxContent:r=!1,columnCount:s=0,center:a=!1,alignSelf:l=null,alignItems:u=null,justifyContent:d=null,fullHeight:g=!0,classNames:m=[],style:f={},...I}=i,C=o.useMemo(()=>{const _=[];return e?_.push("inline-grid"):_.push("grid"),n?_.push("gap-"+n):n===0&&_.push("gap-0"),r&&_.push("flex-basis-max-content"),l&&_.push("align-self-"+l),u&&_.push("align-items-"+u),d&&_.push("justify-content-"+d),!u&&!d&&a&&_.push("align-items-center","justify-content-center"),m.length&&_.push(...m),_},[e,n,r,l,u,d,a,m]),p=o.useMemo(()=>{let _={};return s&&(_["--bs-columns"]=s.toString()),Object.keys(f).length&&(_={..._,...f}),_},[s,f]);return t(FN,{value:{isCssGrid:!0},children:t(P,{fullHeight:g,classNames:C,style:p,...I})})},ye=i=>{const{columnMinWidth:e=40,columnMinHeight:n=40,columnCount:r=0,fullHeight:s=!1,maxContent:a=!0,overflow:l="auto",style:u={},...d}=i,g=o.useMemo(()=>{let m={};return m["--nitro-grid-column-min-height"]=n+"px",r>1&&(m.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(u).length&&(m={...m,...u}),m},[e,n,r,u]);return t(ne,{columnCount:r,fullHeight:s,overflow:l,style:g,...d})},w=i=>{const{display:e="flex",column:n=void 0,reverse:r=!1,gap:s=null,center:a=!1,alignSelf:l=null,alignItems:u=null,justifyContent:d=null,classNames:g=[],...m}=i,f=o.useMemo(()=>{const I=[];return n?r?I.push("flex-column-reverse"):I.push("flex-column"):r&&I.push("flex-row-reverse"),s&&I.push("gap-"+s),l&&I.push("align-self-"+l),u&&I.push("align-items-"+u),d&&I.push("justify-content-"+d),!u&&!d&&a&&I.push("align-items-center","justify-content-center"),g.length&&I.push(...g),I},[n,r,s,a,l,u,d,g]);return t(P,{display:e,classNames:f,...m})},M=i=>{const{variant:e="primary",size:n="sm",active:r=!1,disabled:s=!1,classNames:a=[],...l}=i,u=o.useMemo(()=>{const d=["btn"];return e&&d.push("btn-"+e),n&&d.push("btn-"+n),r&&d.push("active"),s&&d.push("disabled"),a.length&&d.push(...a),d},[e,n,r,s,a]);return t(w,{center:!0,classNames:u,...l})},Lr=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["btn-group"];return e.length&&s.push(...e),s},[e]);return t(P,{classNames:r,...n})},Km=o.createContext({closers:null,setClosers:null,closeAll:null}),GN=i=>t(Km.Provider,{...i}),BN=()=>o.useContext(Km),eo=i=>{const{alignItems:e="center",gap:n=1,children:r=null,...s}=i;return t(w,{alignItems:e,gap:n,...s,children:r})},to=i=>{const{headerText:e="",isExpanded:n=!1,gap:r=0,classNames:s=[],children:a=null,...l}=i,[u,d]=o.useState(!1),{setClosers:g=null,closeAll:m=null}=BN(),f=()=>{m(),d(p=>!p)},I=o.useCallback(()=>d(!1),[]),C=o.useMemo(()=>{const p=["nitro-card-accordion-set"];return u&&p.push("active"),s&&s.length&&p.push(...s),p},[u,s]);return o.useEffect(()=>{d(n)},[n]),o.useEffect(()=>{const p=I;return g(_=>{const E=[..._];return E.push(p),E}),()=>{g(_=>{const E=[..._],b=E.indexOf(p);return b>=0&&E.splice(b,1),E})}},[I,g]),c(v,{classNames:C,gap:r,...l,children:[c(w,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:f,children:[t(S,{style:{color:"#443fbd"},children:e}),u&&t(zl,{className:"fa-icon"}),!u&&t($l,{className:"fa-icon"})]}),u&&t(v,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:a})]})},HN=i=>{const{...e}=i,[n,r]=o.useState([]),s=o.useCallback(()=>{for(const a of n)a()},[n]);return t(GN,{value:{closers:n,setClosers:r,closeAll:s},children:t(v,{gap:0,...e})})},re=i=>{const{overflow:e="auto",classNames:n=[],...r}=i,s=o.useMemo(()=>{const a=["container-fluid","content-area"];return n.length&&a.push(...n),a},[n]);return t(v,{classNames:s,overflow:e,...r})},WN=o.createContext({theme:null}),jN=i=>t(WN.Provider,{value:i.value,children:i.children}),ae=i=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:s=null,onCloseClick:a=null,justifyContent:l="center",alignItems:u="center",classNames:d=[],children:g=null,...m}=i,f=o.useMemo(()=>{const C=["drag-handler","container-fluid","nitro-card-header"];return d.length&&C.push(...d),C},[d]);return t(v,{center:!0,position:"relative",classNames:f,...m,children:c(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-text",children:e}),n&&t(P,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:s,children:t(Kl,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:C=>{C.stopPropagation(),C.nativeEvent.stopImmediatePropagation()},onClick:a,children:t(Xn,{className:"fa-icon w-12 h-12"})})]})})},Xm=i=>{const{justifyContent:e="center",classNames:n=[],variant:r="muted",...s}=i,a=o.useMemo(()=>{const l=["container-fluid","p-1"];return n.length&&l.push(...n),l.push("bg-"+r),l},[n,r]);return t(w,{justifyContent:e,classNames:a,...s})},Ks=class Ks{};Ks.CENTER="DWP_CENTER",Ks.TOP_CENTER="DWP_TOP_CENTER",Ks.TOP_LEFT="DWP_TOP_LEFT",Ks.NOTHING="DWP_NOTHING";let Ft=Ks;const Sr=[],Su=0,vu=0,Jr=i=>{const{uniqueKey:e=null,handleSelector:n=".drag-handler",windowPosition:r=Ft.CENTER,disableDrag:s=!1,dragStyle:a={},children:l=null,offsetLeft:u=0,offsetTop:d=0}=i,[g,m]=o.useState(null),[f,I]=o.useState(null),[C,p]=o.useState({x:0,y:0}),[_,E]=o.useState(!1),[b,N]=o.useState(null),T=o.useRef(),y=o.useCallback(()=>{let z=400;for(const de of Sr)z+=1,de.style.zIndex=z.toString()},[]),R=o.useCallback(()=>{const z=Sr.indexOf(T.current);if(z===-1)Sr.push(T.current);else{if(z===Sr.length-1)return;z>=0&&(Sr.splice(z,1),Sr.push(T.current))}y()},[y]),O=o.useCallback(z=>{R()},[R]),F=o.useCallback(z=>{R()},[R]),D=o.useCallback((z,de)=>{p({x:z,y:de}),E(!0)},[]),A=o.useCallback(z=>{D(z.clientX,z.clientY)},[D]),k=o.useCallback(z=>{const de=z.touches[0];D(de.clientX,de.clientY)},[D]),x=o.useCallback(z=>{m({x:z.clientX-C.x,y:z.clientY-C.y})},[C]),B=o.useCallback(z=>{const de=z.touches[0];m({x:de.clientX-C.x,y:de.clientY-C.y})},[C]),V=o.useCallback(()=>{if(!T.current||!b)return;let z=f.x+g.x,de=f.y+g.y;const ee=T.current.offsetLeft+z,Se=T.current.offsetTop+de;if(Se<Su?de=-T.current.offsetTop:Se+b.offsetHeight>=document.body.offsetHeight-Su&&(de=document.body.offsetHeight-T.current.offsetHeight-T.current.offsetTop),ee+T.current.offsetWidth<vu?z=-T.current.offsetLeft:ee>=document.body.offsetWidth-vu&&(z=document.body.offsetWidth-T.current.offsetWidth-T.current.offsetLeft),m({x:0,y:0}),I({x:z,y:de}),E(!1),e!==null){const qe={...zi(`nitro.windows.${e}`)};qe.offset={x:z,y:de},Gm(`nitro.windows.${e}`,qe)}},[b,g,f,e]),q=o.useCallback(z=>{V()},[V]),Y=o.useCallback(z=>{V()},[V]);return o.useEffect(()=>{const z=T.current;if(!z)return;if(Sr.push(z),y(),!s){const Se=z.querySelector(n);Se&&N(Se)}let de=0,ee=0;switch(r){case Ft.TOP_CENTER:z.style.top=50+d+"px",z.style.left=`calc(50vw - ${z.offsetWidth/2+u}px)`;break;case Ft.CENTER:z.style.top=`calc(50vh - ${z.offsetHeight/2+d}px)`,z.style.left=`calc(50vw - ${z.offsetWidth/2+u}px)`;break;case Ft.TOP_LEFT:z.style.top=50+d+"px",z.style.left=50+u+"px";break}return m({x:0,y:0}),I({x:de,y:ee}),()=>{const Se=Sr.indexOf(z);Se>=0&&Sr.splice(Se,1)}},[n,r,e,s,u,d,y]),o.useEffect(()=>{if(!f&&!g)return;const z=T.current;z&&(z.style.transform=`translate(${f.x+g.x}px, ${f.y+g.y}px)`,z.style.visibility="visible")},[f,g]),o.useEffect(()=>{if(b)return b.addEventListener(ve.MOUSE_DOWN,A),b.addEventListener(pn.TOUCH_START,k),()=>{b.removeEventListener(ve.MOUSE_DOWN,A),b.removeEventListener(pn.TOUCH_START,k)}},[b,A,k]),o.useEffect(()=>{if(_)return document.addEventListener(ve.MOUSE_UP,q),document.addEventListener(pn.TOUCH_END,Y),document.addEventListener(ve.MOUSE_MOVE,x),document.addEventListener(pn.TOUCH_MOVE,B),()=>{document.removeEventListener(ve.MOUSE_UP,q),document.removeEventListener(pn.TOUCH_END,Y),document.removeEventListener(ve.MOUSE_MOVE,x),document.removeEventListener(pn.TOUCH_MOVE,B)}},[_,q,x,Y,B]),o.useEffect(()=>{if(!e)return;const z=zi(`nitro.windows.${e}`);!z||!z.offset||(m({x:0,y:0}),z.offset&&I(z.offset))},[e]),Xl.createPortal(t(P,{position:"absolute",innerRef:T,className:"draggable-window",onMouseDownCapture:O,onTouchStartCapture:F,style:a,children:l}),document.getElementById("draggable-windows-container"))},se=i=>{const{theme:e="primary",uniqueKey:n=null,handleSelector:r=".drag-handler",windowPosition:s=Ft.CENTER,disableDrag:a=!1,overflow:l="hidden",position:u="relative",gap:d=0,classNames:g=[],...m}=i,f=o.useRef(),I=o.useMemo(()=>{const C=["nitro-card","rounded","shadow"];return C.push(`theme-${e||"primary"}`),g.length&&C.push(...g),C},[e,g]);return t(jN,{value:{theme:e},children:t(Jr,{uniqueKey:n,handleSelector:r,windowPosition:s,disableDrag:a,children:t(v,{innerRef:f,overflow:l,position:u,gap:d,classNames:I,...m})})})},it=i=>{const{figure:e="",gender:n="M",headOnly:r=!1,direction:s=0,scale:a=1,classNames:l=[],style:u={},...d}=i,[g,m]=o.useState(null),[f,I]=o.useState(-1),C=o.useRef(!1),p=o.useMemo(()=>{const E=["avatar-image"];return l.length&&E.push(...l),E},[l]),_=o.useMemo(()=>{let E={};return g&&g.length&&(E.backgroundImage=`url('${g}')`),a!==1&&(E.transform=`scale(${a})`,a%1||(E.imageRendering="pixelated")),Object.keys(u).length&&(E={...E,...u}),E},[g,a,u]);return o.useEffect(()=>{const E=St().createAvatarImage(e,tc.LARGE,n,{resetFigure:T=>{C.current||I(Math.random())},dispose:()=>{},disposed:!1},null);if(!E)return;let b=Vi.FULL;r&&(b=Vi.HEAD),E.setDirection(b,s);const N=E.getCroppedImage(b);N&&m(N.src),E.dispose()},[e,n,s,r,f]),o.useEffect(()=>(C.current=!1,()=>{C.current=!0}),[]),t(P,{classNames:p,style:_,...d})},Qm=i=>{const{imageUrl:e=null,fit:n=!0,style:r=null,...s}=i,a=o.useMemo(()=>{const l={...r};return e&&(l.background=`url(${e}) center no-repeat`),l},[r,e]);return t(P,{fit:n,style:a,...s})},We=i=>{const{badgeCode:e=null,isGroup:n=!1,showInfo:r=!1,customTitle:s=null,isGrayscale:a=!1,scale:l=1,classNames:u=[],style:d={},children:g=null,...m}=i,[f,I]=o.useState(null),C=o.useMemo(()=>{const _=["badge-image"];return n&&_.push("group-badge"),a&&_.push("grayscale"),u.length&&_.push(...u),_},[u,n,a]),p=o.useMemo(()=>{let _={};return f&&(_.backgroundImage=`url(${n?f.src:X("badge.asset.url").replace("%badgename%",e.toString())})`,_.width=f.width,_.height=f.height,l!==1&&(_.transform=`scale(${l})`,l%1||(_.imageRendering="pixelated"),_.width=f.width*l,_.height=f.height*l)),Object.keys(d).length&&(_={..._,...d}),_},[f,l,d]);return o.useEffect(()=>{if(!e||!e.length)return;let _=!1;const E=N=>{if(N.badgeId!==e)return;const T=Kn.generateImage(new Fi(N.image));T.onload=()=>I(T),_=!0,H().events.removeEventListener(qo.IMAGE_READY,E)};H().events.addEventListener(qo.IMAGE_READY,E);const b=n?H().getGroupBadgeImage(e):H().getBadgeImage(e);if(b&&!_){const N=Kn.generateImage(new Fi(b));N.onload=()=>I(N)}return()=>H().events.removeEventListener(qo.IMAGE_READY,E)},[e,n]),c(P,{classNames:C,style:p,...m,children:[r&&X("badge.descriptions.enabled",!0)&&c(P,{className:"badge-information text-black py-1 px-2 small",children:[t("div",{className:"fw-bold mb-1",children:n?s:Qa(e)}),t("div",{children:n?h("group.badgepopup.body"):uc(e)})]}),g]})},qN=i=>{const{day:e="00",hour:n="00",minutes:r="00",seconds:s="00",classNames:a=[],children:l=null,...u}=i,d=o.useMemo(()=>{const g=["nitro-counter-time"];return a.length&&g.push(...a),g},[a]);return c(w,{gap:1,children:[t(P,{classNames:d,...u,children:c("div",{children:[e!="00"?e:n,e!="00"?h("countdown_clock_unit_days"):h("countdown_clock_unit_hours")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:c("div",{children:[r,h("countdown_clock_unit_minutes")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:c("div",{children:[s,h("countdown_clock_unit_seconds")]})}),l]})},st=i=>{const{type:e="",classNames:n=[],style:r={},...s}=i,a=o.useMemo(()=>{const d=["nitro-currency-icon"];return n.length&&d.push(...n),d},[n]),l=o.useMemo(()=>{let d=X("currency.asset.icon.url","");return d=d.replace("%type%",e.toString()),`url(${d})`},[e]),u=o.useMemo(()=>{let d={};return d.backgroundImage=l,Object.keys(r).length&&(d={...d,...r}),d},[r,l]);return t(P,{classNames:a,style:u,...s})},fc=i=>{const{productType:e="s",productClassId:n=-1,direction:r=2,extraData:s="",scale:a=1,style:l={},...u}=i,[d,g]=o.useState(null),m=o.useMemo(()=>{var I;let f={};return(I=d==null?void 0:d.src)!=null&&I.length&&(f.backgroundImage=`url('${d.src}')`,f.width=d.width,f.height=d.height),a!==1&&(f.transform=`scale(${a})`,a%1||(f.imageRendering="pixelated")),Object.keys(l).length&&(f={...f,...l}),f},[d,a,l]);return o.useEffect(()=>{let f=null;const I={imageReady:(C,p,_)=>{!_&&p&&(_=Kn.generateImage(p)),_.onload=()=>g(_)},imageFailed:null};switch(e.toLocaleLowerCase()){case he.FLOOR:f=$().getFurnitureFloorImage(n,new Tt(r),64,I,0,s);break;case he.WALL:f=$().getFurnitureWallImage(n,new Tt(r),64,I,0,s);break}if(f){const C=f.getImage();C.onload=()=>g(C)}},[e,n,r,s]),d?t(P,{classNames:["furni-image"],style:m,...u}):null},Jm=i=>{const{figure:e=null,userName:n=null,message:r=null,editable:s=!1,onChange:a=null}=i;return c(w,{overflow:"hidden",className:"nitro-gift-card text-black",children:[c("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!n&&t("div",{className:"gift-incognito"}),e&&t("div",{className:"gift-avatar",children:t(it,{figure:e,direction:2,headOnly:!0})})]}),t(w,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:c(v,{grow:!0,overflow:"auto",justifyContent:"between",children:[!s&&t(S,{textBreak:!0,className:"gift-message",children:r}),s&&a!==null&&t("textarea",{className:"gift-message h-100",maxLength:140,value:r,onChange:l=>a(l.target.value),placeholder:h("catalog.gift_wrapping_new.message_hint")}),n&&t(S,{italics:!0,textEnd:!0,className:"pe-1",children:h("catalog.gift_wrapping_new.message_from",["name"],[n])})]})})]})},v=i=>{const{size:e=0,offset:n=0,column:r=!0,gap:s=2,classNames:a=[],...l}=i,{isCssGrid:u=!1}=VN(),d=o.useMemo(()=>{const g=[];if(e){let m=`col-${e}`;u&&(m=`g-${m}`),g.push(m)}if(n){let m=`offset-${n}`;u&&(m=`g-start-${n}`),g.push(m)}return a.length&&g.push(...a),g},[e,n,u,a]);return t(w,{classNames:d,column:r,gap:s,...l})},Sn=i=>{const{count:e=0,position:n="absolute",classNames:r=[],children:s=null,...a}=i,l=o.useMemo(()=>{const u=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return r.length&&u.push(...r),u},[r]);return c(P,{position:"absolute",classNames:l,...a,children:[e,s]})},Kr=i=>{const{value:e=0}=i,n=e.toString().split("");return t(G,{children:n.map((r,s)=>t("i",{className:"limited-edition-number n-"+r},s))})},Zm=i=>{const{uniqueNumber:e=0,uniqueSeries:n=0,classNames:r=[],children:s=null,...a}=i,l=o.useMemo(()=>{const u=["unique-compact-plate","z-index-1"];return r.length&&u.push(...r),u},[r]);return c(P,{classNames:l,...a,children:[t("div",{children:t(Kr,{value:e})}),t("div",{children:t(Kr,{value:n})}),s]})},YN=i=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:n=0,classNames:r=[],...s}=i,a=o.useMemo(()=>{const l=["unique-complete-plate"];return r.length&&l.push(...r),l},[r]);return t(P,{classNames:a,...s,children:c(v,{className:"plate-container",gap:0,children:[c(w,{justifyContent:"between",alignItems:"center",children:[h("unique.items.left"),t("div",{children:t(Kr,{value:e})})]}),c(w,{justifyContent:"between",alignItems:"center",children:[h("unique.items.number.sold"),t("div",{children:t(Kr,{value:n})})]})]})})},Ne=i=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:l=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:g=!1,disabled:m=!1,center:f=!0,column:I=!0,style:C={},classNames:p=[],position:_="relative",overflow:E="hidden",children:b=null,...N}=i,T=o.useMemo(()=>{const R=["layout-grid-item","border","border-1","border-muted","rounded"];return r&&R.push("active"),(l||u>0)&&R.push("unique-item"),l&&R.push("sold-out"),d&&R.push("unseen"),g&&R.push("has-highlight"),m&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),p.length&&R.push(...p),R},[r,l,u,d,g,m,e,p]),y=o.useMemo(()=>{let R={...C};return e&&!(l||u>0)&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(C).length&&(R={...R,...C}),R},[C,e,n,l,u]);return c(v,{center:f,pointer:!0,position:_,overflow:E,column:I,classNames:T,style:y,...N,children:[s>a&&t(Sn,{count:s}),u>0&&c(G,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Kr,{value:u})})]}),b]})},Cr=i=>{const{imageUrl:e=null,className:n="",...r}=i;return t("img",{src:e,className:"no-select "+n,alt:"",...r})},pc=i=>{const{...e}=i;return c(P,{classNames:["spinner-container"],...e,children:[t(P,{className:"spinner"}),t(P,{className:"spinner"}),t(P,{className:"spinner"})]})},zN=i=>{const{roomId:e=-1,textureReceiver:n=null,onClose:r=null}=i,s=o.useRef(),a=()=>{if(!s||!s.current)return null;const u=s.current.getBoundingClientRect();return new Yd(Math.floor(u.x),Math.floor(u.y),Math.floor(u.width),Math.floor(u.height))},l=()=>{fr(pr.CAMERA_SHUTTER),n($().createTextureFromRoom(e,1,a()))};return t(Jr,{handleSelector:".nitro-room-thumbnail-camera",children:c("div",{className:"nitro-room-thumbnail-camera px-2",children:[t("div",{ref:s,className:"camera-frame"}),c("div",{className:"d-flex align-items-end h-100 pb-2",children:[t("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:r,children:h("cancel")}),t("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:l,children:h("navigator.thumbeditor.save")})]})]})})},Po=i=>{const{title:e="",onClose:n=null,classNames:r=[],children:s=null,type:a=me.DEFAULT,...l}=i,u=o.useMemo(()=>{const d=["nitro-alert"];return d.push("nitro-alert-"+a),r.length&&d.push(...r),d},[r,a]);return c(se,{classNames:u,theme:"primary",...l,children:[t(ae,{headerText:e,onCloseClick:n}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:s})]})},or=class or{};or.BOUNCE="bounce",or.SLIDE_LEFT="slideLeft",or.SLIDE_RIGHT="slideRight",or.FLIP_X="flipX",or.FADE_IN="fadeIn",or.FADE_DOWN="fadeDown",or.FADE_UP="fadeUp",or.HEAD_SHAKE="headShake";let tn=or;function $N(i,e,n=300){switch(i){case tn.BOUNCE:switch(e){default:return{};case Fr:return{animationName:"bounceIn",animationDuration:`${n}ms`};case is:return{animationName:"bounceOut",animationDuration:`${n}ms`}}case tn.SLIDE_LEFT:switch(e){default:return{};case Fr:return{animationName:"slideInLeft",animationDuration:`${n}ms`};case is:return{animationName:"slideOutLeft",animationDuration:`${n}ms`}}case tn.SLIDE_RIGHT:switch(e){default:return{};case Fr:return{animationName:"slideInRight",animationDuration:`${n}ms`};case is:return{animationName:"slideOutRight",animationDuration:`${n}ms`}}case tn.FLIP_X:switch(e){default:return{};case Fr:return{animationName:"flipInX",animationDuration:`${n}ms`};case is:return{animationName:"flipOutX",animationDuration:`${n}ms`}}case tn.FADE_UP:switch(e){default:return{};case Fr:return{animationName:"fadeInUp",animationDuration:`${n}ms`};case is:return{animationName:"fadeOutDown",animationDuration:`${n}ms`}}case tn.FADE_IN:switch(e){default:return{};case Fr:return{animationName:"fadeIn",animationDuration:`${n}ms`};case is:return{animationName:"fadeOut",animationDuration:`${n}ms`}}case tn.FADE_DOWN:switch(e){default:return{};case Fr:return{animationName:"fadeInDown",animationDuration:`${n}ms`};case is:return{animationName:"fadeOutUp",animationDuration:`${n}ms`}}case tn.HEAD_SHAKE:switch(e){default:return{};case Fr:return{animationName:"headShake",animationDuration:`${n}ms`}}}return null}const ni=i=>{const{type:e=null,inProp:n=!1,timeout:r=300,className:s=null,children:a=null}=i,[l,u]=o.useState(!1);return o.useEffect(()=>{let d=null;return n?u(!0):d=setTimeout(()=>{u(!1),clearTimeout(r)},r),()=>{d&&clearTimeout(d)}},[n,r]),t(Hh,{in:n,timeout:r,children:d=>t("div",{className:(s??"")+" animate__animated",style:{...$N(e,d,r)},children:l&&a})})},Ic=i=>{const{fadesOut:e=!0,timeoutMs:n=8e3,onClose:r=null,overflow:s="hidden",classNames:a=[],...l}=i,[u,d]=o.useState(!1),g=o.useMemo(()=>{const m=["nitro-notification-bubble","rounded"];return a.length&&m.push(...a),m},[a]);return o.useEffect(()=>(d(!0),()=>d(!1)),[]),o.useEffect(()=>{if(!e)return;const m=setTimeout(()=>{d(!1),setTimeout(()=>r(),300)},n);return()=>clearTimeout(m)},[e,n,r]),t(ni,{type:tn.FADE_IN,inProp:u,timeout:300,children:t(w,{overflow:s,classNames:g,onClick:r,...l})})},mr=i=>{const{figure:e="",typeId:n=-1,paletteId:r=-1,petColor:s=16777215,customParts:a=[],posture:l="std",headOnly:u=!1,direction:d=0,scale:g=1,style:m={},...f}=i,[I,C]=o.useState(null),[p,_]=o.useState(0),[E,b]=o.useState(0),N=o.useRef(!1),T=o.useMemo(()=>{let y={};return I&&I.length&&(y.backgroundImage=`url(${I})`),g!==1&&(y.transform=`scale(${g})`,g%1||(y.imageRendering="pixelated")),y.width=p,y.height=E,Object.keys(m).length&&(y={...y,...m}),y},[I,g,m,p,E]);return o.useEffect(()=>{let y=n,R=r,O=s,F=a,D=u;if(e&&e.length){const k=new ea(e);y=k.typeId,R=k.paletteId,O=k.color,F=k.customParts}y===16&&(D=!1);const A=$().getRoomObjectPetImage(y,R,O,new Tt(d*45),64,{imageReady:(k,x,B)=>{N.current||(B?(C(B.src),_(B.width),b(B.height)):x&&(C(Kn.generateImageUrl(x)),_(x.width),b(x.height)))},imageFailed:k=>{}},D,0,F,l);if(A){const k=A.getImage();k&&(C(k.src),_(k.width),b(k.height))}},[e,n,r,s,a,l,u,d]),o.useEffect(()=>(N.current=!1,()=>{N.current=!0}),[]),t(P,{classNames:["pet-image"],style:T,...f})},eh=i=>{const{text:e="",progress:n=0,maxProgress:r=100,position:s="relative",justifyContent:a="center",classNames:l=[],children:u=null,...d}=i,g=o.useMemo(()=>{const m=["nitro-progress-bar","text-white"];return l.length&&m.push(...l),m},[l]);return c(v,{position:s,justifyContent:a,classNames:g,...d,children:[e&&e.length>0&&t(w,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),t(P,{className:"nitro-progress-bar-inner",style:{width:~~((n-0)*(100-0)/(r-0)+0)+"%"}}),u]})},Ec=i=>{const{level:e=0,classNames:n=[],children:r=null,...s}=i,a=o.useMemo(()=>{const l=["nitro-rarity-level"];return n.length&&l.push(...n),l},[n]);return c(P,{classNames:a,...s,children:[t("div",{children:e}),r]})},Cc=i=>{const{roomPreviewer:e=null,height:n=0,children:r=null}=i,[s,a]=o.useState(null),l=o.useRef(),u=d=>{e&&(d.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return o.useEffect(()=>{if(!e)return;const d=m=>{!e||!s||!l.current||(e.updatePreviewRoomView(),s.canvasUpdated&&(l.current.style.backgroundImage=`url(${Kn.generateImageUrl(s.master)})`))};if(!s&&l.current&&e){let f=document.defaultView.getComputedStyle(l.current,null).backgroundColor;f=rn.rgbStringToHex(f),f=f.replace("#","0x"),e.backgroundColor=parseInt(f,16);const I=l.current.parentElement.clientWidth;e.getRoomCanvas(I,n);const C=e.getRenderingCanvas();a(C),C.canvasUpdated=!0,d()}zn().add(d);const g=new ResizeObserver(()=>{if(!e||!l.current)return;const m=l.current.parentElement.offsetWidth;e.modifyRoomCanvas(m,n),d()});return g.observe(l.current),()=>{g.disconnect(),zn().remove(d)}},[s,e,l,n]),c("div",{className:"room-preview-container",children:[t("div",{ref:l,className:"room-preview-image",style:{height:"240px"},onClick:u}),r]})},th=i=>{const{roomId:e=-1,customUrl:n=null,shrink:r=!0,overflow:s="hidden",classNames:a=[],children:l=null,...u}=i,d=o.useMemo(()=>{const m=["room-thumbnail","rounded","border"];return a.length&&m.push(...a),m},[a]),g=o.useMemo(()=>n&&n.length?X("image.library.url")+n:X("thumbnails.url").replace("%thumbnail%",e.toString()),[n,e]);return c(P,{shrink:r,overflow:s,classNames:d,...u,children:[g&&t("img",{alt:"",src:g}),l]})},nh=i=>{const{color:e="",message:n="",date:r="",senderName:s="",customTitle:a=null,onCloseClick:l=null}=i;return t(Jr,{handleSelector:".drag-handler",children:c(v,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[c(w,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[t(P,{position:"absolute",pointer:!0,className:"trophy-close",onClick:l}),t(S,{bold:!0,children:h("widget.furni.trophy.title")})]}),c(v,{className:"trophy-content py-1",gap:1,children:[a&&t(S,{bold:!0,children:a}),n]}),c(w,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[t(S,{bold:!0,children:r}),t(S,{bold:!0,children:s})]})]})})},xn=i=>{const{userId:e=0,userName:n=null,classNames:r=[],pointer:s=!0,children:a=null,...l}=i,u=o.useMemo(()=>{const d=["nitro-friends-spritesheet","icon-profile-sm"];return r.length&&d.push(...r),d},[r]);return t(P,{classNames:u,pointer:s,onClick:d=>on(e),...l,children:a})},Ir=i=>{const{isActive:e=!1,count:n=0,overflow:r="hidden",position:s="relative",pointer:a=!0,classNames:l=[],children:u=null,...d}=i,g=o.useMemo(()=>{const m=["nav-item"];return e&&m.push("active"),l.length&&m.push(...l),m},[e,l]);return c(w,{overflow:r,pointer:a,position:s,classNames:g,...d,children:[t(w,{shrink:!0,center:!0,children:u}),n>0&&t(Sn,{count:n})]})},Zr=i=>{const{justifyContent:e="center",gap:n=1,classNames:r=[],children:s=null,...a}=i,l=o.useMemo(()=>{const u=["container-fluid","nitro-card-tabs","pt-1"];return r.length&&u.push(...r),u},[r]);return t(w,{justifyContent:e,gap:n,classNames:l,...a,children:s})},Ts=(...i)=>i.filter(Boolean).join(" "),KN=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["form-group"];return e.length&&s.push(...e),s},[e]);return t(w,{classNames:r,...n})},XN=i=>{const{variant:e="black",height:n=1,classNames:r=[],style:s={},...a}=i,l=o.useMemo(()=>{const d=[];return e&&d.push("bg-"+e),r.length&&d.push(...r),d},[e,r]),u=o.useMemo(()=>{let d={display:"list-item"};return n>0&&(d.height=n),Object.keys(s).length&&(d={...d,...s}),d},[n,s]);return t(P,{classNames:l,style:u,...a})},Lo=i=>{var C,p;const{rows:e=[],overscan:n=5,scrollToBottom:r=!1,rowRender:s=null}=i,[a,l]=o.useState(e.length-1),u=o.useRef(null),{virtualItems:d=[],totalSize:g=0,scrollToIndex:m=null}=Wh({parentRef:u,size:e.length,overscan:n}),f=d.length>0&&((C=d==null?void 0:d[0])==null?void 0:C.start)||0,I=d.length>0?g-(((p=d==null?void 0:d[d.length-1])==null?void 0:p.end)||0):0;return o.useEffect(()=>{r&&m(a)},[r,a,m]),c(P,{fit:!0,innerRef:u,position:"relative",overflow:"auto",children:[f>0&&t("div",{style:{minHeight:`${f}px`}}),d.map(_=>{const E=e[_.index];return E?t("div",{"data-index":_.index,ref:_.measureRef,children:s(E)},_.key):t(o.Fragment,{},_.key)}),I>0&&t("div",{style:{minHeight:`${I}px`}})]})},S=i=>{const{variant:e="black",fontWeight:n=null,fontSize:r=0,align:s=null,bold:a=!1,underline:l=!1,italics:u=!1,truncate:d=!1,center:g=!1,textEnd:m=!1,small:f=!1,wrap:I=!1,noWrap:C=!1,textBreak:p=!1,..._}=i,E=o.useMemo(()=>{const b=["d-inline"];return e&&b.push("text-"+e),a&&b.push("fw-bold"),n&&b.push("fw-"+n),r&&b.push("fs-"+r),s&&b.push("text-"+s),l&&b.push("text-decoration-underline"),u&&b.push("fst-italic"),d&&b.push("text-truncate"),g&&b.push("text-center"),m&&b.push("text-end"),f&&b.push("small"),I&&b.push("text-wrap"),C&&b.push("text-nowrap"),p&&b.push("text-break"),b},[e,n,r,s,a,l,u,d,g,m,f,I,C,p]);return t(P,{classNames:E,..._})},QN=i=>{const{text:e="",progress:n=0,maxProgress:r=100,position:s="relative",justifyContent:a="center",classNames:l=[],children:u=null,...d}=i,g=o.useMemo(()=>{const m=["nitro-progress-bar-loading","text-white"];return l.length&&m.push(...l),m},[l]);return c(v,{position:s,justifyContent:a,classNames:g,...d,children:[e&&e.length>0&&t(w,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-loading-text small",children:e}),t(P,{className:"nitro-progress-bar-loading-inner",style:{width:~~((n-0)*(100-0)/(r-0)+0)+"%"}}),u]})},JN=i=>{const{isError:e=!1,message:n="",percent:r=0}=i;return t(v,{fullHeight:!0,position:"relative",className:"nitro-loading",children:t(P,{fullHeight:!0,className:"container h-100",children:c(v,{fullHeight:!0,alignItems:"center",justifyContent:"center",children:[t(P,{className:"connecting-duck"}),t(v,{size:6,className:"text-center py-4",style:{maxWidth:400},children:e&&n&&n.length?t(P,{className:"fs-4 text-shadow",children:n}):t(G,{children:t(QN,{progress:r,className:"mt-2 large"})})})]})})})},Mr=(i,e,n,r=!0)=>{o.useEffect(()=>{if(r)return Array.isArray(i)?i.map(s=>e.addEventListener(s,n)):e.addEventListener(i,n),()=>{Array.isArray(i)?i.map(s=>e.removeEventListener(s,n)):e.removeEventListener(i,n)}},[i,e,r,n])},Tu=(i,e)=>Mr(i,wb().events,e),ZN=(i,e)=>Mr(i,pe().cameraManager.events,e),eS=(i,e)=>Mr(i,pe().localization.events,e),ls=(i,e)=>Mr(i,pe().events,e),Ee=(i,e)=>Mr(i,$().events,e),Pe=(i,e)=>Mr(i,Os().events,e),tS=(i,e)=>Mr(i,H().events,e),hs=(i,e,n=!0)=>Mr(i,pe().soundManager.events,e,n),U=(i,e)=>{o.useEffect(()=>{const n=new i(e);return Ma().registerMessageEvent(n),()=>Ma().removeMessageEvent(n)},[i,e])},at=(i,e,n=!0)=>Mr(i,gr,e,n),nS=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),[l,u]=o.useState(-1),[d,g]=o.useState(0),m=o.useMemo(()=>{let b=0;return n.forEach(N=>b+=hn.getAchievementCategoryTotalUnseen(N)),b},[n]),f=o.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getProgress()),b},[n]),I=o.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getMaxProgress()),b},[n]),C=o.useMemo(()=>~~((f-0)*(100-0)/(I-0)+0),[f,I]),p=o.useMemo(()=>s===null?null:n.find(b=>b.code===s),[n,s]),_=o.useMemo(()=>l===-1||!p?null:p.achievements.find(b=>b.achievementId===l),[p,l]),E=o.useCallback((b,N)=>{r(T=>{const y=[...T];for(const R of y)if(R.code===b)for(const O of R.achievements)O.achievementId===N&&(O.unseen=0);return y})},[]);return U(_g,b=>{const T=b.getParser().achievement;r(y=>{const R=[...y],O=R.findIndex(F=>F.code===T.category);if(O===-1){const F=new ou(T.category);F.achievements.push(T),R.push(F)}else{const F=Jt(R[O]),D=[...F.achievements],A=D.findIndex(x=>x.achievementId===T.achievementId);let k=null;A===-1?D.push(T):(k=D[A],D[A]=T),hn.getAchievementIsIgnored(T)||(T.unseen++,k&&(T.unseen+=k.unseen)),F.achievements=D,R[O]=F}return R})}),U(bg,b=>{const N=b.getParser(),T=[];for(const y of N.achievements){const R=y.category;let O=T.find(F=>F.code===R);O||(O=new ou(R),T.push(O)),O.achievements.push(y)}r(T)}),U(Ng,b=>{const N=b.getParser();g(N.score)}),o.useEffect(()=>{i&&(L(new Sg),e(!1))},[i]),o.useEffect(()=>{!s||l===-1||E(s,l)},[s,l,E]),{achievementCategories:n,selectedCategoryCode:s,setSelectedCategoryCode:a,selectedAchievementId:l,setSelectedAchievementId:u,achievementScore:d,getTotalUnseen:m,getProgress:f,getMaxProgress:I,scaledProgressPercent:C,selectedCategory:p,selectedAchievement:_,setAchievementSeen:E}},ri=()=>ot(nS),rS=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState(-1),[l,u]=o.useState(10),[d,g]=o.useState(null);return ZN(wg.INITIALIZED,m=>{e(Array.from(ga().effects.values()))}),U(vg,m=>{const f=m.getParser();g({credits:f.creditPrice,duckets:f.ducketPrice,publishDucketPrice:f.publishDucketPrice})}),o.useEffect(()=>{if(!ga().isLoaded){ga().init(),L(new Tg);return}},[]),{availableEffects:i,cameraRoll:n,setCameraRoll:r,selectedPictureIndex:s,setSelectedPictureIndex:a,myLevel:l,price:d}},rh=()=>ot(rS),Hn=class Hn extends Un{};Hn.SHOW_CATALOG="CE_SHOW_CATALOG",Hn.HIDE_CATALOG="CE_HIDE_CATALOG",Hn.TOGGLE_CATALOG="CE_TOGGLE_CATALOG",Hn.SOLD_OUT="CE_SOLD_OUT",Hn.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT",Hn.PURCHASE_APPROVED="CE_PURCHASE_APPROVED",Hn.INIT_GIFT="CE_INIT_GIFT",Hn.CATALOG_RESET="CE_RESET",Hn.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";let ws=Hn;class sS extends ws{constructor(e,n,r){super(ws.INIT_GIFT),this._pageId=e,this._offerId=n,this._extraData=r}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const Co=class Co extends ws{constructor(e){super(Co.POST_MARKETPLACE),this._item=e}get item(){return this._item}};Co.POST_MARKETPLACE="CE_POST_MARKETPLACE";let no=Co;const _o=class _o extends Un{constructor(e){super(_o.PURCHASE_SUCCESS),this._purchase=e}get purchase(){return this._purchase}};_o.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let Er=_o;const bo=class bo extends Un{constructor(e){super(bo.PURCHASE_FAILED),this._code=e}get code(){return this._code}};bo.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let Xr=bo;const No=class No extends Un{constructor(e){super(No.NOT_ALLOWED),this._code=e}get code(){return this._code}};No.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let Wa=No;const mt=class mt extends Un{};mt.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED",mt.SELECT_PRODUCT="CWE_SELECT_PRODUCT",mt.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM",mt.PURCHASE="CWE_PURCHASE",mt.COLOUR_ARRAY="CWE_COLOUR_ARRAY",mt.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY",mt.COLOUR_INDEX="CWE_COLOUR_INDEX",mt.TEXT_INPUT="CWE_TEXT_INPUT",mt.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT",mt.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE",mt.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES",mt.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW",mt.GUILD_SELECTED="CWE_GUILD_SELECTED",mt.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED",mt.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED",mt.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA",mt.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY",mt.TOGGLE="CWE_CWE_TOGGLE",mt.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED",mt.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED",mt.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";let wu=mt;const So=class So extends Un{constructor(){super(So.SOLD_OUT)}};So.SOLD_OUT="CPSOE_SOLD_OUT";let ja=So;const vo=class vo extends Un{constructor(e,n){super(vo.UPDATE_STUFF_DATA),this._offer=e,this._stuffData=n}get offer(){return this._offer}get stuffData(){return this._stuffData}};vo.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";let Ru=vo;const fs=class fs extends Un{};fs.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL",fs.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL",fs.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL",fs.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST",fs.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";let mn=fs;const Pc=class Pc extends Un{};Pc.INIT="HC_NAME_CHANGE_INIT";let qa=Pc;const To=class To extends Un{constructor(e,n,r){super(To.FURNI_ADDED),this.id=e,this.spriteId=n,this.category=r}};To.FURNI_ADDED="IFAE_FURNI_ADDED";let Ya=To;const ka=class ka extends Un{};ka.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL",ka.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL",ka.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";let cr=ka;const Ou=i=>i&&i.length?i.replace(/\\r/g,"\r"):"",yu=i=>{const e="0"+i;return e.substr(e.length-2,e.length)};let da=null;const aS=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[l,u]=o.useState(!1),[d,g]=o.useState(!1),m=()=>X("notification",{}),f=A=>{const k=m();return k?k[A]:null},I=(A,k,x,B)=>{if(A.has(x))return A.get(x);const V=["notification",k,x].join(".");return pe().localization.hasValue(V)||B?h(V,Array.from(A.keys()),Array.from(A.values())):null},C=(A,k)=>{let x=A.get("image");return x||(x=X("image.library.notifications.url","").replace("%image%",k.replace(/\./g,"_"))),h(x)},p=o.useCallback((A,k=null,x=null,B=null,V=null,q=null)=>{(!V||!V.length)&&(V=h("notifications.broadcast.title")),(!k||!k.length)&&(k=me.DEFAULT);const Y=new Xi([Ou(A)],k,x,B,V,q);e(z=>[Y,...z])},[]),_=o.useCallback(()=>p(null,me.NITRO),[p]),E=o.useCallback((A,k,x=null,B=null)=>{if(l)return;const V=new Gl(A,k,x,B);r(q=>[V,...q])},[l]),b=(A,k=null)=>{k||(k=new Map);const x=f("notification."+A);if(x)for(const de in x)k.set(de,x[de]);A==="floorplan_editor.error"&&k.set("message",k.get("message").replace(/[^a-zA-Z._ ]/g,""));const B=I(k,A,"title",!0),V=I(k,A,"message",!0).replace(/\\r/g,"\r"),q=I(k,A,"linkTitle",!1),Y=I(k,A,"linkUrl",!1),z=C(k,A);k.get("display")==="BUBBLE"?E(h(V),Kt.INFO,z,Y):p(h(V),A,Y,q,B,z),k.get("sound")&&fr(k.get("sound"))},N=o.useCallback((A,k,x,B=null,V=null,q=null,Y=null)=>{(!B||!B.length)&&(B=h("generic.confirm")),(!V||!V.length)&&(V=h("generic.cancel")),(!q||!q.length)&&(q=h("notifications.broadcast.title"));const z=new Bl(Y,A,k,x,B,V,q);a(de=>[z,...de])},[]),T=(A,k=null,x=!0)=>{p(A,me.DEFAULT,k,h("mod.alert.link"),h("mod.alert.title"))},y=o.useCallback((A,k="")=>{switch(A){case en.ALERT_SCAM:p(h("inventory.trading.warning.other_not_offering"),null,null,null,h("inventory.trading.notification.title"));return;case en.HOTEL_TRADING_DISABLED:case en.YOU_NOT_ALLOWED:case en.THEY_NOT_ALLOWED:case en.ROOM_DISABLED:case en.YOU_OPEN:case en.THEY_OPEN:p(h(`inventory.trading.openfail.${A}`,["otherusername"],[k]),null,null,null,h("inventory.trading.openfail.title"));return;case en.ERROR_WHILE_COMMIT:p(`${h("inventory.trading.notification.caption")}, ${h("inventory.trading.notification.commiterror.info")}`,null,null,null,h("inventory.trading.notification.title"));return;case en.THEY_CANCELLED:p(h("inventory.trading.info.closed"),null,null,null,h("inventory.trading.notification.title"));return}},[p]),R=o.useCallback(A=>{e(k=>{const x=[...k],B=x.findIndex(V=>A===V);return B>=0&&x.splice(B,1),x})},[]),O=o.useCallback(A=>{r(k=>{const x=[...k],B=x.findIndex(V=>A===V);return B>=0&&x.splice(B,1),x})},[]),F=o.useCallback(A=>{a(k=>{const x=[...k],B=x.findIndex(V=>A===V);return B>=0&&x.splice(B,1),x})},[]);U(Rg,A=>{const k=A.getParser();if(k.userId!==H().userId)return;const x=h("notifications.text.respect.1"),B=h("notifications.text.respect.2",["count"],[k.respectsReceived.toString()]);E(x,Kt.RESPECT),E(B,Kt.RESPECT)}),U(Og,A=>{const k=A.getParser();p(k.message.replace(/\\r/g,"\r"),null,null,h("notifications.broadcast.title"))}),U(yg,A=>{const k=A.getParser(),x=h("achievements.levelup.desc"),B=Qa(k.data.badgeCode),V=H().getBadgeUrl(k.data.badgeCode),q="questengine/achievements/"+k.data.category;E(x+" "+B,Kt.ACHIEVEMENT,V,q)}),U(kg,A=>{const k=A.getParser();k.numGifts<=0||E(k.numGifts.toString(),Kt.CLUBGIFT,null,"catalog/open/"+X("catalog.links")["hc.hc_gifts"])}),U(Ag,A=>{const k=A.getParser();T(k.message,k.url,!1)}),U(zd,A=>{const k=A.getParser();if(k.amountChanged<=0||k.type!==5)return;const x=X("currency.asset.icon.url","").replace("%type%",k.type.toString());E(h("notifications.text.loyalty.received",["AMOUNT"],[k.amountChanged.toString()]),Kt.INFO,x)}),U(Dg,A=>{const k=A.getParser();T(k.message)}),U(Pg,A=>{const k=A.getParser();p(h("opening.hours."+(k.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[yu(k.openHour),yu(k.openMinute)]),me.DEFAULT,null,null,h("opening.hours.title"))}),U(Lg,A=>{const k=A.getParser(),x=h("notifications.text."+(k.boughtAsGift?"petbought":"petreceived"));let B=null;const V=$().getRoomObjectPetImage(k.pet.typeId,k.pet.paletteId,parseInt(k.pet.color,16),new Tt(45*3),64,null,!0);V&&(B=V.getImage().src),E(x,Kt.PETLEVEL,B)}),U(Mg,A=>{const x=A.getParser().messages.map(V=>Ou(V)),B=new Xi(x,me.MOTD,null,null,h("notifications.motd.title"));e(V=>[B,...V])}),U(xg,A=>{const k=A.getParser();let x=null;const B=$().getRoomObjectPetImage(k.figureData.typeId,k.figureData.paletteId,parseInt(k.figureData.color,16),new Tt(45*3),64,null,!0);B&&(x=B.getImage().src),E(h("notifications.text.petlevel",["pet_name","level"],[k.petName,k.level.toString()]),Kt.PETLEVEL,x)}),U(Ug,A=>{const k=A.getParser();u(!k.enabled)}),U(Fg,A=>{const k=A.getParser();if(!k.products||!k.products.length)return;const x=k.products[0];x&&E(h("notifications.text.club_gift.selected"),Kt.INFO,xi.getProductImageUrl(x.productType,x.furniClassId,x.extraParam))}),U(Vg,A=>{const k=A.getParser();p(h("maintenance.shutdown",["m","d"],[k.minutesUntilMaintenance.toString(),k.duration.toString()]),me.DEFAULT,null,null,h("opening.hours.title"))}),U(Gg,A=>{const k=A.getParser();T(k.message,k.url)}),U(Bg,A=>{const k=A.getParser();b(k.type,k.parameters)}),U(Hg,A=>{const k=A.getParser();p(h("opening.hours.shutdown",["m"],[k.openMinute.toString()]),me.DEFAULT,null,null,h("opening.hours.title"))}),U(Wg,A=>{const k=A.getParser();p(h("opening.hours.disconnected",["h","m"],[k.openHour.toString(),k.openMinute.toString()]),me.DEFAULT,null,null,h("opening.hours.title"))}),U(jg,A=>{const k=A.getParser();switch(k.errorCode){default:case 0:p(h("connection.server.error.desc",["errorCode"],[k.errorCode.toString()]),me.ALERT,null,null,h("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:A.connection.dispose();break;case 4013:p(h("connection.room.maintenance.desc"),me.ALERT,null,null,h("connection.room.maintenance.title"));break}}),U(qg,A=>{const k=A.getParser();p(h(k.alertMessage),me.DEFAULT,null,null,h(k.titleMessage?k.titleMessage:"notifications.broadcast.title"))});const D=o.useCallback(()=>{if(!d)if(Rl.isRunning()){if(da)return;da=setTimeout(()=>{D()},Rl.totalRunningTime+5e3)}else da&&(clearTimeout(da),da=null),E(h("mod.chatdisclaimer"),Kt.INFO),g(!0)},[d,E]);return U(Yg,D),{alerts:i,bubbleAlerts:n,confirms:s,simpleAlert:p,showNitroAlert:_,showTradeAlert:y,showConfirm:N,showSingleBubble:E,closeAlert:R,closeBubbleAlert:O,closeConfirm:F}},je=()=>ot(aS),iS=(i,e)=>{const[n,r]=o.useState(()=>{if(typeof window>"u")return e;try{return zi(i)??e}catch{return e}});return[n,a=>{try{const l=a instanceof Function?a(n):a;r(l),typeof window<"u"&&Gm(i,l)}catch(l){$d.error(l)}}]},Mo=iS,oS=()=>Mo(Va.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),sh=()=>ot(oS),lS=()=>Mo(Va.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),ah=()=>ot(lS),cS=-12345678,uS=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(!1),[s,a]=o.useState(-1),[l,u]=o.useState(-1),[d,g]=o.useState(Ln.NORMAL),[m,f]=o.useState(null),[I,C]=o.useState(null),[p,_]=o.useState(null),[E,b]=o.useState(null),[N,T]=o.useState([]),[y,R]=o.useState(null),[O,F]=o.useState([]),[D,A]=o.useState(null),[k,x]=o.useState(!1),[B,V]=o.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[q,Y]=o.useState({}),[z,de]=o.useState(!1),[ee,Se]=sh(),[qe,dt]=ah(),[Ke,Vt]=o.useState(null),[Fe,qt]=o.useState(null),[wn,De]=o.useState(0),[fe,Ge]=o.useState(0),[wt,ue]=o.useState(0),[we,et]=o.useState(0),[un,ge]=o.useState(0),[Oe,Rn]=o.useState(0),{simpleAlert:ns=null}=je(),dn=o.useRef(new ms),ii=o.useCallback(()=>{a(-1),u(-1),f(null),C(null),_(null),b(null),T([]),R(null),F([]),e(!1)},[]),oa=o.useCallback(W=>{if(!W)return wr.MISSING_OFFER;if(wn<0||wn>=fe)return wr.FURNI_LIMIT_REACHED;const K=Te();if(!K)return wr.NOT_IN_ROOM;if(!K.isRoomOwner)return wr.NOT_ROOM_OWNER;if(we<=0){const J=$();let ie=J.getRoomObjectCount(K.roomId,Q.UNIT);for(;ie>0;){const Re=J.getRoomObjectByIndex(K.roomId,ie,Q.UNIT),Be=K.userDataManager.getUserDataByIndex(Re.id);if(Be&&Be.type===ut.USER&&Be.roomIndex!==K.ownRoomIndex&&!Be.isModerator)return wr.VISITORS_IN_ROOM;ie--}}return wr.OKAY},[wn,fe,we]),rs=o.useCallback(W=>{const K=Te();return!!((K&&W.page&&W.page.layoutCode!=="sold_ltd_items"&&d===Ln.NORMAL&&(K.isRoomOwner||K.isGuildRoom&&K.controllerLevel>=Qe.GUILD_MEMBER)||d===Ln.BUILDER&&oa(W)===wr.OKAY)&&W.pricingModel!==xt.PRICING_MODEL_BUNDLE&&W.product.productType!==he.EFFECT&&W.product.productType!==he.HABBO_CLUB)},[d,oa]),ss=o.useCallback(W=>{if(!rs(W))return;const K=W.product;if(!K)return;let J=0;switch(K.productType){case he.FLOOR:J=Q.FLOOR;break;case he.WALL:J=Q.WALL;break}$().processRoomObjectPlacement(Aa.CATALOG,-W.offerId,J,K.productClassId,K.extraParam)&&(Vt(W),de(!0),e(!1))},[rs]),As=o.useCallback((W,K)=>{const J=$();let ie=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_WALL_TYPE),Re=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_FLOOR_TYPE),Be=J.getRoomInstanceVariable(J.activeRoomId,te.ROOM_LANDSCAPE_TYPE);switch(ie=ie&&ie.length?ie:"101",Re=Re&&Re.length?Re:"101",Be=Be&&Be.length?Be:"1.1",W){case"floor":J.updateRoomInstancePlaneType(J.activeRoomId,K,ie,Be,!0);return;case"wallpaper":J.updateRoomInstancePlaneType(J.activeRoomId,Re,K,Be,!0);return;case"landscape":J.updateRoomInstancePlaneType(J.activeRoomId,Re,ie,K,!0);return;default:J.updateRoomInstancePlaneType(J.activeRoomId,Re,ie,Be,!0);return}},[]),la=o.useCallback(()=>{Ke&&($().cancelRoomObjectInsert(),de(!1),Vt(null))},[Ke]),Ur=o.useCallback((W=!0)=>{de(K=>(K&&W&&Z("catalog/open"),!1))},[]),as=o.useCallback((W=!1)=>{W||Ur(),qt(K=>{if(K)switch(K.category){case Q.FLOOR:$().removeRoomObjectFloor(K.roomId,K.objectId);break;case Q.WALL:{switch(K.furniData.className){case"floor":case"wallpaper":case"landscape":As("reset","");break;default:$().removeRoomObjectWall(K.roomId,K.objectId);break}break}default:$().deleteRoomObject(K.objectId,K.category);break}return null})},[Ur,As]),Gt=o.useCallback((W,K)=>{if(K.pageId===W&&K!==m)return K;for(const J of K.children){const ie=Gt(W,J);if(ie)return ie}return null},[m]),Zn=o.useCallback((W,K)=>{if(K.pageName===W&&K!==m)return K;for(const J of K.children){const ie=Zn(W,J);if(ie)return ie}return null},[m]),Ds=o.useCallback((W,K=!1)=>{if(!I||!I.size)return null;if(K){const J=[],ie=I.get(W);if(ie&&ie.length)for(const Re of ie)Re.isVisible&&J.push(Re);if(J.length)return J}return I.get(W)},[I]),er=o.useCallback((W,K)=>{W<0||(r(!0),a(W),W>-1&&L(new zg(W,K,d)))},[d]),Bh=o.useCallback((W,K,J,ie,Re,Be)=>{const Rt=new ji(W,K,J,ie,Be);if(_(Rt),u(Ie=>W!==-1?W:Ie),x(!1),Re>-1&&Rt.offers.length){for(const Ie of Rt.offers)if(Ie.offerId===Re){b(Ie);break}}},[]),Nr=o.useCallback((W,K=-1)=>{if(la(),W.parent.pageName==="root"&&W.children.length){for(const Re of W.children)if(Re.isVisible){W=Re;break}}const J=[];let ie=W;for(;ie&&ie.pageName!=="root";)J.push(ie),ie=ie.parent;J.reverse(),T(Re=>{const Be=Re.indexOf(W)>=0,Rt=W.isOpen;for(const Ie of Re)Ie.deactivate(),J.indexOf(Ie)===-1&&Ie.close();for(const Ie of J)Ie.activate(),Ie.parent&&Ie.open(),Ie===W.parent&&Ie.children.length&&Ie.open();return Be&&Rt?W.close():W.open(),J}),W.pageId>-1&&er(W.pageId,K)},[T,er,la]),ca=o.useCallback(W=>{if(W!==-1&&R(null),!i)dn.current.requestById=W,e(!0);else{const K=Gt(W,m);K&&Nr(K)}},[i,m,Gt,Nr]),Ho=o.useCallback(W=>{if(R(null),!i)dn.current.requestByName=W,e(!0);else{const K=Zn(W,m);K&&Nr(K)}},[i,m,Zn,Nr]),Wo=o.useCallback(W=>{if(R(null),!i)dn.current.requestedByOfferId=W,e(!0);else{const K=Ds(W);if(!K||!K.length)return;Nr(K[0],W)}},[i,Ds,Nr]),Lc=o.useCallback(()=>{},[]);return U($g,W=>{const K=W.getParser(),J=new Map,ie=(Re,Be,Rt)=>{const Ie=new Ob(Re,Be,Rt);for(const On of Ie.offerIds)J.has(On)?J.get(On).push(Ie):J.set(On,[Ie]);Be++;for(const On of Re.children)Ie.addChild(ie(On,Be,Ie));return Ie};f(ie(K.root,0,null)),C(J)}),U(Kg,W=>{const K=W.getParser();if(K.catalogType!==d)return;const J=[];for(const ie of K.offers){const Re=[],Be=Js(ie.localizationId);for(const Ie of ie.products){const On=Pl(Ie.furniClassId,Ie.productType);Re.push(new $r(Ie.productType,Ie.furniClassId,Ie.extraParam,Ie.productCount,Be,On,Ie.uniqueLimitedItem,Ie.uniqueLimitedSeriesSize,Ie.uniqueLimitedItemsLeft))}if(!Re.length)continue;const Rt=new xt(ie.offerId,ie.localizationId,ie.rent,ie.priceCredits,ie.priceActivityPoints,ie.priceActivityPointsType,ie.giftable,ie.clubLevel,Re,ie.bundlePurchaseAllowed);(d===Ln.NORMAL||Rt.pricingModel!==xt.PRICING_MODEL_BUNDLE&&Rt.pricingModel!==xt.PRICING_MODEL_MULTI)&&J.push(Rt)}K.frontPageItems&&K.frontPageItems.length&&F(K.frontPageItems),r(!1),s===K.pageId&&Bh(K.pageId,K.layoutCode,new Dm(K.localization.images.concat(),K.localization.texts.concat()),J,K.offerId,K.acceptSeasonCurrencyAsCredits)}),U(Xg,W=>{const K=W.getParser();Nt(new Er(K.offer))}),U(Qg,W=>{const K=W.getParser();Nt(new Xr(K.code))}),U(Jg,W=>{const K=W.getParser();Nt(new Wa(K.code))}),U(Zg,W=>{W.getParser(),Nt(new ja)}),U(ef,W=>{const J=W.getParser().offer;if(!J||!J.products.length)return;J.products[0].uniqueLimitedItem;const Re=[],Be=Js(J.localizationId);for(const Ie of J.products){const On=Pl(Ie.furniClassId,Ie.productType);Re.push(new $r(Ie.productType,Ie.furniClassId,Ie.extraParam,Ie.productCount,Be,On,Ie.uniqueLimitedItem,Ie.uniqueLimitedSeriesSize,Ie.uniqueLimitedItemsLeft))}const Rt=new xt(J.offerId,J.localizationId,J.rent,J.priceCredits,J.priceActivityPoints,J.priceActivityPointsType,J.giftable,J.clubLevel,Re,J.bundlePurchaseAllowed);(d===Ln.NORMAL||Rt.pricingModel!==xt.PRICING_MODEL_BUNDLE&&Rt.pricingModel!==xt.PRICING_MODEL_MULTI)&&(Rt.page=p,b(Rt),Rt.product&&Rt.product.productType===he.WALL&&V(Ie=>{const On={...Ie};return On.extraData=Rt.product.extraParam||null,On}))}),U(tf,W=>{const K=W.getParser(),J=new yb(K.productCode,K.palettes.slice());Y(ie=>{const Re=[];ie.petPalettes&&Re.push(...ie.petPalettes);for(let Be=0;Be<Re.length;Be++)if(Re[Be].breed===J.breed){Re.splice(Be,1);break}return Re.push(J),{...ie,petPalettes:Re}})}),U(nf,W=>{const K=W.getParser();Y(J=>{const ie=K.offers;return{...J,clubOffers:ie}})}),U(rf,W=>{const K=W.getParser();Y(J=>{const ie=K.groups;return{...J,groups:ie}})}),U(sf,W=>{const K=W.getParser();Y(J=>{const ie=new xb(K);return{...J,giftConfiguration:ie}})}),U(af,W=>{const K=W.getParser();if(!K)return;let J="";K.result===1?J=h("inventory.marketplace.result.title.success"):J=h("inventory.marketplace.result.title.failure");const ie=h(`inventory.marketplace.result.${K.result}`);ns(ie,me.DEFAULT,null,null,J)}),U(Kd,W=>{const K=W.getParser();Y(J=>({...J,clubGifts:K}))}),U(of,W=>{const K=i;ii(),K&&ns(h("catalog.alert.published.description"),me.ALERT,null,null,h("catalog.alert.published.title"))}),U(lf,W=>{const K=W.getParser();De(K.furniCount),Lc()}),U(cf,W=>{const K=W.getParser();Ge(K.furniLimit),ue(K.maxFurniLimit),et(K.secondsLeft),ge(Dn()),Rn(K.secondsLeftWithGrace),Lc()}),at(Er.PURCHASE_SUCCESS,W=>fr(pr.CREDITS)),Ee(Fc.PLACED,W=>{if(!z||W.type!==Fc.PLACED)return;if(as(!0),!Ke){Ur();return}let K=!1;const J=Ke.product;if(W.category===Q.WALL)switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":K=W.placedOnFloor||W.placedOnWall;break;default:K=W.placedInRoom;break}else K=W.placedInRoom;if(!K){Ur();return}switch(qt(new Ub(W.roomId,W.objectId,W.category,W.wallLocation,W.x,W.y,W.direction,Ke)),d){case Ln.NORMAL:{switch(W.category){case Q.FLOOR:$().addFurnitureFloor(W.roomId,W.objectId,J.productClassId,new Tt(W.x,W.y,W.z),new Tt(W.direction),0,new mf);break;case Q.WALL:switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":As(J.furnitureData.className,J.extraParam);break;default:$().addFurnitureWall(W.roomId,W.objectId,J.productClassId,new Tt(W.x,W.y,W.z),new Tt(W.direction*45),0,W.instanceData,0);break}}const ie=$().getRoomObject(W.roomId,W.objectId,W.category);ie&&ie.model.setValue(te.FURNITURE_ALPHA_MULTIPLIER,.5),qe&&L(new Ro(s,Ke.offerId,J.extraParam,1)),ee&&ss(Ke);break}case Ln.BUILDER:{let ie=Ke.page.pageId;switch(ie===cS&&(ie=-1),W.category){case Q.FLOOR:L(new df(ie,Ke.offerId,J.extraParam,W.x,W.y,W.direction));break;case Q.WALL:L(new uf(ie,Ke.offerId,J.extraParam,W.wallLocation));break}ee&&ss(Ke);break}}}),at(Ya.FURNI_ADDED,W=>{const K=$();if(!(!Fe||Fe.productClassId!==W.spriteId||Fe.roomId!==K.activeRoomId)){switch(W.category){case ce.FLOOR:{const J=K.getRoomInstanceVariable(K.activeRoomId,te.ROOM_FLOOR_TYPE);Fe.extraParam!==J&&L(new Mi(W.id));break}case ce.WALL_PAPER:{const J=K.getRoomInstanceVariable(K.activeRoomId,te.ROOM_WALL_TYPE);Fe.extraParam!==J&&L(new Mi(W.id));break}case ce.LANDSCAPE:{const J=K.getRoomInstanceVariable(K.activeRoomId,te.ROOM_LANDSCAPE_TYPE);Fe.extraParam!==J&&L(new Mi(W.id));break}default:L(new hf(W.id,Fe.category,Fe.wallLocation,Fe.x,Fe.y,Fe.direction))}ee||as()}}),o.useEffect(()=>()=>b(null),[p]),o.useEffect(()=>{if(!(!i||!m||!I||!dn.current))switch(dn.current.requestType){case ms.REQUEST_TYPE_NONE:if(p)return;if(m.isBranch){for(const W of m.children)if(W&&W.isVisible){Nr(W);return}}return;case ms.REQUEST_TYPE_ID:ca(dn.current.requestById),dn.current.resetRequest();return;case ms.REQUEST_TYPE_OFFER:Wo(dn.current.requestedByOfferId),dn.current.resetRequest();return;case ms.REQUEST_TYPE_NAME:Ho(dn.current.requestByName),dn.current.resetRequest();return}},[i,m,I,p,Nr,ca,Wo,Ho]),o.useEffect(()=>{!y&&p&&p.pageId===-1&&ca(l)},[y,p,l,ca]),o.useEffect(()=>{E&&V({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[E]),o.useEffect(()=>{!i||m||(L(new gf),L(new Xd),L(new ff(d)),L(new pf))},[i,m,d]),o.useEffect(()=>(A(new Bi($(),++Bi.PREVIEW_COUNTER)),()=>{A(W=>(W.dispose(),null))}),[]),{isVisible:i,setIsVisible:e,isBusy:n,pageId:s,previousPageId:l,currentType:d,rootNode:m,offersToNodes:I,currentPage:p,setCurrentPage:_,currentOffer:E,setCurrentOffer:b,activeNodes:N,searchResult:y,setSearchResult:R,frontPageItems:O,roomPreviewer:D,navigationHidden:k,setNavigationHidden:x,purchaseOptions:B,setPurchaseOptions:V,catalogOptions:q,setCatalogOptions:Y,getNodeById:Gt,getNodeByName:Zn,activateNode:Nr,openPageById:ca,openPageByName:Ho,openPageByOfferId:Wo,requestOfferToMover:ss}},Ae=()=>ot(uS),dS=1e3,mS=10,hS=1e3;let gS=0,fS=0;const pS=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[l,u]=o.useState(!1),d=f=>{f.id=gS++,e(I=>{const C=[...I];return C.push(f),C.length>dS&&C.shift(),C})},g=f=>{r(I=>{const C=[...I];return C.push(f),C.length>mS&&C.shift(),C})},m=f=>{f.id=fS++,a(I=>{const C=[...I];return C.push(f),C.length>hS&&C.shift(),C})};return Pe(Dt.STARTED,f=>u(!0)),U(Ka,f=>{if(!l)return;const I=f.getParser();n.length&&n[n.length-1].id===I.data.roomId||(d({id:-1,webId:-1,entityId:-1,name:I.data.roomName,timestamp:Bm(),type:$n.TYPE_ROOM_INFO,roomId:I.data.roomId}),g({id:I.data.roomId,name:I.data.roomName}),u(!1))}),U(Qd,f=>{const I=f.getParser();m({id:-1,webId:I.senderId,entityId:-1,name:"",message:I.messageText,roomId:-1,timestamp:hu(I.secondsSinceSent),type:$n.TYPE_IM})}),U(Jd,f=>{const I=f.getParser();m({id:-1,webId:I.senderId,entityId:-1,name:"",message:I.messageText,roomId:-1,timestamp:hu(),type:$n.TYPE_IM})}),{addChatEntry:d,chatHistory:i,roomHistory:n,messengerHistory:s}},xo=()=>ot(pS),IS=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[l,u]=o.useState([]),[d,g]=o.useState(null),m=o.useMemo(()=>{const N=i.filter(T=>T.online);return N.sort((T,y)=>T.name<y.name?-1:T.name>y.name?1:0),N},[i]),f=o.useMemo(()=>{const N=i.filter(T=>!T.online);return N.sort((T,y)=>T.name<y.name?-1:T.name>y.name?1:0),N},[i]),I=N=>L(new nc(N.id)),C=(N,T)=>T!==N.relationshipStatus&&L(new ma(N.id,T)),p=N=>{for(const T of i)if(T.id===N)return T;return null},_=N=>!(N===H().userId||p(N)||n.find(T=>T.requesterUserId===N)||s.indexOf(N)>=0),E=(N,T)=>{if(!_(N))return!1;a(y=>{const R=[...y];return R.push(N),R}),L(new Zd(T))},b=(N,T)=>{N===-1&&!T?(L(new Vc(!0)),r([])):r(y=>{const R=[...y],O=R.findIndex(F=>F.id===N);return O===-1?y:(L(T?new Tf(R[O].id):new Vc(!1,R[O].id)),R.splice(O,1),R)})};return U(Ef,N=>{const T=N.getParser();g(new IN(T.userFriendLimit,T.normalFriendLimit,T.extendedFriendLimit,T.categories)),L(new If)}),U(Cf,N=>{const T=N.getParser();e(y=>{const R=[...y];for(const O of T.fragment){const F=R.findIndex(A=>A.id===O.id),D=new nn;D.populate(O),F>-1?R[F]=D:R.push(D)}return R})}),U(_f,N=>{const T=N.getParser();e(y=>{const R=[...y],O=F=>{const D=R.findIndex(A=>A.id===F.id);if(D===-1){const A=new nn;A.populate(F),R.unshift(A)}else R[D].populate(F)};for(const F of T.addedFriends)O(F);for(const F of T.updatedFriends)O(F);for(const F of T.removedFriendIds){const D=R.findIndex(A=>A.id===F);D>-1&&R.splice(D,1)}return R})}),U(bf,N=>{const T=N.getParser();r(y=>{const R=[...y];for(const O of T.requests){const F=R.findIndex(D=>D.requesterUserId===O.requesterUserId);if(F>0)R[F]=Jt(R[F]),R[F].populate(O);else{const D=new gu;D.populate(O),R.push(D)}}return R})}),U(Nf,N=>{const y=N.getParser().request;r(R=>{const O=[...R];if(O.findIndex(D=>D.requesterUserId===y.requesterUserId)===-1){const D=new gu;D.populate(y),O.push(D)}return O})}),o.useEffect(()=>{L(new Sf);const N=setInterval(()=>L(new vf),12e4);return()=>{clearInterval(N)}},[]),{friends:i,requests:n,sentRequests:s,dismissedRequestIds:l,setDismissedRequestIds:u,settings:d,onlineFriends:m,offlineFriends:f,getFriend:p,canRequestFriend:_,requestFriend:E,requestResponse:b,followFriend:I,updateRelationship:C}},ln=()=>ot(IS),ES=()=>{const[i,e]=o.useState([]),[n,r]=o.useState(-1),[s,a]=o.useState([]),[l,u]=o.useState(hr.HIDDEN),{getFriend:d=null}=ln(),{simpleAlert:g=null}=je(),m=o.useMemo(()=>i.filter(_=>s.indexOf(_.threadId)===-1),[i,s]),f=o.useMemo(()=>n>0&&m.find(_=>_.threadId===n||null),[n,m]),I=_=>{let E=i.find(b=>b.participant&&b.participant.id===_);if(E){const b=s.indexOf(E.threadId);b>=0&&a(N=>{const T=[...N];return T.splice(b,1),T})}else{const b=d(_);if(!b)return null;E=new Fl(b),E.addMessage(null,h("messenger.moderationinfo"),0,null,Pr.SECURITY_NOTIFICATION),E.setRead(),e(N=>{const T=[...N];return T.push(E),T})}return E},C=_=>{a(E=>{const b=[...E];return b.indexOf(_)>=0?E:(b.push(_),b)}),n===_&&r(-1)},p=(_,E,b,N=0,T=null,y=Pr.CHAT)=>{if(!_||!b||!b.length)return;const R=E===H().userId;R&&b.length<=255&&L(new Rf(_.participant.id,b)),e(O=>{const F=[...O],D=F.findIndex(A=>A.threadId===_.threadId);return D===-1?O:(_=Jt(F[D]),R&&_.groups.length===1&&fr(pr.MESSENGER_NEW_THREAD),_.addMessage(y===Pr.ROOM_INVITE?null:E,b,N,T,y),n===_.threadId&&_.setRead(),F[D]=_,!R&&_.unread&&fr(pr.MESSENGER_MESSAGE_RECEIVED),F)})};return U(Qd,_=>{const E=_.getParser(),b=I(E.senderId);b&&p(b,E.senderId,E.messageText,E.secondsSinceSent,E.extraData)}),U(Jd,_=>{const E=_.getParser(),b=I(E.senderId);b&&p(b,E.senderId,E.messageText,0,null,Pr.ROOM_INVITE)}),U(wf,_=>{const E=_.getParser();g(`Received room invite error: ${E.errorCode},recipients: ${E.failedRecipients}`,me.DEFAULT,null,null,h("friendlist.alert.title"))}),o.useEffect(()=>{n<=0||e(_=>{const E=[..._],b=E.findIndex(N=>N.threadId===n);return b>=0&&(E[b]=Jt(E[b]),E[b].setRead()),E})},[n]),o.useEffect(()=>{u(_=>{if(!m.length)return hr.HIDDEN;let E=!1;for(const b of m)if(b.unreadCount>0){E=!0;break}return E?hr.UNREAD:hr.SHOW})},[m]),{messageThreads:i,activeThread:f,iconState:l,visibleThreads:m,getMessageThread:I,setActiveThreadId:r,closeThread:C,sendMessage:p}},_c=()=>ot(ES),CS=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(null),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(!1),[m,f]=o.useState(null);return U(Of,I=>{let C=I.getParser();!C||C&&!C.games.length||(a(C.games[0]),r(C.games))}),U(yf,I=>{let C=I.getParser();C&&u(C)}),U(kf,I=>{let C=I.getParser();C&&g(C.isInMaintenance)}),U(Af,I=>{let C=I.getParser();if(C)switch(C.gameTypeId){case 2:return console.log("snowwar");default:return f(C.url)}}),o.useEffect(()=>{i&&(L(new Df),yo())},[i]),{isVisible:i,setIsVisible:e,games:n,accountStatus:l,selectedGame:s,setSelectedGame:a,gameOffline:d,gameURL:m,setGameURL:f}},Uo=()=>ot(CS),_S=()=>{const[i,e]=o.useState(null);return U(Pf,n=>{const r=n.getParser(),s={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};r.bases.forEach((l,u)=>s.badgeBases.push({id:u,images:l})),r.symbols.forEach((l,u)=>s.badgeSymbols.push({id:u,images:l})),r.partColors.forEach((l,u)=>s.badgePartColors.push({id:u,color:l})),r.colorsA.forEach((l,u)=>s.groupColorsA.push({id:u,color:l})),r.colorsB.forEach((l,u)=>s.groupColorsB.push({id:u,color:l}));const a=(l,u)=>l.id<u.id?-1:l.id>u.id?1:0;s.badgeBases.sort(a),s.badgeSymbols.sort(a),s.badgePartColors.sort(a),s.groupColorsA.sort(a),s.groupColorsB.sort(a),e(s)}),o.useEffect(()=>{L(new Lf)},[]),{groupCustomize:i}},si=()=>ot(_S),bS=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),{simpleAlert:s=null,showConfirm:a=null}=je(),l=(u,d)=>{const g={reportType:u,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(u){case Je.BULLY:case Je.EMERGENCY:case Je.IM:g.reportedUserId=d.reportedUserId,g.currentStep=jt.SELECT_CHATS;break;case Je.ROOM:g.roomId=d.roomId,g.roomName=d.roomName,g.currentStep=jt.SELECT_TOPICS;break;case Je.THREAD:g.groupId=d.groupId,g.threadId=d.threadId,g.currentStep=jt.SELECT_TOPICS;break;case Je.MESSAGE:g.groupId=d.groupId,g.threadId=d.threadId,g.messageId=d.messageId,g.currentStep=jt.SELECT_TOPICS;break;case Je.PHOTO:g.extraData=d.extraData,g.roomId=d.roomId,g.reportedUserId=d.reportedUserId,g.roomObjectId=d.roomObjectId,g.currentStep=jt.SELECT_TOPICS;break}e(g)};return U(xf,u=>{const d=u.getParser();let g=d.messageText;switch(d.resultType){case Ki.TOO_MANY_PENDING_CALLS_CODE:L(new Mf),s(h("help.cfh.error.pending"),me.MODERATION,null,null,h("help.cfh.error.title"));break;case Ki.HAS_ABUSIVE_CALL_CODE:s(h("help.cfh.error.abusive"),me.MODERATION,null,null,h("help.cfh.error.title"));break;default:g.trim().length===0&&(g=h("help.cfh.sent.text")),s(g,me.MODERATION,null,null,h("help.cfh.sent.title"))}}),U(Uf,u=>{const d=u.getParser(),g=d.messageText.length===0?h("help.cfh.closed."+vN(d.closeReason)):d.messageText;s(g,me.MODERATION,null,null,h("mod.alert.title"))}),U(Vf,u=>{const d=u.getParser();d.count>0&&a(h("help.emergency.pending.title")+`
`+d.pendingCalls[0].message,()=>{L(new Ff)},null,h("help.emergency.pending.button.discard"),h("help.emergency.pending.button.keep"),h("help.emergency.pending.message.subtitle"))}),U(Gf,u=>{s("Your pending calls were deleted",me.MODERATION,null,null,h("mod.alert.title"))}),U(Bf,u=>{const d=u.getParser();s(d.message,me.MODERATION,null,null,h("help.cfh.reply.title"))}),U(Hf,u=>{const d=u.getParser();s(h("help.emergency.global_mute.message"),me.MODERATION,d.infoUrl,h("help.emergency.global_mute.link"),h("help.emergency.global_mute.subtitle"))}),U(Wf,u=>{const d=u.getParser();r(d)}),{activeReport:i,setActiveReport:e,sanctionInfo:n,setSanctionInfo:r,report:l}},Fn=()=>ot(bS),Fo=()=>{const[i,e]=o.useState([]),n=o.useMemo(()=>!!i.length,[i]),r=o.useCallback(()=>{let a=-1;return e(l=>{const u=[...l];return a=u.length?u[u.length-1]+1:0,u.push(a),u}),a},[]),s=o.useCallback(a=>{e(l=>{const u=[...l],d=u.indexOf(a);return d===-1?l:(u.splice(d,1),u)})},[]);return{isVisible:n,activate:r,deactivate:s}},NS=i=>L(new qf(i)),SS=(i,e)=>L(new Yf(i,...e)),vS=()=>{const[i,e]=o.useState(new Map),n=o.useCallback(d=>{var g;return((g=i.get(d))==null?void 0:g.length)||0},[i]),r=o.useMemo(()=>{let d=0;for(const g of i.keys())d+=n(g);return d},[i,n]),s=o.useCallback(d=>{let g=!0;return e(m=>{if(!m.has(d))return g=!1,m;const f=new Map(m);return f.delete(d),NS(d),f}),g},[]),a=o.useCallback((d,g)=>{let m=!0;return e(f=>{if(!f.has(d))return m=!1,f;const I=new Map(f),C=I.get(d);if(C)for(const p of g)C.splice(C.indexOf(p),1);return SS(d,g),I}),m},[]),l=o.useCallback((d,g)=>i.has(d)?i.get(d).indexOf(g)>=0:!1,[i]),u=o.useCallback((d,g)=>{e(m=>{if(!m.has(d))return m;const f=new Map(m),I=f.get(d),C=I.indexOf(g);return C>=0&&I.splice(C,1),f})},[]);return U(jf,d=>{const g=d.getParser();e(m=>{const f=new Map(m);for(const I of g.categories){let C=f.get(I);C||(C=[],f.set(I,C));const p=g.getItemsByCategory(I);for(const _ of p)C.indexOf(_)===-1&&C.push(_)}return f})}),{getCount:n,getFullCount:r,resetCategory:s,resetItems:a,isUnseen:l,removeUnseen:u}},gn=()=>ot(vS),TS=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(new Map),[l,u]=o.useState([]),[d,g]=o.useState(null),{isVisible:m=!1,activate:f=null,deactivate:I=null}=Fo(),{isUnseen:C=null,resetCategory:p=null}=gn(),_=X("user.badges.max.slots",5),E=y=>l.indexOf(y)>=0,b=()=>l.length<_,N=y=>{u(R=>{const O=[...R],F=O.indexOf(y);if(F===-1){if(!b())return R;O.push(y)}else O.splice(F,1);const D=new Xf;for(let A=0;A<_;A++)D.addActivatedBadge(O[A]??"");return L(D),O})},T=y=>n.indexOf(y)===-1?0:s.get(y)??0;return U(zf,y=>{const R=y.getParser(),O=[];a(F=>{const D=new Map(F);return R.getAllBadgeCodes().forEach(A=>{const k=n.indexOf(A)>=0,x=R.getBadgeId(A);D.set(A,x),!k&&O.push(A)}),D}),u(R.getActiveBadgeCodes()),r(F=>[...F,...O])}),U($f,y=>{const R=y.getParser(),O=C(Ze.BADGE,R.badgeId);r(F=>{const D=[...F];return O?D.unshift(R.badgeCode):D.push(R.badgeCode),D}),a(F=>{const D=new Map(F);return D.set(R.badgeCode,R.badgeId),D})}),o.useEffect(()=>{!n||!n.length||g(y=>{let R=y;return R&&n.indexOf(R)===-1&&(R=null),R||(R=n[0]),R})},[n]),o.useEffect(()=>{if(m)return()=>{p(Ze.BADGE)}},[m,p]),o.useEffect(()=>{!m||!i||(L(new Kf),e(!1))},[m,i]),{badgeCodes:n,activeBadgeCodes:l,selectedBadgeCode:d,setSelectedBadgeCode:g,isWearingBadge:E,canWearBadges:b,toggleBadge:N,getBadgeId:T,activate:f,deactivate:I}},Vo=()=>ot(TS),wS=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:l=!1,activate:u=null,deactivate:d=null}=Fo(),{isUnseen:g=null,resetCategory:m=null}=gn();return U(Qf,f=>{const I=f.getParser();r(C=>{const p=[...C],_=p.map(b=>b.botData.id),E=[];for(const b of I.items.values())_.indexOf(b.id)===-1&&E.push(b);for(const b of _){let N=!0;for(const R of I.items.values())if(R.id===b){N=!1;break}if(!N)continue;const T=p.findIndex(R=>R.botData.id===b),y=p[T];T===-1||!y||(na()===y.botData.id&&(Ba(),Z("inventory/open")),p.splice(T,1))}for(const b of E){const N={botData:b};g(Ze.BOT,b.id)?p.unshift(N):p.push(N)}return p})}),U(Jf,f=>{const I=f.getParser();r(C=>{const p=[...C];if(p.findIndex(N=>N.botData.id===I.item.id)>=0)return C;const E={botData:I.item};return g(Ze.BOT,E.botData.id)?p.unshift(E):p.push(E),p})}),U(Zf,f=>{const I=f.getParser();r(C=>{const p=[...C],_=p.findIndex(E=>E.botData.id===I.itemId);return _===-1?C:(p.splice(_,1),na()===I.itemId&&(Ba(),Z("inventory/show")),p)})}),o.useEffect(()=>{!n||!n.length||a(f=>{let I=f;return I&&n.indexOf(I)===-1&&(I=null),I||(I=n[0]),I})},[n]),o.useEffect(()=>{if(l)return()=>{m(Ze.BOT)}},[l,m]),o.useEffect(()=>{!l||!i||(L(new ep),e(!1))},[l,i]),{botItems:n,selectedBot:s,setSelectedBot:a,activate:u,deactivate:d}},ih=()=>ot(wS);let _i=null;const RS=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:l=!1,activate:u=null,deactivate:d=null}=Fo(),{isUnseen:g=null,resetCategory:m=null}=gn(),f=p=>{if(!(!n||!n.length))return n.filter(_=>_.type===p)},I=p=>{if(!(!n||!n.length)){for(const _ of n){const E=_.getItemById(p);if(E&&E.isWallItem)return _}return null}},C=p=>{if(!(!n||!n.length)){for(const _ of n){const E=_.getItemById(p);if(E&&!E.isWallItem)return _}return null}};return U(em,p=>{const _=p.getParser();r(E=>{const b=[...E];for(const N of _.items){let T=0,y=null;for(;T<b.length;){const R=b[T];let O=0;for(;O<R.items.length;){const F=R.items[O];if(F.id===N.itemId){F.update(N);const D=[...R.items];D[O]=F,R.items=D,y=R;break}O++}if(y)break;T++}if(y)y.hasUnseenItems=!0,b[T]=Jt(y);else{const R=new Ga(N);cu(b,R,g(Ze.FURNI,N.itemId)),Nt(new Ya(R.id,R.type,R.category))}}return b})}),U(Ol,p=>{const _=p.getParser();_i||(_i=new Array(_.totalFragments));const E=Qb(_.fragment,_.totalFragments,_.fragmentNumber,_i);E&&(r(b=>{const N=[...b],T=Jb(N);for(const y of T){if(E.get(y))continue;let R=0;for(;R<N.length;){const O=N[R],F=O.remove(y);if(!F){R++;continue}na()===F.ref&&(Ba(),ra(O)||Z("inventory/show")),O.getTotalCount()<=0&&(N.splice(R,1),O.dispose());break}}for(const y of E.keys()){if(T.indexOf(y)>=0)continue;const R=E.get(y);if(!R)continue;const O=new Ga(R);cu(N,O,g(Ze.FURNI,y)),Nt(new Ya(O.id,O.type,O.category))}return N}),_i=null)}),U(tp,p=>{e(!0)}),U(tm,p=>{const _=p.getParser();r(E=>{const b=[...E];let N=0;for(;N<b.length;){const T=b[N],y=T.remove(_.itemId);if(!y){N++;continue}na()===y.ref&&(Ba(),ra(T)||Z("inventory/show")),T.getTotalCount()<=0&&(b.splice(N,1),T.dispose());break}return b})}),U(np,p=>{}),o.useEffect(()=>{!n||!n.length||a(p=>{let _=p;return _&&n.indexOf(_)===-1&&(_=null),_||(_=n[0]),_})},[n]),o.useEffect(()=>{if(l)return()=>{m(Ze.FURNI)&&r(p=>{const _=[...p];for(const E of _)E.hasUnseenItems=!1;return _})}},[l,m]),o.useEffect(()=>{!l||!i||(L(new rp),e(!1))},[l,i]),{isVisible:l,groupItems:n,setGroupItems:r,selectedItem:s,setSelectedItem:a,activate:u,deactivate:d,getWallItemById:I,getFloorItemById:C,getItemsByType:f}},ks=()=>ot(RS);let bi=null;const OS=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:l=!1,activate:u=null,deactivate:d=null}=Fo(),{isUnseen:g=null,resetCategory:m=null}=gn();return U(sp,f=>{const I=f.getParser();bi||(bi=new Array(I.totalFragments));const C=nN(I.fragment,I.totalFragments,I.fragmentNumber,bi);C&&(r(p=>{const _=[...p];return tN(_,C,g),_}),bi=null)}),U(ap,f=>{const I=f.getParser();r(C=>{const p=[...C];return Fm(I.pet,p,g(Ze.PET,I.pet.id)),p})}),U(ip,f=>{const I=f.getParser();r(C=>{const p=[...C];return Vm(I.petId,p),p})}),o.useEffect(()=>{!n||!n.length||a(f=>{let I=f;return I&&n.indexOf(I)===-1&&(I=null),I||(I=n[0]),I})},[n]),o.useEffect(()=>{if(l)return()=>{m(Ze.PET)}},[l,m]),o.useEffect(()=>{!l||!i||(L(new op),e(!1))},[l,i]),{petItems:n,selectedPet:s,setSelectedPet:a,activate:u,deactivate:d}},oh=()=>ot(OS),yS=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(_t.TRADING_STATE_READY),{groupItems:l=[],setGroupItems:u=null,activate:d=null,deactivate:g=null}=ks(),{simpleAlert:m=null,showTradeAlert:f=null}=je(),I=s>=_t.TRADING_STATE_RUNNING,C=()=>{switch(s){case _t.TRADING_STATE_RUNNING:!n.itemCount&&!i.accepts&&m(h("inventory.trading.warning.other_not_offering"),null,null,null),i.accepts?L(new _p):L(new bp);return;case _t.TRADING_STATE_CONFIRMING:L(new Cp),a(_t.TRADING_STATE_CONFIRMED);return}},p=E=>{const b=E.getLastItem();b&&L(new Np(b.id))},_=()=>{if(I)switch(s){case _t.TRADING_STATE_RUNNING:L(new vp);return;default:L(new Sp);return}};return U(lp,E=>{const b=E.getParser();!i||!n||(i.userId===b.userID?e(N=>{const T=Jt(N);return T.accepts=b.userAccepts,T}):n.userId===b.userID&&r(N=>{const T=Jt(N);return T.accepts=b.userAccepts,T}))}),U(up,E=>{const b=E.getParser();b.reason===cp.ERROR_WHILE_COMMIT?f(en.ERROR_WHILE_COMMIT):i&&b.userID!==i.userId&&f(en.THEY_CANCELLED),e(null),r(null),a(_t.TRADING_STATE_READY)}),U(dp,E=>{E.getParser(),e(null),r(null),a(_t.TRADING_STATE_READY)}),U(mp,E=>{E.getParser(),a(_t.TRADING_STATE_COUNTDOWN)}),U(hp,E=>{const b=E.getParser(),N=mu(b.firstUserItemArray),T=mu(b.secondUserItemArray);e(y=>{const R=Jt(y);R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=T);const O=[];for(const F of R.userItems.getValues()){let D=0;for(;D<F.getTotalCount();){const A=F.getItemByIndex(D);A&&O.push(A.ref),D++}}return u(F=>{const D=[...F];for(const A of D)A.lockItemIds(O);return D}),R}),r(y=>{const R=Jt(y);return R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=T),R})}),U(gp,E=>{E.getParser()}),U(fp,E=>{const b=E.getParser(),N=new uu,T=Te().userDataManager.getUserData(b.userID);N.userItems=new Da;const y=new uu,R=Te().userDataManager.getUserData(b.otherUserID);y.userItems=new Da,T.webID===H().userId?(N.userId=T.webID,N.userName=T.name,N.canTrade=b.userCanTrade,y.userId=R.webID,y.userName=R.name,y.canTrade=b.otherUserCanTrade):R.webID===H().userId&&(N.userId=R.webID,N.userName=R.name,N.canTrade=b.otherUserCanTrade,y.userId=T.webID,y.userName=T.name,y.canTrade=b.userCanTrade),e(N),r(y),a(_t.TRADING_STATE_RUNNING)}),U(pp,E=>{const b=E.getParser();f(b.reason,b.otherUserName)}),U(Ip,E=>{E.getParser(),f(en.THEY_NOT_ALLOWED)}),U(Ep,E=>{E.getParser(),f(en.YOU_NOT_ALLOWED)}),o.useEffect(()=>{if(s===_t.TRADING_STATE_READY)return;const E=d();return()=>g(E)},[s,d,g]),{ownUser:i,otherUser:n,tradeState:s,setTradeState:a,isTrading:I,groupItems:l,progressTrade:C,removeItem:p,stopTrading:_}},lh=()=>ot(yS),kS=()=>{const[i,e]=o.useState(null),[n,r]=o.useState([]),[s,a]=o.useState([]),[l,u]=o.useState([]),[d,g]=o.useState([]),[m,f]=o.useState([]),[I,C]=o.useState([]),{simpleAlert:p=null}=je(),_=x=>{n.indexOf(x)>=0||r(B=>[...B,x])},E=x=>{r(B=>{const V=[...B],q=V.indexOf(x);return q>=0&&V.splice(q),V})},b=x=>{n.indexOf(x)>=0?E(x):_(x)},N=x=>{s.indexOf(x)>=0||a(B=>[...B,x])},T=x=>{a(B=>{const V=[...B],q=V.indexOf(x);return q>=0&&V.splice(q),V})},y=x=>{s.indexOf(x)>=0?T(x):N(x)},R=x=>{l.indexOf(x)>=0||u(B=>[...B,x])},O=x=>{u(B=>{const V=[...B],q=V.indexOf(x);return q>=0&&V.splice(q),V})},F=x=>{l.indexOf(x)>=0?O(x):R(x)},D=x=>{d.indexOf(x)>=0||g(B=>[...B,x])},A=x=>{g(B=>{const V=[...B],q=V.indexOf(x);return q>=0&&V.splice(q),V})},k=x=>{s.indexOf(x)>=0?A(x):D(x)};return U(Tp,x=>{const V=x.getParser().data;e(V),f(V.issues)}),U(wp,x=>{const B=x.getParser();f(V=>{const q=[...V],Y=q.findIndex(z=>z.issueId===B.issueData.issueId);return Y>=0?q[Y]=B.issueData:(q.push(B.issueData),fr(pr.MODTOOLS_NEW_TICKET)),q})}),U(Rp,x=>{x.getParser()}),U(Op,x=>{x.getParser()&&p("Failed to pick issue",me.DEFAULT,null,null,"Error")}),U(yp,x=>{const B=x.getParser();f(V=>{const q=[...V],Y=q.findIndex(z=>z.issueId===B.issueId);return Y>=0&&q.splice(Y,1),q})}),U(kp,x=>{x.getParser().success?p("Moderation action was successfull",me.MODERATION,null,null,"Success"):p("There was a problem applying tht moderation action",me.MODERATION,null,null,"Error")}),U(Ap,x=>{const B=x.getParser();C(B.callForHelpCategories)}),U(Dp,x=>{x.getParser()}),{settings:i,openRooms:n,openRoomChatlogs:s,openUserChatlogs:d,openUserInfos:l,cfhCategories:I,tickets:m,openRoomInfo:_,closeRoomInfo:E,toggleRoomInfo:b,openRoomChatlog:N,closeRoomChatlog:T,toggleRoomChatlog:y,openUserInfo:R,closeUserInfo:O,toggleUserInfo:F,openUserChatlog:D,closeUserChatlog:A,toggleUserChatlog:k}},ia=()=>ot(kS),AS=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState({roomInfo:null,state:Ve.NONE}),[m,f]=o.useState(null),[I,C]=o.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:p=null}=je();return U(Pp,_=>{const E=_.getParser();L(new Gi(E.roomId,!1,!1))}),U(Lp,_=>{const E=_.getParser();E.canCreate||p(h(`navigator.cannotcreateevent.error.${E.errorCode}`),null,null,null,h("navigator.cannotcreateevent.title"))}),U(rm,_=>{L(new Mp),L(new nm)}),U(xp,_=>{const E=_.getParser();C(b=>{const N={...b};return N.eventMod=E.securityLevel>=Hi.MODERATOR,N.roomPicker=E.securityLevel>=Hi.COMMUNITY,N})}),U(Up,_=>{const E=_.getParser();vn(E.roomId)}),U(sm,_=>{const E=_.getParser();C(b=>{const N={...b};return N.enteredGuestRoom=null,N.currentRoomOwner=E.isOwner,N.currentRoomId=E.roomId,N}),L(new Gi(E.roomId,!0,!1)),La.available&&La.call("legacyTrack","navigator","private",[E.roomId])}),U(Ka,_=>{const E=_.getParser();if(E.roomEnter)g({roomInfo:null,state:Ve.NONE}),C(b=>{const N={...b};return N.enteredGuestRoom=E.data,N.currentRoomIsStaffPick=E.staffPick,!(N.createdFlatId===E.data.roomId)&&E.data.displayRoomEntryAd&&X("roomenterad.habblet.enabled",!1)&&za.openRoomEnterAd(),N.createdFlatId=0,N.enteredGuestRoom&&N.enteredGuestRoom.habboGroupId>0,N});else if(E.roomForward){if(E.data.ownerName!==H().userName&&!E.isGroupMember)switch(E.data.doorMode){case ft.DOORBELL_STATE:g(b=>{const N={...b};return N.roomInfo=E.data,N.state=Ve.START_DOORBELL,N});return;case ft.PASSWORD_STATE:g(b=>{const N={...b};return N.roomInfo=E.data,N.state=Ve.START_PASSWORD,N});return}if(E.data.doorMode===ft.NOOB_STATE&&!H().isAmbassador&&!H().isRealNoob&&!H().isModerator)return;Es(E.data.roomId)}else C(b=>{const N={...b};return N.enteredGuestRoom=E.data,N.currentRoomIsStaffPick=E.staffPick,N})}),U(Fp,_=>{const E=_.getParser();C(b=>{const N={...b};return N.currentRoomRating=E.totalLikes,N.canRate=E.canLike,N})}),U(Vp,_=>{const E=_.getParser();(!E.userName||E.userName.length===0)&&g(b=>{const N={...b};return N.state=Ve.STATE_WAITING,N})}),U(Gp,_=>{const E=_.getParser();(!E.userName||E.userName.length===0)&&g(b=>{const N={...b};return N.state=Ve.STATE_ACCEPTED,N})}),U(Bp,_=>{const E=_.getParser();(!E.userName||E.userName.length===0)&&g(b=>{const N={...b};return N.state=Ve.STATE_NO_ANSWER,N})}),U(Hp,_=>{switch(_.getParser().errorCode){case-100002:g(b=>{const N={...b};return N.state=Ve.STATE_WRONG_PASSWORD,N});return;case 4009:p(h("navigator.alert.need.to.be.vip"),me.DEFAULT,null,null,h("generic.alert.title"));return;case 4010:p(h("navigator.alert.invalid_room_name"),me.DEFAULT,null,null,h("generic.alert.title"));return;case 4011:p(h("navigator.alert.cannot_perm_ban"),me.DEFAULT,null,null,h("generic.alert.title"));return;case 4013:p(h("navigator.alert.room_in_maintenance"),me.DEFAULT,null,null,h("generic.alert.title"));return}}),U(Wp,_=>{const E=_.getParser();u(E.topLevelContexts),a(E.topLevelContexts.length?E.topLevelContexts[0]:null)}),U(jp,_=>{const E=_.getParser();a(b=>{let N=b;if(N||(N=l&&l.length&&l[0]||null),!N)return null;if(E.result.code!==N.code&&l&&l.length)for(const T of l)T.code===E.result.code&&(N=T);for(const T of l)T.code===E.result.code&&(N=T);return N}),f(E.result)}),U(qp,_=>{const E=_.getParser();e(E.categories)}),U(Yp,_=>{const E=_.getParser();r(E.categories)}),U(zp,_=>{const E=_.getParser();Es(E.roomId)}),U($p,_=>{const E=_.getParser();let b=!1;if(C(y=>{b=y.settingsReceived;const R={...y};return R.homeRoomId=E.homeRoomId,R.settingsReceived=!0,R}),b)return;let N=-1,T=-1;X("friend.id")!==void 0&&parseInt(X("friend.id"))>0&&(N=0,L(new nc(parseInt(X("friend.id"))))),X("forward.type")!==void 0&&X("forward.id")!==void 0&&(N=parseInt(X("forward.type")),T=parseInt(X("forward.id"))),N===2?vn(T):N===-1&&E.roomIdToEnter>0&&(Z("navigator/close"),E.roomIdToEnter!==E.homeRoomId?Es(E.roomIdToEnter):Es(E.homeRoomId))}),U(Kp,_=>{const E=_.getParser();switch(E.reason){case Yo.REASON_FULL:p(h("navigator.guestroomfull.text"),me.DEFAULT,null,null,h("navigator.guestroomfull.title"));break;case Yo.REASON_QUEUE_ERROR:p(h(`room.queue.error.${E.parameter}`),me.DEFAULT,null,null,h("room.queue.error.title"));break;case Yo.REASON_BANNED:p(h("navigator.banned.text"),me.DEFAULT,null,null,h("navigator.banned.title"));break;default:p(h("room.queue.error.title"),me.DEFAULT,null,null,h("room.queue.error.title"));break}yo()}),U(Xp,_=>Z("navigator/show")),{categories:i,doorData:d,setDoorData:g,topLevelContext:s,topLevelContexts:l,searchResult:m,navigatorData:I}},Qn=()=>ot(AS),DS=()=>{const[i,e]=o.useState(new gc),n=o.useMemo(()=>X("hc.disabled",!1),[]),r=o.useMemo(()=>n||i.clubDays>0?ur.ACTIVE:i.pastVipDays>0||i.pastVipDays>0?ur.EXPIRED:ur.NONE,[i,n]),s=a=>{if(a===-1)return i.credits;for(const[l,u]of i.activityPoints.entries())if(l===a)return u;return 0};return U(Qp,a=>{const l=a.getParser();e(u=>{const d=Jt(u);return d.credits=parseFloat(l.credits),u.credits!==d.credits&&fr(pr.CREDITS),d})}),U(Jp,a=>{const l=a.getParser();e(u=>{const d=Jt(u);return d.activityPoints=l.currencies,d})}),U(zd,a=>{const l=a.getParser();e(u=>{const d=Jt(u);return d.activityPoints=new Map(d.activityPoints),d.activityPoints.set(l.type,l.amount),l.type===0&&fr(pr.DUCKETS),d})}),U(eI,a=>{const l=a.getParser(),u=l.productName;u!=="club_habbo"&&u!=="habbo_club"||e(d=>{const g=Jt(d);return g.clubDays=Math.max(0,l.daysToPeriodEnd),g.clubPeriods=Math.max(0,l.periodsSubscribedAhead),g.isVip=l.isVip,g.pastClubDays=l.pastClubDays,g.pastVipDays=l.pastVipDays,g.isExpiring=l.responseType===Zp.RESPONSE_TYPE_DISCOUNT_AVAILABLE,g.minutesUntilExpiration=l.minutesUntilExpiration,g.minutesSinceLastModified=l.minutesSinceLastModified,g})}),o.useEffect(()=>{if(n)return;L(new Gc("habbo_club"));const a=setInterval(()=>L(new Gc("habbo_club")),5e4);return()=>clearInterval(a)},[n]),o.useEffect(()=>{L(new tI)},[]),{purse:i,hcDisabled:n,clubStatus:r,getCurrencyAmount:s}},es=()=>ot(DS),PS=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return gr.addEventListener(Ue.FURNI_ADDED,n),()=>{gr.removeEventListener(Ue.FURNI_ADDED,n)}},[i,e])},Tn=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return gr.addEventListener(Ue.FURNI_REMOVED,n),()=>{gr.removeEventListener(Ue.FURNI_REMOVED,n)}},[i,e])},LS=i=>{at(Ue.OBJECT_DESELECTED,i)},MS=i=>{at(Ue.OBJECT_ROLL_OUT,i)},xS=i=>{at(Ue.OBJECT_ROLL_OVER,i)},bc=i=>{at(Ue.OBJECT_SELECTED,i)},ch=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return gr.addEventListener(Ue.USER_ADDED,n),()=>{gr.removeEventListener(Ue.USER_ADDED,n)}},[i,e])},uh=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return gr.addEventListener(Ue.USER_REMOVED,n),()=>{gr.removeEventListener(Ue.USER_REMOVED,n)}},[i,e])},US=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1);return U(nI,s=>{const a=s.getParser();a&&e(a)}),{promoteInformation:i,isExtended:n,setPromoteInformation:e,setIsExtended:r}},Nc=()=>ot(US),FS=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(null),[l,u]=o.useState(0),d=(m,f,I,C=!1)=>{if(!n)return;const p=rn.hslToRGB(((m&255)<<16)+((f&255)<<8)+(I&255));C&&u(p),!m&&!f&&!I?n.tint=0:n.tint=p},g=m=>{if(!s)return;const f=m>>16&255,I=m>>8&255,C=m&255;s.red=f/255,s.green=I/255,s.blue=C/255};return at(qr.PREVIEW,m=>d(m.hue,m.saturation,m.lightness)),at(qr.CLEAR_PREVIEW,m=>{n&&(n.tint=l)}),Ee(rI.ROOM_BACKGROUND_COLOR,m=>{Is.isRoomPreviewerId(m.roomId)||(m.enable?d(m.hue,m.saturation,m.lightness,!0):d(0,0,0,!0))}),Ee(sI.ROOM_COLOR,m=>{if(Is.isRoomPreviewerId(m.roomId))return;let f=0,I=255;m.bgOnly||(f=m.color,I=m.brightness),g(rn.hslToRGB((rn.rgbToHSL(f)&16776960)+I))}),Ee([_n.INITIALIZED,_n.DISPOSED],m=>{if(Is.isRoomPreviewerId(m.roomId))return;const f=Te();if(f)switch(m.type){case _n.INITIALIZED:iu(m.roomId),e(f);return;case _n.DISPOSED:e(null);return}}),Pe([Dt.CREATED,Dt.ENDED],m=>{switch(m.type){case Dt.CREATED:Hb(m.session);return;case Dt.ENDED:e(null);return}}),Ee([ht.SELECTED,ht.DESELECTED,ht.ADDED,ht.REMOVED,ht.PLACED,ht.REQUEST_MOVE,ht.REQUEST_ROTATE,ht.MOUSE_ENTER,ht.MOUSE_LEAVE,ht.DOUBLE_CLICK],m=>{if(Is.isRoomPreviewerId(m.roomId))return;let f=null;switch(m.type){case ht.SELECTED:jb(m)||(f=new Ue(Ue.OBJECT_SELECTED,m.objectId,m.category,m.roomId));break;case ht.DESELECTED:f=new Ue(Ue.OBJECT_DESELECTED,m.objectId,m.category,m.roomId);break;case ht.ADDED:{let I=null;switch(m.category){case Q.FLOOR:case Q.WALL:I=Ue.FURNI_ADDED;break;case Q.UNIT:I=Ue.USER_ADDED;break}I&&(f=new Ue(I,m.objectId,m.category,m.roomId));break}case ht.REMOVED:{let I=null;switch(m.category){case Q.FLOOR:case Q.WALL:I=Ue.FURNI_REMOVED;break;case Q.UNIT:I=Ue.USER_REMOVED;break}I&&(f=new Ue(I,m.objectId,m.category,m.roomId));break}case ht.REQUEST_MOVE:xa(i,m.objectId,m.category)&&Us(m.objectId,m.category,Yn.OBJECT_MOVE);break;case ht.REQUEST_ROTATE:xa(i,m.objectId,m.category)&&Us(m.objectId,m.category,Yn.OBJECT_ROTATE_POSITIVE);break;case ht.MOUSE_ENTER:f=new Ue(Ue.OBJECT_ROLL_OVER,m.objectId,m.category,m.roomId);break;case ht.MOUSE_LEAVE:f=new Ue(Ue.OBJECT_ROLL_OUT,m.objectId,m.category,m.roomId);break;case ht.DOUBLE_CLICK:f=new Ue(Ue.OBJECT_DOUBLE_CLICKED,m.objectId,m.category,m.roomId);break}f&&Nt(f)}),o.useEffect(()=>{if(!i)return;const m=pe(),f=$(),I=i.roomId,C=1,p=Math.floor(window.innerWidth),_=Math.floor(window.innerHeight),E=m.application.renderer;E&&(E.view.style.width=`${p}px`,E.view.style.height=`${_}px`,E.resolution=window.devicePixelRatio,E.resize(p,_));const b=f.getRoomInstanceDisplay(I,C,p,_,aI.SCALE_ZOOMED_IN),N=$().getRoomInstanceRenderingCanvas(I,C);if(!b||!N)return;const T=new Fi(iI.WHITE),y=new oI,R=N.master;T.tint=0,T.width=p,T.height=_,R.addChildAt(T,0),R.filters=[y],r(T),a(y);const O=f.getRoomInstanceGeometry(I,C);if(O){const A=f.getRoomInstanceVariable(I,oi.ROOM_MIN_X)||0,k=f.getRoomInstanceVariable(I,oi.ROOM_MAX_X)||0,x=f.getRoomInstanceVariable(I,oi.ROOM_MIN_Y)||0,B=f.getRoomInstanceVariable(I,oi.ROOM_MAX_Y)||0;let V=(A+k)/2,q=(x+B)/2;const Y=20;V=V+(Y-1),q=q+(Y-1);const z=Math.sqrt(Y*Y+Y*Y)*Math.tan(30/180*Math.PI);O.location=new Tt(V,q,z)}const F=m.application.stage;if(!F)return;F.addChild(b),iu(i.roomId);const D=A=>{const k=Math.floor(window.innerWidth),x=Math.floor(window.innerHeight);E.view.style.width=`${k}px`,E.view.style.height=`${x}px`,E.resolution=window.devicePixelRatio,E.resize(k,x),T.width=k,T.height=x,Wb(k,x,1),m.application.render()};return window.addEventListener("resize",D),()=>{r(null),a(null),u(0),window.removeEventListener("resize",D)}},[i]),{roomSession:i}},Le=()=>ot(FS),VS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),{roomSession:l=null}=Le(),u=()=>{const m=rn.rgbToHSL(s),[f,I,C,p]=an.int_to_8BitVals(m);L(new lI(i,I,C,p))},d=()=>l.useMultistateItem(i),g=()=>{Nt(new qr(qr.CLEAR_PREVIEW)),e(-1),r(-1),a(0)};return Ee(_e.REQUEST_BACKGROUND_COLOR,m=>{if(!xa(l,m.objectId,m.category))return;const I=$().getRoomObject(m.roomId,m.objectId,m.category).model;e(m.objectId),r(m.category);const C=parseInt(I.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),p=parseInt(I.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),_=parseInt(I.getValue(te.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),E=an.eight_bitVals_to_int(0,C,p,_),b=rn.hslToRGB(E);a(b)}),Tn(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||g()}),o.useEffect(()=>{if(i===-1||n===-1)return;const m=rn.rgbToHSL(s),[f,I,C,p]=an.int_to_8BitVals(m);Nt(new qr(qr.PREVIEW,I,C,p))},[i,n,s]),{objectId:i,color:s,setColor:a,applyToner:u,toggleToner:d,onClose:g}},GS=VS,BS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("1"),[l,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),[I,C]=o.useState(""),{simpleAlert:p=null}=je(),_=()=>{e(-1),r(-1),a("1"),u(""),g(""),f(""),C("")};return Ee([_e.REQUEST_BADGE_DISPLAY_ENGRAVING,_e.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],E=>{const b=$().getRoomObject(E.roomId,E.objectId,E.category);if(!b)return;const N=new $a;N.initializeFromRoomObjectModel(b.model),e(E.objectId),r(E.category),a("1"),u(Qa(N.getValue(1))),g(uc(N.getValue(1))),f(N.getValue(2)),C(N.getValue(3))}),Ee(_e.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,E=>{const b=$().getRoomObject(E.roomId,E.objectId,E.category);!b||b.model.getValue(te.FURNITURE_OWNER_ID)!==H().userId||p(`${h("resolution.failed.subtitle")} ${h("resolution.failed.text")}`,null,null,null,h("resolution.failed.title"))}),Tn(i!==-1&&n!==-1,E=>{E.id!==i||E.category!==n||_()}),{objectId:i,category:n,color:s,badgeName:l,badgeDesc:d,date:m,senderName:I,onClose:_}},HS=BS,Wl="MONSTERPLANT_SEED_CONFIRMATION",jl="PURCHASABLE_CLOTHING_CONFIRMATION",dh="GROUP_FURNITURE",mh="EFFECTBOX_OPEN",ql="MYSTERYTROPHY_OPEN_DIALOG",WS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(null),[s,a]=o.useState(null),[l,u]=o.useState(-1),[d,g]=o.useState(null),[m,f]=o.useState(!1),[I,C]=o.useState(-1),{roomSession:p=null}=Le(),_=()=>{e(-1),g(null),f(!1),r(null)},E=()=>{a(null),u(-1)},b=N=>{if(N)switch(N){case"use_friend_furni":p.useMultistateItem(i);break;case"use_monsterplant_seed":a(Wl),u(i);break;case"use_random_teleport":$().useRoomObject(i,Q.FLOOR);break;case"use_purchaseable_clothing":a(jl),u(i);break;case"use_mystery_box":p.useMultistateItem(i);break;case"use_mystery_trophy":a(ql),u(i);break;case"join_group":hc(d.guildId),f(!0);return;case"go_to_group_homeroom":d&&vn(d.guildHomeRoomId);break}_()};return Ee([_e.OPEN_FURNI_CONTEXT_MENU,_e.CLOSE_FURNI_CONTEXT_MENU,_e.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,_e.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,_e.REQUEST_EFFECTBOX_OPEN_DIALOG,_e.REQUEST_MYSTERYBOX_OPEN_DIALOG,_e.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],N=>{const T=$().getRoomObject(p.roomId,N.objectId,N.category);if(T)switch(C(T.model.getValue(te.FURNITURE_OWNER_ID)),N.type){case _e.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Wt(T))return;u(T.id),a(Wl),_();return;case _e.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Wt(T))return;u(T.id),a(mh),_();return;case _e.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Wt(T))return;u(T.id),a(jl),_();return;case _e.REQUEST_MYSTERYBOX_OPEN_DIALOG:p.useMultistateItem(T.id),_();return;case _e.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Wt(T))return;u(T.id),a(ql),_();return;case _e.OPEN_FURNI_CONTEXT_MENU:switch(e(T.id),N.contextMenu){case Lt.FRIEND_FURNITURE:r(Lt.FRIEND_FURNITURE);return;case Lt.MONSTERPLANT_SEED:Wt(T)&&r(Lt.MONSTERPLANT_SEED);return;case Lt.MYSTERY_BOX:r(Lt.MYSTERY_BOX);return;case Lt.MYSTERY_TROPHY:Wt(T)&&r(Lt.MYSTERY_TROPHY);return;case Lt.RANDOM_TELEPORT:r(Lt.RANDOM_TELEPORT);return;case Lt.PURCHASABLE_CLOTHING:Wt(T)&&r(Lt.PURCHASABLE_CLOTHING);return}return;case _e.CLOSE_FURNI_CONTEXT_MENU:T.id===i&&_();return}}),U(cI,N=>{const T=N.getParser();e(T.objectId),g(T),f(T.userIsMember),r(dh)}),{objectId:i,mode:n,confirmMode:s,confirmingObjectId:l,groupData:d,isGroupMember:m,objectOwnerId:I,closeConfirm:E,processAction:b,onClose:_}},jS=WS,qS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState([]),[s,a]=o.useState(null),[l,u]=o.useState([]),[d,g]=o.useState(null),[m,f]=o.useState(new Map),[I,C]=o.useState(!1),{groupItems:p=[],getItemsByType:_=null,activate:E=null,deactivate:b=null}=ks(),{simpleAlert:N=null}=je(),T=s&&m.get(s.name)||null,y=()=>{r([]),a(null),u([]),f(new Map)},R=()=>{e(-1),y()},O=()=>{C(!0),L(new pI(i,s.name))},F=D=>{a(D),m.get(D.name)||L(new II(D.name))};return Ee(_e.OPEN_WIDGET,D=>{D.widget===uI.CRAFTING&&(e(D.objectId),y(),L(new dI(D.objectId)))}),U(mI,D=>{const A=D.getParser();if(!A.isActive()){e(-1);return}r(k=>{const x=[];for(const B of A.recipes){const V=$().roomContentLoader._activeObjectTypeIds.get(B.itemName),q=$().getFurnitureFloorIconUrl(V);x.push({name:B.recipeName,localizedName:h("roomItem.name."+V),iconUrl:q})}return x}),g(A.ingredients)}),U(hI,D=>{const A=D.getParser();f(k=>{const x=new Map(k);return x.set(s.name,A.ingredients),x})}),U(gI,D=>{a(null),C(!1),D.getParser().result&&N(h("crafting.info.result.ok"))}),U(fI,D=>{}),o.useEffect(()=>{!d||!d.length||u(D=>{const A=[];for(const k of d){const x=$().roomContentLoader._activeObjectTypeIds.get(k),B=$().getFurnitureFloorIconUrl(x),V=_(x);let q=0;if(V)for(const Y of V)q+=Y.items.length;A.push({name:k,iconUrl:B,count:q})}return A})},[p,d,_]),o.useEffect(()=>{if(i===-1)return;const D=E();return()=>b(D)},[i,E,b]),{objectId:i,recipes:n,ingredients:l,selectedRecipe:s,requiredIngredients:T,isCrafting:I,selectRecipe:F,craft:O,onClose:R}},YS=qS,zS=()=>{const[i,e]=o.useState([]),[n,r]=o.useState(0),[s,a]=o.useState(0),[l,u]=o.useState(0),[d,g]=o.useState(0),[m,f]=o.useState(16777215),[I,C]=o.useState(255),[p,_]=o.useState(0),[E,b]=o.useState(0),[N,T]=o.useState(0),{roomSession:y=null}=Le(),R=()=>y.isRoomOwner||y.controllerLevel>=Qe.GUEST||H().isModerator,O=D=>{const A=i[D-1];A&&(r(A.id),_(A.type),b(A.color),T(A.light))},F=()=>{if(s===0)return;const D=n-1;if(n<1||n>i.length)return;const A=i[D];!A||p===A.type&&E===A.color&&N===A.light||(e(k=>{const x=[...k];return x[D]=new _u(A.id,p,E,N),x}),Pn.savePreset(A.id,p,E,N,!0))};return Ee(_e.REQUEST_DIMMER,D=>{R()&&y.requestMoodlightSettings()}),Pe(EI.ROOM_DIMMER_PRESETS,D=>{const A=[];let k=0;for(;k<D.presetCount;){const x=D.getPreset(k);x&&A.push(new _u(x.id,x.type,x.color,x.brightness)),k++}e(A),r(D.selectedPresetId)}),Ee(CI.ROOM_COLOR,D=>{Is.isRoomPreviewerId(D.roomId)||(u(s),a(D.state),r(D.presetId),g(D.effectId),_(D.effectId),f(D.color),b(D.color),C(D.brightness),T(D.brightness))}),o.useEffect(()=>{s===0&&l===0||Pn.previewDimmer(E,N,p===2)},[s,l,E,N,p]),{presets:i,selectedPresetId:n,dimmerState:s,lastDimmerState:l,effectId:d,color:m,brightness:I,selectedEffectId:p,setSelectedEffectId:_,selectedColor:E,setSelectedColor:b,selectedBrightness:N,setSelectedBrightness:T,selectPresetId:O,applyChanges:F}},$S=zS,KS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),l=()=>{e(-1),r(-1),a(0)},u=()=>{Te().connection.send(new _I(i)),l()};return Ee(_e.REQUEST_CREDITFURNI,d=>{const g=$().getRoomObject(d.roomId,d.objectId,d.category);!g||!Wt(g)||(e(d.objectId),r(d.category),a(g.model.getValue(te.FURNITURE_CREDIT_VALUE)||0))}),Tn(i!==-1&&n!==-1,d=>{d.id!==i||d.category!==n||l()}),{objectId:i,value:s,redeem:u,onClose:l}},XS=KS,QS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(-1),[l,u]=o.useState([]),{roomSession:d=null}=Le(),g=()=>{e(-1),r(-1),a(-1),u([])};return Ee(_e.REQUEST_EXTERNAL_IMAGE,m=>{const f=$().getRoomObject(m.roomId,m.objectId,m.category),I=$().getRoomObjects(d==null?void 0:d.roomId,Q.WALL);if(!f)return;const C=[];I.forEach(_=>{if(_.type!=="external_image_wallitem_poster_small")return null;const E=_.model.getValue(te.FURNITURE_DATA),b=JSON.parse(E);C.push(b)}),e(m.objectId),r(m.category),u(C);const p=JSON.parse(f.model.getValue(te.FURNITURE_DATA));a(_=>{let E=0;return p&&(E=C.findIndex(b=>b.u===p.u)),E<0&&(E=0),E})}),Tn(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||g()}),{objectId:i,currentPhotoIndex:s,currentPhotos:l,onClose:g}},JS=QS,ZS=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),[l,u]=o.useState([]),[d,g]=o.useState([]),[m,f]=o.useState(null),[I,C]=o.useState(0),p=()=>{e(-1),r(-1),a(0),u([]),g([]),f(null)},_=E=>{Te().connection.send(new vI(i,E)),p()};return U(bI,E=>{const b=E.getParser();e(b.furniId),C(b.start?1:2)}),U(NI,E=>p()),U(SI,E=>p()),Ee(_e.REQUEST_FRIEND_FURNITURE_ENGRAVING,E=>{const b=$().getRoomObject(E.roomId,E.objectId,E.category);if(!b)return;const N=b.model.getValue(te.FURNITURE_DATA),T=b.model.getValue(te.FURNITURE_FRIENDFURNI_ENGRAVING);N[0]!=="1"||N.length!==6||(e(E.objectId),r(E.category),a(T),u([N[1],N[2]]),g([N[3],N[4]]),f(N[5]),C(0))}),Tn(i!==-1&&n!==-1,E=>{E.id!==i||E.category!==n||p()}),{objectId:i,type:s,usernames:l,figures:d,date:m,stage:I,onClose:p,respond:_}},ev=ZS,tv=["perteam","mostwins","classic"],nv=["alltime","daily","weekly","monthly"],rv=()=>{const[i,e]=o.useState(new Map),{roomSession:n=null}=Le(),r=a=>tv[a],s=a=>nv[a];return Ee(_e.REQUEST_HIGH_SCORE_DISPLAY,a=>{const l=$().getRoomObject(a.roomId,a.objectId,a.category);if(!l)return;const u=l.model.getValue(te.FURNITURE_DATA_FORMAT),d=qd.getData(u);d.initializeFromRoomObjectModel(l.model),e(g=>{const m=new Map(g);return m.set(l.id,d),m})}),Ee(_e.REQUEST_HIDE_HIGH_SCORE_DISPLAY,a=>{a.roomId===n.roomId&&e(l=>{const u=new Map(l);return u.delete(a.objectId),u})}),{stuffDatas:i,getScoreType:r,getClearType:s}},sv=rv,av="internalLink",iv=()=>(Ee(_e.REQUEST_INTERNAL_LINK,i=>{const e=$().getRoomObject(i.roomId,i.objectId,i.category);if(!e)return;let r=e.model.getValue(te.FURNITURE_DATA)[av];(!r||!r.length)&&(r=e.model.getValue(te.FURNITURE_INTERNAL_LINK)),r&&r.length&&Z(r)}),{}),ov=iv,lv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(sn.NO_CLUB),[m,f]=o.useState(null),I=()=>{e(-1),r(-1),a(null),u(null),f(null)},C=()=>{i!==-1&&(L(new TI(i)),I())},p=()=>{i!==-1&&(L(new yl(i)),I())},_=()=>{i!==-1&&L(new wI(i,m))};return Ee(_e.REQUEST_MANNEQUIN,E=>{const b=$().getRoomObject(E.roomId,E.objectId,E.category);if(!b)return;const N=b.model,T=N.getValue(te.FURNITURE_MANNEQUIN_FIGURE)||null,y=N.getValue(te.FURNITURE_MANNEQUIN_GENDER)||null,R=St().createFigureContainer(T),O=St().getFigureClubLevel(R,y,Zs.MANNEQUIN_CLOTHING_PART_TYPES);e(E.objectId),r(E.category),a(T),u(y),g(O),f(N.getValue(te.FURNITURE_MANNEQUIN_NAME)||null)}),Tn(i!==-1&&n!==-1,E=>{E.id!==i||E.category!==n||I()}),{objectId:i,figure:s,gender:l,clubLevel:d,name:m,setName:f,saveFigure:C,wearFigure:p,saveName:_,onClose:I}},cv=lv,uv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(-1),[l,u]=o.useState(new Da),[d,g]=o.useState([]),{roomSession:m=null}=Le(),{showSingleBubble:f=null,simpleAlert:I=null}=je(),C=()=>{e(-1),r(-1)},p=o.useCallback((N,T)=>L(new RI(N,T)),[]),_=o.useCallback(N=>L(new OI(N)),[]),E=o.useCallback((N,T)=>L(new yl(N,T)),[]);Ee(_e.REQUEST_PLAYLIST_EDITOR,N=>{var y,R,O;const T=$().getRoomObject(N.roomId,N.objectId,N.category);if(T){if(Wt(T)){e(N.objectId),r(N.category),(y=pe().soundManager.musicController)==null||y.requestUserSongDisks(),(O=(R=pe().soundManager.musicController)==null?void 0:R.getRoomItemPlaylist())==null||O.requestPlayList();return}(m.isRoomOwner||m.controllerLevel>=Qe.GUEST||H().isModerator)&&L(new yl(N.objectId,-2))}}),Tn(i!==-1&&n!==-1,N=>{N.id!==i||N.category!==n||C()}),hs(am.NPE_SONG_CHANGED,N=>{a(N.position)}),hs(yI.NOTIFY_PLAYED_SONG,N=>{f(h("soundmachine.notification.playing",["songname","songauthor"],[N.name,N.creator]),Kt.SOUNDMACHINE)}),hs(kI.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,N=>{var T;u((T=pe().soundManager.musicController)==null?void 0:T.songDiskInventory.clone())}),hs(Bc.PLUE_PLAY_LIST_UPDATED,N=>{var T,y;g((y=(T=pe().soundManager.musicController)==null?void 0:T.getRoomItemPlaylist())==null?void 0:y.entries.concat())}),hs(Bc.PLUE_PLAY_LIST_FULL,N=>{I(h("playlist.editor.alert.playlist.full"),me.ALERT,"","",h("playlist.editor.alert.playlist.full.title"))});const b=N=>{var T,y;i!==-1&&(N instanceof Ol?N.getParser().fragmentNumber===0&&((T=pe().soundManager.musicController)==null||T.requestUserSongDisks()):(y=pe().soundManager.musicController)==null||y.requestUserSongDisks())};return U(Ol,b),U(tm,b),U(em,b),{objectId:i,diskInventory:l,playlist:d,currentPlayingIndex:s,onClose:C,addToPlaylist:p,removeFromPlaylist:_,togglePlayPause:E}},dv=uv,ku="floor",mv="wallpaper",Au="landscape",hv="poster",gv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(!1),[m,f]=o.useState(null),[I,C]=o.useState(null),[p,_]=o.useState(-1),[E,b]=o.useState(null),[N,T]=o.useState(!1),[y,R]=o.useState(null),{roomSession:O=null}=Le(),F=()=>{e(-1),r(-1),a(null),u(null),g(!1),f(null),C(null),_(-1),b(null),T(!1),R(null)},D=()=>{i!==-1&&(O.openGift(i),$().changeObjectModelData($().activeRoomId,i,Q.FLOOR,te.FURNITURE_DISABLE_PICKING_ANIMATION,1))},A=o.useMemo(()=>({imageReady:(k,x,B)=>{!B&&x&&(B=Kn.generateImage(x)),R(B.src)},imageFailed:null}),[]);return Pe(AI.RSPE_PRESENT_OPENED,k=>{let x=null;k.itemType===he.FLOOR?x=H().getFloorItemData(k.classId):k.itemType===he.WALL&&(x=H().getWallItemData(k.classId));let B=!1;if(k.placedInRoom){const V=$().getRoomObject(O.roomId,k.placedItemId,Q.FLOOR);V&&(B=Wt(V))}switch(k.itemType){case he.WALL:{if(x)switch(x.className){case ku:case Au:case mv:let V=null;x.className===ku?V=h("inventory.furni.item.floor.name"):x.className===Au?V=h("inventory.furni.item.landscape.name"):V=h("inventory.furni.item.wallpaper.name"),u(V);break;case hv:{const q=k.productCode;let Y=null;q.indexOf("poster")===0&&(Y=q.replace("poster",""));const z=H().getProductData(q);let de=null;z?de=z.name:x&&(de=x.name),u(de),R($().getFurnitureWallIconUrl(k.classId,Y));break}default:{u(x.name||null),R($().getFurnitureWallIconUrl(k.classId));break}}break}case he.HABBO_CLUB:u(h("widget.furni.present.hc"));break;default:{if(k.placedItemType===he.PET){const q=k.petFigureString;if(q&&q.length){const Y=new ea(q),z=$().getRoomObjectPetImage(Y.typeId,Y.paletteId,Y.color,new Tt(90),64,A,!0,0,Y.customParts);z&&R(z.getImage().src)}}else{const q=$().getFurnitureFloorImage(k.classId,new Tt(90),64,A);q&&R(q.getImage().src)}const V=H().getProductData(k.productCode);u(V&&V.name||x.name);break}}e(0),r(k.classId),a(k.itemType),g(B),_(k.placedItemId),b(k.placedItemType),T(k.placedInRoom)}),Ee(_e.REQUEST_PRESENT,k=>{const x=$().getRoomObject(k.roomId,k.objectId,k.category);if(!x)return null;F(),e(k.objectId),r(-1),u(x.model.getValue(te.FURNITURE_DATA)||""),g(Wt(x)),f(x.model.getValue(te.FURNITURE_PURCHASER_NAME)||null),C(x.model.getValue(te.FURNITURE_PURCHASER_FIGURE)||null)}),Tn(i!==-1,k=>{k.id===i&&F(),k.id===p&&N&&T(!1)}),{objectId:i,classId:n,itemType:s,text:l,isOwnerOfFurniture:d,senderName:m,senderFigure:I,placedItemId:p,placedItemType:E,placedInRoom:N,imageUrl:y,openPresent:D,onClose:F}},fv=gv,pv="internalLink",Iv=()=>{const[i,e]=o.useState(0);return Ee(_e.REQUEST_ROOM_LINK,n=>{const r=$().getRoomObject(n.roomId,n.objectId,n.category);if(!r)return;let a=r.model.getValue(te.FURNITURE_DATA)[pv];(!a||!a.length)&&(a=r.model.getValue(te.FURNITURE_INTERNAL_LINK)),!(!a||!a.length)&&(a=parseInt(a,10),!isNaN(a)&&(e(a),L(new Gi(a,!1,!1))))}),U(Ka,n=>{!i||n.getParser().data.roomId!==i||e(0)}),{}},Ev=Iv,Cv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(""),[l,u]=o.useState(""),[d,g]=o.useState("0"),[m,f]=o.useState(""),[I,C]=o.useState(!1),{getWallItemById:p=null}=ks(),_=()=>{L(new PI(i,l,d,m)),e(-1),r(-1),a(""),u(""),g("0"),f(""),C(!1)};return U(DI,E=>{const b=E.getParser();e(b.itemId),r(Q.WALL);const N=p(b.itemId);let T="post_it";if(N){const y=$().getFurnitureWallName(N.type);y.match("post_it_")&&(T=y)}a(T),u(b.location),g("FFFF33"),f(""),C(!0)}),{objectId:i,color:d,setColor:g,text:m,setText:f,canModify:I,onClose:_}},_v=Cv,rl=40,bv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),[l,u]=o.useState(-1),d=()=>{e(-1),r(-1),a(0),u(-1)},g=(m,f=!1)=>{m||(m=0),m=Math.abs(m),f||m>rl&&(m=rl),a(parseFloat(m.toFixed(2))),f||u(m*100)};return U(LI,m=>{const f=m.getParser();i===f.furniId&&g(f.height,!0)}),Ee(_e.REQUEST_STACK_HEIGHT,m=>{if(!xa(Te(),m.objectId,m.category))return;const f=$().getRoomObject(m.roomId,m.objectId,m.category);f&&(e(m.objectId),r(m.category),a(f.getLocation().z),u(-1))}),Tn(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||d()}),o.useEffect(()=>{if(i===-1||l===-1)return;const m=setTimeout(()=>L(new kl(i,~~l)),10);return()=>clearTimeout(m)},[i,l]),{objectId:i,height:s,maxHeight:rl,onClose:d,updateHeight:g}},Nv=bv,Sv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("0"),[l,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(!1),I=()=>{e(-1),r(-1),a("0"),u(""),g(""),f(!1)},C=E=>{E!==s&&(a(E),$().modifyRoomObjectData(i,n,E,l))},p=E=>{u(E),$().modifyRoomObjectData(i,n,s,E)},_=()=>$().deleteRoomObject(i,n);return Ee(_e.REQUEST_STICKIE,E=>{const b=$().getRoomObject(E.roomId,E.objectId,E.category);if(!b)return;const N=b.model.getValue(te.FURNITURE_ITEMDATA);if(N.length<6)return;let T=null,y=null;N.indexOf(" ")>0?(T=N.slice(0,N.indexOf(" ")),y=N.slice(N.indexOf(" ")+1,N.length)):T=N,e(E.objectId),r(E.category),a(T||"0"),u(y||""),g(b.type||"post_it"),f(Te().isRoomOwner||H().isModerator||Wt(b))}),Tn(i!==-1&&n!==-1,E=>{E.id!==i||E.category!==n||I()}),{objectId:i,color:s,text:l,type:d,canModify:m,updateColor:C,updateText:p,trash:_,onClose:I}},vv=Sv,Tv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("1"),[l,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),I=()=>{e(-1),r(-1),a("1"),u(""),g(""),f("")};return Ee(_e.REQUEST_TROPHY,C=>{const p=$().getRoomObject(C.roomId,C.objectId,C.category);if(!p)return;let _=p.model.getValue(te.FURNITURE_DATA);p.model.getValue(te.FURNITURE_EXTRAS),e(C.objectId),r(C.category),a(p.model.getValue(te.FURNITURE_COLOR)||"1");const E=_.substring(0,_.indexOf("	"));_=_.substring(E.length+1,_.length);const b=_.substring(0,_.indexOf("	")),N=_.substr(b.length+1,_.length);u(E),g(b),f(N)}),Tn(i!==-1&&n!==-1,C=>{C.id!==i||C.category!==n||I()}),{objectId:i,color:s,senderName:l,date:d,message:m,onClose:I}},wv=Tv,Rv=0,Ov=1,yv=2,kv=3,Av=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(-1),[I,C]=o.useState(null),[p,_]=o.useState(null),[E,b]=o.useState(!1),N=()=>{e(-1),r(-1),a(null),u(null),g(null),f(-1),C(null),_(null),b(!1)},T=()=>L(new li(i,Rv)),y=()=>L(new li(i,Ov)),R=()=>E&&s&&s.length&&L(new li(i,yv)),O=()=>E&&s&&s.length&&L(new li(i,kv)),F=D=>{if(I===D){C(null),L(new Hc(i,""));return}C(D),L(new Hc(i,D))};return Ee(_e.REQUEST_YOUTUBE,D=>{if(Is.isRoomPreviewerId(D.roomId))return;const A=$().getRoomObject(D.roomId,D.objectId,D.category);A&&(e(D.objectId),r(D.category),b(H().hasSecurity(Hi.EMPLOYEE)||Wt(A)),L(new MI(D.objectId)))}),U(xI,D=>{const A=D.getParser();i===-1||i!==A.furniId||(a(A.videoId),u(A.startAtSeconds),g(A.endAtSeconds),f(A.state))}),U(UI,D=>{const A=D.getParser();i===-1||i!==A.furniId||(_(A.playlists),C(A.selectedPlaylistId),a(null),f(-1),g(null),u(null))}),U(FI,D=>{const A=D.getParser();if(!(i===-1||i!==A.furniId))switch(A.commandId){case 1:f(Yr.PLAYING);break;case 2:f(Yr.PAUSED);break}}),Tn(i!==-1&&n!==-1,D=>{D.id!==i||D.category!==n||N()}),{objectId:i,videoId:s,videoStart:l,videoEnd:d,currentVideoState:m,selectedVideo:I,playlists:p,onClose:N,previous:T,next:y,pause:R,play:O,selectVideo:F}},Dv=Av,Pv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState([]),[s,a]=o.useState(""),[l,u]=o.useState([]),[d,g]=o.useState(0),[m,f]=o.useState(le.STUFF_SELECTION_OPTION_NONE),{showConfirm:I=null}=je(),C=()=>{const _=E=>{E&&(E instanceof im?L(new WI(E.id,n,s,l,d,E.stuffTypeSelectionCode)):E instanceof om?L(new jI(E.id,n,s,l,E.stuffTypeSelectionCode)):E instanceof lm&&L(new qI(E.id,n,s,l,E.stuffTypeSelectionCode)))};Gb(i.id)?_(i):I(h("wiredfurni.nonowner.change.confirm.body"),()=>{_(i)},null,null,null,h("wiredfurni.nonowner.change.confirm.title"))},p=(_,E)=>{!i||!m||_<=0||u(b=>{const N=[...b],T=b.indexOf(_);return T>=0?(N.splice(T,1),bs.hide(_)):N.length<i.maximumItemSelectionCount&&(N.push(_),bs.show(_)),N})};return U(VI,_=>{_.getParser(),e(null)}),U(GI,_=>{const E=_.getParser();e(E.definition)}),U(BI,_=>{const E=_.getParser();e(E.definition)}),U(HI,_=>{const E=_.getParser();e(E.definition)}),o.useEffect(()=>{if(i)return()=>{r([]),a(""),g(0),u(_=>(_&&_.length&&bs.clearSelectionShaderFromFurni(_),[])),f(le.STUFF_SELECTION_OPTION_NONE)}},[i]),{trigger:i,setTrigger:e,intParams:n,setIntParams:r,stringParam:s,setStringParam:a,furniIds:l,setFurniIds:u,actionDelay:d,setActionDelay:g,setAllowsFurni:f,saveWired:C,selectObjectForWired:p}},Ce=()=>ot(Pv),Lv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState([]),[l,u]=o.useState([]),[d,g]=o.useState(null),[m,f]=o.useState(-1),[I,C]=o.useState(!1),{friends:p=[]}=ln(),{selectObjectForWired:_=null}=Ce(),{roomSession:E=null}=Le(),b=O=>{a(F=>{const D=[...F];return D.splice(O,1),D})},N=O=>{u(F=>{const D=[...F],A=D.splice(O,1)[0];return d===A&&g(null),D})},T=O=>{g(O),u([])},y=(O,F)=>{const D=Ls.getObjectName(O,F);D&&(r(D),F!==Q.UNIT&&u([]))},R=(O,F)=>{let D=null;switch(F){case Q.FLOOR:case Q.WALL:D=Ls.getFurniInfo(O,F),D&&_(O,F);break;case Q.UNIT:{const A=E.userDataManager.getUserDataByIndex(O);if(!A)break;switch(A.type){case ut.PET:E.userDataManager.requestPetInfo(A.webID),f(A.webID);break;case ut.USER:D=Ls.getUserInfo(F,A);break;case ut.BOT:D=Ls.getBotInfo(F,A);break;case ut.RENTABLE_BOT:D=Ls.getRentableBotInfo(F,A);break}}}D&&e(D)};return Pe(YI.USER_DATA_UPDATED,O=>{if(!O.addedUsers.length)return;let F=[];O.addedUsers.forEach(D=>{D.webID!==H().userId&&p.find(A=>A.id===D.webID)&&F.push(new qm(D.roomIndex,Q.UNIT,D.webID,D.name,D.type,!0))}),F.length&&a(D=>{const A=[...D];return F.forEach(k=>{const x=A.findIndex(B=>B.id===k.id);x>-1&&A.splice(x,1),A.push(k)}),A})}),Pe(zI.PET_INFO,O=>{const F=O.petInfo;if(!F||F.id!==m)return;const D=Ls.getPetInfo(F);D&&(e(D),f(-1))}),Pe($I.PET_STATUS_UPDATE,O=>{}),Ee(Wc.USE_PRODUCT_FROM_INVENTORY,O=>{}),Ee(Wc.USE_PRODUCT_FROM_ROOM,O=>{const F=$().getRoomObject(E.roomId,O.objectId,Q.FLOOR);if(!F||!Wt(F))return;const D=F.model.getValue(te.FURNITURE_OWNER_ID),A=F.model.getValue(te.FURNITURE_TYPE_ID),k=H().getFloorItemData(A),x=k.customParams.split(" "),B=x.length?parseInt(x[0]):-1;if(B===-1)return;const V=[],q=$().getRoomObjects(E.roomId,Q.UNIT);for(const Y of q){const z=E.userDataManager.getUserDataByIndex(Y.id);let de=!1;if(!(!z||z.type!==ut.PET)){if(z.ownerId===D){z.hasSaddle&&k.specialType===ce.PET_SADDLE&&(de=!0);const ee=z.figure.split(" ");if((ee.length?parseInt(ee[0]):-1)===B){if(k.specialType===ce.MONSTERPLANT_REVIVAL&&!z.canRevive||k.specialType===ce.MONSTERPLANT_REBREED&&(z.petLevel<7||z.canRevive||z.canBreed)||k.specialType===ce.MONSTERPLANT_FERTILIZE&&(z.petLevel>=7||z.canRevive))continue;V.push(new LN(z.roomIndex,Q.UNIT,z.name,O.objectId,Y.id,-1,de))}}}}g(null),V.length&&u(V)}),Ee(ht.REQUEST_MANIPULATION,O=>{xa(E,O.objectId,O.category)&&C(!0)}),bc(O=>{R(O.id,O.category)}),LS(O=>{e(null),u([])}),xS(O=>{i||O.category!==Q.UNIT||y(O.id,O.category)}),MS(O=>{!n||O.category!==Q.UNIT||n.roomIndex!==O.id||r(null)}),at([Ue.FURNI_REMOVED,Ue.USER_REMOVED],O=>{if(n&&n.category===O.category&&n.roomIndex===O.id&&r(null),O.category===Q.UNIT){let F=s.findIndex(D=>D.roomIndex===O.id);F>-1&&a(D=>D.filter(A=>A.roomIndex===O.id)),F=l.findIndex(D=>D.id===O.id),F>-1&&u(D=>D.filter(A=>A.id!==O.id))}else O.category===Q.FLOOR&&l.findIndex(D=>D.id===O.id)>-1&&u(D=>D.filter(A=>A.requestRoomObjectId!==O.id));i&&(i instanceof Ns?i.id===O.id&&e(null):(i instanceof Ct||i instanceof vs||i instanceof Ss)&&i.roomIndex===O.id&&e(null))}),o.useEffect(()=>{i&&(r(null),a([]),u([]))},[i]),o.useEffect(()=>{n&&a([])},[n]),o.useEffect(()=>{E.isDecorating=I},[E,I]),{avatarInfo:i,setAvatarInfo:e,activeNameBubble:n,setActiveNameBubble:r,nameBubbles:s,productBubbles:l,confirmingProduct:d,isDecorating:I,setIsDecorating:C,removeNameBubble:b,removeProductBubble:N,updateConfirmingProduct:T,getObjectName:y}},Mv=Lv,xv=()=>{const[i,e]=o.useState(""),[n,r]=o.useState(!1),[s,a]=o.useState(!1),[l,u]=o.useState(!1),[d,g]=o.useState(!1),[m,f]=o.useState(0),{showNitroAlert:I=null,showConfirm:C=null}=je(),{roomSession:p=null}=Le(),_=(E,b,N="",T=0)=>{if(E==="")return null;const y=E.split(" ");if(y.length>0){const R=y[0];let O="";if(y.length>1&&(O=y[1]),R.charAt(0)===":"&&O==="x"){const F=$().selectedAvatarId;if(F>-1){const D=p.userDataManager.getUserDataByIndex(F);D&&(O=D.name,E=E.replace(" x"," "+D.name))}}switch(R.toLowerCase()){case":shake":return qc.init(2500,5e3),qc.turnVisualizationOn(),null;case":rotate":return jc.init(2500,5e3),jc.turnVisualizationOn(),null;case":d":case";d":Nn()===sn.VIP&&p.sendExpressionMessage(lr.LAUGH.ordinal);break;case"o/":case"_o/":return p.sendExpressionMessage(lr.WAVE.ordinal),null;case":kiss":if(Nn()===sn.VIP)return p.sendExpressionMessage(lr.BLOW.ordinal),null;break;case":jump":if(Nn()===sn.VIP)return p.sendExpressionMessage(lr.JUMP.ordinal),null;break;case":idle":return p.sendExpressionMessage(lr.IDLE.ordinal),null;case"_b":return p.sendExpressionMessage(lr.RESPECT.ordinal),null;case":sign":return p.sendSignMessage(parseInt(O)),null;case":iddqd":case":flip":return $().events.dispatchEvent(new Al(p.roomId,-1,!0)),null;case":zoom":return $().events.dispatchEvent(new Al(p.roomId,parseFloat(O),!1)),null;case":screenshot":const F=$().createTextureFromRoom(p.roomId,1),D=new Image;return D.src=Kn.generateImageUrl(F),window.open("").document.write(D.outerHTML),null;case":pickall":return(p.isRoomOwner||H().isModerator)&&C(h("room.confirm.pick_all"),()=>{H().sendSpecialCommandMessage(":pickall")},null,null,null,h("generic.alert.title")),null;case":ejectall":return(p.isRoomOwner||H().isModerator||p.controllerLevel>=Qe.GUEST)&&C(h("room.confirm.eject_all"),()=>{H().sendSpecialCommandMessage(":ejectall")},null,null,null,h("generic.alert.title")),null;case":furni":return Z("furni-chooser/"),null;case":chooser":return Z("user-chooser/"),null;case":floor":case":bcfloor":return p.controllerLevel>=Qe.ROOM_OWNER&&Z("floor-editor/show"),null;case":togglefps":return zn().maxFPS>0?zn().maxFPS=0:zn().maxFPS=X("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return I(),null;case":settings":return(p.isRoomOwner||H().isModerator)&&L(new cm(p.roomId)),null}}switch(b){case dr.CHAT_DEFAULT:p.sendChatMessage(E,T);break;case dr.CHAT_SHOUT:p.sendShoutMessage(E,T);break;case dr.CHAT_WHISPER:p.sendWhisperMessage(N,E,T);break}};return Pe(yn.FLOOD_EVENT,E=>{g(!0),f(parseFloat(E.message))}),bc(E=>{if(E.category!==Q.UNIT)return;const b=p.userDataManager.getUserDataByIndex(E.id);b&&e(b.name)}),Ee(ht.DESELECTED,E=>e("")),o.useEffect(()=>{if(!d)return;let E=0;const b=setInterval(()=>{f(N=>(E=(N||0)-1,E)),E<0&&(clearInterval(b),g(!1))},1e3);return()=>clearInterval(b)},[d]),o.useEffect(()=>{if(!l)return;let E=null;return l&&(E=setTimeout(()=>{u(!1),r(!1)},1e4)),()=>clearTimeout(E)},[l]),o.useEffect(()=>{n?s||(a(!0),p.sendChatTypingMessage(n)):s&&(a(!1),p.sendChatTypingMessage(n))},[p,n,s]),{selectedUsername:i,floodBlocked:d,floodBlockedSeconds:m,setIsTyping:r,setIsIdle:u,sendChat:_}},Uv=xv,Du=new Map,Pu=new Map,Lu=new Map,Fv=()=>{const[i,e]=o.useState([]),[n,r]=o.useState({mode:gt.CHAT_MODE_FREE_FLOW,weight:gt.CHAT_BUBBLE_WIDTH_NORMAL,speed:gt.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:gt.FLOOD_FILTER_NORMAL}),{roomSession:s=null}=Le(),{addChatEntry:a}=xo(),l=o.useRef(!1),u=o.useMemo(()=>{if(!n)return 6e3;switch(n.speed){case gt.CHAT_SCROLL_SPEED_FAST:return 3e3;case gt.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case gt.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[n]),d=f=>{const I=St().createAvatarImage(f,tc.LARGE,null,{resetFigure:_=>{l.current||d(_)},dispose:()=>{},disposed:!1});if(!I)return;const C=I.getCroppedImage(Vi.HEAD),p=I.getPartColor(Me.CHEST);return Du.set(f,p&&p.rgb||16777215),I.dispose(),Pu.set(f,C.src),C.src},g=f=>{let I=Pu.get(f);return I||(I=d(f)),I},m=(f,I,C,p=64,_=null)=>{let E=Lu.get(f+_);if(E)return E;const b=new ea(f),N=b.typeId,T=$().getRoomObjectPetImage(N,b.paletteId,b.color,new Tt(I*45),p,null,!1,0,b.customParts,_);return T&&(E=Kn.generateImageUrl(T.data),Lu.set(f+_,E)),E};return Pe(yn.CHAT_EVENT,f=>{const I=$().getRoomObject(s.roomId,f.objectId,Q.UNIT),C=I?Pm(s.roomId,I==null?void 0:I.id,Q.UNIT):new zr,p=I?s.userDataManager.getUserDataByIndex(f.objectId):new KI(-1);let _="",E=0,b=null,N=f.chatType,T=f.style,y=0,R=f.message;if(p){y=p.type;const A=p.figure;switch(y){case ut.PET:b=m(A,2,!0,64,I.model.getValue(te.FIGURE_POSTURE)),new ea(A).typeId;break;case ut.USER:b=g(A);break;case ut.RENTABLE_BOT:case ut.BOT:T=JI.BOT;break}E=Du.get(A),_=p.name}switch(N){case yn.CHAT_TYPE_RESPECT:R=h("widgets.chatbubble.respect",["username"],[_]),X("respect.options").enabled&&fr(X("respect.options").sound);break;case yn.CHAT_TYPE_PETREVIVE:case yn.CHAT_TYPE_PET_REBREED_FERTILIZE:case yn.CHAT_TYPE_PET_SPEED_FERTILIZE:{let A="widget.chatbubble.petrevived";N===yn.CHAT_TYPE_PET_REBREED_FERTILIZE?A="widget.chatbubble.petrefertilized;":N===yn.CHAT_TYPE_PET_SPEED_FERTILIZE&&(A="widget.chatbubble.petspeedfertilized");let k=null;if($().getRoomObject(s.roomId,f.extraParam,Q.UNIT)){const B=s.userDataManager.getUserDataByIndex(I.id);B&&(k=B.name)}R=h(A,["petName","userName"],[_,k]);break}case yn.CHAT_TYPE_PETRESPECT:R=h("widget.chatbubble.petrespect",["petname"],[_]);break;case yn.CHAT_TYPE_PETTREAT:R=h("widget.chatbubble.pettreat",["petname"],[_]);break;case yn.CHAT_TYPE_HAND_ITEM_RECEIVED:R=h("widget.chatbubble.handitem",["username","handitem"],[_,h("handitem"+f.extraParam)]);break;case yn.CHAT_TYPE_MUTE_REMAINING:{const A=(f.extraParam>0?Math.floor(f.extraParam/3600):0).toString(),k=(f.extraParam>0?Math.floor(f.extraParam%3600/60):0).toString(),x=(f.extraParam%60).toString();R=h("widget.chatbubble.mutetime",["hours","minutes","seconds"],[A,k,x]);break}}const O=aN(R),F=E&&("#"+E.toString(16).padStart(6,"0")||null),D=new Hl(p.roomIndex,Q.UNIT,s.roomId,R,O,_,new zr(C.x,C.y),N,T,b,F);e(A=>[...A,D]),a({id:-1,webId:p.webID,entityId:p.roomIndex,name:_,imageUrl:b,style:T,chatType:N,entityType:p.type,message:O,timestamp:Bm(),type:$n.TYPE_CHAT,roomId:s.roomId,color:F})}),Ee(XI.ROOM_DRAG,f=>{if(!i.length||f.roomId!==s.roomId)return;const I=f.offsetX;i.forEach(C=>C.elementRef&&(C.left+=I))}),U(Ka,f=>{const I=f.getParser();I.roomEnter&&r(I.chat)}),U(QI,f=>{const I=f.getParser();r(I.chat)}),o.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),{chatMessages:i,setChatMessages:e,chatSettings:n,getScrollSpeed:u}},Vv=Fv,Gv=()=>{const[i,e]=o.useState([]),n=a=>{i.indexOf(a)>=0||e([...i,a])},r=a=>{const l=i.indexOf(a);if(l===-1)return;const u=[...i];u.splice(l,1),e(u)},s=(a,l)=>{Te().sendDoorbellApprovalMessage(a,l),r(a)};return Pe(zo.DOORBELL,a=>n(a.userName)),Pe(zo.RSDE_REJECTED,a=>r(a.userName)),Pe(zo.RSDE_ACCEPTED,a=>r(a.userName)),{users:i,addUser:n,removeUser:r,answer:s}},Bv=Gv,Hv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1),s=()=>r(!1);return U(ZI,a=>{const l=a.getParser();r(!0),e(l.words)}),{wordsFilter:i,isVisible:n,setWordsFilter:e,onClose:s}},Wv=Hv,jv=()=>{const[i,e]=o.useState([]),{requests:n=[],dismissedRequestIds:r=[],setDismissedRequestIds:s=null}=ln(),a=o.useMemo(()=>i.filter(u=>r.indexOf(u.request.requesterUserId)===-1),[i,r]),l=u=>{s(d=>{if(d.indexOf(u)>=0)return d;const g=[...d];return g.push(u),g})};return ch(!0,u=>{if(u.category!==Q.UNIT)return;const d=Te().userDataManager.getUserDataByIndex(u.id);if(!d||d.type!==Yc.getTypeNumber(Yc.USER))return;const g=n.find(f=>f.requesterUserId===d.webID);if(!g||i.find(f=>f.request.requesterUserId===d.webID))return;const m=[...i];m.push({roomIndex:d.roomIndex,request:g}),e(m)}),uh(!0,u=>{if(u.category!==Q.UNIT)return;const d=i.findIndex(m=>m.roomIndex===u.id);if(d===-1)return;const g=[...i];g.splice(d,1),e(g)}),o.useEffect(()=>{const u=[];for(const d of n){const g=Te().userDataManager.getUserData(d.requesterUserId);g&&u.push({roomIndex:g.roomIndex,request:d})}e(u)},[n]),{displayedRequests:a,hideFriendRequest:l}},qv=jv,Yv=()=>{const[i,e]=o.useState(null),{roomSession:n=null}=Le(),r=()=>e(null),s=l=>l&&$().selectRoomObject(Te().roomId,l.id,l.category),a=()=>{const l=H(),u=$().getRoomObjects(n.roomId,Q.WALL),d=$().getRoomObjects(n.roomId,Q.FLOOR),g=u.map(f=>{if(f.id<0)return null;let I=f.type;if(I.startsWith("poster"))I=h(`poster_${I.replace("poster","")}_name`);else{const C=f.model.getValue(te.FURNITURE_TYPE_ID),p=l.getWallItemData(C);p&&p.name.length&&(I=p.name)}return new Fs(f.id,Q.WALL,I)}),m=d.map(f=>{if(f.id<0)return null;let I=f.type;const C=f.model.getValue(te.FURNITURE_TYPE_ID),p=l.getFloorItemData(C);return p&&p.name.length&&(I=p.name),new Fs(f.id,Q.FLOOR,I)});e([...g,...m].sort((f,I)=>f.name<I.name?-1:1))};return PS(!!i,l=>{if(l.id<0)return;const u=$().getRoomObject(Te().roomId,l.id,l.category);if(!u)return;let d=null;switch(l.category){case Q.WALL:{let g=u.type;if(g.startsWith("poster"))g=h(`poster_${g.replace("poster","")}_name`);else{const m=u.model.getValue(te.FURNITURE_TYPE_ID),f=H().getWallItemData(m);f&&f.name.length&&(g=f.name)}d=new Fs(u.id,Q.WALL,g);break}case Q.FLOOR:{let g=u.type;const m=u.model.getValue(te.FURNITURE_TYPE_ID),f=H().getFloorItemData(m);f&&f.name.length&&(g=f.name),d=new Fs(u.id,Q.FLOOR,g)}}e(g=>[...g,d].sort((m,f)=>m.name<f.name?-1:1))}),Tn(!!i,l=>{l.id<0||e(u=>{const d=[...u];for(let g=0;g<d.length;g++){const m=d[g];if(!(m.id!==l.id||m.category!==l.category)){d.splice(g,1);break}}return d})}),{items:i,onClose:r,selectItem:s,populateChooser:a}},zv=Yv,$v=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(-1),[s,a]=o.useState(""),[l,u]=o.useState(""),[d,g]=o.useState(""),m=()=>{g(""),u(""),a(""),r(-1),e(!1)},f=()=>{L(new eE(n,l))},I=p=>{u(p),d.length>0&&g("")},C=p=>{if(!(!p||p===0))switch(p){case 1:return h("catalog.alert.petname.long");case 2:return h("catalog.alert.petname.short");case 3:return h("catalog.alert.petname.chars");case 4:default:return h("catalog.alert.petname.bobba")}};return Pe(zc.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,p=>{if(!p)return;const _=$().getRoomObject(p.session.roomId,p.objectId,Q.FLOOR);r(p.objectId),a(_.type),e(!0)}),Pe(zc.RSOPPE_OPEN_PET_PACKAGE_RESULT,p=>{p&&(p.nameValidationStatus===0&&m(),p.nameValidationStatus!==0&&g(C(p.nameValidationStatus)))}),{isVisible:i,errorResult:d,petName:l,objectType:s,onChangePetName:I,onConfirm:f,onClose:m}},Kv=$v,Xv=()=>{const{roomSession:i=null}=Le(),e=s=>i.sendPollStartMessage(s),n=s=>i.sendPollRejectMessage(s),r=(s,a,l)=>i.sendPollAnswerMessage(s,a,l);return Pe($o.OFFER,s=>{const a=new Gr(Gr.OFFER,s.id);a.summary=s.summary,a.headline=s.headline,Nt(a)}),Pe($o.ERROR,s=>{const a=new Gr(Gr.ERROR,s.id);a.summary=s.summary,a.headline=s.headline,Nt(a)}),Pe($o.CONTENT,s=>{const a=new Gr(Gr.CONTENT,s.id);a.startMessage=s.startMessage,a.endMessage=s.endMessage,a.numQuestions=s.numQuestions,a.questionArray=s.questionArray,a.npsPoll=s.npsPoll,Nt(a)}),{startPoll:e,rejectPoll:n,answerPoll:r}},Qv=Xv,Jv=()=>{const[i,e]=o.useState(null);Le();const n=()=>e(null),r=a=>a&&$().selectRoomObject(Te().roomId,a.id,a.category),s=()=>{const a=Te(),l=$().getRoomObjects(a.roomId,Q.UNIT);e(l.map(u=>{if(u.id<0)return null;const d=a.userDataManager.getUserDataByIndex(u.id);return d?new Fs(d.roomIndex,Q.UNIT,d.name):null}).sort((u,d)=>u.name<d.name?-1:1))};return ch(!!i,a=>{if(a.id<0)return;const l=Te().userDataManager.getUserDataByIndex(a.id);l&&e(u=>{const d=[...u];return d.push(new Fs(l.roomIndex,Q.UNIT,l.name)),d.sort((g,m)=>g.name<m.name?-1:1),d})}),uh(!!i,a=>{a.id<0||e(l=>{const u=[...l];for(let d=0;d<u.length;d++){const g=u[d];if(!(g.id!==a.id||g.category!==a.category)){u.splice(d,1);break}}return u})}),{items:i,onClose:n,selectItem:r,populateChooser:s}},Zv=Jv,Mu=4e3,eT=3,tT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(null),[s,a]=o.useState(!1),[l,u]=o.useState(null),[d,g]=o.useState(new Map),[m,f]=o.useState(new Map),{answerPoll:I=null}=Qv(),{roomSession:C=null}=Le(),p=()=>{e(-1),r(null)},_=E=>{s||!n||(I(i,n.id,[E]),a(!0))};return Pe(Ko.ANSWERED,E=>{const b=C.userDataManager.getUserData(E.userId);b&&(g(E.answerCounts),f(N=>{if(!N.has(b.roomIndex)){const T=new Map(m);return T.set(b.roomIndex,{value:E.value,secondsLeft:eT}),T}return N}),$().updateRoomObjectUserGesture(C.roomId,b.roomIndex,Xs.getGestureId(E.value==="0"?Xs.GESTURE_SAD:Xs.GESTURE_SMILE)))}),Pe(Ko.FINISHED,E=>{n&&n.id===E.questionId&&(g(E.answerCounts),a(!0),u(b=>(b&&clearTimeout(b),setTimeout(()=>p(),Mu)))),f(new Map)}),Pe(Ko.QUESTION,E=>{e(E.id),r(E.question),a(!1),g(new Map),f(new Map),u(b=>{if(b&&clearTimeout(b),E.duration>0){const N=E.duration<1e3?Mu:E.duration;return setTimeout(()=>p(),N)}return null})}),o.useEffect(()=>{const E=()=>{f(N=>{const T=[];if(N.forEach((R,O)=>{R.secondsLeft--,R.secondsLeft<=0&&T.push(O)}),T.length===0)return N;const y=new Map(N);return T.forEach(R=>y.delete(R)),y})},b=setInterval(()=>E(),1e3);return()=>clearInterval(b)},[]),o.useEffect(()=>()=>{u(E=>(E&&clearTimeout(E),null))},[]),{question:n,answerSent:s,answerCounts:d,userAnswers:m,vote:_}},nT=tT,rT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(0),[l,u]=o.useState(0),[d,g]=o.useState(0),[m,f]=Mo("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),I=_=>{a(_),L(new nE(_))},C=_=>{H().giveRespect(_),u(H().respectsLeft)},p=_=>{H().givePetRespect(_),g(H().respectsPetLeft)};return U(rm,_=>{const E=_.getParser();e(E.userInfo),r(E.userInfo.figure),u(E.userInfo.respectsRemaining),g(E.userInfo.respectsPetRemaining)}),U(tE,_=>{const E=_.getParser();r(E.figure)}),U(um,_=>{const E=_.getParser();a(E.chatType)}),o.useEffect(()=>{const _=zi("nitro.screensize");if(_&&(_.width!==window.innerWidth||_.height!==window.innerHeight)){let b=window.localStorage.length;for(;b>0;){const N=window.localStorage.key(b);N&&N.startsWith("nitro.window")&&window.localStorage.removeItem(N),b--}}const E=b=>f({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}},[f]),{userInfo:i,userFigure:n,chatStyleId:s,userRespectRemaining:l,petRespectRemaining:d,respectUser:C,respectPet:p,updateChatStyleId:I}},_r=()=>ot(rT),sT=i=>o.useEffect(i,[]),hh=i=>sT(()=>i()),gh=i=>{const{achievement:e=null,scale:n=1,...r}=i;return e?t(We,{badgeCode:hn.getAchievementBadgeCode(e),isGrayscale:!hn.getAchievementHasStarted(e),scale:n,...r}):null},aT=i=>{const{achievement:e=null}=i,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=ri();return e?t(Ne,{itemActive:n===e,itemUnseen:e.unseen>0,onClick:s=>r(e.achievementId),children:t(gh,{achievement:e})}):null},iT=i=>{const{achievements:e=null}=i;return t(ye,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((n,r)=>t(aT,{achievement:n},r))})},oT=i=>{const{achievement:e=null}=i;return e?c(w,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[c(v,{center:!0,gap:1,children:[t(gh,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),t(S,{fontWeight:"bold",children:h("achievements.details.level",["level","limit"],[hn.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),c(v,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[c(v,{gap:1,children:[t(S,{fontWeight:"bold",truncate:!0,children:Qa(hn.getAchievementBadgeCode(e))}),t(S,{textBreak:!0,children:uc(hn.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&c(v,{gap:1,children:[e.levelRewardPoints>0&&c(w,{alignItems:"center",gap:1,children:[t(S,{truncate:!0,className:"small",children:h("achievements.details.reward")}),c(w,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints,t(st,{type:e.levelRewardPointType})]})]}),e.scoreLimit>0&&t(eh,{text:h("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},lT=i=>{const{category:e=null}=i,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=ri();return o.useEffect(()=>{var s,a;e&&(n||r((a=(s=e==null?void 0:e.achievements)==null?void 0:s[0])==null?void 0:a.achievementId))},[e,n,r]),e?c(v,{fullHeight:!0,justifyContent:"between",children:[t(iT,{achievements:e.achievements}),!!n&&t(oT,{achievement:n})]}):null},cT=i=>{const{category:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=i;if(!e)return null;const s=hn.getAchievementCategoryProgress(e),a=hn.getAchievementCategoryMaxProgress(e),l=hn.getAchievementCategoryImageUrl(e,s),u=hn.getAchievementCategoryTotalUnseen(e);return c(Ne,{itemActive:n===e.code,itemCount:u,itemCountMinimum:0,gap:1,onClick:d=>r(e.code),children:[t(S,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:h(`quests.${e.code}.name`)}),t(Qm,{position:"relative",imageUrl:l,children:c(S,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[s," / ",a]})})]})},uT=i=>{const{categories:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=i;return t(ye,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((s,a)=>t(cT,{category:s,selectedCategoryCode:n,setSelectedCategoryCode:r},a))})},dT=i=>{const[e,n]=o.useState(!1),{achievementCategories:r=[],selectedCategoryCode:s=null,setSelectedCategoryCode:a=null,achievementScore:l=0,getProgress:u=0,getMaxProgress:d=0,selectedCategory:g=null}=ri();return o.useEffect(()=>{const m={linkReceived:f=>{const I=f.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(C=>!C);return}},eventUrlPrefix:"achievements/"};return pt(m),()=>It(m)},[]),e?c(se,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary",children:[t(ae,{headerText:h("inventory.achievements"),onCloseClick:m=>n(!1)}),g&&c(Xm,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[t(P,{onClick:m=>a(null),className:"nitro-achievements-back-arrow"}),c(v,{grow:!0,gap:0,children:[t(S,{fontSize:4,fontWeight:"bold",className:"text-small",children:h(`quests.${g.code}.name`)}),t(S,{children:h("achievements.details.categoryprogress",["progress","limit"],[g.getProgress().toString(),g.getMaxProgress().toString()])})]}),t(Cr,{imageUrl:hn.getAchievementCategoryImageUrl(g,null,!0)})]}),c(re,{gap:1,children:[!g&&c(G,{children:[t(uT,{categories:r,selectedCategoryCode:s,setSelectedCategoryCode:a}),c(v,{grow:!0,justifyContent:"end",gap:1,children:[t(S,{small:!0,center:!0,children:h("achievements.categories.score",["score"],[l.toString()])}),t(eh,{text:h("achievements.categories.totalprogress",["progress","limit"],[u.toString(),d.toString()]),progress:u,maxProgress:d})]})]}),g&&t(lT,{category:g})]})]}):null},fh=i=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:s=null,onCloseClick:a=null,justifyContent:l="center",alignItems:u="center",classNames:d=[],children:g=null,...m}=i,f=o.useMemo(()=>{const C=["drag-handler","container-fluid","nitro-card-header"];return d.length&&C.push(...d),C},[d]);return t(v,{center:!0,position:"relative",classNames:f,...m,children:c(w,{fullWidth:!0,center:!0,children:[t(w,{className:"d-flex w-100 align-items-center justify-content-center nitro-card-header-holder",children:t("span",{className:"nitro-card-header-text",children:e})}),n&&t(P,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:s,children:t(Kl,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 infostand-close bottom-2",onMouseDownCapture:C=>{C.stopPropagation(),C.nativeEvent.stopImmediatePropagation()},onClick:a})]})})},fa=i=>{const{icon:e=null,selected:n=!1,classNames:r=[],children:s=null,...a}=i,l=o.useMemo(()=>{const u=["nitro-avatar-editor-spritesheet"];return e&&e.length&&u.push(e+"-icon"),n&&u.push("selected"),r.length&&u.push(...r),u},[e,n,r]);return t(P,{classNames:l,...a})},mT=i=>{const{partItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(-1),l=X("hc.disabled",!1);return o.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),c(Ne,{itemImage:e.isClear?void 0:e.imageUrl,itemActive:e.isSelected,...r,children:[!l&&e.isHC&&t(st,{className:"position-absolute end-1 bottom-1",type:"hc"}),e.isClear&&t(fa,{icon:"clear"}),e.isSellable&&t(fa,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),n]})},hT=i=>{const{model:e=null,category:n=null,setMaxPaletteCount:r=null}=i,s=o.useRef(null),a=o.useCallback(l=>{const u=n.parts.indexOf(l);if(u===-1)return;e.selectPart(n.name,u);const d=n.getCurrentPart();r(d.maxColorIndex||1)},[e,n,r]);return o.useEffect(()=>{!e||!n||!s||!s.current||(s.current.scrollTop=0)},[e,n]),t(ye,{innerRef:s,columnCount:3,gap:1,className:"h-100 light-grid-bg",columnMinWidth:50,columnMinHeight:45,children:n.parts.length>0&&n.parts.map((l,u)=>t(mT,{partItem:l,onClick:d=>a(l)},u))})},gT=i=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:l=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:g=!1,disabled:m=!1,center:f=!0,column:I=!0,style:C={},classNames:p=[],position:_="relative",overflow:E="hidden",children:b=null,...N}=i,T=o.useMemo(()=>{const R=["layout-grid-item","color-picker-frame"];return r&&R.push("active"),(l||u>0)&&R.push("unique-item"),l&&R.push("sold-out"),d&&R.push("unseen"),g&&R.push("has-highlight"),m&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),p.length&&R.push(...p),R},[r,l,u,d,g,m,e,p]),y=o.useMemo(()=>{let R={...C};return e&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(C).length&&(R={...R,...C}),R},[C,e,n]);return c(v,{center:f,pointer:!0,position:_,overflow:E,column:I,classNames:T,style:y,...N,children:[s>a&&t(Sn,{count:s}),u>0&&c(G,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Kr,{value:u})})]}),b]})},fT=i=>{const{colorItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(-1),l=X("hc.disabled",!1);return o.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),c(gT,{itemHighlight:!0,itemColor:e.color,itemActive:e.isSelected,className:"clear-bg",...r,children:[!l&&e.isHC&&t(st,{className:"position-absolute end-1 bottom-1",type:"hc"}),n]})},xu=i=>{const{model:e=null,category:n=null,paletteSet:r=[],paletteIndex:s=-1}=i,a=o.useRef(null),l=o.useCallback(u=>{const d=r.indexOf(u);d!==-1&&e.selectColor(n.name,d,s)},[e,n,r,s]);return o.useEffect(()=>{!e||!n||!a||!a.current||(a.current.scrollTop=0)},[e,n]),t(ye,{className:"flex-grow-1 light-grid-bg ",innerRef:a,gap:1,columnCount:5,columnMinWidth:23,children:r.length>0&&r.map((u,d)=>t(fT,{colorItem:u,onClick:g=>l(u)},d))})},pT=i=>{const{figureData:e=null}=i,[n,r]=o.useState(-1);return o.useEffect(()=>{if(e)return e.notify=()=>r(s=>s+1),()=>{e.notify=null}},[e]),c(v,{className:"figure-preview-container",overflow:"hidden",position:"relative",size:4,children:[t(it,{figure:e.getFigureString(),direction:e.direction,scale:1}),t(P,{className:"avatar-shadow"})]})},IT=i=>{const{model:e=null,gender:n=null,setGender:r=null,figureData:s=null}=i,[a,l]=o.useState(null),[u,d]=o.useState(1),g=o.useCallback(m=>{const f=e.categories.get(m);if(f){f.init(),l(f);for(const I of f.parts)if(!(!I||!I.isSelected)){d(I.maxColorIndex||1);break}}},[e]);return o.useEffect(()=>{e.init();for(const m of e.categories.keys()){g(m);break}},[e,g]),!e||!a?null:c(ne,{children:[c(v,{size:8,className:"main-avatar-editor",children:[e.canSetGender&&c(w,{className:"avatar-editor-select-header",children:[c(w,{center:!0,pointer:!0,className:"category-item",gap:3,onClick:m=>r(be.MALE),children:[t(fa,{icon:"male",selected:n===be.MALE}),t(S,{className:"text-volter-bold",variant:"white",children:h("avatareditor.generic.boy")})]}),c(w,{center:!0,pointer:!0,className:"category-item",gap:3,onClick:m=>r(be.FEMALE),children:[t(fa,{icon:"female",selected:n===be.FEMALE}),t(S,{variant:"white",className:"text-volter-bold text-white",children:h("avatareditor.generic.girl")})]})]}),t(w,{className:"avatar-editor-select-header",visible:!e.canSetGender,children:e.categories&&e.categories.size>0&&Array.from(e.categories.keys()).map(m=>{const f=e.categories.get(m);return t(w,{center:!0,pointer:!0,className:"category-item",onClick:I=>g(m),children:t(fa,{icon:f.name,selected:a===f})},m)})}),t(hT,{model:e,category:a,setMaxPaletteCount:d})]}),t(pT,{figureData:s}),c(w,{className:"grid g-col-12 flex-row light-grid-bg",overflow:"hidden",children:[u>=1&&t(xu,{model:e,category:a,paletteSet:a.getPalette(0),paletteIndex:0}),u===2&&t(xu,{model:e,category:a,paletteSet:a.getPalette(1),paletteIndex:1})]})]})},ET=i=>{const{figureData:e=null,savedFigures:n=[],setSavedFigures:r=null,loadAvatarInEditor:s=null}=i,a=X("hc.disabled",!1),l=o.useCallback(g=>{if(g>=n.length||g<0)return;const[m,f]=n[g];s(m.getFigureString(),f)},[n,s]),u=o.useCallback(g=>{if(!e||g>=n.length||g<0)return;const m=[...n],f=e.getFigureString(),I=e.gender;m[g]=[St().createFigureContainer(f),I],r(m),L(new rE(g+1,f,I))},[e,n,r]),d=o.useMemo(()=>{if(!n||!n.length)return[];const g=[];return n.forEach(([m,f],I)=>{let C=0;m&&(C=St().getFigureClubLevel(m,f)),g.push(c(Ne,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[m&&t(it,{figure:m.getFigureString(),gender:f,scale:.5,direction:2}),t(P,{className:"avatar-shadow"}),!a&&C>0&&t(st,{className:"position-absolute top-1 start-1",type:"hc"}),c(w,{gap:1,className:"button-container flex-column",children:[t(M,{variant:"primary",grow:!0,fullWidth:!0,onClick:p=>u(I),children:h("avatareditor.wardrobe.save")}),m&&t(M,{variant:"primary",grow:!0,fullWidth:!0,onClick:p=>l(I),disabled:C>Nn(),children:h("generic_usable.button.use")})]})]},I))}),g},[n,a,u,l]);return t(ye,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:d})},CT="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",_T="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",bT=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,l]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,I]=o.useState([]),[C,p]=o.useState([]),[_,E]=o.useState([]),[b,N]=o.useState(!1),[T,y]=o.useState(null),[R,O]=o.useState(null),[F,D]=o.useState(!0),[A,k]=o.useState(!1),x=o.useMemo(()=>X("avatar.wardrobe.max.slots",10),[]);U(sE,ee=>{const Se=ee.getParser();I(Se.figureSetIds),p(Se.boundsFurnitureNames)}),U(aE,ee=>{const Se=ee.getParser(),qe=[];let dt=0;for(;dt<x;)qe.push([null,null]),dt++;for(let[Ke,[Vt,Fe]]of Se.looks.entries()){const qt=St().createFigureContainer(Vt);qe[Ke-1]=[qt,Fe]}E(qe)});const B=o.useCallback(ee=>{u&&m(u.get(ee))},[u]),V=o.useCallback(()=>{const ee=new Map;ee.set(Dr.GENERIC,new Yb),ee.set(Dr.HEAD,new dN),ee.set(Dr.TORSO,new hN),ee.set(Dr.LEGS,new mN),d(ee)},[]),q=o.useCallback(()=>{const ee=new Map,Se=new be,qe=new be;Se.loadAvatarData(CT,be.MALE),qe.loadAvatarData(_T,be.FEMALE),ee.set(be.MALE,Se),ee.set(be.FEMALE,qe),s(ee),l(ee.get(be.MALE))},[]),Y=o.useCallback((ee,Se,qe=!0)=>{Se=bt.getGender(Se);let dt=a;Se!==dt.gender&&(dt=r.get(Se)),ee!==dt.getFigureString()&&dt.loadAvatarData(ee,Se),dt!==a&&l(dt),qe&&(y(a.getFigureString()),O(a.gender))},[r,a]),z=o.useCallback(ee=>{switch(ee){case nr.ACTION_CLEAR:Y(a.getFigureStringWithFace(0,!1),a.gender,!1),V();return;case nr.ACTION_RESET:Y(T,R),V();return;case nr.ACTION_RANDOMIZE:const Se=uN(a,a.gender,Nn(),f,[be.FACE]);Y(Se,a.gender,!1),V();return;case nr.ACTION_SAVE:L(new dm(a.gender,a.getFigureString())),n(!1);return}},[a,T,R,f,Y,V]),de=o.useCallback(ee=>{ee=bt.getGender(ee),l(r.get(ee))},[r]);return o.useEffect(()=>{const ee={linkReceived:Se=>{const qe=Se.split("/");if(!(qe.length<2))switch(qe[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(dt=>!dt);return}},eventUrlPrefix:"avatar-editor/"};return pt(ee),()=>It(ee)},[]),o.useEffect(()=>{E(new Array(x))},[x]),o.useEffect(()=>{b&&(m(null),L(new iE))},[b]),o.useEffect(()=>{g&&N(!1)},[g]),o.useEffect(()=>{u&&B(Dr.GENERIC)},[u,B]),o.useEffect(()=>{if(a)return bt.CURRENT_FIGURE=a,V(),()=>bt.CURRENT_FIGURE=null},[a,V]),o.useEffect(()=>(bt.FIGURE_SET_IDS=f,bt.BOUND_FURNITURE_NAMES=C,V(),()=>{bt.FIGURE_SET_IDS=null,bt.BOUND_FURNITURE_NAMES=null}),[f,C,V]),o.useEffect(()=>{if(e&&!r){q(),k(!0);return}},[e,r,q]),o.useEffect(()=>{!e||!A||!F||(Y(H().figure,H().gender),D(!1))},[e,A,F,Y]),o.useEffect(()=>{if(!e)return()=>{D(!0)}},[e]),!e||!a?null:c(se,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",theme:"avatar-editor",children:[t(fh,{headerText:h("avatareditor.title"),onCloseClick:ee=>n(!1)}),c(Zr,{className:"px-4 nitroAvatarEditorCard",children:[u&&u.size>0&&Array.from(u.keys()).map(ee=>{const Se=g&&g.name===ee;return t(Ir,{isActive:Se,onClick:qe=>B(ee),children:t("div",{className:"nitro-avatar-editor-header-icon "+ee})},ee)}),t(Ir,{isActive:b,onClick:ee=>N(!0),children:h("avatareditor.category.wardrobe")})]}),t(re,{className:"pt-0",children:c(ne,{className:"px-2",children:[c(v,{size:12,overflow:"hidden",className:"avatar-editor-content",children:[g&&!b&&t(IT,{figureData:a,model:g,gender:a.gender,setGender:de}),b&&t(ET,{figureData:a,savedFigures:_,setSavedFigures:E,loadAvatarInEditor:Y})]}),t(v,{size:12,overflow:"hidden",children:c(w,{grow:!0,gap:1,children:[c(w,{grow:!0,children:[t(M,{variant:"primary",onClick:ee=>z(nr.ACTION_RESET),children:t(jh,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:ee=>z(nr.ACTION_CLEAR),children:t(Ql,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:ee=>z(nr.ACTION_RANDOMIZE),children:t(qh,{className:"fa-icon"})})]}),t(M,{onClick:ee=>z(nr.ACTION_SAVE),children:h("avatareditor.save")})]})})]})})]})},NT=5,ST=i=>{const{onClose:e=null,onEdit:n=null,onDelete:r=null}=i,{cameraRoll:s=null,setCameraRoll:a=null,selectedPictureIndex:l=-1,setSelectedPictureIndex:u=null}=rh(),{simpleAlert:d=null}=je(),g=o.useRef(),m=l>-1?s[l]:null,f=()=>{if(!g||!g.current)return null;const C=g.current.getBoundingClientRect();return new Yd(Math.floor(C.x),Math.floor(C.y),Math.floor(C.width),Math.floor(C.height))},I=()=>{if(l>-1){u(-1);return}const C=$().createTextureFromRoom(Te().roomId,1,f()),p=[...s];p.length>=NT&&(d(h("camera.full.body")),p.pop()),fr(pr.CAMERA_SHUTTER),p.push(new gN(C,Kn.generateImageUrl(C))),a(p)};return t(Jr,{uniqueKey:"nitro-camera-capture",children:c(v,{center:!0,className:"nitro-camera-capture",gap:0,children:[m&&t("img",{alt:"",className:"camera-area",src:m.imageUrl}),c("div",{className:"camera-canvas drag-handler",children:[t("div",{className:"position-absolute header-close",onClick:e,children:t(Xn,{className:"fa-icon"})}),!m&&t("div",{ref:g,className:"camera-area camera-view-finder"}),m&&t("div",{className:"camera-area camera-frame",children:c("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[t("button",{className:"btn btn-success me-3",title:h("camera.editor.button.tooltip"),onClick:n,children:h("camera.editor.button.text")}),t("button",{className:"btn btn-danger",onClick:r,children:h("camera.delete.button.text")})]})}),t("div",{className:"d-flex justify-content-center",children:t("div",{className:"camera-button",title:h("camera.take.photo.button.tooltip"),onClick:I})})]}),s.length>0&&t(w,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:s.map((C,p)=>t("img",{alt:"",src:C.imageUrl,onClick:_=>u(p)},p))})]})})},vT=i=>{const{base64Url:e=null,onCloseClick:n=null,onCancelClick:r=null,price:s=null}=i,[a,l]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(0),[f,I]=o.useState(!1),[C,p]=o.useState(!1),[_,E]=o.useState(0),b=o.useMemo(()=>X("camera.publish.disabled",!1),[]);U(oE,T=>{m(y=>y+1),p(!1)}),U(lE,T=>{const y=T.getParser();d(y.extraDataId),E(y.secondsToWait),I(y.ok),p(!1)}),U(cE,T=>{const y=T.getParser();l(X("camera.url")+"/"+y.url)});const N=(T,y=null)=>{switch(T){case"close":n();return;case"buy":if(C)return;p(!0),L(new dE(""));return;case"publish":if(C)return;p(!0),L(new uE);return;case"cancel":r();return}};return o.useEffect(()=>{e&&$().saveBase64AsScreenshot(e)},[e]),s?c(se,{className:"nitro-camera-checkout",theme:"primary",children:[t(ae,{headerText:h("camera.confirm_phase.title"),onCloseClick:T=>N("close")}),c(re,{children:[c(w,{center:!0,children:[a&&a.length&&t(Cr,{className:"picture-preview border",imageUrl:a}),(!a||!a.length)&&t(w,{center:!0,className:"picture-preview border",children:t(S,{bold:!0,children:h("camera.loading")})})]}),c(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[c(v,{size:b?10:6,gap:1,children:[t(S,{bold:!0,children:h("camera.purchase.header")}),(s.credits>0||s.duckets>0)&&c(w,{gap:1,children:[t(S,{children:h("catalog.purchase.confirmation.dialog.cost")}),s.credits>0&&c(w,{gap:1,children:[t(S,{bold:!0,children:s.credits}),t(st,{type:-1})]}),s.duckets>0&&c(w,{gap:1,children:[t(S,{bold:!0,children:s.duckets}),t(st,{type:5})]})]}),g>0&&c(S,{children:[t(S,{bold:!0,children:h("camera.purchase.count.info")})," ",g,t("u",{className:"ms-1 cursor-pointer",onClick:()=>Z("inventory/toggle"),children:h("camera.open.inventory")})]})]}),t(w,{alignItems:"center",children:t(M,{variant:"success",disabled:C,onClick:T=>N("buy"),children:h(g?"camera.buy.another.button.text":"buy")})})]}),!b&&c(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h(f?"camera.publish.successful":"camera.publish.explanation")}),t(S,{children:h(f?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),f&&t("a",{href:u,rel:"noreferrer",target:"_blank",children:h("camera.link.to.published")}),!f&&s.publishDucketPrice>0&&c(w,{gap:1,children:[t(S,{children:h("catalog.purchase.confirmation.dialog.cost")}),c(w,{gap:1,children:[t(S,{bold:!0,children:s.publishDucketPrice}),t(st,{type:5})]})]}),_>0&&t("div",{className:"mt-1 text-center fw-bold",children:h("camera.publish.wait",["minutes"],[Math.ceil(_/60).toString()])})]}),!f&&t(w,{className:"d-flex align-items-end",children:t(M,{variant:"success",disabled:C||_>0,onClick:T=>N("publish"),children:h("camera.publish.button.text")})})]}),t(S,{center:!0,children:h("camera.warning.disclaimer")}),t(w,{justifyContent:"end",children:t(M,{onClick:T=>N("cancel"),children:h("generic.cancel")})})]})]}):null},TT=i=>{const{effect:e=null,thumbnailUrl:n=null,isActive:r=!1,isLocked:s=!1,selectEffect:a=null,removeEffect:l=null}=i;return c(Ne,{title:h(s?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:r,onClick:u=>!r&&a(),children:[r&&t(M,{variant:"danger",className:"rounded-circle remove-effect",onClick:l,children:t(Xn,{className:"fa-icon"})}),!s&&n&&n.length>0&&t("div",{className:"effect-thumbnail-image border",children:t("img",{alt:"",src:n})}),s&&c(S,{center:!0,bold:!0,children:[t("div",{children:t(Ud,{className:"fa-icon"})}),e.minLevel]})]})},wT=i=>{const{myLevel:e=0,selectedEffects:n=[],effects:r=[],thumbnails:s=[],processAction:a=null}=i;return t(ne,{columnCount:3,overflow:"auto",children:r&&r.length>0&&r.map((l,u)=>{const d=s.find(m=>m.effectName===l.name),g=n.findIndex(m=>m.effect.name===l.name)>-1;return t(TT,{effect:l,thumbnailUrl:d&&d.thumbnailUrl||null,isActive:g,isLocked:l.minLevel>e,selectEffect:()=>a("select_effect",l.name),removeEffect:()=>a("remove_effect",l.name)},u)})})},Uu=[Ha.COLORMATRIX,Ha.COMPOSITE],RT=i=>{const{picture:e=null,availableEffects:n=null,myLevel:r=1,onClose:s=null,onCancel:a=null,onCheckout:l=null}=i,[u,d]=o.useState(Uu[0]),[g,m]=o.useState(null),[f,I]=o.useState([]),[C,p]=o.useState([]),[_,E]=o.useState(!1),b=o.useMemo(()=>n.filter(k=>k.colorMatrix),[n]),N=o.useMemo(()=>n.filter(k=>k.texture),[n]),T=o.useCallback(()=>u===Ha.COLORMATRIX?b:N,[u,b,N]),y=o.useCallback(k=>!k||!k.length||!f||!f.length?-1:f.findIndex(x=>x.effect.name===k),[f]),R=o.useMemo(()=>y(g),[g,y]),O=o.useMemo(()=>g&&f[R]||null,[g,R,f]),F=o.useCallback(k=>{const x=R;x!==-1&&I(B=>{const V=[...B],q=V[x];return V[R]=new Xo(q.effect,k),V})},[R,I]),D=o.useMemo(()=>ga().applyEffects(e.texture,f,_).src,[e,f,_]),A=o.useCallback((k,x=null)=>{switch(k){case"close":s();return;case"cancel":a();return;case"checkout":l(D);return;case"change_tab":d(String(x));return;case"select_effect":{if(y(x)>=0)return;const V=n.find(q=>q.name===x);if(!V)return;I(q=>[...q,new Xo(V,1)]),m(V.name);return}case"remove_effect":{let B=y(x);if(B===-1)return;I(V=>{const q=[...V];return q.splice(B,1),q}),g===x&&m(null);return}case"clear_effects":m(null),I([]);return;case"download":{const B=new Image;B.src=D,window.open("").document.write(B.outerHTML);return}case"zoom":E(!_);return}},[_,n,g,D,y,a,l,s,E,I]);return o.useEffect(()=>{const k=[];for(const x of n)k.push(new fN(x.name,ga().applyEffects(e.texture,[new Xo(x,1)],!1).src));p(k)},[e,n]),c(se,{className:"nitro-camera-editor",children:[t(ae,{headerText:h("camera.editor.button.text"),onCloseClick:k=>A("close")}),t(Zr,{children:Uu.map(k=>t(Ir,{isActive:u===k,onClick:x=>A("change_tab",k),children:t("i",{className:"icon icon-camera-"+k})},k))}),t(re,{children:c(ne,{children:[t(v,{size:5,overflow:"hidden",children:t(wT,{myLevel:r,selectedEffects:f,effects:T(),thumbnails:C,processAction:A})}),c(v,{size:7,justifyContent:"between",overflow:"hidden",children:[c(v,{center:!0,children:[t(Cr,{imageUrl:D,className:"picture-preview"}),g&&c(v,{center:!0,fullWidth:!0,gap:1,children:[t(S,{children:h("camera.effect.name."+g)}),t(At,{className:"nitro-slider",min:0,max:1,step:.01,value:O.alpha,onChange:k=>F(k),renderThumb:(k,x)=>t("div",{...k,children:x.valueNow})})]})]}),c(w,{justifyContent:"between",children:[c(Lr,{children:[t(M,{onClick:k=>A("clear_effects"),children:t(Ql,{className:"fa-icon"})}),t(M,{onClick:k=>A("download"),children:t(Yh,{className:"fa-icon"})}),c(M,{onClick:k=>A("zoom"),children:[_&&t(zh,{className:"fa-icon"}),!_&&t($h,{className:"fa-icon"})]})]}),c(w,{gap:1,children:[t(M,{onClick:k=>A("cancel"),children:h("generic.cancel")}),t(M,{onClick:k=>A("checkout"),children:h("camera.preview.button.text")})]})]})]})]})})]})},Ms=0,Ni=1,Fu=2,Vu=3,OT=i=>{const[e,n]=o.useState(Ms),[r,s]=o.useState(null),{availableEffects:a=[],selectedPictureIndex:l=-1,cameraRoll:u=[],setCameraRoll:d=null,myLevel:g=0,price:m={credits:0,duckets:0,publishDucketPrice:0}}=rh(),f=C=>{switch(C){case"close":n(Ms);return;case"edit":n(Fu);return;case"delete":d(p=>{const _=[...p];return _.splice(l,1),_});return;case"editor_cancel":n(Ni);return}},I=C=>{s(C),n(Vu)};return Pe(Dt.ENDED,C=>n(Ms)),o.useEffect(()=>{const C={linkReceived:p=>{const _=p.split("/");if(!(_.length<2))switch(_[1]){case"show":n(Ni);return;case"hide":n(Ms);return;case"toggle":n(E=>E?Ms:Ni);return}},eventUrlPrefix:"camera/"};return pt(C),()=>It(C)},[]),e===Ms?null:c(G,{children:[e===Ni&&t(ST,{onClose:()=>f("close"),onEdit:()=>f("edit"),onDelete:()=>f("delete")}),e===Fu&&t(RT,{picture:u[l],myLevel:g,onClose:()=>f("close"),onCancel:()=>f("editor_cancel"),onCheckout:I,availableEffects:a}),e===Vu&&t(vT,{base64Url:r,onCloseClick:()=>f("close"),onCancelClick:()=>f("editor_cancel"),price:m})]})},yT=i=>{const{itemId:e=-1,state:n=null,product:r=null,active:s=!1,onClick:a=null}=i,l=u=>{let d=H().getFloorItemDataByName(u),g=null;return d?g=$().getFurnitureFloorIconUrl(d.id):(d=H().getWallItemDataByName(u),d&&(g=$().getFurnitureWallIconUrl(d.id))),g};return c(v,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${s?"active":""}`,onClick:()=>a(e),children:[n===Xt.STATE_UNLOCKED&&t(w,{center:!0,className:"campaign-spritesheet unlocked-bg",children:t(w,{center:!0,className:"campaign-spritesheet campaign-opened",children:r&&t(Cr,{imageUrl:r.customImage?X("image.library.url")+r.customImage:l(r.productName)})})}),n!==Xt.STATE_UNLOCKED&&c(w,{center:!0,className:"campaign-spritesheet locked-bg",children:[n===Xt.STATE_LOCKED_AVAILABLE&&t(P,{className:"campaign-spritesheet available"}),(n===Xt.STATE_LOCKED_EXPIRED||n===Xt.STATE_LOCKED_FUTURE)&&t(P,{className:"campaign-spritesheet unavailable"})]})]})},sl=5,kT=i=>{const{onClose:e=null,campaignName:n=null,currentDay:r=null,numDays:s=null,missedDays:a=null,openedDays:l=null,openPackage:u=null,receivedProducts:d=null}=i,[g,m]=o.useState(r),[f,I]=o.useState(Math.max(0,g-1)),C=T=>l.includes(T)?Xt.STATE_UNLOCKED:T>r?Xt.STATE_LOCKED_FUTURE:a.includes(T)?Xt.STATE_LOCKED_EXPIRED:Xt.STATE_LOCKED_AVAILABLE,p=T=>{switch(C(T)){case Xt.STATE_UNLOCKED:return h("campaign.calendar.info.unlocked");case Xt.STATE_LOCKED_FUTURE:return h("campaign.calendar.info.future");case Xt.STATE_LOCKED_EXPIRED:return h("campaign.calendar.info.expired");default:return h("campaign.calendar.info.available.desktop")}},_=()=>{const T=g+1;T!==s&&(m(T),f+sl<T+1&&I(f+1))},E=()=>{const T=g-1;T<0||(m(T),f>T&&I(f-1))},b=T=>{if(g===T){C(T)===Xt.STATE_LOCKED_AVAILABLE&&u(T,!1);return}m(T)},N=()=>{const T=g;C(T)!==Xt.STATE_UNLOCKED&&u(T,!0)};return c(se,{className:"nitro-campaign-calendar",theme:"primary",children:[t(ae,{headerText:h(`campaign.calendar.${n}.title`),onCloseClick:e}),c(re,{children:[c(ne,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[t(v,{size:1}),t(v,{size:10,children:c(w,{justifyContent:"between",alignItems:"center",gap:1,children:[c(v,{gap:1,children:[t(S,{fontSize:3,children:h("campaign.calendar.heading.day",["number"],[(g+1).toString()])}),t(S,{children:p(g)})]}),t("div",{children:H().isModerator&&t(M,{variant:"danger",onClick:N,children:"Force open"})})]})}),t(v,{size:1})]}),c(w,{fullHeight:!0,gap:2,children:[t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet prev",onClick:E})}),t(v,{center:!0,fullWidth:!0,children:t(ne,{fit:!0,columnCount:sl,gap:1,children:[...Array(sl)].map((T,y)=>{const R=f+y;return t(v,{overflow:"hidden",children:t(yT,{itemId:R,state:C(R),active:g===R,product:d.has(R)?d.get(R):null,onClick:b})},y)})})}),t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet next",onClick:_})})]})]})]})},AT=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(-1),[a,l]=o.useState(new Map),[u,d]=o.useState(!1),g=(m,f=!1)=>{e&&(s(m),L(f?new mE(e.campaignName,m):new hE(e.campaignName,m)))};return U(gE,m=>{const f=m.getParser();f&&n(f.calendarData)}),U(fE,m=>{const f=m.getParser();if(!f)return;const I=r;f.doorOpened&&(n(C=>{const p=C.clone();return p.openedDays.push(r),p}),l(C=>{const p=new Map(C);return p.set(I,new pN(f.productName,f.customImage,f.furnitureClassName)),p})),s(-1)}),o.useEffect(()=>{const m={linkReceived:f=>{const I=f.split("/");if(!(I.length<2))switch(I[1]){case"calendar":d(!0);break}},eventUrlPrefix:"openView/"};return pt(m),()=>It(m)},[]),t(G,{children:e&&u&&t(kT,{onClose:()=>d(!1),campaignName:e.campaignName,currentDay:e.currentDay,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openPackage:g,receivedProducts:a})})},DT=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(0),[a,l]=o.useState(0),[u,d]=o.useState(""),[g,m]=o.useState(""),[f,I]=o.useState(!0),[C,p]=o.useState(""),[_,E]=o.useState([]),[b,N]=o.useState(0),[T,y]=o.useState(0),[R,O]=o.useState(0),[F,D]=o.useState(0),[A,k]=o.useState(0),[x,B]=o.useState(!1),{catalogOptions:V=null}=Ae(),{friends:q}=ln(),{giftConfiguration:Y=null}=V,[z,de]=o.useState([]),[ee,Se]=o.useState([]),[qe,dt]=o.useState(!0),Ke=o.useCallback(()=>{n(!1),s(0),l(0),d(""),m(""),I(!0),p(""),N(0),y(0),dt(!1),Se([]),_.length&&O(_[0].id)},[_]),Vt=o.useMemo(()=>Y?Y.defaultStuffTypes.findIndex(ge=>ge===z[b])>-1:!1,[z,Y,b]),Fe=o.useMemo(()=>Y?(z[b]*1e3+Y.ribbonTypes[T]).toString():"",[Y,b,T,z]),qt=o.useMemo(()=>{if(!Y||Vt)return!1;const ge=z[b];return!(ge===8||ge>=3&&ge<=6)},[Y,b,Vt,z]),wn=o.useMemo(()=>Vt?z[b]:R,[Vt,z,b,R]),De=q.filter(ge=>ge.id!==-1),fe=ge=>{const Oe=ge.target.value;let Rn=[];Oe.length>0&&(Rn=De.sort().filter(ns=>ns.name.includes(Oe))),m(Oe),dt(!0),Se(Rn)},Ge=ge=>{m(ge),dt(!1)},wt=o.useCallback(ge=>{switch(ge){case"prev_box":N(Oe=>Oe===0?F:Oe-1);return;case"next_box":N(Oe=>Oe===F?0:Oe+1);return;case"prev_ribbon":y(Oe=>Oe===0?A:Oe-1);return;case"next_ribbon":y(Oe=>Oe===A?0:Oe+1);return;case"buy":if(!g||g.length===0){B(!0);return}L(new pE(r,a,u,g,C,wn,b,T,f));return}},[wn,u,F,A,C,a,r,g,b,T,f]);U(IE,ge=>B(!0)),at([Er.PURCHASE_SUCCESS,ws.INIT_GIFT],ge=>{switch(ge.type){case Er.PURCHASE_SUCCESS:Ke();return;case ws.INIT_GIFT:const Oe=ge;Ke(),s(Oe.pageId),l(Oe.offerId),d(Oe.extraData),n(!0);return}}),o.useEffect(()=>{B(!1)},[g]);const ue=o.useCallback(()=>{Y&&de(ge=>{let Oe=[...Y.boxTypes];return Oe.push(Y.defaultStuffTypes[Math.floor(Math.random()*(Y.defaultStuffTypes.length-1))]),D(Oe.length-1),k(Oe.length-1),Oe})},[Y]);if(o.useEffect(()=>{if(!Y)return;const ge=[];for(const Oe of Y.stuffTypes){const Rn=H().getFloorItemData(Oe);Rn&&Rn.colors&&Rn.colors.length>0&&ge.push({id:Oe,color:an.makeColorNumberHex(Rn.colors[0])})}ue(),ge.length&&(O(ge[0].id),E(ge))},[Y,ue]),o.useEffect(()=>{e&&ue()},[ue,e]),!Y||!Y.isEnabled||!e)return null;const we="catalog.gift_wrapping_new.box."+(Vt?"default":z[b]),et=`catalog.gift_wrapping_new.ribbon.${T}`,un="catalog.gift_wrapping_new."+(Vt?"freeprice":"price");return c(se,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary",children:[t(ae,{headerText:h("catalog.gift_wrapping.title"),onCloseClick:Ke}),c(re,{className:"text-black",children:[c(KN,{column:!0,children:[t(S,{children:h("catalog.gift_wrapping.receiver")}),t("input",{type:"text",className:Ts("form-control form-control-sm",x&&"is-invalid"),value:g,onChange:ge=>fe(ge)}),ee.length>0&&qe&&t(v,{className:"autocomplete-gift-container",children:ee.map(ge=>t(P,{className:"autocomplete-gift-item",onClick:Oe=>Ge(ge.name),children:ge.name},ge.id))}),x&&t(P,{className:"invalid-feedback",children:h("catalog.gift_wrapping.receiver_not_found.title")})]}),t(Jm,{figure:H().figure,userName:H().userName,message:C,editable:!0,onChange:ge=>p(ge)}),c(P,{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:f,onChange:ge=>I(Oe=>!Oe)}),t("label",{className:"form-check-label",children:h("catalog.gift_wrapping.show_face.title")})]}),c(w,{alignItems:"center",gap:2,children:[R&&t(P,{className:"gift-preview",children:t(fc,{productType:he.FLOOR,productClassId:wn,extraData:Fe})}),c(v,{gap:1,children:[c(w,{gap:2,children:[c(Lr,{children:[t(M,{variant:"primary",onClick:()=>wt("prev_box"),children:t(In,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:()=>wt("next_box"),children:t(En,{className:"fa-icon"})})]}),c(v,{gap:1,children:[t(S,{fontWeight:"bold",children:h(we)}),c(w,{alignItems:"center",gap:1,children:[h(un,["price"],[Y.price.toString()]),t(st,{type:-1})]})]})]}),c(w,{alignItems:"center",gap:2,className:qt?"":"opacity-50 pointer-events-none",children:[c(Lr,{children:[t(M,{variant:"primary",onClick:()=>wt("prev_ribbon"),children:t(In,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:()=>wt("next_ribbon"),children:t(En,{className:"fa-icon"})})]}),t(S,{fontWeight:"bold",children:h(et)})]})]})]}),c(v,{gap:1,className:qt?"":"opacity-50 pointer-events-none",children:[t(S,{fontWeight:"bold",children:h("catalog.gift_wrapping.pick_color")}),t(Lr,{fullWidth:!0,children:_.map(ge=>t(M,{variant:"dark",active:ge.id===R,disabled:!qt,style:{backgroundColor:ge.color},onClick:()=>O(ge.id)},ge.id))})]}),c(w,{justifyContent:"between",alignItems:"center",children:[t(M,{variant:"link",onClick:Ke,className:"text-black",children:h("cancel")}),t(M,{variant:"success",onClick:()=>wt("buy"),children:h("catalog.gift_wrapping.give_gift")})]})]})]})},PT=i=>{const[e,n]=o.useState(""),{currentType:r=null,rootNode:s=null,offersToNodes:a=null,searchResult:l=null,setSearchResult:u=null,setCurrentPage:d=null}=Ae();return o.useEffect(()=>{let g=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!g||!g.length){u(null);return}const m=setTimeout(()=>{const f=H().getAllFurnitureData({loadFurnitureData:null});if(!f||!f.length)return;const I=[],C=[];for(const E of f){if(r===Ln.BUILDER&&!E.availableForBuildersClub||r===Ln.NORMAL&&E.excludeDynamic)continue;const b=[E.className,E.name,E.description].join(" ").replace(/ /gi,"").toLowerCase();if(r===Ln.BUILDER&&E.purchaseOfferId===-1&&E.rentOfferId===-1)E.furniLine!==""&&C.indexOf(E.furniLine)<0&&b.indexOf(g)>=0&&C.push(E.furniLine);else if([...au(a,E.purchaseOfferId),...au(a,E.rentOfferId)].length&&(b.indexOf(g)>=0&&I.push(E),I.length===250))break}const p=[];for(const E of I)p.push(new Lb(E));let _=[];Am(g,C,s,_),u(new Fb(g,p,_.filter(E=>E.isVisible))),d(new ji(-1,"default_3x3",new Dm([],[]),p,!1,1))},300);return()=>clearTimeout(m)},[a,r,s,e,d,u]),c(w,{gap:1,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:e,onChange:g=>n(g.target.value)})}),(!e||!e.length)&&t(M,{variant:"primary",className:"catalog-search-button",children:t(Kh,{className:"fa-icon"})}),e&&!!e.length&&t(M,{variant:"primary",className:"catalog-search-button",onClick:g=>n(""),children:t(Xn,{className:"fa-icon"})})]})},LT=i=>{const{icon:e=0}=i,n=o.useMemo(()=>X("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return t(Cr,{imageUrl:n,style:{width:20,height:20}})},ph=i=>{const{node:e=null,child:n=!1}=i;return t(G,{children:e&&e.children.length>0&&e.children.map((r,s)=>r.isVisible?t(Ih,{node:r,child:n},s):null)})},Ih=i=>{const{node:e=null,child:n=!1}=i,{activateNode:r=null}=Ae();return c(P,{className:"nitro-catalog-navigation-section",children:[c(Ne,{gap:1,column:!1,itemActive:e.isActive,onClick:s=>r(e),className:n?"inset":"",children:[t(LT,{icon:e.iconId}),t(S,{grow:!0,truncate:!0,children:e.localization}),e.isBranch&&c(G,{children:[e.isOpen&&t(zl,{className:"fa-icon"}),!e.isOpen&&t($l,{className:"fa-icon"})]})]}),e.isOpen&&e.isBranch&&t(ph,{node:e,child:!0})]})},MT=i=>{const{node:e=null}=i,{searchResult:n=null}=Ae();return c(G,{children:[t(PT,{}),t(v,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:c(ye,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[n&&n.filteredNodes.length>0&&n.filteredNodes.map((r,s)=>t(Ih,{node:r},s)),!n&&t(ph,{node:e})]})})]})},xT=i=>{const{columnCount:e=5,...n}=i,[r,s]=o.useState(!1),[a,l]=o.useState(null),{currentOffer:u=null,setPurchaseOptions:d=null}=Ae(),{badgeCodes:g=[],activate:m=null,deactivate:f=null}=Vo(),I=o.useMemo(()=>{if(!a)return null;const C=new $a;return C.setValue(["0",a,"",""]),C},[a]);return o.useEffect(()=>{u&&d(C=>{const p={...C};return p.extraParamRequired=!0,p.extraData=I&&I.getValue(1)||null,p.previewStuffData=I,p})},[u,I,d]),o.useEffect(()=>{if(!r)return;const C=m();return()=>f(C)},[r,m,f]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),t(ye,{columnCount:e,...n,children:g&&g.length>0&&g.map((C,p)=>t(Ne,{itemActive:a===C,onClick:_=>l(C),children:t(We,{badgeCode:C})},p))})},Go=i=>{const{currentPage:e=null,setCurrentOffer:n=null}=Ae();return o.useEffect(()=>{!e||!e.offers.length||n(e.offers[0])},[e,n]),null},Sc=i=>{const{offer:e=null,selectOffer:n=null,itemActive:r=!1,...s}=i,[a,l]=o.useState(!1),{requestOfferToMover:u=null}=Ae(),{isVisible:d=!1}=ks(),g=o.useMemo(()=>e.pricingModel===xt.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),m=I=>{switch(I.type){case ve.MOUSE_DOWN:n(e),l(!0);return;case ve.MOUSE_UP:l(!1);return;case ve.ROLL_OUT:if(!a||!r||!d)return;u(e);return}},f=e.product;return f?t(Ne,{itemImage:g,itemCount:e.pricingModel===xt.PRICING_MODEL_MULTI?f.productCount:1,itemUniqueSoldout:f.uniqueLimitedItemSeriesSize&&!f.uniqueLimitedItemsLeft,itemUniqueNumber:f.uniqueLimitedItemSeriesSize,itemActive:r,onMouseDown:m,onMouseUp:m,onMouseOut:m,...s,children:e.product.productType===he.ROBOT&&t(it,{figure:e.product.extraParam,headOnly:!0,direction:3})}):null},ai=i=>{const{columnCount:e=5,children:n=null,...r}=i,{currentOffer:s=null,setCurrentOffer:a=null,currentPage:l=null,setPurchaseOptions:u=null}=Ae(),d=o.useRef();if(o.useEffect(()=>{d&&d.current&&(d.current.scrollTop=0)},[l]),!l)return null;const g=m=>{m.activate(),!m.isLazy&&(a(m),m.product&&m.product.productType===he.WALL&&u(f=>{const I={...f};return I.extraData=m.product.extraParam||null,I}))};return c(ye,{innerRef:d,columnCount:e,...r,children:[l.offers&&l.offers.length>0&&l.offers.map((m,f)=>t(Sc,{itemActive:s&&s.offerId===m.offerId,offer:m,selectOffer:g},f)),n]})},Bo=i=>{const{children:e=null,...n}=i,{currentOffer:r=null}=Ae();return!r||r.pricingModel!==xt.PRICING_MODEL_SINGLE||!r.product.isUniqueLimitedItem?null:c(P,{...n,children:[t(YN,{className:"mx-auto",uniqueLimitedItemsLeft:r.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:r.product.uniqueLimitedItemSeriesSize}),e]})},Jn=i=>{const{noGiftOption:e=!1,purchaseCallback:n=null}=i;o.useState(!1);const[r,s]=o.useState($e.NONE);Mo(Va.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:a=null,currentPage:l=null,purchaseOptions:u=null,setPurchaseOptions:d=null}=Ae(),{getCurrencyAmount:g=null}=es(),m=o.useCallback(p=>{switch(p.type){case Er.PURCHASE_SUCCESS:s($e.NONE);return;case Xr.PURCHASE_FAILED:s($e.FAILED);return;case Wa.NOT_ALLOWED:s($e.FAILED);return;case ja.SOLD_OUT:s($e.SOLD_OUT);return}},[]);at(Er.PURCHASE_SUCCESS,m),at(Xr.PURCHASE_FAILED,m),at(Wa.NOT_ALLOWED,m),at(ja.SOLD_OUT,m);const f=o.useMemo(()=>{if(!a||u.extraParamRequired&&(!u.extraData||!u.extraData.length))return!1;if(a.pricingModel===xt.PRICING_MODEL_SINGLE){const p=a.product;if(p&&p.isUniqueLimitedItem)return!p.uniqueLimitedItemsLeft}return!1},[a,u]),I=(p=!1)=>{if(!a)return;if(Nn()<a.clubLevel){Z("habboUI/open/hccenter");return}if(p){Nt(new sS(a.page.pageId,a.offerId,u.extraData));return}if(s($e.PURCHASE),n){n();return}let _=a.page.pageId;L(new Ro(_,a.offerId,u.extraData,u.quantity))};return o.useEffect(()=>{a&&s($e.NONE)},[a,d]),o.useEffect(()=>{let p=null;return(r===$e.CONFIRM||r===$e.FAILED)&&(p=setTimeout(()=>s($e.NONE),3e3)),()=>{p&&clearTimeout(p)}},[r]),a?c(G,{children:[t(()=>{const p=a.priceInCredits*u.quantity,_=a.priceInActivityPoints*u.quantity;if(Nn()<a.clubLevel)return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.hc.required")});if(f)return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.limited_edition_sold_out.title")});if(p>g(-1))return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.notenough.title")});if(_>g(a.activityPointType))return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.notenough.activitypoints.title."+a.activityPointType)});switch(r){case $e.CONFIRM:return t(M,{variant:"warning",onClick:E=>I(),children:h("catalog.marketplace.confirm_title")});case $e.PURCHASE:return t(M,{disabled:!0,children:t(pc,{})});case $e.FAILED:return t(M,{variant:"danger",children:h("generic.failed")});case $e.SOLD_OUT:return t(M,{variant:"danger",children:h("generic.failed")+" - "+h("catalog.alert.limited_edition_sold_out.title")});case $e.NONE:default:return t(M,{disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:E=>s($e.CONFIRM),children:h("catalog.purchase_confirmation."+(a.isRentOffer?"rent":"buy"))})}},{}),!e&&!a.isRentOffer&&t(M,{disabled:u.quantity>1||!a.giftable||f||u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:p=>I(!0),children:h("catalog.purchase_confirmation.gift")})]}):null},Eh=i=>{const{offer:e=null,separator:n=!1}=i,{purchaseOptions:r=null}=Ae(),{quantity:s=1}=r;return e?c(G,{children:[e.priceInCredits>0&&c(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInCredits*s}),t(st,{type:-1})]}),n&&e.priceInCredits>0&&e.priceInActivityPoints>0&&t(wo,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&c(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInActivityPoints*s}),t(st,{type:e.activityPointType})]})]}):null},xr=i=>{const{gap:e=1,...n}=i,{currentOffer:r=null}=Ae();return t(v,{gap:e,...n,children:t(Eh,{offer:r})})},ts=i=>{const{currentOffer:e=null,roomPreviewer:n=null,purchaseOptions:r=null}=Ae(),{previewStuffData:s=null}=r;return o.useEffect(()=>{if(!e||e.pricingModel===xt.PRICING_MODEL_BUNDLE||!n)return;const a=e.product;if(a)switch(n.reset(!1),a.productType){case he.FLOOR:{if(!a.furnitureData)return;if(a.furnitureData.specialType===ce.FIGURE_PURCHASABLE_SET){const u=H().getFloorItemData(a.furnitureData.id).customParams.split(",").map(m=>parseInt(m)),d=[];for(const m of u)St().isValidFigureSetForGender(m,H().gender)&&d.push(m);const g=St().getFigureStringWithFigureIds(H().figure,H().gender,d);n.addAvatarIntoRoom(g,a.productClassId)}else n.addFurnitureIntoRoom(a.productClassId,new Tt(90),s,a.extraParam);return}case he.WALL:{if(!a.furnitureData)return;switch(a.furnitureData.specialType){case ce.FLOOR:n.updateObjectRoom(a.extraParam);return;case ce.WALL_PAPER:n.updateObjectRoom(null,a.extraParam);return;case ce.LANDSCAPE:{n.updateObjectRoom(null,null,a.extraParam);const l=H().getWallItemDataByName("window_double_default");l&&n.addWallItemIntoRoom(l.id,new Tt(90),l.customParams);return}default:n.updateObjectRoom("default","default","default"),n.addWallItemIntoRoom(a.productClassId,new Tt(90),a.extraParam);return}}case he.ROBOT:n.addAvatarIntoRoom(a.extraParam,0);return;case he.EFFECT:n.addAvatarIntoRoom(H().figure,a.productClassId);return}},[e,s,n]),e?e.pricingModel===xt.PRICING_MODEL_BUNDLE?t(v,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(ye,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((a,l)=>t(Ne,{itemImage:a.getIconUrl(e),itemCount:a.productCount},l))})}):t(Cc,{roomPreviewer:n,height:240}):null},UT=i=>{const{page:e=null}=i,{currentOffer:n=null}=Ae();return c(G,{children:[t(Go,{}),c(ne,{children:[c(v,{size:7,overflow:"hidden",children:[t(ai,{shrink:!0}),c(v,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog_selectbadge")}),t(xT,{})]})]}),c(v,{center:!n,size:5,overflow:"hidden",children:[!n&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&c(G,{children:[t(P,{position:"relative",overflow:"hidden",children:t(ts,{})}),c(v,{grow:!0,gap:1,children:[t(Bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(xr,{alignItems:"end"})}),t(Jn,{})]})]})]})]})]})},Qr=i=>{const{...e}=i,{currentOffer:n=null}=Ae();return!n||!n.badgeCode||!n.badgeCode.length?null:t(We,{badgeCode:n.badgeCode,...e})},FT=1,VT=100,Ch=i=>{const{currentOffer:e=null,purchaseOptions:n=null,setPurchaseOptions:r=null}=Ae(),{quantity:s=1}=n,a=l=>{isNaN(l)&&(l=1),l=Math.max(l,FT),l=Math.min(l,VT),l!==s&&r(u=>{const d={...u};return d.quantity=l,d})};return!e||!e.bundlePurchaseAllowed?null:c(G,{children:[t(S,{style:{fontFamily:"Volter",fontSize:"9px"},children:h("catalog.bundlewidget.spinner.select.amount")}),c(w,{alignItems:"center",gap:1,children:[t(Fd,{className:"text-black cursor-pointer fa-icon",onClick:l=>a(s-1)}),t("input",{style:{fontFamily:"Volter",fontSize:"9px"},type:"number",className:"form-control form-control-sm quantity-input",value:s,onChange:l=>a(l.target.valueAsNumber)}),t(Vd,{className:"text-black cursor-pointer fa-icon",onClick:l=>a(s+1)})]})]})},GT=i=>{const{page:e=null}=i,[n,r]=o.useState(new Map),{currentOffer:s=null,setCurrentOffer:a=null}=Ae(),[l,u]=o.useState(!1),d=(C,p)=>!C.product.furnitureData.colorIndex||!p.product.furnitureData.colorIndex||C.product.furnitureData.colorIndex>p.product.furnitureData.colorIndex?1:C==p?0:-1,g=(C,p)=>C.product.furnitureData.className>p.product.furnitureData.className?1:C==p?0:-1,m=C=>{C.activate(),a(C)},f=(C,p)=>{const _=`${p}*${C}`,E=e.offers.findIndex(b=>b.product.furnitureData.fullName===_);E>-1&&m(e.offers[E])},I=o.useMemo(()=>{const C=[],p=new Map,_=new Map;return e.offers.sort(d),e.offers.forEach(E=>{if(!E.product)return;const b=E.product.furnitureData;if(!b||!b.hasIndexedColor)C.push(E);else{const N=b.className,T=b.colorIndex;_.has(N)||_.set(N,[]);let y=16777215;if(b.colors){for(let R of b.colors)R!==16777215&&(y=R);_.get(N).indexOf(y)===-1&&(_.get(N)[T]=y)}p.has(N)||(C.push(E),p.set(N,!0))}}),C.sort(g),r(_),C},[e.offers]);return c(ne,{children:[t(v,{size:7,overflow:"hidden",children:c(ye,{columnCount:5,children:[(!l||!s||!n.has(s.product.furnitureData.className))&&I.map((C,p)=>t(Sc,{itemActive:s&&(s.product.furnitureData.hasIndexedColor?s.product.furnitureData.className===C.product.furnitureData.className:s.offerId===C.offerId),offer:C,selectOffer:m},p)),l&&s&&n.has(s.product.furnitureData.className)&&n.get(s.product.furnitureData.className).map((C,p)=>t(Ne,{itemHighlight:!0,itemActive:s.product.furnitureData.colorIndex===p,itemColor:rn.int2rgb(C),className:"clear-bg",onClick:_=>f(p,s.product.furnitureData.className)},p))]})}),c(v,{center:!s,size:5,overflow:"hidden",children:[!s&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&c(G,{children:[c(P,{position:"relative",overflow:"hidden",children:[t(ts,{}),t(Qr,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),s.product.furnitureData.hasIndexedColor&&t(M,{position:"absolute",className:"bottom-1 start-1",onClick:C=>u(p=>!p),children:t(Gd,{className:"fa-icon"})})]}),c(v,{grow:!0,gap:1,children:[t(Bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:s.localizationName}),c(w,{justifyContent:"between",children:[t(v,{gap:1,children:t(Ch,{})}),t(xr,{justifyContent:"end",alignItems:"end"})]}),t(Jn,{})]})]})]})]})},_h=i=>{const{imageUrl:e=null}=i,[n,r]=o.useState("");return o.useEffect(()=>{r(e??X("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[e]),t(w,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:t("img",{src:n,onError:({currentTarget:s})=>{s.src=X("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},BT=i=>{const{page:e=null}=i,{currentOffer:n=null,currentPage:r=null}=Ae();return t(G,{children:c(ne,{children:[!!e.localization.getImage(1)&&c(v,{size:12,overflow:"hidden",className:"catalogIDxF",children:[t(Cr,{imageUrl:e.localization.getImage(1)}),t(S,{style:{fontFamily:"Volter",fontSize:"9px"},center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),c(v,{size:6,overflow:"hidden",children:[X("catalog.headers")&&t(_h,{imageUrl:r.localization.getImage(0)}),t(ai,{})]}),t(v,{center:!n,size:6,overflow:"hidden",children:n&&c(G,{children:[c(w,{center:!0,overflow:"hidden",style:{height:240},children:[n.product.productType!==he.BADGE&&c(G,{children:[t(ts,{}),t(Qr,{className:"bg-muted rounded bottom-1 end-1"})]}),n.product.productType===he.BADGE&&t(Qr,{className:"scale-2"})]}),c(v,{grow:!0,gap:1,children:[t(Bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,style:{fontFamily:"Volter",fontSize:"9px",fontWeight:"600"},children:n.localizationName}),t(w,{justifyContent:"between",children:t(xr,{justifyContent:"end",alignItems:"end"})}),t(Jn,{})]})]})})]})})},HT=i=>{const{...e}=i,{currentOffer:n=null,purchaseOptions:r=null}=Ae(),{previewStuffData:s=null}=r,a=o.useMemo(()=>{if(!n||!s)return null;const l=s.getValue(2);return!l||!l.length?null:l},[n,s]);return a?t(We,{badgeCode:a,isGroup:!0,...e}):null},bh=i=>{const[e,n]=o.useState(0),{currentOffer:r=null,catalogOptions:s=null,setPurchaseOptions:a=null}=Ae(),{groups:l=null}=s,u=o.useMemo(()=>{if(!l||!l.length)return null;const g=l[e];if(!g)return null;const m=new $a;return m.setValue(["0",g.groupId.toString(),g.badgeCode,g.colorA,g.colorB]),m},[e,l]);if(o.useEffect(()=>{r&&a(g=>{const m={...g};return m.extraParamRequired=!0,m.extraData=u&&u.getValue(1)||null,m.previewStuffData=u,m})},[r,u,a]),o.useEffect(()=>{L(new mm)},[]),!l||!l.length)return c(P,{className:"bg-muted rounded p-1 text-black text-center",children:[h("catalog.guild_selector.members_only"),t(M,{className:"mt-1",children:h("catalog.guild_selector.find_groups")})]});const d=l[e];return c(w,{gap:1,children:[!!d&&c(w,{overflow:"hidden",className:"rounded border",children:[t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorA}}),t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorB}})]}),t("select",{className:"form-select form-select-sm",value:e,onChange:g=>n(parseInt(g.target.value)),children:l.map((g,m)=>t("option",{value:m,children:g.groupName},m))})]})},WT=i=>{const{page:e=null}=i,{currentOffer:n=null}=Ae();return c(ne,{children:[t(v,{size:7,overflow:"hidden",children:t(ai,{})}),c(v,{center:!n,size:5,overflow:"hidden",children:[!n&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&c(G,{children:[c(P,{position:"relative",overflow:"hidden",children:[t(ts,{}),t(HT,{position:"absolute",className:"bottom-1 end-1"})]}),c(v,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(bh,{})}),t(w,{justifyContent:"end",children:t(xr,{alignItems:"end"})}),t(Jn,{})]})]})]})]})},jT=i=>{const{page:e=null}=i;o.useState(0);const{currentOffer:n=null,setCurrentOffer:r=null,catalogOptions:s=null}=Ae();return o.useEffect(()=>{L(new mm)},[e]),c(G,{children:[t(Go,{}),c(ne,{children:[t(v,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:t(P,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),t(v,{size:5,overflow:"hidden",gap:1,children:!!n&&t(G,{children:c(v,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(bh,{})}),t(w,{justifyContent:"end",children:t(xr,{alignItems:"end"})}),t(Jn,{noGiftOption:!0})]})})})]})]})},qT=i=>{const{page:e=null}=i;return c(ne,{children:[c(v,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(P,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),c(v,{center:!0,size:5,overflow:"hidden",children:[t(Cr,{imageUrl:e.localization.getImage(1)}),t(M,{onClick:()=>Z("groups/create"),children:h("catalog.start.guild.purchase.button")})]})]})},YT=i=>{const{page:e=null}=i;return t("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:t("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:t("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},Nh=i=>{const{page:e=null}=i,n=e.localization.getImage(1);return c(v,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[c(w,{alignItems:"center",gap:2,children:[n&&t("img",{alt:"",src:n}),t(P,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),t(v,{grow:!0,alignItems:"center",overflow:"auto",children:t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),t(w,{alignItems:"center",children:t(P,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},zT=i=>t(Nh,{...i}),$T=i=>{const{page:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(""),[l,u]=o.useState(-1),[d,g]=o.useState([]),[m,f]=o.useState(!1),[I,C]=o.useState(1),{categories:p=null}=Qn(),{setIsVisible:_=null}=Ae(),{promoteInformation:E,isExtended:b,setIsExtended:N}=Nc();o.useEffect(()=>{b&&(u(E.data.flatId),r(E.data.eventName),a(E.data.eventDescription),C(E.data.categoryId),f(b),N(!1))},[b,n,s,I]);const T=()=>{u(-1),r(""),a(""),C(1),N(!1),_(!1)},y=()=>{const R=e.pageId,O=e.offers.length>=1?e.offers[0].offerId:-1,F=l,D=n,A=s,k=I;L(new _E(R,O,F,D,m,A,k)),T()};return U(EE,R=>{const O=R.getParser();O&&g(O.rooms)}),o.useEffect(()=>{L(new CE),L(new nm)},[]),c(G,{children:[t(S,{bold:!0,center:!0,children:h("roomad.catalog_header")}),c(v,{size:12,overflow:"hidden",className:"text-black",children:[t(P,{children:h("roomad.catalog_text",["duration"],["120"])}),c(P,{className:"bg-muted rounded p-1",children:[c(v,{gap:2,children:[t(S,{bold:!0,children:h("navigator.category")}),t("select",{className:"form-select form-select-sm",value:I,onChange:R=>C(parseInt(R.target.value)),disabled:m,children:p&&p.map((R,O)=>t("option",{value:R.id,children:h(R.name)},O))})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("roomad.catalog_name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:n,onChange:R=>r(R.target.value),readOnly:m})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("roomad.catalog_description")}),t("textarea",{className:"form-control form-control-sm",maxLength:64,value:s,onChange:R=>a(R.target.value),readOnly:m})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("roomad.catalog_roomname")}),c("select",{className:"form-select form-select-sm",value:l,onChange:R=>u(parseInt(R.target.value)),disabled:m,children:[t("option",{value:-1,disabled:!0,children:h("roomad.catalog_roomname")}),d&&d.map((R,O)=>t("option",{value:R.roomId,children:R.roomName},O))]})]}),t(v,{gap:1,children:t(M,{variant:!n||!s||l===-1?"danger":"success",onClick:y,disabled:!n||!s||l===-1,children:h(m?"roomad.extend.event":"buy")})})]})]})]})},Sh=i=>{const{columnCount:e=5,children:n=null,...r}=i,{currentOffer:s=null}=Ae(),a=o.useRef();return o.useEffect(()=>{a&&a.current&&(a.current.scrollTop=0)},[s]),s?c(ye,{innerRef:a,columnCount:5,...r,children:[s.products&&s.products.length>0&&s.products.map((l,u)=>t(Ne,{itemImage:l.getIconUrl(),itemCount:l.productCount},u)),n]}):null},vh=i=>{const{gap:e=1,...n}=i,{currentOffer:r=null}=Ae();return t(w,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...n,children:t(Eh,{separator:!0,offer:r})})},KT=i=>{const{page:e=null}=i;return c(G,{children:[t(Go,{}),c(ne,{children:[c(v,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(v,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Sh,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),c(v,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),c(v,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Qr,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(vh,{position:"absolute",className:"bottom-0 end-0"})]}),t(v,{gap:1,children:t(Jn,{})})]})]})]})},XT=i=>{const{page:e=null}=i;return c(G,{children:[t(Go,{}),c(ne,{children:[c(v,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(v,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Sh,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),c(v,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),c(v,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Qr,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(vh,{position:"absolute",className:"bottom-0 end-0"})]}),t(v,{gap:1,children:t(Jn,{})})]})]})]})},QT=i=>{const{page:e=null}=i,[n,r]=o.useState(-1),[s,a]=o.useState(""),{currentOffer:l=null,currentPage:u=null}=Ae(),d=g=>{var m;return(m=pe().soundManager.musicController)==null?void 0:m.playSong(g,ha.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return U(bE,g=>{const m=g.getParser();m.officialSongId===s&&r(m.songId)}),o.useEffect(()=>{if(!l)return;const g=l.product;if(g){if(g.extraParam.length>0){const m=parseInt(g.extraParam);m>0?r(m):(a(g.extraParam),L(new NE(g.extraParam)))}else a(""),r(-1);return()=>{var m;return(m=pe().soundManager.musicController)==null?void 0:m.stop(ha.PRIORITY_PURCHASE_PREVIEW)}}},[l]),o.useEffect(()=>()=>{var g;return(g=pe().soundManager.musicController)==null?void 0:g.stop(ha.PRIORITY_PURCHASE_PREVIEW)},[]),t(G,{children:c(ne,{children:[c(v,{size:7,overflow:"hidden",children:[X("catalog.headers")&&t(_h,{imageUrl:u.localization.getImage(0)}),t(ai,{})]}),c(v,{center:!l,size:5,overflow:"hidden",children:[!l&&c(G,{children:[!!e.localization.getImage(1)&&t(Cr,{imageUrl:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),l&&c(G,{children:[c(w,{center:!0,overflow:"hidden",style:{height:140},children:[l.product.productType!==he.BADGE&&c(G,{children:[t(ts,{}),t(Qr,{className:"bg-muted rounded bottom-1 end-1"})]}),l.product.productType===he.BADGE&&t(Qr,{className:"scale-2"})]}),c(v,{grow:!0,gap:1,children:[t(Bo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:l.localizationName}),n>-1&&t(M,{onClick:()=>d(n),children:h("play_preview_button")}),c(w,{justifyContent:"between",children:[t(v,{gap:1,children:t(Ch,{})}),t(xr,{justifyContent:"end",alignItems:"end"})]}),t(Jn,{})]})]})]})]})})},JT=["floors","walls","views"],ZT=i=>{const{columnCount:e=5,children:n=null,...r}=i,[s,a]=o.useState(null),[l,u]=o.useState(-1),[d,g]=o.useState(null),{currentPage:m=null,currentOffer:f=null,setCurrentOffer:I=null,setPurchaseOptions:C=null}=Ae(),p=o.useRef(),_=b=>{b&&g(N=>{const T=[...N];return T[l]=b,T})};if(o.useEffect(()=>{if(!m)return;const b=[[],[],[]];for(const N of m.offers){if(N.pricingModel!==xt.PRICING_MODEL_SINGLE&&N.pricingModel!==xt.PRICING_MODEL_MULTI)continue;const T=N.product;if(!T||T.productType!==he.WALL&&T.productType!==he.FLOOR||!T.furnitureData)continue;switch(T.furnitureData.className){case"floor":b[0].push(N);break;case"wallpaper":b[1].push(N);break;case"landscape":b[2].push(N);break}}a(b),u(0),g([b[0][0],b[1][0],b[2][0]])},[m]),o.useEffect(()=>{l===-1||!d||I(d[l])},[l,d,I]),o.useEffect(()=>{l===-1||!d||!f||C(b=>{const N={...b};return N.extraData=d[l].product.extraParam,N.extraParamRequired=!0,N})},[f,l,d,C]),o.useEffect(()=>{p&&p.current&&(p.current.scrollTop=0)},[l]),!s||l===-1)return null;const E=s[l];return c(G,{children:[t(Lr,{children:JT.map((b,N)=>t(M,{active:l===N,onClick:T=>u(N),children:h(`catalog.spaces.tab.${b}`)},N))}),c(ye,{innerRef:p,columnCount:e,...r,children:[E&&E.length>0&&E.map((b,N)=>t(Sc,{itemActive:f&&f===b,offer:b,selectOffer:T=>_(T)},N)),n]})]})},ew=i=>{const{page:e=null}=i,{currentOffer:n=null,roomPreviewer:r=null}=Ae();return o.useEffect(()=>{r.updatePreviewObjectBoundingRectangle(new zr)},[r]),c(ne,{children:[t(v,{size:7,overflow:"hidden",children:t(ZT,{})}),c(v,{center:!n,size:5,overflow:"hidden",children:[!n&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&c(G,{children:[t(P,{position:"relative",overflow:"hidden",children:t(ts,{})}),c(v,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(xr,{alignItems:"end"})}),t(Jn,{})]})]})]})]})},tw=i=>{const{page:e=null}=i,[n,r]=o.useState(""),{currentOffer:s=null,setPurchaseOptions:a=null}=Ae();return o.useEffect(()=>{s&&a(l=>{const u={...l};return u.extraData=n,u})},[s,n,a]),c(ne,{children:[c(v,{size:7,overflow:"hidden",children:[t(ai,{}),t("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:n||"",onChange:l=>r(l.target.value)})]}),c(v,{center:!s,size:5,overflow:"hidden",children:[!s&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&c(G,{children:[t(ts,{}),c(v,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:s.localizationName}),t(w,{justifyContent:"end",children:t(xr,{alignItems:"end"})}),t(Jn,{})]})]})]})]})},nw=i=>{const[e,n]=o.useState(null),[r,s]=o.useState($e.NONE),{currentPage:a=null,catalogOptions:l=null}=Ae(),{purse:u=null,getCurrencyAmount:d=null}=es(),{clubOffers:g=null}=l,m=o.useCallback(N=>{switch(N.type){case Er.PURCHASE_SUCCESS:s($e.NONE);return;case Xr.PURCHASE_FAILED:s($e.FAILED);return}},[]);at(Er.PURCHASE_SUCCESS,m),at(Xr.PURCHASE_FAILED,m);const f=o.useCallback(N=>{let T="";return N.months>0&&(T=h("catalog.vip.item.header.months",["num_months"],[N.months.toString()])),N.extraDays>0&&(T!==""&&(T+=" "),T+=" "+h("catalog.vip.item.header.days",["num_days"],[N.extraDays.toString()])),T},[]),I=o.useCallback(()=>{if(!u)return"";const N=u.clubDays>0||u.clubPeriods>0?"extension.":"subscription.",T=e.months===0?"days":"months",y=e.months===0?e.extraDays:e.months;return h("catalog.vip.buy.confirm."+N+T).replace("%NUM_"+T.toUpperCase()+"%",y.toString())},[e,u]),C=o.useCallback(()=>{let N=h("catalog.vip.buy.confirm.end_date");return N=N.replace("%month%",e.month.toString()),N=N.replace("%day%",e.day.toString()),N=N.replace("%year%",e.year.toString()),N},[e]),p=o.useMemo(()=>{const N=u.clubDays,y=u.clubPeriods*31+N;return h("catalog.vip.extend.info",["days"],[y.toString()])},[u]),_=o.useCallback(()=>{e&&(s($e.PURCHASE),L(new Ro(a.pageId,e.offerId,null,1)))},[e,a]),E=o.useCallback(N=>{s($e.NONE),n(N)},[]),b=o.useCallback(()=>{if(!e)return null;if(e.priceCredits>d(-1))return t(M,{fullWidth:!0,variant:"danger",children:h("catalog.alert.notenough.title")});if(e.priceActivityPoints>d(e.priceActivityPointsType))return t(M,{fullWidth:!0,variant:"danger",children:h("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(r){case $e.CONFIRM:return t(M,{fullWidth:!0,variant:"warning",onClick:_,children:h("catalog.marketplace.confirm_title")});case $e.PURCHASE:return t(M,{fullWidth:!0,variant:"primary",disabled:!0,children:t(pc,{})});case $e.FAILED:return t(M,{fullWidth:!0,variant:"danger",disabled:!0,children:h("generic.failed")});case $e.NONE:default:return t(M,{fullWidth:!0,variant:"success",onClick:()=>s($e.CONFIRM),children:h("buy")})}},[e,r,_,d]);return o.useEffect(()=>{g||L(new SE(1))},[g]),c(ne,{children:[c(v,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[t(ye,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:g&&g.length>0&&g.map((N,T)=>c(Ne,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===N,className:"p-1",onClick:()=>E(N),children:[t("i",{className:"icon-hc-banner"}),c(v,{justifyContent:"end",gap:0,children:[t(S,{textEnd:!0,children:f(N)}),c(w,{justifyContent:"end",gap:1,children:[N.priceCredits>0&&c(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceCredits}),t(st,{type:-1})]}),N.priceActivityPoints>0&&c(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceActivityPoints}),t(st,{type:N.priceActivityPointsType})]})]})]})]},T))}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:h("catalog.vip.buy.hccenter")}})]}),c(v,{size:5,overflow:"hidden",children:[c(v,{fullHeight:!0,center:!0,overflow:"hidden",children:[a.localization.getImage(1)&&t("img",{alt:"",src:a.localization.getImage(1)}),t(S,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:p}})]}),e&&c(v,{fullWidth:!0,grow:!0,justifyContent:"end",children:[c(w,{alignItems:"end",children:[c(v,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:I()}),t(S,{children:C()})]}),c(v,{gap:1,children:[e.priceCredits>0&&c(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceCredits}),t(st,{type:-1})]}),e.priceActivityPoints>0&&c(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceActivityPoints}),t(st,{type:e.priceActivityPointsType})]})]})]}),b()]})]})]})},rw=i=>{const{text:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(!1),{simpleAlert:l=null}=je(),u=()=>{!n||!n.length||s||(L(new wE(n)),a(!0))};return U(vE,d=>{const g=d.getParser();let m=h("catalog.alert.voucherredeem.ok.description");g.productName&&(m=h("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[g.productName,g.productDescription])),l(m,null,null,null,h("catalog.alert.voucherredeem.ok.title")),a(!1),r("")}),U(TE,d=>{const g=d.getParser();l(h(`catalog.alert.voucherredeem.error.description.${g.errorCode}`),null,null,null,h("catalog.alert.voucherredeem.error.title")),a(!1)}),c(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:e,value:n,onChange:d=>r(d.target.value)}),t(M,{variant:"primary",onClick:u,disabled:s,children:t(Xh,{className:"fa-icon"})})]})},Si=i=>{const{item:e=null,position:n="relative",pointer:r=!0,overflow:s="hidden",fullHeight:a=!0,classNames:l=[],children:u=null,...d}=i,g=o.useMemo(()=>{const f=["rounded","nitro-front-page-item"];return l.length&&f.push(...l),f},[l]);if(!e)return null;const m=X("image.library.url")+e.itemPromoImage;return c(Qm,{imageUrl:m,classNames:g,position:n,fullHeight:a,pointer:r,overflow:s,...d,children:[t(S,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:e.itemName}),u]})},sw=i=>{const{page:e=null,hideNavigation:n=null}=i,{frontPageItems:r=[]}=Ae(),s=o.useCallback(a=>{switch(a.type){case $c.ITEM_CATALOGUE_PAGE:Z(`catalog/open/${a.catalogPageLocation}`);return;case $c.ITEM_PRODUCT_OFFER:Z(`catalog/open/${a.productOfferId}`);return}},[]);return o.useEffect(()=>{n()},[e,n]),c(ne,{children:[t(v,{size:4,children:r[0]&&t(Si,{item:r[0],onClick:a=>s(r[0])})}),c(v,{size:8,children:[r[1]&&t(Si,{item:r[1],onClick:a=>s(r[1])}),r[2]&&t(Si,{item:r[2],onClick:a=>s(r[2])}),r[3]&&t(Si,{item:r[3],onClick:a=>s(r[3])}),t(rw,{text:e.localization.getText(1)})]})]})},Yl=1,Ui=2,Th=i=>{const{offerData:e=null,type:n=Ui,onClick:r=null}=i,s=o.useMemo(()=>e?h((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),a=o.useCallback(()=>{if(!e)return"";if(e.status===Fa.SOLD)return h("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return h("catalog.marketplace.offer.expired");const l=Math.max(1,e.timeLeftMinutes),u=Math.floor(l/60);let g=l-u*60+" "+h("catalog.marketplace.offer.minutes");return u>0&&(g=u+" "+h("catalog.marketplace.offer.hours")+" "+g),h("catalog.marketplace.offer.time_left",["time"],[g])},[e]);return c(Ne,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(v,{style:{width:40,height:40},children:t(Ne,{column:!1,itemImage:Mb(e.furniType===Ua.TYPE_FLOOR?he.FLOOR:he.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),c(v,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:s}),n===Yl&&c(G,{children:[t(S,{children:h("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),t(S,{children:a()})]}),n===Ui&&c(G,{children:[t(S,{children:h("catalog.marketplace.offer.price_public_item",["price","average"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-"])}),t(S,{children:h("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),c(v,{gap:1,children:[n===Yl&&e.status!==Fa.SOLD&&t(M,{variant:"secondary",onClick:()=>r(e),children:h("catalog.marketplace.offer.pick")}),n===Ui&&c(G,{children:[t(M,{variant:"secondary",onClick:()=>r(e),children:h("buy")}),t(M,{variant:"secondary",disabled:!0,children:h("catalog.marketplace.view_more")})]})]})]})},aw=i=>{const[e,n]=o.useState(0),[r,s]=o.useState([]),{simpleAlert:a=null}=je();U(RE,g=>{const m=g.getParser();if(!m)return;const f=m.offers.map(I=>{const C=new Ua(I.offerId,I.furniId,I.furniType,I.extraData,I.stuffData,I.price,I.status,I.averagePrice,I.offerCount);return C.timeLeftMinutes=I.timeLeftMinutes,C});n(m.creditsWaiting),s(f)}),U(OE,g=>{const m=g.getParser();if(m){if(!m.success){a(h("catalog.marketplace.cancel_failed"),me.DEFAULT,null,null,h("catalog.marketplace.operation_failed.topic"));return}s(f=>f.filter(I=>I.offerId!==m.offerId))}});const l=o.useMemo(()=>r.filter(g=>g.status===Fa.SOLD),[r]),u=o.useCallback(()=>{s(g=>{const m=l.map(f=>f.offerId);return g.filter(f=>m.indexOf(f.offerId)===-1)}),L(new yE)},[l]),d=g=>{L(new AE(g.offerId))};return o.useEffect(()=>{L(new kE)},[]),c(v,{overflow:"hidden",children:[e<=0&&t(S,{center:!0,className:"bg-muted rounded p-1",children:h("catalog.marketplace.redeem.no_sold_items")}),e>0&&c(v,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[t(S,{children:h("catalog.marketplace.redeem.get_credits",["count","credits"],[l.length.toString(),e.toString()])}),t(M,{className:"mt-1",onClick:u,children:h("catalog.marketplace.offer.redeem")})]}),c(v,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog.marketplace.items_found",["count"],[r.length.toString()])}),t(v,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:r.length>0&&r.map(g=>t(Th,{offerData:g,type:Yl,onClick:d},g.offerId))})]})]})},iw=i=>{const{searchType:e=null,sortTypes:n=null,onSearch:r=null}=i,[s,a]=o.useState(n?n[0]:3),[l,u]=o.useState(""),[d,g]=o.useState(0),[m,f]=o.useState(0),I=o.useCallback(p=>{a(p),(e===Ht.BY_ACTIVITY||e===Ht.BY_VALUE)&&r({minPrice:-1,maxPrice:-1,query:"",type:p})},[r,e]),C=o.useCallback(()=>{const p=d>0?d:-1,_=m>0?m:-1;r({minPrice:p,maxPrice:_,type:s,query:l})},[m,d,r,l,s]);return o.useEffect(()=>{if(!n||!n.length)return;const p=n[0];a(p),(e===Ht.BY_ACTIVITY||Ht.BY_VALUE===e)&&r({minPrice:-1,maxPrice:-1,query:"",type:p})},[r,e,n]),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("catalog.marketplace.sort_order")}),t("select",{className:"form-select form-select-sm",value:s,onChange:p=>I(parseInt(p.target.value)),children:n.map(p=>t("option",{value:p,children:h(`catalog.marketplace.sort.${p}`)},p))})]}),e===Ht.ADVANCED&&c(G,{children:[c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("catalog.marketplace.search_name")}),t("input",{className:"form-control form-control-sm",type:"text",value:l,onChange:p=>u(p.target.value)})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("catalog.marketplace.search_price")}),c(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:d,onChange:p=>g(p.target.valueAsNumber)}),t("input",{className:"form-control form-control-sm",type:"number",min:0,value:m,onChange:p=>f(p.target.valueAsNumber)})]})]}),t(M,{variant:"secondary",className:"mx-auto",onClick:C,children:h("generic.search")})]})]})},ow=[1,2],lw=[3,4,5,6],cw=[1,2,3,4,5,6],uw=i=>{const[e,n]=o.useState(Ht.BY_ACTIVITY),[r,s]=o.useState(0),[a,l]=o.useState(new Map),[u,d]=o.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:g=null}=es(),{simpleAlert:m=null,showConfirm:f=null}=je(),I=o.useCallback(_=>{d(_),L(new DE(_.minPrice,_.maxPrice,_.query,_.type))},[]),C=o.useMemo(()=>{switch(e){case Ht.BY_ACTIVITY:return lw;case Ht.BY_VALUE:return ow;case Ht.ADVANCED:return cw}return[]},[e]),p=o.useCallback(_=>{if(_.price>g(-1)){m(h("catalog.alert.notenough.credits.description"),me.DEFAULT,null,null,h("catalog.alert.notenough.title"));return}const E=_.offerId;f(h("catalog.marketplace.confirm_header"),()=>{L(new Kc(E))},null,null,null,h("catalog.marketplace.confirm_title"))},[g,m,f]);return U(PE,_=>{const E=_.getParser();if(!E)return;const b=new Map;E.offers.forEach(N=>{const T=new Ua(N.offerId,N.furniId,N.furniType,N.extraData,N.stuffData,N.price,N.status,N.averagePrice,N.offerCount);T.timeLeftMinutes=N.timeLeftMinutes,b.set(N.offerId,T)}),s(E.totalItemsFound),l(b)}),U(LE,_=>{const E=_.getParser();if(E)switch(E.result){case 1:I(u);break;case 2:l(b=>{const N=new Map(b);return N.delete(E.requestedOfferId),N}),m(h("catalog.marketplace.not_available_header"),me.DEFAULT,null,null,h("catalog.marketplace.not_available_title"));break;case 3:l(b=>{const N=new Map(b),T=N.get(E.requestedOfferId);return T&&(T.offerId=E.offerId,T.price=E.newPrice,T.offerCount--,N.set(T.offerId,T)),N.delete(E.requestedOfferId),N}),f(h("catalog.marketplace.confirm_higher_header")+`
`+h("catalog.marketplace.confirm_price",["price"],[E.newPrice.toString()]),()=>{L(new Kc(E.offerId))},null,null,null,h("catalog.marketplace.confirm_higher_title"));break;case 4:m(h("catalog.alert.notenough.credits.description"),me.DEFAULT,null,null,h("catalog.alert.notenough.title"));break}}),c(G,{children:[c(Lr,{children:[t(M,{active:e===Ht.BY_ACTIVITY,onClick:()=>n(Ht.BY_ACTIVITY),children:h("catalog.marketplace.search_by_activity")}),t(M,{active:e===Ht.BY_VALUE,onClick:()=>n(Ht.BY_VALUE),children:h("catalog.marketplace.search_by_value")}),t(M,{active:e===Ht.ADVANCED,onClick:()=>n(Ht.ADVANCED),children:h("catalog.marketplace.search_advanced")})]}),t(iw,{sortTypes:C,searchType:e,onSearch:I}),c(v,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog.marketplace.items_found",["count"],[a.size.toString()])}),t(v,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(a.values()).map((_,E)=>t(Th,{offerData:_,type:Ui,onClick:p},E))})]})]})},dw=i=>{const{page:e=null}=i,[n,r]=o.useState(-1),[s,a]=o.useState([]),[l,u]=o.useState(-1),[d,g]=o.useState([]),[m,f]=o.useState(-1),[I,C]=o.useState(!1),[p,_]=o.useState("");o.useState(!0);const[E,b]=o.useState(-1),{currentOffer:N=null,setCurrentOffer:T=null,setPurchaseOptions:y=null,catalogOptions:R=null,roomPreviewer:O=null}=Ae(),{petPalettes:F=null}=R,D=o.useMemo(()=>!d.length||m===-1?16777215:d[m][0],[d,m]),A=o.useMemo(()=>n===-1||!s.length||l===-1?"":h(`pet.breed.${n}.${s[l].breedId}`),[n,s,l]),k=o.useMemo(()=>{if(!s.length||l===-1)return"";const V=s[l].paletteId;let q=16777215;if(n<=7){if(m===-1)return"";q=d[m][0]}let Y=q.toString(16).toUpperCase();for(;Y.length<6;)Y="0"+Y;return`${V}
${Y}`},[s,l,n,d,m]),x=o.useMemo(()=>{let V="";switch(E){case 1:V="catalog.alert.petname.long";break;case 2:V="catalog.alert.petname.short";break;case 3:V="catalog.alert.petname.chars";break;case 4:V="catalog.alert.petname.bobba";break}return!V||!V.length?"":h(V)},[E]),B=o.useCallback(()=>{if(E===-1){L(new ME(p,1));return}if(E===0){L(new Ro(e.pageId,N.offerId,`${p}
${k}`,1));return}},[e,N,p,k,E]);return U(xE,V=>{const q=V.getParser();b(q.result),q.result===0?B():Nt(new Xr(-1))}),o.useEffect(()=>{if(!e||!e.offers.length)return;const V=e.offers[0];T(V),r(Db(V.localizationId)),C(!1)},[e,T]),o.useEffect(()=>{if(!N)return;const V=N.product.productData;if(V){if(F)for(const q of F){if(q.breed!==V.type)continue;const Y=[];for(const z of q.palettes)z.sellable&&Y.push(z);u(Y.length?0:-1),a(Y);return}u(-1),a([]),L(new UE(V.type))}},[N,F]),o.useEffect(()=>{if(n===-1)return;const V=Pb(n,s);f(V.length?0:-1),g(V)},[n,s]),o.useEffect(()=>{if(!O||(O.reset(!1),n===-1||!s.length||l===-1))return;let V=`${n} ${s[l].paletteId}`;n<=7&&(V+=` ${D.toString(16)}`),O.addPetIntoRoom(V)},[O,n,s,l,D]),o.useEffect(()=>{b(-1)},[p]),N?c(ne,{children:[t(v,{size:7,overflow:"hidden",children:c(ye,{columnCount:5,children:[!I&&s.length>0&&s.map((V,q)=>t(Ne,{itemActive:l===q,onClick:Y=>u(q),children:t(mr,{typeId:n,paletteId:V.paletteId,direction:2,headOnly:!0})},q)),I&&d.length>0&&d.map((V,q)=>t(Ne,{itemHighlight:!0,itemActive:m===q,itemColor:rn.int2rgb(V[0]),className:"clear-bg",onClick:Y=>f(q)},q))]})}),c(v,{center:!N,size:5,overflow:"hidden",children:[!N&&c(G,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),N&&c(G,{children:[c(P,{position:"relative",overflow:"hidden",children:[t(ts,{}),t(Qr,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),n>-1&&n<=7&&t(M,{position:"absolute",className:"bottom-1 start-1",onClick:V=>C(!I),children:t(Gd,{className:"fa-icon"})})]}),c(v,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:A}),c(v,{grow:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:h("widgets.petpackage.name.title"),value:p,onChange:V=>_(V.target.value)}),E>0&&t(P,{className:"invalid-feedback d-block m-0",children:x})]}),t(w,{justifyContent:"end",children:t(xr,{justifyContent:"end",alignItems:"end"})}),t(Jn,{purchaseCallback:B})]})]})]})]}):null},mw=i=>{const{offer:e=null,isAvailable:n=!1,daysRequired:r=0,onSelect:s=null}=i,a=o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0];return xi.getProductImageUrl(u.productType,u.furniClassId,u.extraParam)},[e]),l=o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=xi.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.name."+u.furniClassId:"roomItem.name."+u.furniClassId;return h(d)},[e]);return o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=xi.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.desc."+u.furniClassId:"roomItem.desc."+u.furniClassId;return h(d)},[e]),o.useCallback(()=>Math.floor(r/31),[r]),c(Ne,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(Cr,{imageUrl:a()}),t(S,{grow:!0,fontWeight:"bold",children:l()}),t(M,{variant:"secondary",onClick:()=>s(e.localizationId),disabled:!n,children:h("catalog.club_gift.select")})]})},hw=i=>{const{purse:e=null}=es(),{catalogOptions:n=null,setCatalogOptions:r=null}=Ae(),{clubGifts:s=null}=n,{showConfirm:a=null}=je(),l=o.useCallback(()=>s?s.giftsAvailable>0?h("catalog.club_gift.available",["amount"],[s.giftsAvailable.toString()]):s.daysUntilNextGift>0?h("catalog.club_gift.days_until_next",["days"],[s.daysUntilNextGift.toString()]):e.isVip?h("catalog.club_gift.not_available"):h("catalog.club_gift.no_club"):"",[s,e]),u=o.useCallback(g=>{a(h("catalog.club_gift.confirm"),()=>{L(new FE(g)),r(m=>(m.clubGifts.giftsAvailable--,{...m}))},null)},[r,a]),d=o.useMemo(()=>s.offers.sort((m,f)=>s.getOfferExtraData(m.offerId).daysRequired-s.getOfferExtraData(f.offerId).daysRequired),[s]);return c(G,{children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:l()}),t(ye,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:s.offers.length>0&&d.map(g=>t(mw,{offer:g,isAvailable:s.getOfferExtraData(g.offerId).isSelectable&&s.giftsAvailable>0,onSelect:u,daysRequired:s.getOfferExtraData(g.offerId).daysRequired},g.offerId))})]})},gw=(i,e)=>{if(!i)return null;const n={page:i,hideNavigation:e};switch(i.layoutCode){case"frontpage_featured":return null;case"frontpage4":return t(sw,{...n});case"pets":return t(dw,{...n});case"pets2":return t(zT,{...n});case"pets3":return t(Nh,{...n});case"vip_buy":return t(nw,{...n});case"guild_frontpage":return t(qT,{...n});case"guild_forum":return t(jT,{...n});case"guild_custom_furni":return t(WT,{...n});case"club_gifts":return t(hw,{...n});case"marketplace_own_items":return t(aw,{...n});case"marketplace":return t(uw,{...n});case"single_bundle":return t(XT,{...n});case"room_bundle":return t(KT,{...n});case"spaces_new":return t(ew,{...n});case"trophies":return t(tw,{...n});case"info_loyalty":return t(YT,{...n});case"badge_display":return t(UT,{...n});case"roomads":return t($T,{...n});case"default_3x3_color_grouping":return t(GT,{...n});case"soundmachine":return t(QT,{...n});case"bots":case"default_3x3":default:return t(BT,{...n})}},fw=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(0),[a,l]=o.useState("0"),{catalogOptions:u=null,setCatalogOptions:d=null}=Ae(),{marketplaceConfiguration:g=null}=u,{showConfirm:m=null}=je(),f=E=>{l(E);const b=parseInt(E);isNaN(b)||b===r||s(parseInt(E))};if(U(VE,E=>{const b=E.getParser();d(N=>{const T={...N};return T.marketplaceConfiguration=b,T})}),at(no.POST_MARKETPLACE,E=>n(E.item)),o.useEffect(()=>{!e||g||L(new GE)},[e,g]),o.useEffect(()=>{if(e)return()=>s(0)},[e]),!g||!e)return null;const I=e?h(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",C=e?h(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",p=()=>Math.max(Math.ceil(g.commission*.01*r),1),_=()=>{!e||r<g.minimumPrice||m(h("inventory.marketplace.confirm_offer.info",["furniname","price"],[I,r.toString()]),()=>{L(new BE(r,e.isWallItem?2:1,e.id)),n(null)},()=>{n(null)},null,null,h("inventory.marketplace.confirm_offer.title"))};return c(se,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary",children:[t(ae,{headerText:h("inventory.marketplace.make_offer.title"),onCloseClick:E=>n(null)}),t(re,{overflow:"hidden",children:c(ne,{fullHeight:!0,children:[t(v,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:t(fc,{productType:e.isWallItem?he.WALL:he.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),c(v,{size:8,justifyContent:"between",overflow:"hidden",children:[c(v,{grow:!0,gap:1,children:[t(S,{fontWeight:"bold",children:I}),t(S,{truncate:!0,shrink:!0,children:C})]}),c(v,{overflow:"auto",children:[t(S,{italics:!0,children:h("inventory.marketplace.make_offer.expiration_info",["time"],[g.offerTime.toString()])}),c("div",{className:"input-group has-validation",children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:a,onChange:E=>f(E.target.value),placeholder:h("inventory.marketplace.make_offer.price_request")}),(r<g.minimumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.min_price",["minprice"],[g.minimumPrice.toString()])}),r>g.maximumPrice&&!isNaN(r)&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.max_price",["maxprice"],[g.maximumPrice.toString()])}),!(r<g.minimumPrice||r>g.maximumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[p().toString(),(r+p()).toString()])})]}),t(M,{disabled:r<g.minimumPrice||r>g.maximumPrice||isNaN(r),onClick:_,children:h("inventory.marketplace.make_offer.post")})]})]})]})})]})},pw=i=>{const{isVisible:e=!1,setIsVisible:n=null,rootNode:r=null,currentPage:s=null,navigationHidden:a=!1,setNavigationHidden:l=null,activeNodes:u=[],searchResult:d=null,setSearchResult:g=null,openPageByName:m=null,openPageByOfferId:f=null,activateNode:I=null,getNodeById:C}=Ae();return o.useEffect(()=>{const p={linkReceived:_=>{const E=_.split("/");if(!(E.length<2))switch(E[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return;case"open":if(E.length>2)if(E.length===4)switch(E[2]){case"offerId":f(parseInt(E[3]));return}else m(E[2]);else n(!0);return}},eventUrlPrefix:"catalog/"};return pt(p),()=>It(p)},[n,f,m]),c(G,{children:[e&&c(se,{uniqueKey:"catalog",className:"nitro-catalog",style:X("catalog.headers")?{width:710}:{},children:[t(ae,{className:"catalogHeaderView",headerText:h("catalog.title"),onCloseClick:p=>n(!1)}),t(re,{children:c(ne,{children:[!a&&t(v,{size:3,overflow:"hidden",children:u&&u.length>0&&t(MT,{node:u[0]})}),t(v,{size:a?12:9,overflow:"hidden",children:gw(s,()=>l(!0))})]})})]}),t(DT,{}),t(fw,{})]})},Iw=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(""),{chatHistory:a=[]}=xo(),l=o.useRef(null),u=o.useMemo(()=>{if(r.length===0)return a;let d=r.toLowerCase();return a.filter(g=>g.message&&g.message.toLowerCase().includes(d)||g.name&&g.name.toLowerCase().includes(d))},[a,r]);return o.useEffect(()=>{l&&l.current&&e&&(l.current.scrollTop=l.current.scrollHeight)},[e]),o.useEffect(()=>{const d={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return}},eventUrlPrefix:"chat-history/"};return pt(d),()=>It(d)},[]),e?t(P,{className:"nitro-chat-history",children:t(v,{gap:2,fullHeight:!0,className:"chat-history-content",children:t(P,{overflow:"auto",position:"relative",fullWidth:!0,fullHeight:!0,children:t(Lo,{rows:u,scrollToBottom:!0,rowRender:d=>c(w,{alignItems:"center",className:"p-1",gap:2,children:[t(S,{variant:"muted",children:d.timestamp}),d.type===$n.TYPE_CHAT&&c("div",{className:"bubble-container",style:{position:"relative"},children:[d.style===0&&t("div",{className:"user-container-bg",style:{backgroundColor:d.color}}),c("div",{className:`chat-bubble bubble-${d.style} type-${d.chatType}`,style:{maxWidth:"100%"},children:[t("div",{className:"user-container",children:d.imageUrl&&d.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${d.imageUrl})`}})}),c("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${d.name}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${d.message}`}})]})]})]}),d.type===$n.TYPE_ROOM_INFO&&c(G,{children:[t("i",{className:"icon icon-small-room"}),t(S,{variant:"white",textBreak:!0,wrap:!0,grow:!0,children:d.name})]})]})})})})}):null},Mn=32,cs=64,pa="x0123456789abcdefghijklmnopq",ps=class ps{};ps.DOOR=0,ps.UP=1,ps.DOWN=2,ps.SET=3,ps.UNSET=4;let kt=ps;const Ew={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class Cw{constructor(){this._currentAction=kt.SET,this._currentHeight=pa[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=kt.SET,this._currentHeight=pa[1]}}class vi{constructor(e,n){this._height=e,this._isBlocked=n}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const _w=(i,e)=>{let n=i*Mn/2-e*Mn/2;const r=i*Mn/4+e*Mn/4;return n=n+1024,[n,r]},bw=(i,e)=>{const n=i-1024,r=(n/(Mn/2)+e/(Mn/4))/2,s=(e/(Mn/4)-n/(Mn/2))/2;return[r,s]},ro=i=>{switch(i=parseInt(i.toString()),i){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},Ti=i=>{switch(i){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Wn=class Wn extends HE{constructor(){const e=Mn*cs+20,n=Mn*cs/2+100;super({width:e,height:n,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._tilemap=[],this._doorLocation=new zr(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new zr(-1,-1),this._actionSettings=new Cw}initialize(){if(this._isInitialized)return;const e=hm().getCollection("floor_editor");e&&(this._assetCollection=e,this._tilemapRenderer=new WE(e.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){const e=new zr;this._tilemapRenderer.containsPoint=n=>(this._tilemapRenderer.worldTransform.applyInverse(n,e),this.tileHitDetection(e,!1)),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",n=>{if(!(n.data.originalEvent instanceof PointerEvent)&&!(n.data.originalEvent instanceof TouchEvent))return;const r=n.data.originalEvent;if(r instanceof MouseEvent&&r.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0)}),this._tilemapRenderer.on("click",n=>{if(!(n.data.originalEvent instanceof PointerEvent)||n.data.originalEvent.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0,!0)})}tileHitDetection(e,n,r=!1){const s=this._tilemapRenderer.pointsBuf,a=Qh,l=s.length;n&&(this._isHolding=!0);for(let u=0;u<l;u+=a){const d=u+a,g=s.slice(u,d),m=Mn,f=Mn/2,I=Math.floor(e.x),C=Math.floor(e.y),p=g[2],_=g[3],E=p+m/2,b=_+f/2,N=Math.abs(I-E),T=Math.abs(C-b);if(N/(m*.5)+T/(f*.5)<=1){if(this._isHolding){const[R,O]=bw(p,_);r?this.onClick(R,O):(this._lastUsedTile.x!==R||this._lastUsedTile.y!==O)&&(this._lastUsedTile.x=R,this._lastUsedTile.y=O,this.onClick(R,O))}return!0}}return!1}onClick(e,n){const r=this._tilemap[n][e],s=pa.indexOf(r.height);let a=0;switch(this._actionSettings.currentAction){case kt.DOOR:r.height!=="x"&&(this._doorLocation.x=e,this._doorLocation.y=n,this.renderTiles());return;case kt.UP:if(r.height==="x")return;a=s+1;break;case kt.DOWN:if(r.height==="x"||s<=1)return;a=s-1;break;case kt.SET:a=pa.indexOf(this._actionSettings.currentHeight);break;case kt.UNSET:a=0;break}if(a===-1||s===a)return;a>0&&(e+1>this._width&&(this._width=e+1),n+1>this._height&&(this._height=n+1));const l=pa[a];l&&(r.isBlocked||(this._tilemap[n][e].height=l,this.renderTiles()))}renderTiles(){this.tilemapRenderer.clear();for(let e=0;e<this._tilemap.length;e++)for(let n=0;n<this.tilemap[e].length;n++){const r=this.tilemap[e][n];let s=r.height;this._doorLocation.x===n&&this._doorLocation.y===e&&(s=Wn.TILE_DOOR),r.isBlocked&&(s=Wn.TILE_BLOCKED);const[a,l]=_w(n,e);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${s}`),a,l)}}setTilemap(e,n){this._tilemap=[];const r=e.split("\r");let s=0,a=r.length;for(let l=0;l<a;l++){const u=r[l];if(u.length===0){r.splice(l,1),a=r.length,l--;continue}u.length>s&&(s=u.length)}for(let l=0;l<a;l++){this._tilemap[l]=[];const u=r[l];for(let d=0;d<s;d++){const g=n[l]&&n[l][d]||!1,m=u[d];m!=="x"&&m!=="X"&&m?this._tilemap[l][d]=new vi(m,g):this._tilemap[l][d]=new vi("x",g)}for(let d=s;d<cs;d++)this.tilemap[l][d]=new vi("x",!1)}for(let l=a;l<cs;l++){this.tilemap[l]||(this.tilemap[l]=[]);for(let u=0;u<cs;u++)this.tilemap[l][u]=new vi("x",!1)}this._width=s,this._height=a}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let r=cs-1;r>=0;r--)if(this._tilemap[r])for(let s=cs-1;s>=0;s--){if(!this._tilemap[r][s])continue;this._tilemap[r][s].height!=="x"&&(s+1>this._width&&(this._width=s+1),r+1>this._height&&(this._height=r+1))}}const n=[];for(let r=0;r<this._height;r++){const s=[];for(let a=0;a<this._width;a++){const l=this._tilemap[r][a];s[a]=l.height}n[r]=s.join("")}return n.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear()}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(e){this._doorLocation=e}get actionSettings(){return this._actionSettings}static get instance(){return Wn._INSTANCE||(Wn._INSTANCE=new Wn),Wn._INSTANCE}};Wn._INSTANCE=null,Wn.TILE_BLOCKED="r_blocked",Wn.TILE_DOOR="r_door";let Ut=Wn;const wh=o.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),Nw=i=>t(wh.Provider,{...i}),vc=()=>o.useContext(wh),Sw=i=>{const{gap:e=1,children:n=null,...r}=i,[s,a]=o.useState(!1),[l,u]=o.useState(!1),{originalFloorplanSettings:d=null,setOriginalFloorplanSettings:g=null,setVisualizationSettings:m=null}=vc(),f=o.useRef(null);U(jE,C=>{const p=C.getParser();g(_=>{const E={..._};return E.reservedTiles=p.blockedTilesMap,Ut.instance.setTilemap(E.tilemap,E.reservedTiles),E}),a(!0),f.current.scrollTo(Ut.instance.view.width/3,0)}),U(qE,C=>{const p=C.getParser();g(_=>{const E={..._};return E.entryPoint=[p.x,p.y],E.entryPointDir=p.direction,E}),m(_=>{const E={..._};return E.entryPointDir=p.direction,E}),Ut.instance.doorLocation=new zr(p.x,p.y),u(!0)});const I=C=>{const p=f.current;if(p)switch(C){case"up":p.scrollBy({top:-10});break;case"down":p.scrollBy({top:10});break;case"left":p.scrollBy({left:-10});break;case"right":p.scrollBy({left:10});break}};return o.useEffect(()=>()=>{Ut.instance.clear(),m(C=>({wallHeight:d.wallHeight,thicknessWall:d.thicknessWall,thicknessFloor:d.thicknessFloor,entryPointDir:C.entryPointDir}))},[d.thicknessFloor,d.thicknessWall,d.wallHeight,m]),o.useEffect(()=>{!l||!s||Ut.instance.renderTiles()},[l,s]),o.useEffect(()=>{L(new YE),L(new zE),Ut.instance.tilemapRenderer.interactive=!0,f.current&&f.current.appendChild(Ut.instance.renderer.view)},[]),c(v,{gap:e,...r,children:[c(ne,{overflow:"hidden",gap:1,children:[t(v,{center:!0,size:1,children:t(M,{className:"d-md-none",onClick:C=>I("left"),children:t(Bd,{className:"fa-icon"})})}),c(v,{overflow:"hidden",size:10,gap:1,children:[t(w,{justifyContent:"center",className:"d-md-none",children:t(M,{shrink:!0,onClick:C=>I("up"),children:t(Jh,{className:"fa-icon"})})}),t(P,{overflow:"auto",innerRef:f}),t(w,{justifyContent:"center",className:"d-md-none",children:t(M,{shrink:!0,onClick:C=>I("down"),children:t(Zh,{className:"fa-icon"})})})]}),t(v,{center:!0,size:1,children:t(M,{className:"d-md-none",onClick:C=>I("right"),children:t(Hd,{className:"fa-icon"})})})]}),n]})},Gu=i=>i.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),vw=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(""),{originalFloorplanSettings:s=null}=vc(),a=()=>{L(new gm(n.split(`
`).join("\r"),s.entryPoint[0],s.entryPoint[1],s.entryPointDir,ro(s.thicknessWall),ro(s.thicknessFloor),s.wallHeight-1))};return hh(()=>{r(Gu(s.tilemap))}),c(se,{theme:"primary",className:"floorplan-import-export",children:[t(ae,{headerText:h("floor.plan.editor.import.export"),onCloseClick:e}),c(re,{children:[t("textarea",{className:"h-100",value:n,onChange:l=>r(l.target.value)}),c(w,{justifyContent:"between",children:[t(M,{onClick:l=>r(Gu(s.tilemap)),children:h("floor.plan.editor.revert.to.last.received.map")}),t(M,{onClick:a,children:h("floor.plan.editor.save")})]})]})]})},Bu=0,wi=16,Tw=0,ww=26,Rw=i=>{const{visualizationSettings:e=null,setVisualizationSettings:n=null}=vc(),[r,s]=o.useState(kt.SET),[a,l]=o.useState(0),u=_=>{s(_),Ut.instance.actionSettings.currentAction=_},d=()=>{n(_=>{const E={..._};return E.entryPointDir<7?++E.entryPointDir:E.entryPointDir=0,E})},g=_=>{(isNaN(_)||_<=0)&&(_=0),_>26&&(_=26),l(_),Ut.instance.actionSettings.currentHeight=_.toString(36)},m=_=>{n(E=>{const b={...E};return b.thicknessFloor=_,b})},f=_=>{n(E=>{const b={...E};return b.thicknessWall=_,b})},I=_=>{(isNaN(_)||_<=0)&&(_=Bu),_>wi&&(_=wi),n(E=>{const b={...E};return b.wallHeight=_,b})},C=()=>{let _=e.wallHeight+1;_>wi&&(_=wi),I(_)},p=()=>{let _=e.wallHeight-1;_<=0&&(_=Bu),I(_)};return c(v,{children:[c(w,{gap:1,children:[c(v,{size:5,gap:1,children:[t(S,{bold:!0,children:h("floor.plan.editor.draw.mode")}),c(w,{gap:3,children:[c(w,{gap:1,children:[t(Ne,{itemActive:r===kt.SET,onClick:_=>u(kt.SET),children:t("i",{className:"icon icon-set-tile"})}),t(Ne,{itemActive:r===kt.UNSET,onClick:_=>u(kt.UNSET),children:t("i",{className:"icon icon-unset-tile"})})]}),c(w,{gap:1,children:[t(Ne,{itemActive:r===kt.UP,onClick:_=>u(kt.UP),children:t("i",{className:"icon icon-increase-height"})}),t(Ne,{itemActive:r===kt.DOWN,onClick:_=>u(kt.DOWN),children:t("i",{className:"icon icon-decrease-height"})})]}),t(Ne,{itemActive:r===kt.DOOR,onClick:_=>u(kt.DOOR),children:t("i",{className:"icon icon-set-door"})})]})]}),c(v,{alignItems:"center",size:4,children:[t(S,{bold:!0,children:h("floor.plan.editor.enter.direction")}),t("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:d})]}),c(v,{size:3,children:[t(S,{bold:!0,children:h("floor.editor.wall.height")}),c(w,{alignItems:"center",gap:1,children:[t(Fd,{className:"cursor-pointer fa-icon",onClick:p}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:_=>I(_.target.valueAsNumber)}),t(Vd,{className:"cursor-pointer fa-icon",onClick:C})]})]})]}),c(w,{gap:1,children:[c(v,{size:6,children:[c(S,{bold:!0,children:[h("floor.plan.editor.tile.height"),": ",a]}),t(At,{className:"nitro-slider",min:Tw,max:ww,step:1,value:a,onChange:_=>g(_),renderThumb:({style:_,...E},b)=>t("div",{style:{backgroundColor:`#${Ew[b.valueNow.toString(33)]}`,..._},...E,children:b.valueNow})})]}),c(v,{size:6,children:[t(S,{bold:!0,children:h("floor.plan.editor.room.options")}),c(w,{className:"align-items-center",children:[c("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:_=>f(parseInt(_.target.value)),children:[t("option",{value:0,children:h("navigator.roomsettings.wall_thickness.thinnest")}),t("option",{value:1,children:h("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:2,children:h("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:3,children:h("navigator.roomsettings.wall_thickness.thick")})]}),c("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:_=>m(parseInt(_.target.value)),children:[t("option",{value:0,children:h("navigator.roomsettings.floor_thickness.thinnest")}),t("option",{value:1,children:h("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:2,children:h("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:3,children:h("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},Ow=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,l]=o.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[u,d]=o.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),g=()=>{L(new gm(Ut.instance.getCurrentTilemapString(),Ut.instance.doorLocation.x,Ut.instance.doorLocation.y,u.entryPointDir,ro(u.thicknessWall),ro(u.thicknessFloor),u.wallHeight-1))},m=()=>{d({wallHeight:a.wallHeight,thicknessWall:a.thicknessWall,thicknessFloor:a.thicknessFloor,entryPointDir:a.entryPointDir}),Ut.instance.doorLocation=new zr(a.entryPoint[0],a.entryPoint[1]),Ut.instance.setTilemap(a.tilemap,a.reservedTiles),Ut.instance.renderTiles()};return Ee(_n.DISPOSED,f=>n(!1)),U($E,f=>{const I=f.getParser();l(C=>{const p={...C};return p.tilemap=I.model,p.wallHeight=I.wallHeight+1,p}),d(C=>{const p={...C};return p.wallHeight=I.wallHeight+1,p})}),U(KE,f=>{const I=f.getParser();l(C=>{const p={...C};return p.thicknessFloor=Ti(I.thicknessFloor),p.thicknessWall=Ti(I.thicknessWall),p}),d(C=>{const p={...C};return p.thicknessFloor=Ti(I.thicknessFloor),p.thicknessWall=Ti(I.thicknessWall),p})}),o.useEffect(()=>{const f={linkReceived:I=>{const C=I.split("/");if(!(C.length<2))switch(C[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(p=>!p);return}},eventUrlPrefix:"floor-editor/"};return pt(f),()=>It(f)},[]),o.useEffect(()=>{Ut.instance.initialize()},[]),c(Nw,{value:{originalFloorplanSettings:a,setOriginalFloorplanSettings:l,visualizationSettings:u,setVisualizationSettings:d},children:[e&&c(se,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary",children:[t(ae,{headerText:h("floor.plan.editor.title"),onCloseClick:()=>n(!1)}),c(re,{overflow:"hidden",children:[t(Rw,{}),t(Sw,{overflow:"hidden"}),c(w,{justifyContent:"between",children:[t(M,{onClick:m,children:h("floor.plan.editor.reload")}),c(Lr,{children:[t(M,{disabled:!0,children:h("floor.plan.editor.preview")}),t(M,{onClick:f=>s(!0),children:h("floor.plan.editor.import.export")}),t(M,{onClick:g,children:h("floor.plan.editor.save")})]})]})]})]}),r&&t(vw,{onCloseClick:()=>s(!1)})]})},yw=i=>{const{friend:e=null}=i,[n,r]=o.useState(!1),{followFriend:s=null}=ln(),a=o.useRef();return o.useEffect(()=>{const l=u=>{const d=a.current;d&&u.target!==d&&!d.contains(u.target)&&r(!1)};return document.addEventListener(ve.MOUSE_CLICK,l),()=>document.removeEventListener(ve.MOUSE_CLICK,l)},[]),e?c("div",{ref:a,className:"btn btn-success friend-bar-item "+(n?"friend-bar-item-active":""),onClick:l=>r(u=>!u),children:[c("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&t(it,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&t(We,{isGroup:!0,badgeCode:e.figure})]}),t("div",{className:"text-truncate text-white",children:e.name}),n&&c("div",{className:"d-flex justify-content-between",children:[t(P,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:l=>Do(e.id)}),e.followingAllowed&&t(P,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:l=>s(e)}),t(P,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:l=>on(e.id)})]})]}):c("div",{ref:a,className:"btn btn-primary friend-bar-item friend-bar-search",children:[t("div",{className:"friend-bar-item-head position-absolute"}),t("div",{className:"text-truncate text-white",children:h("friend.bar.find.title")})]})},kw=i=>{const{onlineFriends:e=null}=i,[n,r]=o.useState(0),[s,a]=o.useState(3),l=o.useRef(),u=()=>{const d=window.innerWidth;d>=1536?a(8):d>=1280?a(6):d>=1024?a(5):d>=768?a(4):a(3)};return o.useEffect(()=>(u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),c(w,{innerRef:l,alignItems:"center",className:"friend-bar",children:[t(M,{variant:"black",className:"friend-bar-button left",disabled:n<=0,onClick:()=>r(n-1)}),Array.from(Array(s),(d,g)=>t(yw,{friend:e[n+g]||null},g)),t(M,{variant:"black",className:"friend-bar-button right",disabled:!(e.length>s&&n+s<=e.length-1),onClick:()=>r(n+1)})]})},Aw=i=>{const{overflow:e="auto",classNames:n=[],...r}=i,s=o.useMemo(()=>{const a=["",""];return n.length&&a.push(...n),a},[n]);return t(v,{classNames:s,overflow:e,...r})},Rh=i=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:s=null,onCloseClick:a=null,justifyContent:l="center",alignItems:u="center",classNames:d=[],children:g=null,...m}=i,f=o.useMemo(()=>{const C=["drag-handler","container-fluid","nitro-card-header-friends"];return d.length&&C.push(...d),C},[d]);return t(v,{center:!0,position:"relative",classNames:f,...m,children:c(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-text-friends",children:e}),n&&t(P,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:s,children:t(Kl,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close-friends",onMouseDownCapture:C=>{C.stopPropagation(),C.nativeEvent.stopImmediatePropagation()},onClick:a,children:t(Xn,{className:"fa-icon w-12 h-12"})})]})})},Dw=i=>{const{friend:e=null,selected:n=!1,selectFriend:r=null}=i,[s,a]=o.useState(!1),{followFriend:l=null,updateRelationship:u=null}=ln(),d=C=>{C.stopPropagation(),l(e)},g=C=>{C.stopPropagation(),Do(e.id)},m=C=>{C.stopPropagation(),a(!0)},f=(C,p)=>{C.stopPropagation(),u(e,p),a(!1)},I=()=>{if(!e)return"none";switch(e.relationshipStatus){case nn.RELATIONSHIP_HEART:return"heart";case nn.RELATIONSHIP_SMILE:return"smile";case nn.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return e?c(eo,{justifyContent:"between",className:`px-2 py-1 ${n&&"bg-primary text-white"}`,onClick:C=>r(e.id),children:[c(w,{alignItems:"center",gap:1,children:[t(P,{onClick:C=>C.stopPropagation(),children:t(xn,{userId:e.id})}),t("div",{style:{fontFamily:"Volter",fontSize:"9px"},children:e.name})]}),c(w,{alignItems:"center",gap:1,children:[!s&&c(G,{children:[e.followingAllowed&&t(P,{pointer:!0,onClick:d,className:"nitro-friends-spritesheet icon-follow",title:h("friendlist.tip.follow")}),e.online&&t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:g,title:h("friendlist.tip.im")}),e.id>0&&t(P,{className:`nitro-friends-spritesheet icon-${I()} cursor-pointer`,onClick:m,title:h("infostand.link.relationship")})]}),s&&c(G,{children:[t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:C=>f(C,nn.RELATIONSHIP_HEART)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:C=>f(C,nn.RELATIONSHIP_SMILE)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:C=>f(C,nn.RELATIONSHIP_BOBBA)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:C=>f(C,nn.RELATIONSHIP_NONE)})]})]})]}):null},Hu=i=>{const{list:e=null,selectedFriendsIds:n=null,selectFriend:r=null}=i;return!e||!e.length?null:t(G,{children:e.map((s,a)=>t(Dw,{friend:s,selected:n&&n.indexOf(s.id)>=0,selectFriend:r},a))})},Pw=i=>{const{request:e=null}=i,{requestResponse:n=null}=ln();return e?c(eo,{justifyContent:"between",className:"px-2 py-1",children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:e.id}),t("div",{children:e.name})]}),c(w,{alignItems:"center",gap:1,children:[t(P,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:r=>n(e.id,!0)}),t(P,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:r=>n(e.id,!1)})]})]}):null},Lw=i=>{const{children:e=null,...n}=i,{requests:r=[],requestResponse:s=null}=ln();return r.length?c(to,{...n,children:[c(v,{fullHeight:!0,justifyContent:"between",gap:1,children:[t(v,{gap:0,children:r.map((a,l)=>t(Pw,{request:a},l))}),t(w,{justifyContent:"center",className:"px-2 py-1",children:t(M,{onClick:a=>s(-1,!1),children:h("friendlist.requests.dismissall")})})]}),e]}):null},Mw=i=>{const{selectedFriendsIds:e=null,removeFriendsText:n=null,removeSelectedFriends:r=null,onCloseClick:s=null}=i;return c(se,{className:"nitro-friends-remove-confirmation",theme:"primary",children:[t(ae,{headerText:h("friendlist.removefriendconfirm.title"),onCloseClick:s}),c(re,{className:"text-black",children:[t("div",{children:n}),c(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:r,children:h("generic.ok")}),t(M,{fullWidth:!0,onClick:s,children:h("generic.cancel")})]})]})]})},xw=i=>{const{selectedFriendsIds:e=null,onCloseClick:n=null,sendRoomInvite:r=null}=i,[s,a]=o.useState("");return c(se,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"primary",children:[t(ae,{headerText:h("friendlist.invite.title"),onCloseClick:n}),c(re,{className:"text-black",children:[h("friendlist.invite.summary",["count"],[e.length.toString()]),t("textarea",{className:"form-control",value:s,maxLength:255,onChange:l=>a(l.target.value)}),t(S,{center:!0,className:"bg-muted rounded p-1",children:h("friendlist.invite.note")}),c(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"success",disabled:s.length===0||e.length===0,onClick:()=>r(s),children:h("friendlist.invite.send")}),t(M,{fullWidth:!0,onClick:n,children:h("generic.cancel")})]})]})]})},Uw=i=>{const{...e}=i,[n,r]=o.useState(""),[s,a]=o.useState(null),[l,u]=o.useState(null),{canRequestFriend:d=null,requestFriend:g=null}=ln();return U(XE,m=>{const f=m.getParser();a(f.friends),u(f.others)}),o.useEffect(()=>{if(!n||!n.length)return;const m=setTimeout(()=>{!n||!n.length||L(new QE(n))},500);return()=>clearTimeout(m)},[n]),c(to,{...e,children:[t("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:h("generic.search"),value:n,maxLength:50,onChange:m=>r(m.target.value)}),c(v,{children:[s&&c(G,{children:[s.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.nofriendsfound")}),s.length>0&&c(v,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.friendscaption",["cnt"],[s.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(v,{gap:0,children:s.map(m=>c(eo,{justifyContent:"between",className:"px-2 py-1",children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:m.avatarId}),t("div",{children:m.avatarName})]}),t(w,{alignItems:"center",gap:1,children:m.isAvatarOnline&&t(P,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:f=>Do(m.avatarId),title:h("friendlist.tip.im")})})]},m.avatarId))})]})]}),l&&c(G,{children:[l.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.noothersfound")}),l.length>0&&c(v,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.otherscaption",["cnt"],[l.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(v,{gap:0,children:l.map(m=>c(eo,{justifyContent:"between",className:"px-2 py-1",children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:m.avatarId}),t("div",{children:m.avatarName})]}),t(w,{alignItems:"center",gap:1,children:d(m.avatarId)&&t(P,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:f=>g(m.avatarId,m.avatarName),title:h("friendlist.tip.addfriend")})})]},m.avatarId))})]})]})]})]})},Fw=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState([]),[a,l]=o.useState(!1),[u,d]=o.useState(!1),{onlineFriends:g=[],offlineFriends:m=[],requests:f=[],requestFriend:I=null}=ln(),C=o.useMemo(()=>{if(!r||!r.length)return"";const b=[];for(const N of r){let T=g.find(y=>y.id===N);T||(T=m.find(y=>y.id===N)),T&&b.push(T.name)}return h("friendlist.removefriendconfirm.userlist",["user_names"],[b.join(", ")])},[m,g,r]),p=o.useCallback(b=>{b<0||s(N=>{const T=[...N],y=T.indexOf(b);return y>-1?T.splice(y,1):T.push(b),T})},[s]),_=b=>{!r.length||!b||!b.length||b.length>255||(L(new JE(b,r)),l(!1))},E=()=>{r.length!==0&&(s(b=>(L(new ZE(...b)),[])),d(!1))};return o.useEffect(()=>{const b={linkReceived:N=>{const T=N.split("/");if(!(T.length<2))switch(T[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(y=>!y);return;case"request":if(T.length<4)return;I(parseInt(T[2]),T[3])}},eventUrlPrefix:"friends/"};return pt(b),()=>It(b)},[I]),e?c(G,{children:[c(se,{className:"nitro-friends nf-special",uniqueKey:"nitro-friends nf-special",theme:"primary",children:[t(Rh,{headerText:h("friendlist.friends"),onCloseClick:b=>n(!1)}),c(Aw,{overflow:"hidden",gap:1,className:"text-black p-0 friend-content-area",children:[c(HN,{fullHeight:!0,overflow:"hidden",children:[t(to,{headerText:h("friendlist.friends")+` (${g.length})`,isExpanded:!0,children:t(Hu,{list:g,selectedFriendsIds:r,selectFriend:p})}),t(to,{className:"offline-friends",headerText:h("friendlist.friends.offlinecaption")+` (${m.length})`,children:t(Hu,{list:m,selectedFriendsIds:r,selectFriend:p})}),t(Lw,{headerText:h("friendlist.tab.friendrequests")+` (${f.length})`,isExpanded:!0}),t(Uw,{className:"search-friends",headerText:h("people.search.title")})]}),r&&r.length>0&&c(w,{gap:1,className:"p-1",children:[t(M,{fullWidth:!0,onClick:()=>l(!0),children:h("friendlist.tip.invite")}),t(M,{fullWidth:!0,variant:"danger",onClick:b=>d(!0),children:h("generic.delete")})]})]})]}),a&&t(xw,{selectedFriendsIds:r,onCloseClick:()=>l(!1),sendRoomInvite:_}),u&&t(Mw,{selectedFriendsIds:r,removeFriendsText:C,onCloseClick:()=>d(!1),removeSelectedFriends:E})]}):null},Vw=i=>{const{overflow:e="auto",classNames:n=[],...r}=i,s=o.useMemo(()=>{const a=[];return n.length&&a.push(...n),a},[n]);return t(v,{classNames:s,overflow:e,...r})},Gw=i=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:l=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:g=!1,disabled:m=!1,center:f=!0,column:I=!0,style:C={},classNames:p=[],position:_="relative",overflow:E="hidden",children:b=null,...N}=i,T=o.useMemo(()=>{const R=["layout-grid-item-messenger"];return r&&R.push("active"),(l||u>0)&&R.push("unique-item"),l&&R.push("sold-out"),d&&R.push("unseen"),g&&R.push("has-highlight"),m&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),p.length&&R.push(...p),R},[r,l,u,d,g,m,e,p]),y=o.useMemo(()=>{let R={...C};return e&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(C).length&&(R={...R,...C}),R},[C,e,n]);return c(v,{center:f,pointer:!0,position:_,overflow:E,column:I,classNames:T,style:y,...N,children:[s>a&&t(Sn,{count:s}),u>0&&c(G,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Kr,{value:u})})]}),b]})},Bw=i=>{const{thread:e=null,group:n=null}=i,r=o.useMemo(()=>n.type===sa.GROUP_CHAT&&Hm(n.chats[0].extraData),[n]),s=o.useMemo(()=>!e||!n?!1:!!(n.type===sa.PRIVATE_CHAT&&n.userId===H().userId||r&&n.chats.length&&r.userId===H().userId),[e,n,r]);return!e||!n?null:n.userId?t(w,{fullWidth:!0,justifyContent:"start",gap:2,children:t(P,{className:"text-black w-100 messages-group-"+(s?"right":"left"),children:n.chats.map((a,l)=>c(P,{className:"text-break chat-message",children:[a.date.getHours(),":",a.date.getMinutes(),": ",a.message,"  "]},l))})}):t(G,{children:n.chats.map((a,l)=>t(w,{fullWidth:!0,gap:2,justifyContent:"start",children:c(P,{className:"w-100 text-break",children:[a.type===Pr.SECURITY_NOTIFICATION&&c(w,{gap:2,alignItems:"center",className:"bg-light px-2 py-1 text-muted",children:[t(P,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),t(P,{style:{fontSize:11},children:a.message})]}),a.type===Pr.ROOM_INVITE&&c(w,{gap:2,alignItems:"center",className:"bg-light px-2 py-1 small text-black",children:[t(P,{className:"messenger-notification-icon flex-shrink-0"}),c(P,{children:[h("messenger.invitation")+" ",a.message]})]})]})},l))})},Hw=i=>{const{thread:e=null}=i;return e.setRead(),t(G,{children:e.groups.length>0&&e.groups.map((n,r)=>t(Bw,{thread:e,group:n},r))})},Ww=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(-1),[a,l]=o.useState(""),{visibleThreads:u=[],activeThread:d=null,getMessageThread:g=null,sendMessage:m=null,setActiveThreadId:f=null,closeThread:I=null}=_c(),{report:C=null}=Fn(),p=o.useRef(),_=()=>d&&d.participant&&L(new nc(d.participant.id)),E=()=>d&&d.participant&&on(d.participant.id),b=()=>{!d||!a.length||(m(d,H().userId,a),l(""))},N=T=>{T.key==="Enter"&&b()};return o.useEffect(()=>{const T={linkReceived:y=>{const R=y.split("/");if(R.length===2){if(R[1]==="open"){n(!0);return}if(R[1]==="toggle"){n(F=>!F);return}const O=g(parseInt(R[1]));if(!O)return;f(O.threadId),n(!0)}},eventUrlPrefix:"friends-messenger/"};return pt(T),()=>It(T)},[g,f]),o.useEffect(()=>{!e||!d||(p.current.scrollTop=p.current.scrollHeight)},[e,d]),o.useEffect(()=>{if(e&&!d){r>0?f(r):u.length>0&&f(u[0].threadId);return}!e&&d&&(s(d.threadId),f(-1))},[e,d,r,u,f]),e?c(se,{className:"nitro-friends-messenger nitro-friends",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:[t(Rh,{headerText:d&&d.participant.name||h("messenger.window.title"),onCloseClick:T=>n(!1)}),c(Vw,{className:"text-black friend-content-area",gap:1,overflow:"hidden",children:[t(v,{fullWidth:!0,size:4,children:t("div",{className:"d-flex h-100 messenger-friend-heads ",children:u&&u.length>0&&u.map(T=>c(Gw,{itemActive:d===T,onClick:y=>f(T.threadId),children:[T.unread&&t(Sn,{count:T.unreadCount}),t(w,{fullWidth:!0,alignItems:"center",gap:1,children:c(w,{alignItems:"center",className:"friend-head px-1",children:[T.participant.id>0&&t(it,{figure:T.participant.figure,headOnly:!0,scale:.7,direction:2}),T.participant.id<=0&&t(We,{style:{backgroundImage:`url(${ds.instance.getConfiguration("badge.asset.grouparts.url")}/${T.participant.figure}.gif`},isGroup:!0,badgeCode:""})]})})]},T.threadId))})}),t(v,{size:8,gap:1,overflow:"auto",className:"w-100 nitro-messenger-messages",children:d&&c(G,{children:[c(w,{alignItems:"center",className:"px-1",justifyContent:"between",gap:1,children:[c(w,{gap:1,children:[c(Lr,{className:"gap-1",children:[t(w,{justifyContent:"center",alignItems:"center",className:"btn btn-sm btn-primary",onClick:_,children:t("div",{className:"nitro-friends-spritesheet icon-follow"})}),t(w,{justifyContent:"center",alignItems:"center",className:"btn btn-sm btn-primary",onClick:E,children:t("div",{className:"nitro-friends-spritesheet icon-profile"})})]}),t("button",{className:"btn btn-sm btn-primary messenger-button fw-bold px-3",onClick:()=>C(Je.IM,{reportedUserId:d.participant.id}),children:h("messenger.window.button.report")})]}),t("button",{className:"close-messenger",onClick:T=>I(d.threadId)})]}),t(v,{fit:!0,className:"chat-messages",children:t(v,{innerRef:p,gap:0,overflow:"auto",children:t(Hw,{thread:d})})})]})})]}),d&&t(w,{gap:1,className:"px-1 py-2",children:t("textarea",{className:"chat-input-form w-100",maxLength:255,placeholder:h("messenger.window.input.default",["FRIEND_NAME"],[d.participant.name]),onChange:T=>l(T.target.value),value:a,onKeyDown:N})})]}):null},jw=i=>{const{settings:e=null,onlineFriends:n=[]}=ln();return e?c(G,{children:[Xl.createPortal(t(kw,{onlineFriends:n}),document.getElementById("toolbar-friend-bar-container")),t(Fw,{}),t(Ww,{})]}):null},qw=()=>{const{games:i,selectedGame:e,setSelectedGame:n}=Uo(),r=a=>{let l=["game-icon"];return e===a&&l.push("selected"),l.join(" ")},s=a=>`url(${a.assetUrl}${a.gameNameId}_icon.png)`;return c(P,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[h("gamecenter.game_list_title"),t(w,{gap:3,children:i&&i.map((a,l)=>t(P,{className:r(a),onClick:u=>n(a),style:{backgroundImage:s(a)}},l))})]})},Yw=()=>{const{gameURL:i,setGameURL:e}=Uo(),[n,r]=o.useState(0),s=o.useRef();return o.useEffect(()=>{if(!s||s&&!s.current)return;r(0);let a=document.createElement("iframe");a.src=i,a.classList.add("game-center-stage"),a.classList.add("h-100"),a.onload=()=>{r(l=>l+=1)},s.current.innerHTML="",s.current.appendChild(a)},[s,i]),o.useEffect(()=>{n>1&&(e(null),L(new eC))},[n,e]),i?t(P,{innerRef:s,className:"game-center-stage"}):null},zw=()=>{const{selectedGame:i,accountStatus:e}=Uo();o.useEffect(()=>{i&&(L(new tC(i.gameId)),L(new nC(i.gameId)))},[i]);const n=()=>an.uintHexColor(i.bgColor),r=()=>`url(${i.assetUrl}${i.gameNameId}_theme.png)`,s=()=>an.uintHexColor(i.textColor),a=()=>{L(new rC(i.gameId))};return c(w,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:n(),backgroundImage:r(),color:s()},children:[c(w,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[t(S,{bold:!0,children:h(`gamecenter.${i.gameNameId}.description_title`)}),t("img",{src:i.assetUrl+i.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&t(G,{children:c(M,{variant:"light",position:"relative",className:"px-4",onClick:a,children:[h("gamecenter.play_now"),!e.hasUnlimitedGames&&t(Sn,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),t(S,{bold:!0,className:"w-50",center:!0,children:h(`gamecenter.${i.gameNameId}.description_content`)})]}),t(P,{className:"w-25"})]})},$w=()=>{const{isVisible:i,setIsVisible:e,games:n,accountStatus:r}=Uo();if(o.useEffect(()=>{const s=()=>{e(l=>!l)},a={linkReceived:l=>{switch(l.split("/")[1]){case"toggle":s();break}},eventUrlPrefix:"games/"};return pt(a),()=>It(a)},[]),!(!i||!n||!r))return c(w,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[c(w,{className:"game-center-main",column:!0,children:[t(zw,{}),t(qw,{})]}),t(Yw,{})]})},Kw=[0,1,2,3,4,5,6,7,8],Xw=i=>{const{badgeParts:e=[],setBadgeParts:n=null}=i,[r,s]=o.useState(-1),{groupCustomize:a=null}=si(),l=(u,d,g)=>{const m=[...e];m[u][d]=g,n(m),d==="key"&&s(-1)};return!e||!e.length?null:c(G,{children:[r<0&&e&&e.length>0&&e.map((u,d)=>c(w,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[c(w,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:g=>s(d),children:[e[d].code&&e[d].code.length>0&&t(We,{badgeCode:e[d].code,isGroup:!0}),(!e[d].code||!e[d].code.length)&&t(w,{center:!0,className:"badge-image group-badge",children:t(wo,{className:"fa-icon"})})]}),u.type!==$t.BASE&&t(ne,{gap:1,columnCount:3,children:Kw.map((g,m)=>t(P,{pointer:!0,className:`group-badge-position-swatch ${e[d].position===g?"active":""}`,onClick:f=>l(d,"position",g)},m))}),t(ne,{gap:1,columnCount:8,children:a.badgePartColors.length>0&&a.badgePartColors.map((g,m)=>t(P,{pointer:!0,className:`group-badge-color-swatch ${e[d].color===m+1?"active":""}`,style:{backgroundColor:"#"+g.color},onClick:f=>l(d,"color",m+1)},m))})]},d)),r>=0&&c(ne,{gap:1,columnCount:5,children:[e[r].type===$t.SYMBOL&&t(v,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>l(r,"key",0),children:t(w,{center:!0,className:"badge-image group-badge",children:t(Xn,{className:"fa-icon"})})}),(e[r].type===$t.BASE?a.badgeBases:a.badgeSymbols).map((u,d)=>t(v,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:g=>l(r,"key",u.id),children:t(We,{badgeCode:$t.getCode(e[r].type,u.id,e[r].color,4),isGroup:!0})},d))]})]})},Oh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,skipDefault:s=null}=i,[a,l]=o.useState(null),{groupCustomize:u=null}=si(),d=()=>{if(!a||!a.length)return"";let m="";return a.forEach(f=>f.code&&(m+=f.code)),m},g=o.useCallback(()=>{if(!e||!a||!a.length)return!1;if(e.groupBadgeParts===a)return!0;if(e.groupId<=0)return n(f=>{const I={...f};return I.groupBadgeParts=a,I}),!0;const m=[];return a.forEach(f=>{f.code&&(m.push(f.key),m.push(f.color),m.push(f.position))}),L(new sC(e.groupId,m)),!0},[e,a,n]);return o.useEffect(()=>{if(e.groupBadgeParts)return;const m=[new $t($t.BASE,u.badgeBases[0].id,u.badgePartColors[0].id),new $t($t.SYMBOL,0,u.badgePartColors[0].id),new $t($t.SYMBOL,0,u.badgePartColors[0].id),new $t($t.SYMBOL,0,u.badgePartColors[0].id),new $t($t.SYMBOL,0,u.badgePartColors[0].id)];n(f=>({...f,groupBadgeParts:m}))},[e.groupBadgeParts,u,n]),o.useEffect(()=>{if(e.groupId<=0){l(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}l(e.groupBadgeParts)},[e]),o.useEffect(()=>(r({action:g}),()=>r(null)),[r,g]),c(ne,{overflow:"hidden",gap:1,children:[t(v,{size:2,children:t(w,{center:!0,className:"bg-muted rounded p-1",children:t(We,{badgeCode:d(),isGroup:!0})})}),t(v,{size:10,overflow:"auto",children:t(Xw,{badgeParts:a,setBadgeParts:l})})]})},yh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=i,[s,a]=o.useState(null),{groupCustomize:l=null}=si(),u=m=>m===0?l.groupColorsA.find(f=>f.id===s[m]).color:l.groupColorsB.find(f=>f.id===s[m]).color,d=(m,f)=>{a(I=>{const C=[...I];return C[m]=f,C})},g=o.useCallback(()=>!e||!s||!s.length?!1:e.groupColors===s?!0:e.groupId<=0?(n(m=>{const f={...m};return f.groupColors=[...s],f}),!0):(L(new aC(e.groupId,s[0],s[1])),!0),[e,s,n]);return o.useEffect(()=>{if(!l.groupColorsA||!l.groupColorsB||e.groupColors)return;const m=[l.groupColorsA[0].id,l.groupColorsB[0].id];n(f=>({...f,groupColors:m}))},[l,e.groupColors,n]),o.useEffect(()=>{if(e.groupId<=0){a(e.groupColors?[...e.groupColors]:null);return}a(e.groupColors)},[e]),o.useEffect(()=>(r({action:g}),()=>r(null)),[r,g]),s?c(ne,{overflow:"hidden",children:[c(v,{size:2,gap:1,children:[t(S,{bold:!0,children:h("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&c(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(1)}})]})]}),c(v,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:h("group.edit.color.primary.color")}),t(ye,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&l.groupColorsA&&l.groupColorsA.map((m,f)=>t("div",{className:Ts("group-badge-color-swatch cursor-pointer",e.groupColors[0]===m.id&&"active"),style:{backgroundColor:"#"+m.color},onClick:()=>d(0,m.id)},f))})]}),c(v,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:h("group.edit.color.secondary.color")}),t(ye,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&l.groupColorsB&&l.groupColorsB.map((m,f)=>t("div",{className:Ts("group-badge-color-swatch cursor-pointer",e.groupColors[1]===m.id&&"active"),style:{backgroundColor:"#"+m.color},onClick:()=>d(1,m.id)},f))})]})]}):null},Qw=i=>{const{groupData:e=null,setGroupData:n=null,purchaseCost:r=0}=i,{groupCustomize:s=null}=si(),a=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let u="";return e.groupBadgeParts.forEach(d=>d.code&&(u+=d.code)),u},l=u=>u===0?s.groupColorsA.find(d=>d.id===e.groupColors[u]).color:s.groupColorsB.find(d=>d.id===e.groupColors[u]).color;return e?c(ne,{overflow:"hidden",gap:1,children:[c(v,{size:3,children:[c(v,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:h("group.create.confirm.guildbadge")}),t(We,{badgeCode:a(),isGroup:!0})]}),c(v,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:h("group.edit.color.guild.color")}),c(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+l(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+l(1)}})]})]})]}),c(v,{size:9,justifyContent:"between",children:[c(v,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:e.groupName}),t(S,{children:e.groupDescription})]}),t(S,{overflow:"auto",children:h("group.create.confirm.info")})]}),t(S,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:h("group.create.confirm.buyinfo",["amount"],[r.toString()])})]})]}):null},kh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,onClose:s=null,isCreator:a=!1,availableRooms:l=[]}=i,[u,d]=o.useState(""),[g,m]=o.useState(""),[f,I]=o.useState(-1),{showConfirm:C=null}=je(),p=()=>{!e||e.groupId<=0||C(h("group.deleteconfirm.desc"),()=>{L(new oC(e.groupId)),s&&s()},null,null,null,h("group.deleteconfirm.title"))},_=o.useCallback(()=>!e||!u||!u.length?!1:u===e.groupName&&g===e.groupDescription?!0:e.groupId<=0?f<=0?!1:(n(E=>{const b={...E};return b.groupName=u,b.groupDescription=g,b.groupHomeroomId=f,b}),!0):(L(new iC(e.groupId,u,g||"")),!0),[e,u,g,f,n]);return o.useEffect(()=>{d(e.groupName||""),m(e.groupDescription||""),I(e.groupHomeroomId)},[e]),o.useEffect(()=>(r({action:_}),()=>r(null)),[r,_]),e?c(v,{justifyContent:"between",overflow:"auto",children:[c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:h("group.edit.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:29,onChange:E=>d(E.target.value)})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:h("group.edit.desc")}),t("textarea",{className:"form-control form-control-sm",value:g,maxLength:254,onChange:E=>m(E.target.value)})]}),a&&c(G,{children:[c(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:h("group.edit.base")}),t(v,{fullWidth:!0,gap:1,children:c("select",{className:"form-select form-select-sm",value:f,onChange:E=>I(parseInt(E.target.value)),children:[t("option",{value:-1,disabled:!0,children:h("group.edit.base.select.room")}),l&&l.map((E,b)=>t("option",{value:E.id,children:E.name},b))]})})]}),c(w,{gap:1,children:[t(P,{className:"col-3",children:" "}),t(S,{small:!0,children:h("group.edit.base.warning")})]})]})]}),!a&&t(M,{variant:"danger",onClick:p,children:h("group.delete")}),a&&t(S,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:E=>Z("navigator/create"),children:h("group.createroom")})]}):null},Jw=[1,2,3,4],Zw=i=>{const{onClose:e=null}=i,[n,r]=o.useState(1),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(0),I=()=>{a(null),u(null),e&&e()},C=()=>{if(!l)return;const E=[];l.groupBadgeParts.forEach(b=>{b.code&&(E.push(b.key),E.push(b.color),E.push(b.position))}),L(new uC(l.groupName,l.groupDescription,l.groupHomeroomId,l.groupColors[0],l.groupColors[1],E))},p=()=>{if(!(s&&s.action&&!s.action())){if(n===1){e();return}r(E=>E-1)}},_=()=>{if(!(s&&s.action&&!s.action())){if(n===4){C();return}r(E=>E===4?E:E+1)}};return U(lC,E=>{const b=E.getParser(),N=[];b.availableRooms.forEach((T,y)=>N.push({id:y,name:T})),g(N),f(b.groupCost)}),o.useEffect(()=>{r(1),u({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),L(new cC)},[u]),l?c(se,{className:"nitro-group-creator",theme:"primary",children:[t(ae,{headerText:h("group.create.title"),onCloseClick:I}),c(re,{children:[t(w,{center:!0,className:"creator-tabs",children:Jw.map((E,b)=>t(w,{center:!0,className:`tab tab-${E===1?"blue-flat":E===4?"yellow":"blue-arrow"} ${n===E?"active":""}`,children:t(S,{variant:"white",children:h(`group.create.steplabel.${E}`)})},b))}),c(v,{overflow:"hidden",children:[c(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${n}`}),c(v,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:h(`group.create.stepcaption.${n}`)}),t(S,{children:h(`group.create.stepdesc.${n}`)})]})]}),c(v,{overflow:"hidden",children:[n===1&&t(kh,{groupData:l,setGroupData:u,setCloseAction:a,onClose:null,isCreator:!0,availableRooms:d}),n===2&&t(Oh,{groupData:l,setGroupData:u,setCloseAction:a}),n===3&&t(yh,{groupData:l,setGroupData:u,setCloseAction:a}),n===4&&t(Qw,{groupData:l,setGroupData:u,purchaseCost:m})]}),c(w,{justifyContent:"between",children:[t(M,{variant:"link",className:"text-black",onClick:p,children:h(n===1?"generic.cancel":"group.create.previousstep")}),t(M,{disabled:n===4&&!Cs(),variant:n===4?Cs()?"success":"danger":"primary",onClick:_,children:h(n===4?Cs()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},eR=["regular","exclusive","private"],Ah=i=>{const{groupInformation:e=null,onClose:n=null,overflow:r="hidden",...s}=i,{showConfirm:a=null}=je(),l=e&&e.ownerName===H().userName,u=()=>e&&hc(e.id),d=()=>{a(h("group.leaveconfirm.desc"),()=>{L(new rc(e.id,H().userId)),n&&n()},null)},g=()=>e.membershipType===yt.NOT_MEMBER||e.membershipType===yt.REQUEST_PENDING?null:l?t("i",{className:"icon icon-group-owner",title:h("group.youareowner")}):e.isAdmin?t("i",{className:"icon icon-group-admin",title:h("group.youareadmin")}):t("i",{className:"icon icon-group-member",title:h("group.youaremember")}),m=()=>{if(l)return"group.youareowner";if(e.type===Cn.PRIVATE&&e.membershipType!==yt.MEMBER)return"";if(e.membershipType===yt.MEMBER)return"group.leave";if(e.membershipType===yt.NOT_MEMBER&&e.type===Cn.REGULAR)return"group.join";if(e.membershipType===yt.REQUEST_PENDING)return"group.membershippending";if(e.membershipType===yt.NOT_MEMBER&&e.type===Cn.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(!(e.type===Cn.PRIVATE&&e.membershipType===yt.NOT_MEMBER)){if(e.membershipType===yt.MEMBER){d();return}u()}},I=C=>{switch(C){case"members":fu(e.id);break;case"members_pending":fu(e.id,2);break;case"manage":jm(e.id);break;case"homeroom":vn(e.roomId);break;case"furniture":Z("catalog/open/"+qi.GUILD_CUSTOM_FURNI);break;case"popular_groups":Z("navigator/search/groups");break}};return e?c(ne,{overflow:r,...s,children:[c(v,{center:!0,size:3,overflow:"hidden",children:[t(w,{alignItems:"center",overflow:"hidden",className:"group-badge",children:t(We,{badgeCode:e.badge,isGroup:!0,scale:2})}),c(v,{alignItems:"center",gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("members"),children:h("group.membercount",["totalMembers"],[e.membersCount.toString()])}),e.pendingRequestsCount>0&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("members_pending"),children:h("group.pendingmembercount",["amount"],[e.pendingRequestsCount.toString()])}),e.isOwner&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("manage"),children:h("group.manage")})]}),g()]}),c(v,{size:9,justifyContent:"between",overflow:"auto",children:[c(v,{overflow:"hidden",children:[c(v,{gap:1,children:[c(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,children:e.title}),c(w,{gap:1,children:[t("i",{className:"icon icon-group-type-"+e.type,title:h(`group.edit.settings.type.${eR[e.type]}.help`)}),e.canMembersDecorate&&t("i",{className:"icon icon-group-decorate",title:h("group.memberscandecorate")})]})]}),t(S,{small:!0,children:h("group.created",["date","owner"],[e.createdAt,e.ownerName])})]}),t(S,{small:!0,overflow:"auto",className:"group-description",children:e.description})]}),c(v,{children:[c(v,{gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("homeroom"),children:h("group.linktobase")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("furniture"),children:h("group.buyfurni")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>I("popular_groups"),children:h("group.showgroups")})]}),(e.type!==Cn.PRIVATE||e.type===Cn.PRIVATE&&e.membershipType===yt.MEMBER)&&t(M,{disabled:e.membershipType===yt.REQUEST_PENDING||l,onClick:f,children:h(m())})]})]})]}):null},tR=i=>{const[e,n]=o.useState(null);return U(Xa,r=>{const s=r.getParser();(e&&e.id===s.id||s.flag)&&n(s)}),e?c(se,{className:"nitro-group-information-standalone",theme:"primary",children:[t(ae,{headerText:h("group.window.title"),onCloseClick:r=>n(null)}),t(re,{children:t(Ah,{groupInformation:e,onClose:()=>n(null)})})]}):null},nR=["regular","exclusive","private"],rR=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=i,[s,a]=o.useState(e.groupState),[l,u]=o.useState(e.groupCanMembersDecorate),d=o.useCallback(()=>e?s===e.groupState&&l===e.groupCanMembersDecorate?!0:e.groupId<=0?(n(g=>{const m={...g};return m.groupState=s,m.groupCanMembersDecorate=l,m}),!0):(L(new dC(e.groupId,s,l?0:1)),!0):!1,[e,s,l,n]);return o.useEffect(()=>{a(e.groupState),u(e.groupCanMembersDecorate)},[e]),o.useEffect(()=>(r({action:d}),()=>r(null)),[r,d]),c(v,{overflow:"auto",children:[t(v,{children:nR.map((g,m)=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"groupState",checked:s===m,onChange:f=>a(m)}),c(v,{gap:0,children:[c(w,{gap:1,children:[t("i",{className:`icon icon-group-type-${m}`}),t(S,{bold:!0,children:h(`group.edit.settings.type.${g}.label`)})]}),t(S,{children:h(`group.edit.settings.type.${g}.help`)})]})]},m))}),t(XN,{}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:l,onChange:g=>u(m=>!m)}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("group.edit.settings.rights.caption")}),t(S,{children:h("group.edit.settings.rights.members.help")})]})]})]})},sR=[1,2,3,5],aR=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(null),[a,l]=o.useState(null),u=()=>{s(g=>(g&&g.action&&g.action(),null)),l(null)},d=g=>{r&&r.action&&r.action(),n(g)};return U(Xa,g=>{const m=g.getParser();!a||a.groupId!==m.id||l(f=>{const I={...f};return I.groupName=m.title,I.groupDescription=m.description,I.groupState=m.type,I.groupCanMembersDecorate=m.canMembersDecorate,I})}),U(mC,g=>{const m=g.getParser(),f=[];m.badgeParts.forEach((I,C)=>{f.push(new Qo(I.isBase?Qo.BASE:Qo.SYMBOL,I.key,I.color,I.position))}),l({groupId:m.id,groupName:m.title,groupDescription:m.description,groupHomeroomId:m.roomId,groupState:m.state,groupCanMembersDecorate:m.canMembersDecorate,groupColors:[m.colorA,m.colorB],groupBadgeParts:f})}),!a||a.groupId<=0?null:c(se,{className:"nitro-group-manager",children:[t(ae,{headerText:h("group.window.title"),onCloseClick:u}),t(Zr,{children:sR.map(g=>t(Ir,{isActive:e===g,onClick:()=>d(g),children:h(`group.edit.tab.${g}`)},g))}),c(re,{children:[c(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${e}`}),c(v,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:h(`group.edit.tabcaption.${e}`)}),t(S,{children:h(`group.edit.tabdesc.${e}`)})]})]}),c(v,{grow:!0,overflow:"hidden",children:[e===1&&t(kh,{groupData:a,setGroupData:l,setCloseAction:s,onClose:u}),e===2&&t(Oh,{groupData:a,setGroupData:l,setCloseAction:s,skipDefault:!0}),e===3&&t(yh,{groupData:a,setGroupData:l,setCloseAction:s}),e===5&&t(rR,{groupData:a,setGroupData:l,setCloseAction:s})]})]})]})},iR=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),[a,l]=o.useState(null),[u,d]=o.useState(-1),[g,m]=o.useState(0),[f,I]=o.useState(""),[C,p]=o.useState(null),{showConfirm:_=null}=je(),E=R=>{if(R.rank===Zt.OWNER)return"group.members.owner";if(a.admin){if(R.rank===Zt.ADMIN)return"group.members.removerights";if(R.rank===Zt.MEMBER)return"group.members.giverights"}return""},b=o.useCallback(()=>{e===-1||r===-1||u===-1||L(new Xc(e,u,f,r))},[e,r,u,f]),N=R=>{!a.admin||R.rank===Zt.OWNER||(R.rank!==Zt.ADMIN?L(new fC(a.groupId,R.id)):L(new pC(a.groupId,R.id)),b())},T=R=>{!a.admin||R.rank!==Zt.REQUESTED||(L(new IC(a.groupId,R.id)),b())},y=R=>{if(a.admin){if(R.rank===Zt.REQUESTED){L(new EC(a.groupId,R.id)),b();return}p(R.name),L(new CC(a.groupId,R.id))}};return U(hC,R=>{const O=R.getParser();l(O),s(O.level),m(Math.ceil(O.totalMembersCount/O.pageSize))}),U(gC,R=>{const O=R.getParser();_(h(O.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[C,O.furnitureCount.toString()]),()=>{L(new rc(a.groupId,O.userId)),b()},null),p(null)}),o.useEffect(()=>{const R={linkReceived:O=>{const F=O.split("/");if(F.length<2)return;const D=parseInt(F[1])||-1,A=parseInt(F[2])||3;n(D),s(A),d(0)},eventUrlPrefix:"group-members/"};return pt(R),()=>It(R)},[]),o.useEffect(()=>{d(0)},[e,r,f]),o.useEffect(()=>{e===-1||r===-1||u===-1||L(new Xc(e,u,f,r))},[e,r,u,f]),o.useEffect(()=>{e!==-1&&(s(-1),l(null),m(0),I(""),p(null))},[e]),e===-1||!a?null:c(se,{className:"nitro-group-members",theme:"primary",children:[t(ae,{headerText:h("group.members.title",["groupName"],[a?a.groupTitle:""]),onCloseClick:R=>n(-1)}),c(re,{overflow:"hidden",children:[c(w,{gap:2,children:[t(w,{center:!0,className:"group-badge",children:t(We,{badgeCode:a.badge,isGroup:!0,className:"mx-auto d-block"})}),c(v,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:h("group.members.searchinfo"),value:f,onChange:R=>I(R.target.value)}),c("select",{className:"form-select form-select-sm w-100",value:r,onChange:R=>s(parseInt(R.target.value)),children:[t("option",{value:"0",children:h("group.members.search.all")}),t("option",{value:"1",children:h("group.members.search.admins")}),t("option",{value:"2",children:h("group.members.search.pending")})]})]})]}),t(ne,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:a.result.map((R,O)=>c(w,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[t("div",{className:"avatar-head cursor-pointer",onClick:()=>on(R.id),children:t(it,{figure:R.figure,headOnly:!0,direction:2})}),c(v,{grow:!0,gap:1,children:[t(S,{bold:!0,small:!0,pointer:!0,onClick:F=>on(R.id),children:R.name}),R.rank!==Zt.REQUESTED&&t(S,{small:!0,italics:!0,variant:"muted",children:h("group.members.since",["date"],[R.joinedAt])})]}),c(v,{gap:1,children:[R.rank!==Zt.REQUESTED&&t(w,{center:!0,children:t(P,{pointer:a.admin,className:`icon icon-group-small-${R.rank===Zt.OWNER?"owner":R.rank===Zt.ADMIN?"admin":a.admin&&R.rank===Zt.MEMBER?"not-admin":""}`,title:h(E(R)),onClick:F=>N(R)})}),a.admin&&R.rank===Zt.REQUESTED&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:h("group.members.accept"),onClick:F=>T(R)})}),a.admin&&R.rank!==Zt.OWNER&&R.id!==H().userId&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:h(R.rank===Zt.REQUESTED?"group.members.reject":"group.members.kick"),onClick:F=>y(R)})})]})]},O))}),c(w,{gap:1,justifyContent:"between",alignItems:"center",children:[t(M,{disabled:a.pageIndex===0,onClick:R=>d(O=>O-1),children:t(In,{className:"fa-icon"})}),t(S,{small:!0,children:h("group.members.pageinfo",["amount","page","totalPages"],[a.totalMembersCount.toString(),(a.pageIndex+1).toString(),g.toString()])}),t(M,{disabled:a.pageIndex===g-1,onClick:R=>d(O=>O+1),children:t(En,{className:"fa-icon"})})]})]})]})},oR=i=>{const[e,n]=o.useState(!1);return si(),U(_C,r=>{const s=r.getParser();n(!1),vn(s.roomId)}),o.useEffect(()=>{const r={linkReceived:s=>{const a=s.split("/");if(!(a.length<2))switch(a[1]){case"create":n(!0);return;case"manage":if(!a[2])return;n(!1),L(new bC(Number(a[2])));return}},eventUrlPrefix:"groups/"};return pt(r),()=>It(r)},[]),c(G,{children:[e&&t(Zw,{onClose:()=>n(!1)}),!e&&t(aR,{}),t(iR,{}),t(tR,{})]})},lR=i=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=i,r=s=>L(new NC(s));return c(v,{children:[c(v,{gap:0,className:"bg-muted p-2 rounded",children:[t(S,{bold:!0,children:h("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:h("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),c(v,{gap:1,children:[t(M,{variant:"success",onClick:s=>r(!0),children:h("guide.help.request.guide.accept.accept.button")}),t(M,{variant:"danger",onClick:s=>r(!1),children:h("guide.help.request.guide.accept.skip.link")})]})]})},cR=i=>{const{isOnDuty:e=!1,isHandlingGuideRequests:n=!1,setIsHandlingGuideRequests:r=null,isHandlingHelpRequests:s=!1,setIsHandlingHelpRequests:a=null,isHandlingBullyReports:l=!1,setIsHandlingBullyReports:u=null,guidesOnDuty:d=0,helpersOnDuty:g=0,guardiansOnDuty:m=0,processAction:f=null}=i;return c(v,{children:[c(w,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[t(P,{className:"duty-switch"+(e?"":" off"),onClick:I=>f("toggle_duty")}),c(v,{gap:0,children:[t(S,{bold:!0,children:h("guide.help.guide.tool.yourstatus")}),t(S,{children:h(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("guide.help.guide.tool.tickettypeselection.caption")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:n,onChange:I=>r(I.target.checked)}),t(S,{children:h("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:s,onChange:I=>a(I.target.checked)}),t(S,{children:h("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:l,onChange:I=>u(I.target.checked)}),t(S,{children:h("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),t("hr",{className:"bg-dark m-0"}),c(w,{center:!0,gap:2,children:[t(P,{className:"info-icon"}),c(v,{gap:1,children:[t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.guidesonduty",["amount"],[d.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.helpersonduty",["amount"],[g.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.guardiansonduty",["amount"],[m.toString()])}})]})]}),t("hr",{className:"bg-dark m-0"}),c(w,{justifyContent:"between",gap:2,children:[t(M,{disabled:!0,onClick:I=>f("forum_link"),children:h("guide.help.guide.tool.forum.link")}),t(M,{disabled:!0,children:h("guide.help.guide.tool.skill.link")})]})]})},uR=i=>{const e=o.useRef(null),{isGuide:n=!1,userId:r=0,userName:s=null,userFigure:a=null,isTyping:l=!1,messageGroups:u=[]}=i,[d,g]=o.useState("");o.useEffect(()=>{var E;(E=e.current)==null||E.scrollIntoView({block:"end",behavior:"smooth"})},[u]);const m=o.useCallback(()=>{L(new SC)},[]),f=o.useCallback(()=>{L(new vC)},[]),I=o.useCallback(()=>{L(new TC)},[]);U(wC,E=>{const b=E.getParser();vn(b.requesterRoomId)});const C=o.useCallback(()=>{!d||!d.length||(L(new RC(d)),g(""))},[d]),p=o.useCallback(E=>{E.key==="Enter"&&C()},[C]),_=o.useCallback(E=>E===H().userId,[]);return c(v,{fullHeight:!0,children:[c(w,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[n&&c(Lr,{children:[t(M,{onClick:m,children:h("guide.help.request.guide.ongoing.visit.button")}),t(M,{onClick:f,children:h("guide.help.request.guide.ongoing.invite.button")})]}),!n&&c(v,{gap:0,children:[t(S,{bold:!0,children:s}),t(S,{children:h("guide.help.request.user.ongoing.guide.desc")})]}),t(M,{variant:"danger",disabled:!0,children:h("guide.help.common.report.link")})]}),t(v,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:c(v,{overflow:"auto",children:[u.map((E,b)=>c(w,{fullWidth:!0,justifyContent:_(E.userId)?"end":"start",gap:2,children:[t(P,{shrink:!0,className:"message-avatar",children:!_(E.userId)&&t(it,{figure:a,direction:2})}),c(P,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(_(E.userId)?"right":"left"),children:[c(S,{bold:!0,children:[_(E.userId)&&H().userName,!_(E.userId)&&s]}),E.messages.map((N,T)=>t(P,{pointer:!!N.roomId,className:N.roomId?"text-break text-underline":"text-break",onClick:()=>N.roomId?vn(N.roomId):null,children:N.message},T))]}),_(E.userId)&&t(P,{className:"message-avatar flex-shrink-0",children:t(it,{figure:H().figure,direction:4})})]},b)),t("div",{ref:e})]})}),c(v,{gap:1,children:[c(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("guide.help.request.guide.ongoing.input.empty",["name"],[s]),value:d,onChange:E=>g(E.target.value),onKeyDown:p}),t(M,{variant:"success",onClick:C,children:h("widgets.chatinput.say")})]}),l&&t(S,{variant:"muted",children:h("guide.help.common.typing")})]}),t(M,{fullWidth:!0,variant:"success",onClick:I,children:h("guide.help.request."+(n?"guide":"user")+".ongoing.close.link")})]})},dR=15,mR=i=>{const{userRequest:e="",setUserRequest:n=null}=i,[r,s]=o.useState(!1),a=()=>{s(!0),L(new OC(1,e))};return c(v,{children:[t(S,{children:h("guide.help.request.user.create.help")}),t("textarea",{className:"request-message",maxLength:140,value:e,onChange:l=>n(l.target.value),placeholder:h("guide.help.request.user.create.input.help")}),t(M,{fullWidth:!0,variant:"success",disabled:e.length<dR||r,onClick:a,children:h("guide.help.request.user.create.input.button")})]})},hR=i=>{const{userName:e=null}=i,n=r=>L(new yC(r));return c(v,{children:[c(w,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[c(v,{gap:0,children:[t(S,{bold:!0,children:e}),t(S,{children:h("guide.help.request.user.feedback.guide.desc")})]}),t(M,{variant:"danger",disabled:!0,children:h("guide.help.common.report.link")})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("guide.help.request.user.feedback.closed.title")}),t(S,{children:h("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&c(G,{children:[t("hr",{className:"bg-dark m-0 mt-auto"}),c(v,{children:[t(S,{center:!0,bold:!0,children:h("guide.help.request.user.feedback.question")}),c(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:r=>n(!0),children:h("guide.help.request.user.feedback.positive.button")}),t(M,{fullWidth:!0,variant:"danger",onClick:r=>n(!1),children:h("guide.help.request.user.feedback.negative.button")})]})]})]})]})},gR=i=>c(v,{gap:1,children:[t(S,{bold:!0,children:h("guide.help.request.no_tour_guides.title")}),t(S,{children:h("guide.help.request.no_tour_guides.message")})]}),fR=i=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=i,r=()=>L(new kC);return c(v,{children:[c(v,{gap:0,className:"bg-muted rounded p-2",children:[t(S,{bold:!0,children:h("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:h("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("guide.help.request.user.pending.info.title")}),t(S,{children:h("guide.help.request.user.pending.info.message")}),t(S,{children:h("guide.help.request.user.pending.info.waiting",["waitingtime"],[n.toString()])})]}),t(M,{variant:"danger",onClick:r,children:h("guide.help.request.user.pending.cancel.button")})]})},pR=i=>t(v,{gap:1,children:t(S,{children:h("guide.help.request.user.guide.disconnected.error.desc")})}),IR=i=>c(v,{gap:1,children:[t(S,{bold:!0,children:h("guide.help.request.user.thanks.info.title")}),t(S,{children:h("guide.help.request.user.thanks.info.desc")})]}),ER=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(h("guide.help.guide.tool.title")),[a,l]=o.useState(!1),[u,d]=o.useState(ke.GUIDE_TOOL_MENU),[g,m]=o.useState(!1),[f,I]=o.useState(!1),[C,p]=o.useState(!1),[_,E]=o.useState(!1),[b,N]=o.useState(0),[T,y]=o.useState(0),[R,O]=o.useState(0),[F,D]=o.useState(""),[A,k]=o.useState(null),[x,B]=o.useState(0),[V,q]=o.useState(0),[Y,z]=o.useState(null),[de,ee]=o.useState(null),[Se,qe]=o.useState(!1),[dt,Ke]=o.useState([]),{simpleAlert:Vt=null}=je(),Fe=o.useCallback((De,fe)=>{switch(De){case ke.GUIDE_TOOL_MENU:s(h("guide.help.guide.tool.title")),l(!1);break;case ke.GUIDE_ACCEPT:s(h("guide.help.request.guide.accept.title")),l(!0);break;case ke.GUIDE_ONGOING:s(h("guide.help.request.guide.ongoing.title",["name"],[fe])),l(!0);break;case ke.USER_CREATE:s(h("guide.help.request.user.create.title")),l(!1);break;case ke.USER_PENDING:s(h("guide.help.request.user.pending.title")),l(!0);break;case ke.USER_ONGOING:s(h("guide.help.request.user.ongoing.title",["name"],[fe])),l(!0);break;case ke.USER_FEEDBACK:s(h("guide.help.request.user.feedback.title")),l(!0);break;case ke.USER_THANKS:s(h("guide.help.request.user.thanks.title")),l(!1);break;case ke.USER_NO_HELPERS:s(h("guide.help.request.no_tour_guides.heading")),l(!1);break;case ke.USER_SOMETHING_WRONG:s(h("guide.help.request.user.guide.disconnected.error.heading")),l(!1);break}d(De),n(!0)},[]),qt=o.useCallback(De=>{switch(De.type){case mn.SHOW_GUIDE_TOOL:n(!0);return;case mn.HIDE_GUIDE_TOOL:n(!1);return;case mn.TOGGLE_GUIDE_TOOL:n(fe=>!fe);return;case mn.CREATE_HELP_REQUEST:Fe(ke.USER_CREATE);return}},[Fe]);at(mn.SHOW_GUIDE_TOOL,qt),at(mn.HIDE_GUIDE_TOOL,qt),at(mn.TOGGLE_GUIDE_TOOL,qt),at(mn.CREATE_HELP_REQUEST,qt),U(ac,De=>{!De.getParser().isAllowed(sc.USE_GUIDE_TOOL)&&g&&(m(!1),L(new Qc(!1,!1,!1,!1)))}),U(AC,De=>{const fe=De.getParser();m(fe.onDuty),y(fe.guidesOnDuty),N(fe.helpersOnDuty),O(fe.guardiansOnDuty)}),U(DC,De=>{const fe=De.getParser();k(fe.helpRequestDescription),B(fe.roleSpecificWaitTime),fe.asGuide&&g&&Fe(ke.GUIDE_ACCEPT),fe.asGuide||Fe(ke.USER_PENDING)}),U(PC,De=>{const fe=De.getParser();g?(q(fe.requesterUserId),z(fe.requesterName),ee(fe.requesterFigure),Fe(ke.GUIDE_ONGOING,fe.requesterName)):(q(fe.guideUserId),z(fe.guideName),ee(fe.guideFigure),Fe(ke.USER_ONGOING,fe.guideName))}),U(LC,De=>{const fe=De.getParser();qe(fe.isTyping)}),U(MC,De=>{const fe=De.getParser(),Ge=[...dt];let wt=Ge[Ge.length-1];(!wt||wt.userId!==fe.senderId)&&(wt=new Iu(fe.senderId),Ge.push(wt)),wt.addChat(new pu(fe.chatMessage)),Ke(Ge)}),U(xC,De=>{const fe=De.getParser();if(fe.roomId!==0){const Ge=[...dt];let wt=Ge[Ge.length-1];const ue=g?H().userId:V;(!wt||wt.userId!==ue)&&(wt=new Iu(ue),Ge.push(wt)),wt.addChat(new pu(fe.roomName,fe.roomId)),Ke(Ge)}}),U(UC,De=>{g?(q(0),z(null),ee(null),qe(!1),Ke([]),Fe(ke.GUIDE_TOOL_MENU)):Fe(ke.USER_FEEDBACK)}),U(FC,De=>{switch(De.getParser().errorCode){case 0:Fe(ke.USER_SOMETHING_WRONG);break;case 1:case 2:Fe(ke.USER_NO_HELPERS);break}}),U(VC,De=>{q(0),z(null),ee(null),qe(!1),Ke([]),Fe(g?ke.GUIDE_TOOL_MENU:ke.USER_THANKS)}),o.useEffect(()=>{const De={linkReceived:fe=>{const Ge=fe.split("/");if(!(Ge.length<2))switch(Ge[1]){case"tour":return}},eventUrlPrefix:"help/"};return pt(De),()=>It(De)},[]);const wn=o.useCallback(De=>{switch(De){case"close":n(!1),D(""),d(ke.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!f&&!C&&!_){Vt(h("guide.help.guide.tool.noqueueselected.message"),null,null,null,h("guide.help.guide.tool.noqueueselected.caption"),null);return}m(Ge=>(L(new Qc(!Ge,Ge?!1:C,Ge?!1:_,Ge?!1:f)),!Ge));return;case"forum_link":const fe=X("group.homepage.url","").replace("%groupid%",X("guide.help.alpha.groupid","0"));window.open(fe);return}},[f,C,_,Vt]);return e?c(se,{className:"nitro-guide-tool",theme:"primary",children:[t(ae,{headerText:r,onCloseClick:De=>wn("close"),noCloseButton:a}),c(re,{className:"text-black",children:[u===ke.GUIDE_TOOL_MENU&&t(cR,{isOnDuty:g,isHandlingGuideRequests:C,setIsHandlingGuideRequests:p,isHandlingHelpRequests:_,setIsHandlingHelpRequests:E,isHandlingBullyReports:f,setIsHandlingBullyReports:I,guidesOnDuty:T,helpersOnDuty:b,guardiansOnDuty:R,processAction:wn}),u===ke.GUIDE_ACCEPT&&t(lR,{helpRequestDescription:A,helpRequestAverageTime:x}),[ke.GUIDE_ONGOING,ke.USER_ONGOING].includes(u)&&t(uR,{isGuide:g,userId:V,userName:Y,userFigure:de,isTyping:Se,messageGroups:dt}),u===ke.USER_CREATE&&t(mR,{userRequest:F,setUserRequest:D}),u===ke.USER_PENDING&&t(fR,{helpRequestDescription:A,helpRequestAverageTime:x}),u===ke.USER_FEEDBACK&&t(hR,{userName:Y}),u===ke.USER_THANKS&&t(IR,{}),u===ke.USER_NO_HELPERS&&t(gR,{}),u===ke.USER_SOMETHING_WRONG&&t(pR,{})]})]}):null},CR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,l]=o.useState(0),[u,d]=o.useState(null),{userFigure:g=null}=_r(),{purse:m=null,clubStatus:f=null}=es(),{badgeCodes:I=[],activate:C=null,deactivate:p=null}=Vo(),_=()=>m.clubDays<=0?h("purse.clubdays.zero.amount.text"):m.minutesUntilExpiration>-1&&m.minutesUntilExpiration<60*24?bn.shortFormat(m.minutesUntilExpiration*60):bn.shortFormat((m.clubPeriods*31+m.clubDays)*86400),E=()=>{switch(f){case ur.ACTIVE:return h(`hccenter.status.${f}.info`,["timeleft","joindate","streakduration"],[_(),r==null?void 0:r.firstSubscriptionDate,bn.shortFormat((r==null?void 0:r.currentHcStreak)*86400)]);case ur.EXPIRED:return h(`hccenter.status.${f}.info`,["joindate"],[r==null?void 0:r.firstSubscriptionDate]);default:return h(`hccenter.status.${f}.info`)}},b=()=>!r||r.timeUntilPayday<60?h("hccenter.special.time.soon"):bn.shortFormat(r.timeUntilPayday*60),N=()=>h("hccenter.special.sum",["credits"],[((r==null?void 0:r.creditRewardForStreakBonus)+(r==null?void 0:r.creditRewardForMonthlySpent)).toString()]);if(U(Kd,y=>{const R=y.getParser();l(R.giftsAvailable)}),U(GC,y=>{const R=y.getParser();s(R.data)}),o.useEffect(()=>{const y={linkReceived:R=>{const O=R.split("/");if(!(O.length<2))switch(O[1]){case"open":if(O.length>2)switch(O[2]){case"hccenter":n(!0);break}return}},eventUrlPrefix:"habboUI/"};return pt(y),()=>It(y)},[]),o.useEffect(()=>{d(SN(I))},[I]),o.useEffect(()=>{if(!e)return;const y=C();return()=>p(y)},[e,C,p]),o.useEffect(()=>{L(new Xd),L(new BC)},[]),!e)return null;const T=t(wl,{id:"popover-basic",children:c(wl.Body,{className:"text-black py-2 px-3",children:[t("h5",{children:h("hccenter.breakdown.title")}),t("div",{children:h("hccenter.breakdown.creditsspent",["credits"],[r==null?void 0:r.totalCreditsSpent.toString()])}),t("div",{children:h("hccenter.breakdown.paydayfactor.percent",["percent"],[((r==null?void 0:r.kickbackPercentage)*100).toString()])}),t("div",{children:h("hccenter.breakdown.streakbonus",["credits"],[r==null?void 0:r.creditRewardForStreakBonus.toString()])}),t("hr",{className:"w-100 text-black my-1"}),t("div",{children:h("hccenter.breakdown.total",["credits","actual"],[N(),(((r==null?void 0:r.kickbackPercentage)*(r==null?void 0:r.totalCreditsSpent)+(r==null?void 0:r.creditRewardForStreakBonus))*100/100).toString()])}),t("div",{className:"btn btn-link text-primary p-0",onClick:()=>Z("habbopages/"+X("hc.center")["payday.habbopage"]),children:h("hccenter.special.infolink")})]})});return c(se,{theme:"primary",className:"nitro-hc-center",children:[t(ae,{headerText:h("generic.hccenter"),onCloseClick:()=>n(!1)}),c(w,{position:"relative",className:"bg-muted p-2",children:[c(v,{gap:1,children:[t("div",{className:"hc-logo"}),t(w,{children:t(M,{variant:"success",onClick:y=>Z("catalog/open/"+X("catalog.links")["hc.buy_hc"]),children:h(f===ur.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),t(P,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:t(it,{figure:g,direction:4,scale:2})})]}),c(re,{children:[c(w,{gap:2,children:[t(We,{badgeCode:u,className:"align-self-center flex-shrink-0 me-1"}),c(v,{size:5,className:"streak-info",gap:0,children:[t(S,{children:h("hccenter.status."+f)}),t(S,{dangerouslySetInnerHTML:{__html:E()}})]})]}),X("hc.center")["payday.info"]&&c(w,{alignItems:"center",children:[c(v,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[t("h4",{className:"mb-1",children:h("hccenter.special.title")}),t("div",{children:h("hccenter.special.info")}),t("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>Z("habbopages/"+X("hc.center")["payday.habbopage"]),children:h("hccenter.special.infolink")})]}),c("div",{className:"payday flex-shrink-0 p-2",children:[t("h5",{className:"mb-2 ms-2",children:h("hccenter.special.time.title")}),c("div",{className:"d-flex flex-row mb-2",children:[t("div",{className:"clock me-2"}),t("h6",{className:"mb-0 align-self-center",children:b()})]}),f===ur.ACTIVE&&c("div",{className:"pe-3",children:[t("h5",{className:"ms-2 mb-1 bolder",children:h("hccenter.special.amount.title")}),c("div",{className:"d-flex flex-column",children:[t("div",{className:"w-100 text-center ms-4n",children:N()}),t(Jl,{trigger:["hover","focus"],placement:"left",overlay:T,children:t("div",{className:"btn btn-link align-self-end text-primary",children:h("hccenter.breakdown.infolink")})})]})]})]})]}),X("hc.center")["gift.info"]&&c("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[c("div",{children:[t("h4",{className:"mb-1",children:h("hccenter.gift.title")}),t("div",{dangerouslySetInnerHTML:{__html:a>0?h("hccenter.unclaimedgifts",["unclaimedgifts"],[a.toString()]):h("hccenter.gift.info")}})]}),t("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>Z("catalog/open/"+X("catalog.links")["hc.hc_gifts"]),children:h(f===ur.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),X("hc.center")["benefits.info"]&&c("div",{className:"benefits text-black py-2",children:[t("h5",{className:"mb-1 text-primary",children:h("hccenter.general.title")}),t("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:h("hccenter.general.info")}}),t("button",{className:"btn btn-link p-0 text-primary",onClick:()=>Z("habbopages/"+X("hc.center")["benefits.habbopage"]),children:h("hccenter.general.infolink")})]})]})]})},_R=i=>{const[e,n]=o.useState(""),{activeReport:r=null,setActiveReport:s=null}=Fn(),a=()=>{e.length<15||s(u=>{const d=jt.REPORT_SUMMARY;return{...u,message:e,currentStep:d}})},l=()=>{s(u=>({...u,currentStep:u.currentStep-1}))};return c(G,{children:[c(v,{gap:1,children:[t(S,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(S,{children:h("help.cfh.input.text")})]}),t("textarea",{className:"form-control h-100",value:e,onChange:u=>n(u.target.value)}),c(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",disabled:!(r.reportType===Je.BULLY||r.reportType===Je.EMERGENCY),onClick:l,children:h("generic.back")}),t(M,{disabled:e.length<15,onClick:a,children:h("help.emergency.main.submit.button")})]})]})},bR=i=>{const{setActiveReport:e=null}=Fn(),n=()=>{e(r=>{const s=jt.SELECT_USER,a=Je.BULLY;return{...r,currentStep:s,reportType:a}})};return c(G,{children:[c(v,{grow:!0,center:!0,gap:1,children:[t(S,{fontSize:3,children:h("help.main.frame.title")}),t(S,{children:h("help.main.self.description")})]}),c(v,{gap:1,children:[t(M,{onClick:n,children:h("help.main.bully.subtitle")}),t(M,{onClick:()=>Nt(new mn(mn.CREATE_HELP_REQUEST)),disabled:!X("guides.enabled"),children:h("help.main.help.title")}),t(M,{disabled:!0,children:h("help.main.self.tips.title")})]}),t(M,{variant:"link",textColor:"black",onClick:()=>L(new HC(!1)),children:h("help.main.my.sanction.status")})]})},NR=i=>{const{username:e="",onAction:n=null}=i,[r,s]=o.useState(!1),a=()=>{r||(s(!0),L(new jC(e)))};return U(WC,l=>{const u=l.getParser();u&&u.webId===H().userId&&n("close")}),c("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:h("tutorial.name_change.info.confirm")}),c("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[t("div",{children:h("tutorial.name_change.confirm")}),t("div",{className:"fw-bold",children:e})]}),c("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:r,onClick:a,children:h("generic.ok")}),t("button",{className:"btn btn-primary w-100",onClick:()=>n("close"),children:h("cancel")})]})]})},SR=i=>{const{onAction:e=null}=i;return c("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:h("tutorial.name_change.info.main")}),t("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:h("tutorial.name_change.current",["name"],[H().userName])}),c("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:h("tutorial.name_change.change")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",H().userName),children:h("tutorial.name_change.keep")})]})]})},vR=0,TR=2,wR=3,RR=4,OR=5,yR=6,kR=i=>{const{onAction:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(!1),[l,u]=o.useState(!1),[d,g]=o.useState(null),[m,f]=o.useState([]),I=()=>{n!==""&&(a(!1),f([]),g(null),u(!0),L(new YC(n)))},C=p=>{a(!1),f([]),g(null),r(p)};return U(qC,p=>{u(!1);const _=p.getParser();if(_)switch(_.resultCode){case vR:a(!0);break;case TR:g("short");break;case wR:g("long");break;case RR:g("invalid");break;case OR:f(_.nameSuggestions),g("taken");break;case yR:g("change_not_allowed")}}),c("div",{className:"d-flex flex-column gap-3 h-100",children:[t("div",{children:h("tutorial.name_change.info.select")}),c("div",{className:"d-flex gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:p=>C(p.target.value)}),t("button",{className:"btn btn-primary",disabled:n===""||l,onClick:I,children:h("tutorial.name_change.check")})]}),!d&&!s&&t("div",{className:"bg-muted rounded p-2 text-center",children:h("help.tutorial.name.info")}),d&&t("div",{className:"bg-danger rounded p-2 text-center text-white",children:h(`help.tutorial.name.${d}`,["name"],[n])}),s&&t("div",{className:"bg-success rounded p-2 text-center text-white",children:h("help.tutorial.name.available",["name"],[n])}),m&&t("div",{className:"d-flex flex-column gap-2",children:m.map((p,_)=>t("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>C(p),children:p},_))}),c("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:!s,onClick:()=>e("confirmation",n),children:h("tutorial.name_change.pick")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:h("cancel")})]})]})},Ri="INIT",al="INPUT",il="CONFIRMATION",AR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(Ri),[a,l]=o.useState(""),u=(g,m)=>{switch(g){case"start":s(al);break;case"confirmation":l(m),s(il);break;case"close":l(""),n(!1);break}},d=o.useMemo(()=>{switch(r){case Ri:return"tutorial.name_change.title.main";case al:return"tutorial.name_change.title.select";case il:return"tutorial.name_change.title.confirm"}},[r]);return at(qa.INIT,g=>{s(Ri),n(!0)}),e?c(se,{className:"nitro-change-username",theme:"primary",children:[t(ae,{headerText:h(d),onCloseClick:()=>u("close")}),c(re,{className:"text-black",children:[r===Ri&&t(SR,{onAction:u}),r===al&&t(kR,{onAction:u}),r===il&&t(NR,{username:a,onAction:u})]})]}):null},DR=i=>{const{activeReport:e=null,setActiveReport:n=null}=Fn(),r=()=>{const s=[];switch(e.reportType){case Je.BULLY:case Je.EMERGENCY:case Je.ROOM:{const a=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(l=>s.push(l.webId,l.message)),L(new QC(e.message,e.cfhTopic,e.reportedUserId,a,s));break}case Je.IM:e.reportedChats.forEach(a=>s.push(a.webId,a.message)),L(new XC(e.message,e.cfhTopic,e.reportedUserId,s));break;case Je.THREAD:L(new KC(e.groupId,e.threadId,e.cfhTopic,e.message));break;case Je.MESSAGE:L(new $C(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case Je.PHOTO:L(new zC(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}n(null)};return c(G,{children:[c(v,{gap:1,children:[t(S,{fontSize:4,children:h("help.cfh.button.send")}),t(S,{children:h("help.main.summary")})]}),t(M,{variant:"success",onClick:r,children:h("guide.help.request.emergency.submit.button")})]})},PR=i=>{const{sanctionInfo:e=null,setSanctionInfo:n=null}=Fn(),r=(s,a,l)=>{let u=`help.sanction.${s}`;switch(a){case"ALERT":u=u+".alert";break;case"MUTE":u=u+".mute";break;case"BAN_PERMANENT":u=u+".permban";break;default:if(u=u+".ban",l>24)return u=u+".days",h(u,["days"],[(l/24).toString()])}return h(u,["hours"],[l.toString()])};return e?c(se,{className:"nitro-help",theme:"primary",children:[t(ae,{headerText:h("help.sanction.info.title"),onCloseClick:()=>n(null)}),t(re,{className:"text-black",children:c(ne,{children:[t(v,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),c(v,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?t("div",{className:"col-12 fw-bold",children:h("help.sanction.current.none")}):c(G,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&t("div",{className:"col-12 fw-bold",children:h("help.sanction.probation.reminder")}),c("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[h("help.sanction.last.sanction")," ",r("current",e.sanctionName,e.sanctionLengthHours)]}),c("div",{className:"col-12",children:[h("generic.start.time")," ",e.sanctionCreationTime]}),c("div",{className:"col-12",children:[h("generic.reason")," ",e.sanctionReason]}),c("div",{className:"col-12",children:[h("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&t("div",{className:"col-12 fw-bold",children:h("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&c("div",{className:"col-12 fw-bold",children:[h("trade.locked.until")," ",e.tradeLockExpiryTime]}),t("div",{className:"col-12",children:r("next",e.nextSanctionName,e.nextSanctionLengthHours)}),t(M,{variant:"success",onClick:s=>n(null),children:h("habbo.way.ok.button")})]})]})})]}):null},LR=i=>{const[e,n]=o.useState([]),{activeReport:r=null,setActiveReport:s=null}=Fn(),{chatHistory:a=[],messengerHistory:l=[]}=xo(),u=o.useMemo(()=>{switch(r.reportType){case Je.BULLY:case Je.EMERGENCY:return a.filter(f=>f.type===$n.TYPE_CHAT&&f.webId===r.reportedUserId&&f.entityType===ut.USER);case Je.IM:return l.filter(f=>f.webId===r.reportedUserId&&f.type===$n.TYPE_IM)}return[]},[r,a,l]),d=f=>{n(I=>{const C=[...I],p=C.indexOf(f);return p>=0?C.splice(p,1):C.push(f),C})},g=()=>{!e||e.length<=0||s(f=>({...f,reportedChats:e,currentStep:jt.SELECT_TOPICS}))},m=()=>{s(f=>({...f,currentStep:f.currentStep-1}))};return c(G,{children:[c(v,{gap:1,children:[t(S,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(S,{children:h("help.emergency.chat_report.description")})]}),c(v,{gap:1,overflow:"hidden",children:[!u||!u.length&&t(S,{children:h("help.cfh.error.no_user_data")}),u.length>0&&t(ye,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:u.map((f,I)=>t(Ne,{onClick:C=>d(f),itemActive:e.indexOf(f)>=0,children:t(S,{children:f.message})},f.id))})]}),c(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:m,disabled:r.reportType===Je.IM,children:h("generic.back")}),t(M,{disabled:e.length<=0,onClick:g,children:h("help.emergency.main.submit.button")})]})]})},MR=i=>{const[e,n]=o.useState(-1),{chatHistory:r=[]}=xo(),{activeReport:s=null,setActiveReport:a=null}=Fn(),l=o.useMemo(()=>{const m=new Map;return r.forEach(f=>{f.type===$n.TYPE_CHAT&&f.entityType===ut.USER&&f.webId!==H().userId&&!m.has(f.webId)&&m.set(f.webId,{id:f.webId,username:f.name})}),Array.from(m.values())},[r]),u=m=>{m<=0||a(f=>({...f,reportedUserId:m,currentStep:jt.SELECT_CHATS}))},d=m=>{n(f=>m===f?-1:m)},g=()=>{a(m=>({...m,currentStep:m.currentStep-1}))};return c(G,{children:[c(v,{gap:1,children:[t(S,{fontSize:4,children:h("help.emergency.main.step.two.title")}),l.length>0&&t(S,{children:h("report.user.pick.user")})]}),c(v,{gap:1,overflow:"hidden",children:[!l.length&&t(S,{children:h("report.user.error.nolist")}),l.length>0&&t(ye,{columnCount:1,columnMinHeight:25,gap:1,children:l.map((m,f)=>t(Ne,{onClick:I=>d(m.id),itemActive:e===m.id,children:t("span",{dangerouslySetInnerHTML:{__html:m.username}})},m.id))})]}),c(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:g,children:h("generic.back")}),t(M,{disabled:e<=0,onClick:()=>u(e),children:h("help.emergency.main.submit.button")})]})]})},xR=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{setActiveReport:a=null}=Fn(),{cfhCategories:l=[]}=ia(),u=()=>{e<0||r<0||a(g=>({...g,cfhCategory:e,cfhTopic:l[e].topics[r].id,currentStep:jt.INPUT_REPORT_MESSAGE}))},d=()=>{a(g=>({...g,currentStep:g.currentStep-1}))};return c(G,{children:[c(v,{gap:1,children:[t(S,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(S,{children:h("help.cfh.pick.topic")})]}),c(v,{gap:1,overflow:"auto",children:[e<0&&l.map((g,m)=>t(M,{variant:"danger",onClick:f=>n(m),children:h(`help.cfh.reason.${g.name}`)},m)),e>=0&&l[e].topics.map((g,m)=>t(M,{variant:"danger",onClick:f=>s(m),active:r===m,children:h(`help.cfh.topic.${g.id}`)},m))]}),c(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:d,children:h("generic.back")}),t(M,{disabled:r<0,onClick:u,children:h("help.emergency.main.submit.button")})]})]})},UR=i=>{const[e,n]=o.useState(!1),{activeReport:r=null,setActiveReport:s=null,report:a=null}=Fn(),l=()=>{s(null),n(!1)};o.useEffect(()=>{const d={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return;case"tour":return;case"report":m.length>=5&&m[2]==="room"&&(parseInt(m[3]),unescape(m.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return pt(d),()=>It(d)},[]),o.useEffect(()=>{r&&n(!0)},[r]);const u=()=>{if(r)switch(r.currentStep){case jt.SELECT_USER:return t(MR,{});case jt.SELECT_CHATS:return t(LR,{});case jt.SELECT_TOPICS:return t(xR,{});case jt.INPUT_REPORT_MESSAGE:return t(_R,{});case jt.REPORT_SUMMARY:return t(DR,{})}return t(bR,{})};return c(G,{children:[e&&c(se,{className:"nitro-help",theme:"primary",children:[t(ae,{headerText:h("help.button.cfh"),onCloseClick:l}),t(re,{className:"text-black",children:c(ne,{children:[t(v,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),t(v,{justifyContent:"between",size:7,overflow:"hidden",children:t(u,{})})]})})]}),t(PR,{}),t(AR,{})]})},FR=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),[a,l]=o.useState(null),[u,d]=o.useState(null);return U(JC,g=>{const m=g.getParser();n(m.productType),s(m.productClassId),l(m.totalCoinsForBonus),d(m.coinsStillRequiredToBuy)}),o.useEffect(()=>{L(new ZC)},[]),e?c("div",{className:"bonus-rare widget d-flex",children:[e,c("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[t("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:a-u+"/"+a}),t("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(a-u)/a*100+"%"}})]})]}):null},VR=i=>{const{data:e=null,level:n=0}=i;return c("div",{className:"hof-user-container",children:[c("div",{className:"hof-tooltip",children:[c("div",{className:"hof-header",children:[n,". ",e.userName," ",t(xn,{userId:e.userId})]}),t("div",{className:"small text-center text-white",children:h("landing.view.competition.hof.points",["points"],[ta(e.currentScore).toString()])})]}),t(it,{figure:e.figure,direction:2})]})},GR=i=>{const{slot:e=-1,conf:n=null}=i,[r,s]=o.useState(null);return U(e_,a=>{const l=a.getParser();s(l.data)}),o.useEffect(()=>{const a=n?n.campaign:"";L(new t_(a))},[n]),r?t("div",{className:"hall-of-fame d-flex",children:r.hof&&r.hof.length>0&&r.hof.map((a,l)=>t(VR,{data:a,level:l+1},l))}):null},BR=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(0);return U(n_,a=>{const l=a.getParser();n(l.articles)}),o.useEffect(()=>{L(new r_)},[]),e?c("div",{className:"promo-articles widget mb-2",children:[c("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[t("small",{className:"flex-shrink-0 pe-1",children:h("landing.view.promo.article.header")}),t("hr",{className:"w-100 my-0"})]}),t("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((a,l)=>t("div",{className:"promo-articles-bullet cursor-pointer "+(a===e[r]?"promo-articles-bullet-active":""),onClick:u=>s(l)},a.id))}),e&&e[r]&&c("div",{className:"promo-article d-flex flex-row row mx-0",children:[t("div",{className:"promo-article-image",style:{backgroundImage:`url(${e[r].imageUrl})`}}),c("div",{className:"col-3 d-flex flex-column h-100",children:[t("h3",{className:"my-0",children:e[r].title}),t("b",{children:e[r].bodyText}),t("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:a=>Rs(e[r].linkContent),children:e[r].buttonText})]})]})]}):null},HR=i=>{const{conf:e=null}=i,n=r=>{const s=e[r];if(!s)return null;switch(r){case"image":return Ar.interpolate(s)}return s};return c("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[t("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${n("image")})`}}),c("div",{className:"d-flex flex-column align-self-center",children:[t("h3",{className:"my-0",children:h(`landing.view.${n("texts")}.header`)}),t("i",{children:h(`landing.view.${n("texts")}.body`)}),t("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:r=>Rs(n("btnLink")),children:h(`landing.view.${n("texts")}.button`)})]})]})},WR=i=>{switch(i.widgetType){case"promoarticle":return t(BR,{});case"achievementcompetition_hall_of_fame":return t(GR,{slot:i.slot,conf:i.widgetConf});case"bonusrare":return t(FR,{});case"widgetcontainer":return t(HR,{conf:i.widgetConf});default:return null}},us=i=>{const{widgetType:e=null,widgetSlot:n=0,widgetConf:r=null,className:s="",...a}=i;return t("div",{className:`widget-slot slot-${n} ${s||""}`,...a,children:t(WR,{widgetType:e,slot:n,widgetConf:r})})},jR=i=>{const[e,n]=o.useState(!0),{userFigure:r=null}=_r();if(Pe([Dt.CREATED,Dt.ENDED],f=>{switch(f.type){case Dt.CREATED:n(!1);return;case Dt.ENDED:n(f.openLandingView);return}}),!e)return null;const s=X("hotelview").images["background.colour"],a=Ar.interpolate(X("hotelview").images.background),l=Ar.interpolate(X("hotelview").images.sun),u=Ar.interpolate(X("hotelview").images.drape),d=Ar.interpolate(X("hotelview").images.left),g=Ar.interpolate(X("hotelview").images["right.repeat"]),m=Ar.interpolate(X("hotelview").images.right);return c("div",{className:"nitro-hotel-view",style:s&&s?{background:s}:{},children:[t("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:c("div",{className:"row h-100",children:[c("div",{className:"col-9 h-100 d-flex flex-column",children:[t(us,{widgetSlot:1,widgetType:X("hotelview").widgets["slot.1.widget"],widgetConf:X("hotelview").widgets["slot.1.conf"],className:"col-6"}),c("div",{className:"col-12 row mx-0",children:[t(us,{widgetSlot:2,widgetType:X("hotelview").widgets["slot.2.widget"],widgetConf:X("hotelview").widgets["slot.2.conf"],className:"col-7"}),t(us,{widgetSlot:3,widgetType:X("hotelview").widgets["slot.3.widget"],widgetConf:X("hotelview").widgets["slot.3.conf"],className:"col-5"}),t(us,{widgetSlot:4,widgetType:X("hotelview").widgets["slot.4.widget"],widgetConf:X("hotelview").widgets["slot.4.conf"],className:"col-7"}),t(us,{widgetSlot:5,widgetType:X("hotelview").widgets["slot.5.widget"],widgetConf:X("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),t(us,{widgetSlot:6,widgetType:X("hotelview").widgets["slot.6.widget"],widgetConf:X("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),t("div",{className:"col-3 h-100",children:t(us,{widgetSlot:7,widgetType:X("hotelview").widgets["slot.7.widget"],widgetConf:X("hotelview").widgets["slot.7.conf"]})})]})}),t("div",{className:"background position-absolute",style:a&&a.length?{backgroundImage:`url(${a})`}:{}}),t("div",{className:"sun position-absolute",style:l&&l.length?{backgroundImage:`url(${l})`}:{}}),t("div",{className:"drape position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),t("div",{className:"left position-absolute",style:d&&d.length?{backgroundImage:`url(${d})`}:{}}),t("div",{className:"right-repeat position-absolute",style:g&&g.length?{backgroundImage:`url(${g})`}:{}}),t("div",{className:"right position-absolute",style:m&&m.length?{backgroundImage:`url(${m})`}:{}}),X("hotelview")["show.avatar"]&&t("div",{className:"avatar-image",children:t(it,{figure:r,direction:2})})]})},Wu=i=>{const{badgeCode:e=null,children:n=null,...r}=i,{selectedBadgeCode:s=null,setSelectedBadgeCode:a=null,toggleBadge:l=null,getBadgeId:u=null}=Vo(),{isUnseen:d=null}=gn(),g=d(Ze.BADGE,u(e));return c(Ne,{itemActive:s===e,itemUnseen:g,onMouseDown:m=>a(e),onDoubleClick:m=>l(s),...r,children:[t(We,{badgeCode:e}),n]})},qR=i=>{const[e,n]=o.useState(!1),{badgeCodes:r=[],activeBadgeCodes:s=[],selectedBadgeCode:a=null,isWearingBadge:l=null,canWearBadges:u=null,toggleBadge:d=null,getBadgeId:g=null,activate:m=null,deactivate:f=null}=Vo(),{isUnseen:I=null,removeUnseen:C=null}=gn();return o.useEffect(()=>{!a||!I(Ze.BADGE,g(a))||C(Ze.BADGE,g(a))},[a,I,C,g]),o.useEffect(()=>{if(!e)return;const p=m();return()=>f(p)},[e,m,f]),o.useEffect(()=>(n(!0),()=>n(!1)),[]),c(ne,{children:[t(v,{size:7,overflow:"hidden",children:t(ye,{columnCount:4,children:r&&r.length>0&&r.map((p,_)=>l(p)?null:t(Wu,{badgeCode:p},_))})}),c(v,{className:"justify-content-between",size:5,overflow:"auto",children:[c(v,{overflow:"hidden",gap:2,children:[t(S,{children:h("inventory.badges.activebadges")}),t(ye,{columnCount:3,children:s&&s.length>0&&s.map((p,_)=>t(Wu,{badgeCode:p},_))})]}),!!a&&c(v,{grow:!0,justifyContent:"end",gap:2,children:[c(w,{alignItems:"center",gap:2,children:[t(We,{shrink:!0,badgeCode:a}),t(S,{children:Qa(a)})]}),t(M,{variant:l(a)?"danger":"success",disabled:!l(a)&&!u(),onClick:p=>d(a),children:h(l(a)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},Tc=i=>{const{title:e="",desc:n="",children:r=null,...s}=i;return c(ne,{...s,children:[t(v,{center:!0,size:5,overflow:"hidden",children:t("div",{className:"empty-image"})}),c(v,{justifyContent:"center",size:7,overflow:"hidden",children:[t(S,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:e}),t(S,{overflow:"auto",children:n})]}),r]})},YR=i=>{const{botItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(!1),{selectedBot:l=null,setSelectedBot:u=null}=ih(),{isUnseen:d=null}=gn(),g=d(Ze.BOT,e.botData.id),m=f=>{switch(f.type){case ve.MOUSE_DOWN:u(e),a(!0);return;case ve.MOUSE_UP:a(!1);return;case ve.ROLL_OUT:if(!s||l!==e)return;Ul(e);return;case"dblclick":Ul(e);return}};return c(Ne,{itemActive:l===e,itemUnseen:g,onMouseDown:m,onMouseUp:m,onMouseOut:m,onDoubleClick:m,...r,children:[t(it,{figure:e.botData.figure,direction:3,headOnly:!0}),n]})},zR=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),{botItems:a=[],selectedBot:l=null,activate:u=null,deactivate:d=null}=ih(),{isUnseen:g=null,removeUnseen:m=null}=gn();return o.useEffect(()=>{if(!l||!n)return;const f=l.botData,I=$();let C=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_WALL_TYPE),p=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_FLOOR_TYPE),_=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_LANDSCAPE_TYPE);C=C&&C.length?C:"101",p=p&&p.length?p:"101",_=_&&_.length?_:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(p,C,_),n.addAvatarIntoRoom(f.figure,0)},[n,l]),o.useEffect(()=>{!l||!g(Ze.BOT,l.botData.id)||m(Ze.BOT,l.botData.id)},[l,g,m]),o.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(Tc,{title:h("inventory.empty.bots.title"),desc:h("inventory.empty.bots.desc")}):c(ne,{children:[t(v,{size:7,overflow:"hidden",children:t(ye,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(YR,{botItem:f},f.botData.id))})}),c(v,{size:5,overflow:"auto",children:[t(v,{overflow:"hidden",position:"relative",children:t(Cc,{roomPreviewer:n,height:140})}),l&&c(v,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:l.botData.name}),!!e&&t(M,{variant:"success",onClick:f=>Ul(l),children:h("inventory.furni.placetoroom")})]})]})]})},$R=i=>{const{roomPreviewer:e=null,height:n=0,children:r=null}=i,[s,a]=o.useState(null),l=o.useRef(),u=d=>{e&&(d.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return o.useEffect(()=>{if(!e)return;const d=m=>{!e||!s||!l.current||(e.updatePreviewRoomView(),s.canvasUpdated&&(l.current.style.backgroundImage=`url(${Kn.generateImageUrl(s.master)})`))};if(!s&&l.current&&e){let f=document.defaultView.getComputedStyle(l.current,null).backgroundColor;f=rn.rgbStringToHex(f),f=f.replace("#","0x"),e.backgroundColor=parseInt(f,16);const I=l.current.parentElement.clientWidth;e.getRoomCanvas(I,n);const C=e.getRenderingCanvas();a(C),C.canvasUpdated=!0,d()}zn().add(d);const g=new ResizeObserver(()=>{if(!e||!l.current)return;const m=l.current.parentElement.offsetWidth;e.modifyRoomCanvas(m,n),d()});return g.observe(l.current),()=>{g.disconnect(),zn().remove(d)}},[s,e,l,n]),c("div",{className:"room-preview-container",children:[t("div",{ref:l,className:"room-preview-image",style:{height:"140px"},onClick:u}),r]})},KR=i=>{const{groupItem:e=null,...n}=i,[r,s]=o.useState(!1),{selectedItem:a=null,setSelectedItem:l=null}=ks(),u=g=>{switch(g.type){case ve.MOUSE_DOWN:l(e),s(!0);return;case ve.MOUSE_UP:s(!1);return;case ve.ROLL_OUT:if(!r||e!==a)return;ra(e);return;case"dblclick":ra(e);return}},d=e.getUnlockedCount();return t(Ne,{className:d?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===a,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...n})},ol="inventory.filter.option.everything",ju="inventory.furni.tab.floor",qu="inventory.furni.tab.wall",Yu="inventory.furni.tab.wired",XR=i=>{const e=i.getLastItem();if(!e||!e.sellable)return!1;Nt(new no(e))},QR=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),[a,l]=o.useState([]),{groupItems:u=[],selectedItem:d=null,activate:g=null,deactivate:m=null}=ks(),{resetItems:f=null}=gn(),[I,C]=o.useState(ol);return o.useEffect(()=>{const p=u.filter(_=>{const E=_.isWallItem,b=!E,N=_.name.startsWith("WIRED");switch(I){case qu:return E;case ju:return b;case Yu:return N;case ol:default:return!0}});l(p)},[u,I]),o.useEffect(()=>{if(!d||!n)return;const p=d.getLastItem();if(!p)return;const _=$();let E=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_WALL_TYPE),b=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_FLOOR_TYPE),N=_.getRoomInstanceVariable(_.activeRoomId,te.ROOM_LANDSCAPE_TYPE);if(E=E&&E.length?E:"101",b=b&&b.length?b:"101",N=N&&N.length?N:"1.1",n.reset(!1),n.updateObjectRoom(b,E,N),n.updateRoomWallsAndFloorVisibility(!0,!0),p.category===ce.WALL_PAPER||p.category===ce.FLOOR||p.category===ce.LANDSCAPE){if(b=p.category===ce.FLOOR?d.stuffData.getLegacyString():b,E=p.category===ce.WALL_PAPER?d.stuffData.getLegacyString():E,N=p.category===ce.LANDSCAPE?d.stuffData.getLegacyString():N,n.updateObjectRoom(b,E,N),p.category===ce.LANDSCAPE){const T=H().getWallItemDataByName("window_double_default");T&&n.addWallItemIntoRoom(T.id,new Tt(90,0,0),T.customParams)}}else d.isWallItem?n.addWallItemIntoRoom(d.type,new Tt(90),p.stuffData.getLegacyString()):n.addFurnitureIntoRoom(d.type,new Tt(90),d.stuffData,p.extra.toString())},[n,d]),o.useEffect(()=>{!d||!d.hasUnseenItems||(f(Ze.FURNI,d.items.map(p=>p.id)),d.hasUnseenItems=!1)},[d,f]),o.useEffect(()=>{if(!r)return;const p=g();return()=>m(p)},[r,g,m]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!u||!u.length?t(Tc,{title:h("inventory.empty.title"),desc:h("inventory.empty.desc")}):c(ne,{children:[t(v,{size:12,overflow:"hidden",children:t(w,{gap:2,alignItems:"center",style:{width:"100%"},children:t("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[ol,ju,qu,Yu].map((p,_)=>t("div",{onClick:()=>C(p),style:{flex:1,textAlign:"center",padding:"4px",border:"1px solid #000",cursor:"pointer",backgroundColor:I===p?"#eee":"#fff",fontFamily:"Volter",fontSize:"9px",borderTopLeftRadius:_===0?"4px":"0",borderBottomLeftRadius:_===0?"4px":"0",borderTopRightRadius:_===3?"4px":"0",borderBottomRightRadius:_===3?"4px":"0"},children:h(p)},p))})})}),t(v,{size:7,overflow:"hidden",children:t(ye,{columnCount:5,children:a&&a.length>0&&a.map((p,_)=>t(KR,{groupItem:p},_))})}),c(v,{size:5,overflow:"auto",children:[c(v,{overflow:"hidden",position:"relative",children:[t($R,{roomPreviewer:n,height:140}),d&&d.stuffData.isUnique&&t(Zm,{className:"top-2 end-2",position:"absolute",uniqueNumber:d.stuffData.uniqueNumber,uniqueSeries:d.stuffData.uniqueSeries}),d&&d.stuffData.rarityLevel>-1&&t(Ec,{className:"top-2 end-2",position:"absolute",level:d.stuffData.rarityLevel})]}),d&&c(v,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:d.name}),c(v,{gap:1,children:[!!e&&t(M,{variant:"success",onClick:p=>ra(d),children:h("inventory.furni.placetoroom")}),d&&d.isSellable&&t(M,{onClick:p=>XR(d),children:h("inventory.marketplace.sell")})]})]})]})]})},ll="inventory.filter.option.everything",zu="inventory.furni.tab.floor",$u="inventory.furni.tab.wall",Ku="inventory.furni.tab.wired",cl=9,JR=i=>{const{cancelTrade:e=null}=i,[n,r]=o.useState(null),[s,a]=o.useState(null),[l,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(3);o.useState(null);const[I,C]=o.useState(1),{ownUser:p=null,otherUser:_=null,groupItems:E=[],tradeState:b=_t.TRADING_STATE_READY,progressTrade:N=null,removeItem:T=null,setTradeState:y=null}=lh(),{simpleAlert:R=null}=je(),[O,F]=o.useState(ll);o.useEffect(()=>{const V=E.filter(q=>{const Y=q.isWallItem,z=!Y,de=q.name.startsWith("WIRED");switch(O){case $u:return Y;case zu:return z;case Ku:return de;case ll:default:return!0}});g(V)},[E,O]);const D=(V,q,Y,z,de)=>{if(!p||p.accepts||!p.userItems)return!1;if(p.userItems.length<cl)return!0;if(!z)return!1;let ee=q.toString();return Y===ce.POSTER?ee=ee+"poster"+de.getLegacyString():Y===ce.GUILD_FURNI?ee=rN(q,de):ee=(V?"I":"S")+ee,!!p.userItems.getValue(ee)},A=V=>{if(!n)return;const q=n.getTradeItems(V);if(!q||!q.length)return;let Y=null;const z=[];for(const ee of q)z.push(ee.id),Y||(Y=ee);if(p.userItems.length+z.length<=1500)if(!Y.isGroupable&&z.length)L(new Jc(z.pop()));else{const ee=[];for(const Se of z)D(Y.isWallItem,Y.type,Y.category,Y.isGroupable,Y.stuffData)&&ee.push(Se);ee.length&&(ee.length===1?L(new Jc(ee.pop())):L(new s_(...ee)))}else R(h("trading.items.too_many_items.desc"),me.DEFAULT,null,null,h("trading.items.too_many_items.title"))},k=V=>V?t(Ud,{className:"text-success fa-icon"}):t(eg,{className:"text-danger fa-icon"}),x=(V,q)=>{(isNaN(Number(V))||Number(V)<0||!V)&&(V=1),V=Math.max(Number(V),1),V=Math.min(Number(V),q),V!==I&&C(V)},B=V=>{x(I,V),A(I)};return o.useEffect(()=>{C(1)},[n]),o.useEffect(()=>{if(b!==_t.TRADING_STATE_COUNTDOWN)return;f(3);const V=setInterval(()=>{f(q=>{const Y=q-1;return Y===0&&clearInterval(V),Y})},1e3);return()=>clearInterval(V)},[b,y]),o.useEffect(()=>{m===0&&y(_t.TRADING_STATE_CONFIRMING)},[m,y]),b===_t.TRADING_STATE_READY||!p||!_?null:(o.useEffect(()=>{const V=document.createElement("style");return V.innerHTML=`
            .nitro-inventory {
                width: 390px;
                height: 575px;
            }
        `,document.head.appendChild(V),()=>{document.head.removeChild(V)}},[]),c(ne,{children:[c(v,{size:12,overflow:"hidden",children:[t(w,{gap:2,alignItems:"center",style:{width:"100%"},children:t("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[ll,zu,$u,Ku].map((V,q)=>t("div",{onClick:()=>F(V),style:{flex:1,textAlign:"center",padding:"4px",border:"1px solid #000",cursor:"pointer",backgroundColor:O===V?"#eee":"#fff",fontFamily:"Volter",fontSize:"9px",borderTopLeftRadius:q===0?"4px":"0",borderBottomLeftRadius:q===0?"4px":"0",borderTopRightRadius:q===3?"4px":"0",borderBottomRightRadius:q===3?"4px":"0"},children:h(V)},V))})}),c(w,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[t(ye,{columnCount:3,children:d&&d.length>0&&d.map((V,q)=>{const Y=V.getUnlockedCount();return t(Ne,{className:Y?"":"opacity-0-5 ",itemImage:V.iconUrl,itemCount:Y,itemActive:n===V,itemUniqueNumber:V.stuffData.uniqueNumber,onClick:z=>Y&&r(V),onDoubleClick:z=>A(1),children:Y>0&&n===V&&t(M,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:z=>A(1),children:t(En,{className:"fa-icon"})})},q)})}),c(v,{gap:1,alignItems:"center",fullWidth:!0,children:[c(ne,{overflow:"hidden",fullWidth:!0,children:[t(v,{size:6,overflow:"hidden",children:t("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:h("catalog.bundlewidget.spinner.select.amount"),disabled:!n,value:I,onChange:V=>C(V.target.valueAsNumber)})}),t(v,{size:6,overflow:"hidden",children:t(M,{variant:"secondary",disabled:!n,onClick:V=>B(n.getUnlockedCount()),children:h("inventory.trading.areoffering")})})]}),t(P,{fullWidth:!0,className:"badge bg-muted text-black",children:n?n.name:h("catalog_selectproduct")})]})]})]}),c(v,{size:12,overflow:"hidden",style:{padding:"10px",background:"#28546c"},children:[c(ne,{overflow:"hidden",children:[c(v,{size:6,overflow:"hidden",style:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[c(w,{justifyContent:"between",alignItems:"center",children:[c(S,{variant:"white",children:[h("inventory.trading.you")," ",h("inventory.trading.areoffering"),":"]}),k(p.accepts)]}),t(ye,{columnCount:3,children:Array.from(Array(cl),(V,q)=>{const Y=p.userItems.getWithIndex(q)||null;return Y?t(Ne,{itemActive:s===Y,itemImage:Y.iconUrl,itemCount:Y.getTotalCount(),itemUniqueNumber:Y.stuffData.uniqueNumber,onClick:z=>a(Y),onDoubleClick:z=>T(Y),children:s===Y&&t(M,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:z=>T(Y),children:t(In,{className:"fa-icon"})})},q):t(Ne,{},q)})}),t(P,{fullWidth:!0,className:"badge bg-muted text-black",children:s?s.name:h("catalog_selectproduct")})]}),c(v,{size:6,overflow:"hidden",style:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[c(w,{justifyContent:"between",alignItems:"center",children:[c(S,{variant:"white",children:[_.userName," ",h("inventory.trading.isoffering"),":"]}),k(_.accepts)]}),t(ye,{columnCount:3,children:Array.from(Array(cl),(V,q)=>{const Y=_.userItems.getWithIndex(q)||null;return Y?t(Ne,{itemActive:l===Y,itemImage:Y.iconUrl,itemCount:Y.getTotalCount(),itemUniqueNumber:Y.stuffData.uniqueNumber,onClick:z=>u(Y)},q):t(Ne,{},q)})}),t(P,{fullWidth:!0,className:"badge bg-muted w-100 text-black",children:l?l.name:h("catalog_selectproduct")})]})]}),c(w,{grow:!0,justifyContent:"between",children:[t(M,{variant:"danger",onClick:e,children:h("generic.cancel")}),b===_t.TRADING_STATE_READY&&t(M,{variant:"secondary",disabled:!p.itemCount&&!_.itemCount,onClick:N,children:h("inventory.trading.accept")}),b===_t.TRADING_STATE_RUNNING&&t(M,{variant:"secondary",disabled:!p.itemCount&&!_.itemCount,onClick:N,children:h(p.accepts?"inventory.trading.modify":"inventory.trading.accept")}),b===_t.TRADING_STATE_COUNTDOWN&&t(M,{variant:"secondary",disabled:!0,children:h("inventory.trading.countdown",["counter"],[m.toString()])}),b===_t.TRADING_STATE_CONFIRMING&&t(M,{variant:"secondary",onClick:N,children:h("inventory.trading.button.restore")}),b===_t.TRADING_STATE_CONFIRMED&&t(M,{variant:"secondary",children:h("inventory.trading.info.waiting")})]})]})]}))},ZR=i=>{const{petItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(!1),{selectedPet:l=null,setSelectedPet:u=null}=oh(),{isUnseen:d}=gn(),g=d(Ze.PET,e.petData.id),m=f=>{switch(f.type){case ve.MOUSE_DOWN:u(e),a(!0);return;case ve.MOUSE_UP:a(!1);return;case ve.ROLL_OUT:if(!s||e!==l)return;xl(e);return;case"dblclick":xl(e);return}};return c(Ne,{itemActive:e===l,itemUnseen:g,onMouseDown:m,onMouseUp:m,onMouseOut:m,onDoubleClick:m,...r,children:[t(mr,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),n]})},eO=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),{petItems:a=null,selectedPet:l=null,activate:u=null,deactivate:d=null}=oh(),{isUnseen:g=null,removeUnseen:m=null}=gn();return o.useEffect(()=>{if(!l||!n)return;const f=l.petData,I=$();let C=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_WALL_TYPE),p=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_FLOOR_TYPE),_=I.getRoomInstanceVariable(I.activeRoomId,te.ROOM_LANDSCAPE_TYPE);C=C&&C.length?C:"101",p=p&&p.length?p:"101",_=_&&_.length?_:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(p,C,_),n.addPetIntoRoom(f.figureString)},[n,l]),o.useEffect(()=>{!l||!g(Ze.PET,l.petData.id)||m(Ze.PET,l.petData.id)},[l,g,m]),o.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(Tc,{title:h("inventory.empty.pets.title"),desc:h("inventory.empty.pets.desc")}):c(ne,{children:[t(v,{size:7,overflow:"hidden",children:t(ye,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(ZR,{petItem:f},f.petData.id))})}),c(v,{size:5,overflow:"auto",children:[t(v,{overflow:"hidden",position:"relative",children:t(Cc,{roomPreviewer:n,height:140})}),l&&l.petData&&c(v,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:l.petData.name}),!!e&&t(M,{variant:"success",onClick:f=>xl(l),children:h("inventory.furni.placetoroom")})]})]})]})},Dh="inventory.furni",Ph="inventory.bots",Lh="inventory.furni.tab.pets",Mh="inventory.badges",Xu=[Dh,Ph,Lh,Mh],tO=[Ze.FURNI,Ze.BOT,Ze.PET,Ze.BADGE],nO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(Xu[0]),[a,l]=o.useState(null),[u,d]=o.useState(null),{isTrading:g=!1,stopTrading:m=null}=lh(),{getCount:f=null,resetCategory:I=null}=gn(),C=()=>{g&&m(),n(!1)};return Ee(ht.PLACED,p=>{Zb()&&(Ja(!1),p.placedInRoom||n(!0))}),Pe([Dt.CREATED,Dt.ENDED],p=>{switch(p.type){case Dt.CREATED:l(p.session);return;case Dt.ENDED:l(null),n(!1);return}}),U(a_,p=>{const _=p.getParser();for(const E of _.data)km().setBadgePointLimit(E.badgeId,E.limit)}),o.useEffect(()=>{const p={linkReceived:_=>{const E=_.split("/");if(!(E.length<2))switch(E[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return}},eventUrlPrefix:"inventory/"};return pt(p),()=>It(p)},[]),o.useEffect(()=>(d(new Bi($(),++Bi.PREVIEW_COUNTER)),()=>{d(p=>(p.dispose(),null))}),[]),o.useEffect(()=>{!e&&g&&n(!0)},[e,g]),e?c(se,{uniqueKey:"inventory",className:"nitro-inventory",theme:g?"primary":"",children:[t(ae,{headerText:h("inventory.title"),onCloseClick:C}),!g&&c(G,{children:[t(Zr,{justifyContent:"start",children:Xu.map((p,_)=>t(Ir,{isActive:r===p,onClick:E=>s(p),count:f(tO[_]),children:h(p)},_))}),c(re,{children:[r===Dh&&t(QR,{roomSession:a,roomPreviewer:u}),r===Ph&&t(zR,{roomSession:a,roomPreviewer:u}),r===Lh&&t(eO,{roomSession:a,roomPreviewer:u}),r===Mh&&t(qR,{})]})]}),g&&t(re,{children:t(JR,{cancelTrade:C})})]}):null},wc=i=>{const{records:e=null}=i,{openRoomInfo:n=null}=ia(),r=o.useMemo(()=>{const a=[];return e.forEach(l=>{a.push({isRoomInfo:!0,roomId:l.roomId,roomName:l.roomName}),l.chatlog.forEach(u=>{a.push({timestamp:u.timestamp,habboId:u.userId,username:u.userName,hasHighlighting:u.hasHighlighting,message:u.message,isRoomInfo:!1})})}),a},[e]),s=a=>c(w,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[c(w,{gap:1,children:[t(S,{bold:!0,children:"Room name:"}),t(S,{children:a.roomName})]}),c(w,{gap:1,children:[t(M,{onClick:l=>vn(a.roomId),children:"Visit Room"}),t(M,{onClick:l=>n(a.roomId),children:"Room Tools"})]})]});return t(G,{children:c(v,{fit:!0,gap:0,overflow:"hidden",children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-3",children:"User"}),t(P,{className:"g-col-7",children:"Message"})]})}),e&&e.length>0&&t(Lo,{rows:r,rowRender:a=>c(G,{children:[a.isRoomInfo&&t(s,{roomId:a.roomId,roomName:a.roomName}),!a.isRoomInfo&&c(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[t(S,{className:"g-col-2",children:a.timestamp}),t(S,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:l=>Z(`mod-tools/open-user-info/${a.habboId}`),children:a.username}),t(S,{textBreak:!0,wrap:!0,className:"g-col-7",children:a.message})]})]})})]})})},rO=i=>{const{roomId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null);return U(i_,a=>{const l=a.getParser();!l||l.data.roomId!==e||s(l.data)}),o.useEffect(()=>{L(new o_(e))},[e]),r?c(se,{className:"nitro-mod-tools-chatlog",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:`Room Chatlog ${r.roomName}`,onCloseClick:n}),t(re,{className:"text-black",overflow:"hidden",children:r&&t(wc,{records:[r]})})]}):null},sO=i=>{const{roomId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(!1),[a,l]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,I]=o.useState(null),[C,p]=o.useState(!1),[_,E]=o.useState(0),[b,N]=o.useState(!1),[T,y]=o.useState(!1),[R,O]=o.useState(!1),[F,D]=o.useState(""),A=(k,x)=>{if(k)switch(k){case"alert_only":if(F.trim().length===0)return;L(new ci(ci.ACTION_ALERT,F,"")),L(new Zc(e,T?1:0,R?1:0,b?1:0));return;case"send_message":if(F.trim().length===0)return;L(new ci(ci.ACTION_MESSAGE,F,"")),L(new Zc(e,T?1:0,R?1:0,b?1:0));return}};return U(l_,k=>{const x=k.getParser();!x||x.data.flatId!==e||(l(x.data.flatId),d(x.data.room.name),m(x.data.ownerId),I(x.data.ownerName),p(x.data.ownerInRoom),E(x.data.userCount))}),o.useEffect(()=>{r||(L(new c_(e)),s(!0))},[e,r,s]),c(se,{className:"nitro-mod-tools-room",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:"Room Info"+(u?": "+u:""),onCloseClick:k=>n()}),c(re,{className:"text-black",children:[c(w,{gap:2,children:[c(v,{justifyContent:"center",grow:!0,gap:1,children:[c(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Room Owner:"}),t(S,{underline:!0,pointer:!0,truncate:!0,children:f})]}),c(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Users in room:"}),t(S,{children:_})]}),c(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Owner in room:"}),t(S,{children:C?"Yes":"No"})]})]}),c(v,{gap:1,children:[t(M,{onClick:k=>vn(e),children:"Visit Room"}),t(M,{onClick:k=>Z(`mod-tools/open-room-chatlog/${e}`),children:"Chatlog"})]})]}),c(v,{className:"bg-muted rounded p-2",gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:b,onChange:k=>N(k.target.checked)}),t(S,{small:!0,children:"Kick everyone out"})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:T,onChange:k=>y(k.target.checked)}),t(S,{small:!0,children:"Enable the doorbell"})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:R,onChange:k=>O(k.target.checked)}),t(S,{small:!0,children:"Change room name"})]})]}),t("textarea",{className:"form-control",placeholder:"Type a mandatory message to the users in this text box...",value:F,onChange:k=>D(k.target.value)}),c(w,{justifyContent:"between",children:[t(M,{variant:"danger",onClick:k=>A("send_message"),children:"Send Caution"}),t(M,{onClick:k=>A("alert_only"),children:"Send Alert only"})]})]})]})},aO=i=>{const{onCloseClick:e=null,issueId:n=null}=i,[r,s]=o.useState(null);return U(u_,a=>{const l=a.getParser();!l||l.data.issueId!==n||s(l.data)}),o.useEffect(()=>{L(new d_(n))},[n]),c(se,{className:"nitro-mod-tools-chatlog",theme:"primary",children:[t(ae,{headerText:"Issue Chatlog",onCloseClick:e}),t(re,{className:"text-black",children:r&&t(wc,{records:[r.chatRecord]})})]})},iO=i=>{const{issueId:e=null,onIssueInfoClosed:n=null}=i,[r,s]=o.useState(!1),{tickets:a=[],openUserInfo:l=null}=ia(),u=a.find(m=>m.issueId===e),d=m=>{L(new fm([m])),n(m)},g=m=>{L(new ui([e],m)),n(e)};return c(G,{children:[c(se,{className:"nitro-mod-tools-handle-issue",theme:"primary",children:[t(ae,{headerText:"Resolving issue "+e,onCloseClick:()=>n(e)}),c(re,{className:"text-black",children:[t(S,{fontSize:4,children:"Issue Information"}),c(ne,{overflow:"auto",children:[t(v,{size:8,children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:c("tbody",{children:[c("tr",{children:[t("th",{children:"Source"}),t("td",{children:TN(u.categoryId)})]}),c("tr",{children:[t("th",{children:"Category"}),t("td",{className:"text-break",children:h("help.cfh.topic."+u.reportedCategoryId)})]}),c("tr",{children:[t("th",{children:"Description"}),t("td",{className:"text-break",children:u.message})]}),c("tr",{children:[t("th",{children:"Caller"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:m=>l(u.reporterUserId),children:u.reporterUserName})})]}),c("tr",{children:[t("th",{children:"Reported User"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:m=>l(u.reportedUserId),children:u.reportedUserName})})]})]})})}),c(v,{size:4,gap:1,children:[t(M,{variant:"secondary",onClick:()=>s(!r),children:"Chatlog"}),t(M,{onClick:m=>g(ui.RESOLUTION_USELESS),children:"Close as useless"}),t(M,{variant:"danger",onClick:m=>g(ui.RESOLUTION_ABUSIVE),children:"Close as abusive"}),t(M,{variant:"success",onClick:m=>g(ui.RESOLUTION_RESOLVED),children:"Close as resolved"}),t(M,{variant:"secondary",onClick:m=>d(e),children:"Release"})]})]})]})]}),r&&t(aO,{issueId:e,onCloseClick:()=>s(!1)})]})},oO=i=>{const{myIssues:e=null,handleIssue:n=null}=i;return c(v,{gap:0,overflow:"hidden",children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-3",children:"Opened"}),t(P,{className:"g-col-2"}),t(P,{className:"g-col-2"})]})}),t(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(r=>c(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:r.categoryId}),t(P,{className:"g-col-3",children:r.reportedUserName}),t(P,{className:"g-col-3",children:new Date(Date.now()-r.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-2",children:t(M,{variant:"primary",onClick:s=>n(r.issueId),children:"Handle"})}),t(P,{className:"g-col-2",children:t(M,{variant:"danger",onClick:s=>L(new fm([r.issueId])),children:"Release"})})]},r.issueId))})]})},lO=i=>{const{openIssues:e=null}=i;return c(v,{gap:0,overflow:"hidden",children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3"})]})}),t(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>c(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:t(M,{variant:"success",onClick:r=>L(new m_([n.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},n.issueId))})]})},cO=i=>{const{pickedIssues:e=null}=i;return c(v,{gap:0,overflow:"hidden",children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3",children:"Picker"})]})}),t(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>c(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:n.pickerUserName})]},n.issueId))})]})},uO=["Open Issues","My Issues","Picked Issues"],dO=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(0),[s,a]=o.useState([]),{tickets:l=[]}=ia(),u=l.filter(C=>C.state===Jo.STATE_OPEN),d=l.filter(C=>C.state===Jo.STATE_PICKED&&C.pickerUserId===H().userId),g=l.filter(C=>C.state===Jo.STATE_PICKED),m=C=>{a(p=>{const _=[...p],E=_.indexOf(C);return E>=0&&_.splice(E,1),_})},f=C=>{a(p=>{const _=[...p],E=_.indexOf(C);return E===-1?_.push(C):_.splice(E,1),_})},I=()=>{switch(n){case 0:return t(lO,{openIssues:u});case 1:return t(oO,{myIssues:d,handleIssue:f});case 2:return t(cO,{pickedIssues:g})}return null};return c(G,{children:[c(se,{className:"nitro-mod-tools-tickets",children:[t(ae,{headerText:"Tickets",onCloseClick:e}),t(Zr,{children:uO.map((C,p)=>t(Ir,{isActive:n===p,onClick:_=>r(p),children:C},p))}),t(re,{gap:1,children:t(I,{})})]}),s&&s.length>0&&s.map(C=>t(iO,{issueId:C,onIssueInfoClosed:m},C))]})},mO=i=>{const{userId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null),[a,l]=o.useState(null);return U(h_,u=>{const d=u.getParser();!d||d.data.userId!==e||(l(d.data.username),s(d.data.roomChatlogs))}),o.useEffect(()=>{L(new g_(e))},[e]),c(se,{className:"nitro-mod-tools-chatlog",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:`User Chatlog: ${a||""}`,onCloseClick:n}),t(re,{className:"text-black h-100",children:r&&t(wc,{records:r})})]})},Qu=[new xe(1,"Alert",xe.ALERT,1,0),new xe(2,"Mute 1h",xe.MUTE,2,0),new xe(3,"Ban 18h",xe.BAN,3,0),new xe(4,"Ban 7 days",xe.BAN,4,0),new xe(5,"Ban 30 days (step 1)",xe.BAN,5,0),new xe(7,"Ban 30 days (step 2)",xe.BAN,7,0),new xe(6,"Ban 100 years",xe.BAN,6,0),new xe(106,"Ban avatar-only 100 years",xe.BAN,6,0),new xe(101,"Kick",xe.KICK,0,0),new xe(102,"Lock trade 1 week",xe.TRADE_LOCK,0,168),new xe(104,"Lock trade permanent",xe.TRADE_LOCK,0,876e3),new xe(105,"Message",xe.MESSAGE,0,0)],hO=i=>{const{user:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(-1),[a,l]=o.useState(-1),[u,d]=o.useState(""),{cfhCategories:g=null,settings:m=null}=ia(),{simpleAlert:f=null}=je(),I=o.useMemo(()=>{const E=[];if(g&&g.length)for(const b of g)for(const N of b.topics)E.push(N);return E},[g]),C=E=>f(E,me.DEFAULT,null,null,"Error"),p=()=>{let E=null;const b=I[r];if(r===-1&&(E="You must select a CFH topic"),E)return C(E);const N=u.trim().length===0?h(`help.cfh.topic.${b.id}`):u;L(new f_(e.userId,r,N)),n()},_=()=>{let E=null;const b=I[r],N=Qu[a];if(r===-1||a===-1?E="You must select a CFH topic and Sanction":!m||!m.cfhPermission?E="You do not have permission to do this":b?N||(E="You must select a sanction"):E="You must select a CFH topic",E){C(E);return}const T=u.trim().length===0?h(`help.cfh.topic.${b.id}`):u;switch(N.actionType){case xe.ALERT:{if(!m.alertPermission){C("You have insufficient permissions");return}L(new __(e.userId,T,b.id));break}case xe.MUTE:L(new C_(e.userId,T,b.id));break;case xe.BAN:{if(!m.banPermission){C("You have insufficient permissions");return}L(new E_(e.userId,T,b.id,a,N.actionId===106));break}case xe.KICK:{if(!m.kickPermission){C("You have insufficient permissions");return}L(new I_(e.userId,T,b.id));break}case xe.TRADE_LOCK:{const y=N.actionLengthHours*60;L(new p_(e.userId,T,y,b.id));break}case xe.MESSAGE:{if(u.trim().length===0){C("Please write a message to user");return}L(new pm(e.userId,u,b.id));break}}n()};return e?c(se,{className:"nitro-mod-tools-user-action",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:"Mod Action: "+(e?e.username:""),onCloseClick:()=>n()}),c(re,{className:"text-black",children:[c("select",{className:"form-select form-select-sm",value:r,onChange:E=>s(parseInt(E.target.value)),children:[t("option",{value:-1,disabled:!0,children:"CFH Topic"}),I.map((E,b)=>t("option",{value:b,children:h("help.cfh.topic."+E.id)},b))]}),c("select",{className:"form-select form-select-sm",value:a,onChange:E=>l(parseInt(E.target.value)),children:[t("option",{value:-1,disabled:!0,children:"Sanction Type"}),Qu.map((E,b)=>t("option",{value:b,children:E.name},b))]}),c(v,{gap:1,children:[t(S,{small:!0,children:"Optional message type, overrides default"}),t("textarea",{className:"form-control",value:u,onChange:E=>d(E.target.value)})]}),c(w,{justifyContent:"between",gap:1,children:[t(M,{variant:"primary",onClick:p,children:"Default Sanction"}),t(M,{variant:"success",onClick:_,children:"Sanction"})]})]})]}):null},gO=i=>{const{userId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null);return U(b_,a=>{const l=a.getParser();l.data.userId===e&&s(l.data)}),o.useEffect(()=>{L(new N_(e))},[e]),e?c(se,{className:"nitro-mod-tools-user-visits",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:"User Visits",onCloseClick:n}),t(re,{className:"text-black",gap:1,children:c(v,{fullHeight:!0,gap:0,overflow:"hidden",children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-7",children:"Room name"}),t(P,{className:"g-col-3",children:"Visit"})]})}),t(Lo,{rows:(r==null?void 0:r.rooms)??[],rowRender:a=>c(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[c(S,{className:"g-col-2",children:[a.enterHour.toString().padStart(2,"0"),": ",a.enterMinute.toString().padStart(2,"0")]}),t(S,{className:"g-col-7",children:a.roomName}),t(S,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:l=>vn(a.roomId),children:"Visit Room"})]})})]})})]}):null},fO=i=>{const{user:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(""),{simpleAlert:a=null}=je();if(!e)return null;const l=()=>{if(r.trim().length===0){a("Please write a message to user.",null,null,null,"Error",null);return}L(new pm(e.userId,r,-999)),n()};return c(se,{className:"nitro-mod-tools-user-message",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:"Send Message",onCloseClick:()=>n()}),c(re,{className:"text-black",children:[c(S,{children:["Message To: ",e.username]}),t("textarea",{className:"form-control",value:r,onChange:u=>s(u.target.value)}),t(M,{fullWidth:!0,onClick:l,children:"Send message"})]})]})},pO=i=>{const{onCloseClick:e=null,userId:n=null}=i,[r,s]=o.useState(null),[a,l]=o.useState(!1),[u,d]=o.useState(!1),[g,m]=o.useState(!1),f=o.useMemo(()=>r?[{localeKey:"modtools.userinfo.userName",value:r.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:r.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:r.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:r.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:r.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:r.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:r.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:r.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:bn.format(r.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:r.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:r.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:r.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:bn.format(r.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:r.userClassification}]:null,[r]);return U(S_,I=>{const C=I.getParser();!C||C.data.userId!==n||s(C.data)}),o.useEffect(()=>{L(new v_(n))},[n]),r?c(G,{children:[c(se,{className:"nitro-mod-tools-user",theme:"primary",windowPosition:Ft.TOP_LEFT,children:[t(ae,{headerText:h("modtools.userinfo.title",["username"],[r.userName]),onCloseClick:()=>e()}),t(re,{className:"text-black",children:c(ne,{overflow:"hidden",children:[t(v,{size:8,overflow:"auto",children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:t("tbody",{children:f.map((I,C)=>c("tr",{children:[t("th",{scope:"row",children:h(I.localeKey)}),c("td",{children:[I.value,I.showOnline&&t("i",{className:`icon icon-pf-${r.online?"online":"offline"} ms-2`})]})]},C))})})}),c(v,{size:4,gap:1,children:[t(M,{onClick:I=>Z(`mod-tools/open-user-chatlog/${n}`),children:"Room Chat"}),t(M,{onClick:I=>l(!a),children:"Send Message"}),t(M,{onClick:I=>m(!g),children:"Room Visits"}),t(M,{onClick:I=>d(!u),children:"Mod Action"})]})]})})]}),a&&t(fO,{user:{userId:n,username:r.userName},onCloseClick:()=>l(!1)}),u&&t(hO,{user:{userId:n,username:r.userName},onCloseClick:()=>d(!1)}),g&&t(gO,{userId:n,onCloseClick:()=>m(!1)})]}):null},IO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(-1),[a,l]=o.useState(null),[u,d]=o.useState(!1),{openRooms:g=[],openRoomChatlogs:m=[],openUserChatlogs:f=[],openUserInfos:I=[],openRoomInfo:C=null,closeRoomInfo:p=null,toggleRoomInfo:_=null,openRoomChatlog:E=null,closeRoomChatlog:b=null,toggleRoomChatlog:N=null,openUserInfo:T=null,closeUserInfo:y=null,toggleUserInfo:R=null,openUserChatlog:O=null,closeUserChatlog:F=null,toggleUserChatlog:D=null}=ia(),A=o.useRef(null);return Ee([_n.INITIALIZED,_n.DISPOSED],k=>{if(!Is.isRoomPreviewerId(k.roomId))switch(k.type){case _n.INITIALIZED:s(k.roomId);return;case _n.DISPOSED:s(-1);return}}),bc(k=>{if(k.category!==Q.UNIT)return;const x=Te();if(!x)return;const B=x.userDataManager.getUserDataByIndex(k.id);!B||B.type!==ut.USER||l({userId:B.webID,username:B.name})}),o.useEffect(()=>{const k={linkReceived:x=>{const B=x.split("/");if(!(B.length<2))switch(B[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(V=>!V);return;case"open-room-info":C(Number(B[2]));return;case"close-room-info":p(Number(B[2]));return;case"toggle-room-info":_(Number(B[2]));return;case"open-room-chatlog":E(Number(B[2]));return;case"close-room-chatlog":b(Number(B[2]));return;case"toggle-room-chatlog":N(Number(B[2]));return;case"open-user-info":T(Number(B[2]));return;case"close-user-info":y(Number(B[2]));return;case"toggle-user-info":R(Number(B[2]));return;case"open-user-chatlog":O(Number(B[2]));return;case"close-user-chatlog":F(Number(B[2]));return;case"toggle-user-chatlog":D(Number(B[2]));return}},eventUrlPrefix:"mod-tools/"};return pt(k),()=>It(k)},[C,p,_,E,b,N,T,y,R,O,F,D]),c(G,{children:[e&&c(se,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:Ft.TOP_LEFT,theme:"primary",children:[t(ae,{headerText:"Mod Tools",onCloseClick:k=>n(!0)}),c(re,{className:"text-black",gap:1,children:[c(M,{gap:1,onClick:k=>Z(`mod-tools/toggle-room-info/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),c(M,{innerRef:A,gap:1,onClick:k=>Z(`mod-tools/toggle-room-chatlog/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),c(M,{gap:1,onClick:()=>Z(`mod-tools/toggle-user-info/${a.userId}`),disabled:!a,className:"position-relative",children:[t(P,{className:"icon icon-user position-absolute start-1"})," User: ",a?a.username:""]}),c(M,{gap:1,onClick:()=>d(k=>!k),className:"position-relative",children:[t(P,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]})]})]}),g.length>0&&g.map(k=>t(sO,{roomId:k,onCloseClick:()=>Z(`mod-tools/close-room-info/${k}`)},k)),m.length>0&&m.map(k=>t(rO,{roomId:k,onCloseClick:()=>Z(`mod-tools/close-room-chatlog/${k}`)},k)),I.length>0&&I.map(k=>t(pO,{userId:k,onCloseClick:()=>Z(`mod-tools/close-user-info/${k}`)},k)),f.length>0&&f.map(k=>t(mO,{userId:k,onCloseClick:()=>Z(`mod-tools/close-user-chatlog/${k}`)},k)),u&&t(dO,{onCloseClick:()=>d(!1)})]})},EO=[Ve.START_DOORBELL,Ve.STATE_WAITING,Ve.STATE_NO_ANSWER,Ve.START_PASSWORD,Ve.STATE_WRONG_PASSWORD],CO=[Ve.START_DOORBELL,Ve.STATE_WAITING,Ve.STATE_NO_ANSWER],_O=i=>{const[e,n]=o.useState(""),{doorData:r=null,setDoorData:s=null}=Qn(),a=()=>{r&&r.state===Ve.STATE_WAITING&&Ll(),s(null)},l=()=>{!r||!r.roomInfo||(Es(r.roomInfo.roomId),s(g=>{const m={...g};return m.state=Ve.STATE_PENDING_SERVER,m}))},u=()=>{!r||!r.roomInfo||(Es(r.roomInfo.roomId,e),s(g=>{const m={...g};return m.state=Ve.STATE_PENDING_SERVER,m}))};if(o.useEffect(()=>{!r||r.state!==Ve.STATE_NO_ANSWER||Ll()},[r]),!r||r.state===Ve.NONE||EO.indexOf(r.state)===-1)return null;const d=CO.indexOf(r.state)>=0;return c(se,{className:"nitro-navigator-doorbell",theme:"primary",children:[t(ae,{headerText:h(d?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:a}),c(re,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:r&&r.roomInfo&&r.roomInfo.roomName}),r.state===Ve.START_DOORBELL&&t(S,{children:h("navigator.doorbell.info")}),r.state===Ve.STATE_WAITING&&t(S,{children:h("navigator.doorbell.waiting")}),r.state===Ve.STATE_NO_ANSWER&&t(S,{children:h("navigator.doorbell.no.answer")}),r.state===Ve.START_PASSWORD&&t(S,{children:h("navigator.password.info")}),r.state===Ve.STATE_WRONG_PASSWORD&&t(S,{children:h("navigator.password.retryinfo")})]}),d&&c(v,{gap:1,children:[r.state===Ve.START_DOORBELL&&t(M,{variant:"success",onClick:l,children:h("navigator.doorbell.button.ring")}),t(M,{variant:"danger",onClick:a,children:h("generic.cancel")})]}),!d&&c(G,{children:[c(v,{gap:1,children:[t(S,{children:h("navigator.password.enter")}),t("input",{type:"password",className:"form-control form-control-sm",onChange:g=>n(g.target.value)})]}),c(v,{gap:1,children:[t(M,{variant:"success",onClick:u,children:h("navigator.password.button.try")}),t(M,{variant:"danger",onClick:a,children:h("generic.cancel")})]})]})]})]})},bO=i=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:l=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:g=!1,disabled:m=!1,center:f=!0,column:I=!0,style:C={},classNames:p=[],position:_="relative",overflow:E="hidden",children:b=null,...N}=i,T=o.useMemo(()=>{const R=["room-creator-grid-item"];return r&&R.push("active"),(l||u>0)&&R.push("unique-item"),l&&R.push("sold-out"),d&&R.push("unseen"),g&&R.push("has-highlight"),m&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),p.length&&R.push(...p),R},[r,l,u,d,g,m,e,p]),y=o.useMemo(()=>{let R={...C};return e&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(C).length&&(R={...R,...C}),R},[C,e,n]);return c(v,{center:f,pointer:!0,position:_,overflow:E,column:I,classNames:T,style:y,...N,children:[s>a&&t(Sn,{count:s}),u>0&&c(G,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Kr,{value:u})})]}),b]})},NO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),[a,l]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,I]=o.useState(0),[C,p]=o.useState([]),[_,E]=o.useState(""),{categories:b=null}=Qn(),N=X("hc.disabled",!1),T=O=>X("images.url")+`/navigator/models/model_${O}.png`,y=(O,F)=>{!O||O.clubLevel>Nn()||E(C[F].name)},R=()=>{L(new T_(r,a,"model_"+_,Number(u),Number(g),f))};return o.useEffect(()=>{if(!e){const O=[];for(let F=10;F<=100;F=F+10)O.push(F);n(O),m(O[0])}},[e]),o.useEffect(()=>{b&&b.length&&d(b[0].id)},[b]),o.useEffect(()=>{const O=X("navigator.room.models");O&&O.length&&(p(O),E(O[0].name))},[]),c(se,{className:"nitro-room-creator",theme:"primary",children:[t(ae,{headerText:h("navigator.createroom.title"),onCloseClick:O=>i.closeFunction()}),t(re,{children:t(v,{overflow:"hidden",children:c(ne,{overflow:"hidden",children:[t(v,{size:12,gap:1,overflow:"auto",children:t(ye,{className:"room-creator-grid",columnCount:12,columnMinWidth:137,columnMinHeight:50,overflow:"unset",children:C.map((O,F)=>c(bO,{fullHeight:!0,onClick:()=>y(O,F),itemActive:_===O.name,overflow:"unset",gap:0,className:"py-3",disabled:Nn()<O.clubLevel,children:[t(w,{fullHeight:!0,center:!0,overflow:"hidden",children:t("img",{alt:"",src:T(O.name)})}),c(S,{position:"absolute",className:"bottom-1",children:[t("i",{className:"icon icon-tiles "})," ",O.tileSize," ",h("navigator.createroom.tilesize")]}),!N&&O.clubLevel>sn.NO_CLUB&&t(st,{position:"absolute",className:"top-1 end-1",type:"hc"}),_&&t("i",{className:"active-arrow"})]},O.name))})}),c(v,{size:12,gap:1,overflow:"auto",className:"px-2 py-1",children:[c(v,{gap:1,children:[t(S,{className:"text-volter-bold",children:h("navigator.createroom.roomnameinfo")}),t("input",{type:"text",className:"room-creator-form",minLength:1,maxLength:60,onChange:O=>s(O.target.value),placeholder:h("navigator.createroom.roomnameinfo")})]}),c(w,{gap:2,children:[t(M,{fullWidth:!0,className:"volter-bold-button",onClick:R,disabled:!r||r.length<3,children:h("navigator.createroom.create")}),t(M,{fullWidth:!0,className:"volter-button",onClick:O=>i.closeFunction(),children:h("cancel")})]})]})]})})})]})},SO=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(!1),[s,a]=o.useState(!1),{report:l=null}=Fn(),{navigatorData:u=null}=Qn(),d=m=>{switch(m){case"settings":return H().userId===u.enteredGuestRoom.ownerId||H().isModerator;case"staff_pick":return H().securityLevel>=Hi.COMMUNITY;default:return!1}},g=(m,f)=>{if(!(!u||!u.enteredGuestRoom))switch(m){case"set_home_room":let I=-1;u.homeRoomId!==u.enteredGuestRoom.roomId&&(I=u.enteredGuestRoom.roomId),I>0&&L(new y_(I));return;case"navigator_search_tag":Z(`navigator/search/${f}`),L(new ic("hotel_view",`tag:${f}`));return;case"open_room_thumbnail_camera":Nt(new cr(cr.TOGGLE_THUMBNAIL));return;case"open_group_info":Za(u.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":Z("navigator/toggle-room-link");return;case"open_room_settings":L(new cm(u.enteredGuestRoom.roomId));return;case"toggle_pick":r(C=>!C),L(new O_(u.enteredGuestRoom.roomId));return;case"toggle_mute":a(C=>!C),L(new R_);return;case"room_filter":L(new w_(u.enteredGuestRoom.roomId));return;case"open_floorplan_editor":Z("floor-editor/toggle");return;case"report_room":l(Je.ROOM,{roomId:u.enteredGuestRoom.roomId,roomName:u.enteredGuestRoom.roomName});return;case"close":e();return}};return o.useEffect(()=>{u&&(r(u.currentRoomIsStaffPick),u.enteredGuestRoom&&a(u.enteredGuestRoom.allInRoomMuted))},[u]),u.enteredGuestRoom?c(se,{className:"nitro-room-info",theme:"primary",children:[t(ae,{headerText:h("navigator.roomsettings.roominfo"),onCloseClick:()=>g("close")}),t(re,{className:"text-black",children:u.enteredGuestRoom&&c(G,{children:[c(w,{gap:2,overflow:"hidden",children:[t(th,{roomId:u.enteredGuestRoom.roomId,customUrl:u.enteredGuestRoom.officialRoomPicRef,children:d("settings")&&t("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>g("open_room_thumbnail_camera")})}),c(v,{grow:!0,gap:1,overflow:"hidden",children:[c(w,{gap:1,children:[c(v,{grow:!0,gap:1,children:[c(w,{gap:1,children:[t("i",{onClick:()=>g("set_home_room"),className:Ts("flex-shrink-0 icon icon-house-small cursor-pointer",u.homeRoomId!==u.enteredGuestRoom.roomId&&"gray")}),t(S,{bold:!0,children:u.enteredGuestRoom.roomName})]}),u.enteredGuestRoom.showOwner&&c(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:h("navigator.roomownercaption")}),c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:u.enteredGuestRoom.ownerId}),t(S,{children:u.enteredGuestRoom.ownerName})]})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:h("navigator.roomrating")}),t(S,{children:u.currentRoomRating})]}),u.enteredGuestRoom.tags.length>0&&t(w,{alignItems:"center",gap:1,children:u.enteredGuestRoom.tags.map(m=>c(S,{pointer:!0,className:"bg-muted rounded p-1",onClick:f=>g("navigator_search_tag",m),children:["#",m]},m))})]}),c(v,{alignItems:"center",gap:1,children:[d("settings")&&t("i",{className:"icon icon-cog cursor-pointer",title:h("navigator.room.popup.info.room.settings"),onClick:m=>g("open_room_settings")}),t(tg,{title:h("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:m=>Z("navigator/toggle-room-link")})]})]}),t(S,{overflow:"auto",style:{maxHeight:50},children:u.enteredGuestRoom.description}),u.enteredGuestRoom.habboGroupId>0&&c(w,{pointer:!0,alignItems:"center",gap:1,onClick:()=>g("open_group_info"),children:[t(We,{className:"flex-none",badgeCode:u.enteredGuestRoom.groupBadgeCode,isGroup:!0}),t(S,{underline:!0,children:h("navigator.guildbase",["groupName"],[u.enteredGuestRoom.groupName])})]})]})]}),c(v,{gap:1,children:[d("staff_pick")&&t(M,{onClick:()=>g("toggle_pick"),children:h(n?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),t(M,{variant:"danger",onClick:()=>g("report_room"),children:h("help.emergency.main.report.room")}),d("settings")&&c(G,{children:[t(M,{onClick:()=>g("toggle_mute"),children:h(s?"navigator.muteall_on":"navigator.muteall_off")}),t(M,{onClick:()=>g("room_filter"),children:h("navigator.roomsettings.roomfilter")}),t(M,{onClick:()=>g("open_floorplan_editor"),children:h("open.floor.plan.editor")})]})]})]})})]}):null},vO=i=>{const{onCloseClick:e=null}=i,{navigatorData:n=null}=Qn();return n.enteredGuestRoom?c(se,{className:"nitro-room-link",theme:"primary",children:[t(ae,{headerText:h("navigator.embed.title"),onCloseClick:e}),t(re,{className:"text-black d-flex align-items-center",children:c(w,{gap:2,children:[t(th,{roomId:n.enteredGuestRoom.roomId,customUrl:n.enteredGuestRoom.officialRoomPicRef}),c(v,{children:[t(S,{bold:!0,fontSize:5,children:h("navigator.embed.headline")}),t(S,{children:h("navigator.embed.info")}),t("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:h("navigator.embed.src",["roomId"],[n.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",X("url.prefix",""))})]})]})})]}):null},TO=i=>{const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(""),[a,l]=o.useState(""),[u,d]=o.useState(!1),g=()=>{!u||r.length<=0||a.length<=0||r!==a||n("password",r)};return o.useEffect(()=>{s(""),l(""),d(!1)},[e]),c(G,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.roomaccess.caption")}),t(S,{children:h("navigator.roomsettings.roomaccess.info")})]}),c(v,{overflow:"auto",children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.doormode")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===ft.OPEN_STATE&&!u,onChange:m=>n("lock_state",ft.OPEN_STATE)}),t(S,{children:h("navigator.roomsettings.doormode.open")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===ft.DOORBELL_STATE&&!u,onChange:m=>n("lock_state",ft.DOORBELL_STATE)}),t(S,{children:h("navigator.roomsettings.doormode.doorbell")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===ft.INVISIBLE_STATE&&!u,onChange:m=>n("lock_state",ft.INVISIBLE_STATE)}),t(S,{children:h("navigator.roomsettings.doormode.invisible")})]}),c(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===ft.PASSWORD_STATE||u,onChange:m=>d(m.target.checked)}),!u&&e.lockState!==ft.PASSWORD_STATE&&t(S,{children:h("navigator.roomsettings.doormode.password")}),(u||e.lockState===ft.PASSWORD_STATE)&&c(v,{gap:1,children:[t(S,{children:h("navigator.roomsettings.doormode.password")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:r,onChange:m=>s(m.target.value),placeholder:h("navigator.roomsettings.password"),onFocus:m=>d(!0)}),u&&r.length<=0&&t(S,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.passwordismandatory")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:a,onChange:m=>l(m.target.value),onBlur:g,placeholder:h("navigator.roomsettings.passwordconfirm")}),u&&r.length>0&&r!==a&&t(S,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.invalidconfirm")})]})]})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.pets")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:m=>n("allow_pets",m.target.checked)}),t(S,{children:h("navigator.roomsettings.allowpets")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:m=>n("allow_pets_eat",m.target.checked)}),t(S,{children:h("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},Ju=3,Zu=60,ed=255,Oi=15,wO=i=>{const{roomData:e=null,handleChange:n=null,onClose:r=null}=i,[s,a]=o.useState(""),[l,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),[I,C]=o.useState(0),[p,_]=o.useState(""),{showConfirm:E=null}=je(),{categories:b=null}=Qn();U(k_,O=>{const F=O.getParser();if(F)switch(F.code){case eu.ERROR_INVALID_TAG:_("navigator.roomsettings.unacceptablewords");case eu.ERROR_NON_USER_CHOOSABLE_TAG:_("navigator.roomsettings.nonuserchoosabletag");break;default:_("");break}});const N=()=>{E(h("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{L(new A_(e.roomId)),r&&r(),Z("navigator/search/myworld_view")},null,null,null,h("navigator.roomsettings.deleteroom.confirm.title"))},T=()=>{s===e.roomName||s.length<Ju||s.length>Zu||n("name",s)},y=()=>{l===e.roomDescription||l.length>ed||n("description",l)},R=O=>{O===0&&d===e.tags[0]||d.length>Oi||O===1&&m===e.tags[1]||m.length>Oi||(d===""&&m!==""&&f(""),_(""),C(O),n("tags",d===""&&m!==""?[m]:[d,m]))};return o.useEffect(()=>{a(e.roomName),u(e.roomDescription),g(e.tags.length>0&&e.tags[0]?e.tags[0]:""),f(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),c(G,{children:[c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.roomname")}),c(v,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:s,maxLength:Zu,onChange:O=>a(O.target.value),onBlur:T}),s.length<Ju&&t(S,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.roomnameismandatory")})]})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.roomsettings.desc")}),t("textarea",{className:"form-control form-control-sm",value:l,maxLength:ed,onChange:O=>u(O.target.value),onBlur:y})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.category")}),t("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:O=>n("category",O.target.value),children:b&&b.map(O=>t("option",{value:O.id,children:h(O.name)},O.id))})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",value:e.userCount,onChange:O=>n("max_visitors",O.target.value),children:Eu&&Eu.map(O=>t("option",{value:O,children:O},O))})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.tradesettings")}),c("select",{className:"form-select form-select-sm",value:e.tradeState,onChange:O=>n("trade_state",O.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:h("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:h("navigator.roomsettings.trade_allowed")})]})]}),c(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:h("navigator.tags")}),c(v,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:d,onChange:O=>g(O.target.value),onBlur:()=>R(0)}),d.length>Oi&&t(S,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.toomanycharacters")}),I===0&&p!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:h(p)})]}),c(v,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:m,onChange:O=>f(O.target.value),onBlur:()=>R(1)}),m.length>Oi&&t(S,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.toomanycharacters")}),I===1&&p!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:h(p)})]})]}),c(w,{alignItems:"center",gap:1,children:[t(P,{className:"col-3"}),t("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,onChange:O=>n("allow_walkthrough",O.target.checked)}),t(S,{children:h("navigator.roomsettings.allow_walk_through")})]}),c(S,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:N,children:[t(Xn,{className:"fa-icon"}),h("navigator.roomsettings.delete")]})]})},RO=i=>{var d;const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(-1),[a,l]=o.useState([]),u=g=>{l(m=>{const f=[...m],I=f.findIndex(C=>C.userId===g);return I>=0&&f.splice(I,1),f}),L(new P_(g,e.roomId)),s(-1)};return U(D_,g=>{const m=g.getParser();!e||e.roomId!==m.roomId||l(m.bannedUsers)}),o.useEffect(()=>{L(new Im(e.roomId))},[e.roomId]),c(ne,{overflow:"auto",children:[c(v,{size:6,children:[c(S,{bold:!0,children:[h("navigator.roomsettings.moderation.banned.users")," (",a.length,")"]}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(v,{fullWidth:!0,overflow:"auto",gap:1,children:a&&a.length>0&&a.map((g,m)=>c(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(xn,{userName:g.userName}),c(S,{pointer:!0,grow:!0,onClick:f=>s(g.userId),children:[" ",g.userName]})]},m))})}),c(M,{disabled:r<=0,onClick:g=>u(r),children:[h("navigator.roomsettings.moderation.unban")," ",r>0&&((d=a.find(g=>g.userId===r))==null?void 0:d.userName)]})]}),c(v,{size:6,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.moderation.mute.header")}),t(w,{alignItems:"center",gap:1,children:c("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:g=>n("moderation_mute",g.target.value),children:[t("option",{value:jn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:jn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")})]})})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.moderation.kick.header")}),t(w,{alignItems:"center",gap:1,children:c("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:g=>n("moderation_kick",g.target.value),children:[t("option",{value:jn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:jn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")}),t("option",{value:jn.MODERATION_LEVEL_ALL,children:h("navigator.roomsettings.moderation.all")})]})})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.moderation.ban.header")}),t(w,{alignItems:"center",gap:1,children:c("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:g=>n("moderation_ban",g.target.value),children:[t("option",{value:jn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:jn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")})]})})]})]})]})},OO=i=>{const{roomData:e=null}=i,[n,r]=o.useState(new Map);return U(L_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(a.users)}),U(M_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(l=>{const u=new Map(l);return u.set(a.data.userId,a.data.userName),u})}),U(x_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(l=>{const u=new Map(l);return u.delete(a.userId),u})}),o.useEffect(()=>{L(new U_(e.roomId))},[e.roomId]),c(ne,{children:[c(v,{size:6,children:[t(S,{bold:!0,children:h("navigator.flatctrls.userswithrights",["displayed","total"],[n.size.toString(),n.size.toString()])}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(v,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(n.entries()).map(([s,a],l)=>c(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(xn,{userName:a}),c(S,{pointer:!0,grow:!0,onClick:u=>L(new F_(s)),children:[" ",a]})]},l))})})]}),t(v,{size:6,justifyContent:"end",children:t(M,{variant:"danger",disabled:!n.size,onClick:s=>L(new V_(e.roomId)),children:h("navigator.flatctrls.clear")})})]})},yO=i=>{const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(0);return o.useEffect(()=>{s(e.chatSettings.distance)},[e.chatSettings]),c(G,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.vip.caption")}),t(S,{children:h("navigator.roomsettings.vip.info")})]}),c(ne,{overflow:"auto",children:[c(v,{size:6,gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.chat_settings")}),t(S,{children:h("navigator.roomsettings.chat_settings.info")}),c("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:a=>n("bubble_mode",a.target.value),children:[t("option",{value:gt.CHAT_MODE_FREE_FLOW,children:h("navigator.roomsettings.chat.mode.free.flow")}),t("option",{value:gt.CHAT_MODE_LINE_BY_LINE,children:h("navigator.roomsettings.chat.mode.line.by.line")})]}),c("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:a=>n("chat_weight",a.target.value),children:[t("option",{value:gt.CHAT_BUBBLE_WIDTH_NORMAL,children:h("navigator.roomsettings.chat.bubbles.width.normal")}),t("option",{value:gt.CHAT_BUBBLE_WIDTH_THIN,children:h("navigator.roomsettings.chat.bubbles.width.thin")}),t("option",{value:gt.CHAT_BUBBLE_WIDTH_WIDE,children:h("navigator.roomsettings.chat.bubbles.width.wide")})]}),c("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:a=>n("bubble_speed",a.target.value),children:[t("option",{value:gt.CHAT_SCROLL_SPEED_FAST,children:h("navigator.roomsettings.chat.speed.fast")}),t("option",{value:gt.CHAT_SCROLL_SPEED_NORMAL,children:h("navigator.roomsettings.chat.speed.normal")}),t("option",{value:gt.CHAT_SCROLL_SPEED_SLOW,children:h("navigator.roomsettings.chat.speed.slow")})]}),c("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:a=>n("flood_protection",a.target.value),children:[t("option",{value:gt.FLOOD_FILTER_LOOSE,children:h("navigator.roomsettings.chat.flood.loose")}),t("option",{value:gt.FLOOD_FILTER_NORMAL,children:h("navigator.roomsettings.chat.flood.normal")}),t("option",{value:gt.FLOOD_FILTER_STRICT,children:h("navigator.roomsettings.chat.flood.strict")})]}),t(S,{children:h("navigator.roomsettings.chat_settings.hearing.distance")}),t("input",{type:"number",min:"0",className:"form-control form-control-sm",value:r,onChange:a=>s(a.target.valueAsNumber),onBlur:a=>n("chat_distance",r)})]}),c(v,{size:6,gap:1,children:[t(S,{bold:!0,children:h("navigator.roomsettings.vip_settings")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:a=>n("hide_walls",a.target.checked)}),t(S,{children:h("navigator.roomsettings.hide_walls")})]}),c("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:a=>n("wall_thickness",a.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:"1",children:h("navigator.roomsettings.wall_thickness.thick")}),t("option",{value:"-1",children:h("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:"-2",children:h("navigator.roomsettings.wall_thickness.thinnest")})]}),c("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:a=>n("floor_thickness",a.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:"1",children:h("navigator.roomsettings.floor_thickness.thick")}),t("option",{value:"-1",children:h("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:"-2",children:h("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},Vr=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],kO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(Vr[0]);U(G_,u=>{const d=u.getParser();if(!d)return;const g=d.data;n({roomId:g.roomId,roomName:g.name,roomDescription:g.description,categoryId:g.categoryId,userCount:g.maximumVisitorsLimit,tags:g.tags,tradeState:g.tradeMode,allowWalkthrough:g.allowWalkThrough,lockState:g.doorMode,password:null,allowPets:g.allowPets,allowPetsEat:g.allowFoodConsume,hideWalls:g.hideWalls,wallThickness:g.wallThickness,floorThickness:g.floorThickness,chatSettings:{mode:g.chatSettings.mode,weight:g.chatSettings.weight,speed:g.chatSettings.speed,distance:g.chatSettings.distance,protection:g.chatSettings.protection},moderationSettings:{allowMute:g.roomModerationSettings.allowMute,allowKick:g.roomModerationSettings.allowKick,allowBan:g.roomModerationSettings.allowBan}}),L(new Im(g.roomId))});const a=()=>{n(null),s(Vr[0])},l=(u,d)=>{n(g=>{const m={...g};switch(u){case"name":m.roomName=String(d);break;case"description":m.roomDescription=String(d);break;case"category":m.categoryId=Number(d);break;case"max_visitors":m.userCount=Number(d);break;case"trade_state":m.tradeState=Number(d);break;case"tags":m.tags=d;break;case"allow_walkthrough":m.allowWalkthrough=!!d;break;case"allow_pets":m.allowPets=!!d;break;case"allow_pets_eat":m.allowPetsEat=!!d;break;case"hide_walls":m.hideWalls=!!d;break;case"wall_thickness":m.wallThickness=Number(d);break;case"floor_thickness":m.floorThickness=Number(d);break;case"lock_state":m.lockState=Number(d);break;case"password":m.lockState=ft.PASSWORD_STATE,m.password=String(d);break;case"moderation_mute":m.moderationSettings.allowMute=Number(d);break;case"moderation_kick":m.moderationSettings.allowKick=Number(d);break;case"moderation_ban":m.moderationSettings.allowBan=Number(d);break;case"bubble_mode":m.chatSettings.mode=Number(d);break;case"chat_weight":m.chatSettings.weight=Number(d);break;case"bubble_speed":m.chatSettings.speed=Number(d);break;case"flood_protection":m.chatSettings.protection=Number(d);break;case"chat_distance":m.chatSettings.distance=Number(d);break}return L(new B_(m.roomId,m.roomName,m.roomDescription,m.lockState,m.password,m.userCount,m.categoryId,m.tags.length,m.tags,m.tradeState,m.allowPets,m.allowPetsEat,m.allowWalkthrough,m.hideWalls,m.wallThickness,m.floorThickness,m.moderationSettings.allowMute,m.moderationSettings.allowKick,m.moderationSettings.allowBan,m.chatSettings.mode,m.chatSettings.weight,m.chatSettings.speed,m.chatSettings.distance,m.chatSettings.protection)),m})};return e?c(se,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[t(ae,{headerText:h("navigator.roomsettings"),onCloseClick:a}),t(Zr,{children:Vr.map(u=>t(Ir,{isActive:r===u,onClick:d=>s(u),children:h(u)},u))}),c(re,{children:[r===Vr[0]&&t(wO,{roomData:e,handleChange:l,onClose:a}),r===Vr[1]&&t(TO,{roomData:e,handleChange:l}),r===Vr[2]&&t(OO,{roomData:e,handleChange:l}),r===Vr[3]&&t(yO,{roomData:e,handleChange:l}),r===Vr[4]&&t(RO,{roomData:e,handleChange:l})]})]}):null},td=i=>{const{roomData:e=null,children:n=null,thumbnail:r=!1,...s}=i,{setDoorData:a=null}=Qn(),l=()=>{const d=100*(e.userCount/e.maxUserCount);let g="bg-primary";return d>=92?g="bg-danger":d>=50?g="bg-warning":d>0&&(g="bg-success"),g},u=d=>{if(e.ownerId!==H().userId){if(e.habboGroupId!==0){vn(e.roomId);return}switch(e.doorMode){case ft.DOORBELL_STATE:a(g=>{const m={...g};return m.roomInfo=e,m.state=Ve.START_DOORBELL,m});return;case ft.PASSWORD_STATE:a(g=>{const m={...g};return m.roomInfo=e,m.state=Ve.START_PASSWORD,m});return}}Es(e.roomId)};return r?c(w,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:2,className:"navigator-item px-2 py-1 small",...s,children:[t(S,{truncate:!0,grow:!0,children:e.roomName}),c(w,{reverse:!0,alignItems:"center",gap:1,children:[e.habboGroupId>0&&t("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==ft.OPEN_STATE&&t("i",{className:"icon icon-navigator-room-"+(e.doorMode===ft.DOORBELL_STATE?"locked":e.doorMode===ft.PASSWORD_STATE?"password":e.doorMode===ft.INVISIBLE_STATE?"invisible":"")})]}),n,c(w,{center:!0,className:"badge p-1 "+l(),gap:1,children:[t(Mc,{className:"fa-icon"}),e.userCount]})]}):c(w,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:2,className:"navigator-item px-2 py-1 small",...s,children:[t(S,{truncate:!0,grow:!0,children:e.roomName}),c(w,{reverse:!0,alignItems:"center",gap:1,children:[e.habboGroupId>0&&t("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==ft.OPEN_STATE&&t("i",{className:"icon icon-navigator-room-"+(e.doorMode===ft.DOORBELL_STATE?"locked":e.doorMode===ft.PASSWORD_STATE?"password":e.doorMode===ft.INVISIBLE_STATE?"invisible":"")})]}),n,c(w,{center:!0,className:"badge p-1 "+l(),gap:1,children:[t(Mc,{className:"fa-icon"}),e.userCount]})]})},AO=i=>{const{searchResult:e=null,...n}=i,[r,s]=o.useState(!0),[a,l]=o.useState(0);Qn();const u=()=>{let g=e.code;return!g||!g.length||h("navigator.searchcode.title."+g)=="navigator.searchcode.title."+g?e.data:g.startsWith("${")?g.slice(2,g.length-1):"navigator.searchcode.title."+g};o.useEffect(()=>{e&&(s(!e.closed),l(e.mode))},[e]);const d=a>=Vl.THUMBNAILS;return c(v,{className:"",gap:0,children:[t(w,{fullWidth:!0,alignItems:"center",justifyContent:"between",style:{background:"#403c3c",paddingLeft:"10px",paddingTop:"3px",paddingBottom:"3px",borderRadius:"6px",marginBottom:"5px"},children:t(S,{variant:"white",children:h(u())})})," ",r&&t(G,{children:d?t(ye,{columnCount:1,gap:0,...n,columnMinWidth:110,columnMinHeight:130,className:"mx-0",children:e.rooms.length>0&&e.rooms.map((g,m)=>t(td,{roomData:g,thumbnail:!1},m))}):t(ne,{columnCount:1,className:"navigator-grid",gap:0,children:e.rooms.length>0&&e.rooms.map((g,m)=>t(td,{roomData:g},m))})})]})},DO=i=>{const{sendSearch:e=null}=i,[n,r]=o.useState(0),[s,a]=o.useState(""),{topLevelContext:l=null,searchResult:u=null}=Qn(),d=()=>{if(!l)return;let m=Ps[n];m||(m=Ps[0]);const f=(m.query?m.query+":":"")+s;e(f||"",l.code)},g=m=>{m.key==="Enter"&&d()};return o.useEffect(()=>{if(!u)return;const m=u.data.split(":");let f=null,I="";if(m.length>=2){const[C,...p]=m;f=Ps.find(_=>_.query===C),I=p.join(":")}else I=u.data;f||(f=Ps[0]),r(Ps.findIndex(C=>C===f)),a(I)},[u]),c(v,{fullWidth:!0,gap:1,children:[c(w,{style:{padding:5,background:"#c9c9c9"},className:"rounded",fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("navigator.filter.input.placeholder"),value:s,onChange:m=>a(m.target.value),onKeyDown:m=>g(m)}),t(M,{variant:"primary",onClick:d,children:"Suchen"})]}),t(w,{fullWidth:!0,shrink:!0,children:t("select",{className:"form-select form-select-sm w-100",value:n,onChange:m=>r(parseInt(m.target.value)),children:Ps.map((m,f)=>t("option",{value:f,children:h("navigator.filter."+m.name)},f))})})]})},PO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,l]=o.useState(!1),[u,d]=o.useState(!1),[g,m]=o.useState(!1),[f,I]=o.useState(!1),[C,p]=o.useState(!0),[_,E]=o.useState(!1),{searchResult:b=null,topLevelContext:N=null,topLevelContexts:T=null,navigatorData:y=null}=Qn(),R=o.useRef(null),O=o.useRef();Pe(Dt.CREATED,A=>{n(!1),l(!1)});const F=o.useCallback((A,k)=>{l(!1),L(new ic(k,A)),I(!0)},[]),D=o.useCallback(()=>{if(!r){E(!0);return}if(R.current){F(R.current.value,R.current.code),R.current=null;return}if(b){F(b.data,b.code);return}N&&F("",N.code)},[r,b,N,F]);return o.useEffect(()=>{const A={linkReceived:k=>{const x=k.split("/");if(!(x.length<2))switch(x[1]){case"show":{n(!0),E(!0);return}case"hide":n(!1);return;case"toggle":{if(e){n(!1);return}n(!0),E(!0);return}case"toggle-room-info":d(B=>!B);return;case"toggle-room-link":m(B=>!B);return;case"goto":if(x.length<=2)return;switch(x[2]){case"home":if(y.homeRoomId<=0)return;vn(y.homeRoomId);break;default:{const B=parseInt(x[2]);vn(B)}}return;case"create":n(!0),l(!0);return;case"search":if(x.length>2){const B=x[2];let V="";x.length>3&&(V=x[3]),R.current={value:V,code:B},n(!0),E(!0)}return}},eventUrlPrefix:"navigator/"};return pt(A),()=>It(A)},[e,y]),o.useEffect(()=>{b&&(I(!1),O&&O.current&&(O.current.scrollTop=0))},[b]),o.useEffect(()=>{!e||!r||!_||(D(),E(!1))},[e,r,_,D]),o.useEffect(()=>{r||!N||s(!0)},[r,N]),o.useEffect(()=>{!e||!C||(L(new H_),p(!1))},[e,C]),o.useEffect(()=>{La.addCallback(za.OPENROOM,(A,k=!1,x=null)=>L(new W_(A)))},[]),c(G,{children:[e&&c(se,{uniqueKey:"navigator",className:"nitro-navigator",children:[t(ae,{headerText:h(a?"navigator.createroom.title":"navigator.title"),onCloseClick:A=>n(!1)}),c(Zr,{children:[T&&T.length>0&&T.map((A,k)=>t(Ir,{isActive:N===A&&!a,onClick:x=>F("",A.code),children:h("navigator.toplevelview."+A.code)},k)),t(Ir,{isActive:a,onClick:A=>l(!0),children:t(wo,{className:"fa-icon"})})]}),c(re,{position:"relative",children:[f&&t(P,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!a&&c(G,{children:[t(DO,{sendSearch:F}),t(v,{grow:!0,innerRef:O,overflow:"auto",children:b&&b.results.map((A,k)=>t(AO,{searchResult:A},k))})]}),a&&t(NO,{closeFunction:()=>l(!1)}),!a&&c(v,{gap:0,children:[t(P,{style:{fontFamily:"UbuntuBold",fontWeight:"bold",fontSize:"13px"},children:"Staffempfehlung"}),t(w,{alignItems:"end",justifyContent:"end",position:"relative",className:"navBottomImage",children:t(w,{className:"navBottomImageDescription",children:"[AL] Questpark"})})]})]})]}),t(_O,{}),u&&t(SO,{onCloseClick:()=>d(!1)}),g&&t(vO,{onCloseClick:()=>m(!1)}),t(kO,{})]})},LO=/\n\r|\n|\r/mg,MO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(""),[a,l]=o.useState(null),u=o.useRef(null);return o.useEffect(()=>{const d=async m=>{try{const f=await fetch(m);if(!f)return;const C=(await f.text()).split(LO),p=C.shift().split("|");s(p[0]),l(_=>p[1]&&p[1].split(";").length===2?{width:parseInt(p[1].split(";")[0]),height:parseInt(p[1].split(";")[1])}:null),n(C.join(""))}catch{$d.error(`Failed to fetch ${m}`)}},g={linkReceived:m=>{const f=m.split("/");f.length<2||(f.shift(),d(X("habbopages.url")+f.join("/")))},eventUrlPrefix:"habbopages/"};return pt(g),()=>It(g)},[]),o.useEffect(()=>{const d=g=>{if(!(g.target instanceof HTMLAnchorElement))return;g.preventDefault();const m=g.target.href;!m||!m.length||Rs(m)};return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[]),e?c(se,{className:"nitropedia",theme:"primary",style:a?{width:a.width,height:a.height}:{},children:[t(ae,{headerText:r,onCloseClick:()=>n(null)}),t(re,{children:t(P,{fit:!0,innerRef:u,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},xO=i=>{const{offer:e=null,setOpen:n=null}=i;if(e)return c(Ic,{fadesOut:!1,onClose:null,onClick:r=>n(!0),gap:2,children:[t(P,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${X("image.library.url")+e.iconImageUrl})`}}),t(S,{variant:"light",className:"ubuntu-bold",children:e.title})]})},UO=i=>{const{offer:e=null,setOpen:n=null}=i,{getCurrencyAmount:r}=es(),[s,a]=o.useState(1),l=o.useMemo(()=>{let g=!1,m=!1,f=!1;return e.priceInCredits>0&&(g=r(-1)>=e.priceInCredits),e.priceInActivityPoints>0?m=r(e.activityPointType)>=e.priceInActivityPoints:m=!0,e.purchaseLimit>0&&(f=!0),g&&m&&f},[e,r]),u=()=>{let g=Math.max(0,(e.expirationTime-Date.now())/1e3);return bn.format(g)},d=()=>{L(new j_(e.id,s)),L(new Em)};if(e)return c(se,{theme:"primary",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[t(ae,{headerText:h(e.title),onCloseClick:g=>n(!1)}),t(Xm,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:h("targeted.offer.timeleft",["timeleft"],[u()])}),c(re,{gap:1,children:[c(w,{gap:1,fullHeight:!0,children:[c(w,{gap:1,column:!0,className:"w-75 text-black",children:[c(v,{className:"bg-warning p-2",fullHeight:!0,children:[t("h4",{children:h(e.title)}),t(P,{dangerouslySetInnerHTML:{__html:e.description}})]}),c(w,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&c(w,{gap:1,children:[t(S,{variant:"muted",children:h("catalog.bundlewidget.quantity")}),t("input",{type:"number",value:s,onChange:g=>a(parseInt(g.target.value)),min:1,max:e.purchaseLimit})]}),t(M,{variant:"primary",disabled:!l,onClick:()=>d(),children:h("targeted.offer.button.buy")})]})]}),t(P,{className:"w-50",fullHeight:!0,style:{background:`url(${X("image.library.url")+e.imageUrl}) no-repeat center`}})]}),c(w,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[t(S,{children:h("targeted.offer.price.label")}),e.priceInCredits>0&&c(w,{gap:1,children:[t(S,{variant:"light",children:e.priceInCredits}),t(st,{type:-1})]}),e.priceInActivityPoints>0&&c(w,{gap:1,children:[c(S,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",t(st,{type:e.activityPointType})]})]})]})]})},FO=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1);if(U(q_,s=>{let a=s.getParser();a&&e(a.data)}),hh(()=>{L(new Em)}),!!i)return t(G,{children:n?t(UO,{offer:i,setOpen:r}):t(xO,{offer:i,setOpen:r})})},VO=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(null),[a,l]=o.useState(!0),{showConfirm:u=null}=je();U(Cm,I=>{n(0),s(null)}),U(sm,I=>{n(0),s(null)}),U(Ka,I=>{const C=I.getParser();C.roomEnter&&(C.data.habboGroupId>0?(n(C.data.habboGroupId),L(new Pa(C.data.habboGroupId,!1))):(n(0),s(null)))}),U(Y_,I=>{const C=I.getParser();!r||C.groupId!==r.id&&C.groupId!==e||(n(0),s(null))}),U(Xa,I=>{const C=I.getParser();C.id===e&&s(C)});const d=()=>{u(h("group.leaveconfirm.desc"),()=>{L(new rc(r.id,H().userId))},null)},g=r&&r.ownerName===H().userName,m=()=>{if(g)return"group.manage";if(r.type===Cn.PRIVATE)return"";if(r.membershipType===yt.MEMBER)return"group.leave";if(r.membershipType===yt.NOT_MEMBER&&r.type===Cn.REGULAR)return"group.join";if(r.membershipType===yt.REQUEST_PENDING)return"group.membershippending";if(r.membershipType===yt.NOT_MEMBER&&r.type===Cn.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(g)return jm(r.id);if(!(r.type===Cn.PRIVATE&&r.membershipType===yt.NOT_MEMBER)){if(r.membershipType===yt.MEMBER){d();return}hc(r.id)}};return r?t(P,{className:"nitro-notification-bubble rounded",children:c(v,{children:[c(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:I=>l(C=>!C),children:[t(S,{variant:"white",children:h("group.homeroominfo.title")}),a&&t(Zl,{className:"fa-icon"}),!a&&t(ec,{className:"fa-icon"})]}),a&&c(G,{children:[c(w,{pointer:!0,alignItems:"center",gap:2,onClick:I=>Za(r.id),children:[t(P,{className:"group-badge",children:t(We,{badgeCode:r.badge,isGroup:!0})}),t(S,{variant:"white",children:r.title})]}),(r.type!==Cn.PRIVATE||g)&&t(M,{fullWidth:!0,variant:"success",disabled:r.membershipType===yt.REQUEST_PENDING,onClick:f,children:h(m())})]})]})}):null},GO=i=>{const{title:e="Nitro",onClose:n=null,...r}=i;return t(Po,{title:e,onClose:n,...r,children:c(ne,{children:[t(v,{center:!0,size:5,children:t("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:" "})}),c(v,{size:7,children:[c(v,{alignItems:"center",gap:0,children:[t(S,{bold:!0,fontSize:4,children:"Nitro React"}),c(S,{children:["v",Wm()]})]}),c(v,{alignItems:"center",children:[c(S,{children:[t("b",{children:"Renderer:"})," v",CN()]}),c(v,{fullWidth:!0,gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:s=>window.open("https://discord.nitrodev.co"),children:"Discord"}),c(w,{gap:1,children:[t(M,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),t(M,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]})})},BO=i=>{const{title:e="",onClose:n=null,classNames:r=[],children:s=null,type:a=me.DEFAULT,...l}=i,u=o.useMemo(()=>{const d=["nitro-alert"];return d.push("nitro-alert-modified-"+a),r.length&&d.push(...r),d},[r,a]);return c(se,{classNames:u,theme:"avatar-editor",...l,children:[t(fh,{headerText:e,onCloseClick:n}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black modifiedContentArea",gap:0,children:s})]})},HO=i=>{const{item:e=null,title:n=i.item&&i.item.title||"",onClose:r=null,...s}=i,[a,l]=o.useState(!1),u=()=>{Rs(e.clickUrl),r()};return e.alertType===me.DEFAULT?c(BO,{title:n,onClose:r,...s,type:me.DEFAULT,children:[t(w,{fullHeight:!0,overflow:"auto",gap:2,children:c(P,{className:"notification-default-view flex-shrink-0",children:[t("p",{id:"heading",children:"Wichtige Nachricht vom Hotelmanagament:"}),e.messages.length>0&&e.messages.map((g,m)=>{const f=g.replace(/\r\n|\r|\n/g,"<br />");return t(P,{id:"desc",dangerouslySetInnerHTML:{__html:f}},m)})]})}),c(v,{alignItems:"center",center:!0,gap:0,children:[t("hr",{className:"my-2 w-100"}),t(w,{onClick:r,className:"modifiedHotelButton",children:h("generic.close")})]})]}):c(Po,{title:n,onClose:r,...s,type:e.alertType,children:[c(w,{fullHeight:!0,overflow:"auto",gap:e.imageUrl&&!a?2:0,children:[e.imageUrl&&!a&&t("img",{src:e.imageUrl,alt:e.title,onError:()=>l(!0),className:"align-self-baseline"}),c(P,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((g,m)=>{const f=g.replace(/\r\n|\r|\n/g,"<br />");return t(P,{dangerouslySetInnerHTML:{__html:f}},m)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!a&&c(G,{children:[t("hr",{className:"my-2 w-100"}),t(M,{onClick:u,className:"align-self-center px-3",children:h(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&a)&&c(v,{alignItems:"center",center:!0,gap:0,children:[t("hr",{className:"my-2 w-100"}),!e.clickUrl&&t(M,{onClick:r,children:h("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(M,{onClick:u,children:h(e.clickUrlText)})]})]})},WO=i=>{const{item:e=null,title:n=i.item&&i.item.title||"",onClose:r=null,...s}=i,[a,l]=o.useState(""),[u,d]=o.useState([]),g=()=>{Rs(e.clickUrl),r()},m=I=>{let C=JSON.parse(e.messages[0]);d(C.filter(p=>p.includes(I))),l(I)};o.useEffect(()=>{d(JSON.parse(e.messages[0]))},[e]);const f=e.clickUrl&&e.clickUrl.startsWith("event:");return c(Po,{title:n,onClose:r,...s,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:a,onChange:I=>m(I.target.value)})}),t(v,{fullHeight:!0,className:"py-1",overflow:"hidden",children:t(ye,{gap:1,columnCount:1,children:u&&u.map((I,C)=>t("span",{children:I},C))})}),t("hr",{className:"my-2"}),c(v,{alignItems:"center",center:!0,gap:1,children:[!f&&!e.clickUrl&&t(M,{onClick:r,children:h("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(M,{onClick:g,children:h(e.clickUrlText)})]})]})},jO=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.alertType){case me.NITRO:return t(GO,{...n});case me.SEARCH:return t(WO,{...n});default:return t(HO,{...n})}},qO=i=>{const{item:e=null,onClose:n=null,...r}=i;return c(Ic,{fadesOut:!1,className:"flex-column club-gift",onClose:n,...r,children:[c("div",{className:"d-flex align-items-center gap-2 mb-2",children:[t(st,{type:"hc",className:"flex-shrink-0"}),t("span",{className:"ms-1",children:h("notifications.text.club_gift")})]}),c("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[t("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>Rs(e.linkUrl),children:h("notifications.button.show_gift_list")}),t("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:n,children:h("notifications.button.later")})]})]})},YO=i=>{const{item:e=null,onClose:n=null,...r}=i,s=e.message.replace(/\r\n|\r|\n/g,"<br />");return c(Ic,{onClose:n,gap:2,alignItems:"center",onClick:a=>e.linkUrl&&e.linkUrl.length&&Rs(e.linkUrl),...r,children:[t(w,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&t("img",{className:"no-select",src:e.iconUrl,alt:""})}),t(S,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:s}})]})},zO=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.notificationType){case Kt.CLUBGIFT:return t(qO,{...n});default:return t(YO,{...n})}},$O=i=>{const{item:e=null,onClose:n=null,...r}=i,{message:s=null,onConfirm:a=null,onCancel:l=null,confirmText:u=null,cancelText:d=null,title:g=null}=e,m=()=>{a&&a(),n()},f=()=>{l&&l(),n()};return c(Po,{title:g,onClose:n,...r,type:me.ALERT,children:[t(w,{grow:!0,center:!0,children:t(S,{children:s})}),c(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",onClick:f,children:d}),t(M,{fullWidth:!0,onClick:m,children:u})]})]})},KO=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.confirmType){default:return t($O,{...n})}},XO=i=>{const{alerts:e=[],bubbleAlerts:n=[],confirms:r=[],closeAlert:s=null,closeBubbleAlert:a=null,closeConfirm:l=null}=je(),u=o.useMemo(()=>{if(!e||!e.length)return null;const m=[];for(const f of e){const I=jO(f,()=>s(f));m.push(I)}return m},[e,s]),d=o.useMemo(()=>{if(!n||!n.length)return null;const m=[];for(const f of n){const I=zO(f,()=>a(f));if(f.notificationType===Kt.CLUBGIFT){m.unshift(I);continue}m.push(I)}return m},[n,a]),g=o.useMemo(()=>{if(!r||!r.length)return null;const m=[];for(const f of r){const I=KO(f,()=>l(f));m.push(I)}return m},[r,l]);return c(G,{children:[t(v,{gap:1,children:d}),g,u]})},nd=i=>{const{type:e=-1,amount:n=-1,short:r=!1}=i,s=o.useMemo(()=>c(w,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[t(S,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:r?zb(n):ta(n)}),t(st,{type:e})]}),[n,r,e]);return r?t(Jl,{placement:"left",overlay:t(Wd,{id:`tooltip-${e}`,children:ta(n)}),children:s}):s},QO=i=>{const{type:e=-1,amount:n=-1}=i;return c(w,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[t(S,{variant:"white",children:h(`purse.seasonal.currency.${e}`)}),c(w,{gap:1,children:[t(S,{variant:"white",children:ta(n)}),t(st,{type:e})]})]})},JO=i=>{const{purse:e=null,hcDisabled:n=!1}=es(),r=o.useMemo(()=>X("system.currency.types",[]),[]),s=o.useMemo(()=>X("currency.display.number.short",!1),[]),a=(()=>{if(!e)return null;const u=e.clubPeriods*31+e.clubDays,d=e.minutesUntilExpiration;return e.clubLevel===sn.NO_CLUB?h("purse.clubdays.zero.amount.text"):d>-1&&d<60*24?bn.shortFormat(d*60):bn.shortFormat(u*86400)})(),l=(u,d=-1,g=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const m=Array.from(e.activityPoints.keys()).filter(C=>r.indexOf(C)>=0);let f=0;for(;f<u;)m.shift(),f++;f=0;const I=[];for(const C of m){if(d>-1&&f===d)break;g?I.push(t(QO,{type:C,amount:e.activityPoints.get(C)},C)):I.push(t(nd,{type:C,amount:e.activityPoints.get(C),short:s},C)),f++}return I};return e?c(v,{alignItems:"end",className:"nitro-purse-container d-block d-sm-none",gap:1,children:[t(w,{className:"nitro-purse rounded-bottom p-1",children:c(ne,{fullWidth:!0,gap:1,children:[c(v,{justifyContent:"center",size:n?10:6,gap:0,children:[t(nd,{type:-1,amount:e.credits,short:s}),l(0,2)]}),!n&&c(v,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:u=>Z("habboUI/open/hccenter"),children:[t(st,{type:"hc"}),t(S,{variant:"white",children:a})]}),c(v,{justifyContent:"center",size:2,gap:0,children:[t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>Z("help/show"),children:t("i",{className:"icon icon-help"})}),t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>Z("user-settings/toggle"),children:t("i",{className:"icon icon-cog"})})]})]})}),l(2,-1,!0)]}):null},ul=i=>{const{type:e=-1,amount:n=-1,short:r=!1}=i,s=o.useMemo(()=>c("div",{className:`habbo-right-side-purse-item icon-${e}`,children:[t("div",{className:"habbo-right-side-purse-item-left-side",children:t("p",{className:"habbo-right-side-purse-item-text-type",children:h(`habbo.purse.${e}`)})}),t("div",{className:"habbo-right-side-purse-item-right-side",children:t("p",{className:"habbo-right-side-purse-item-text",children:ta(n)})}),t("div",{className:"habbo-right-side-purse-item-type-container",children:t("i",{className:"habbo-right-side-purse-item-type-container-icon"})})]}),[n,r,e]);return r?t(Jl,{placement:"left",overlay:t(Wd,{id:`tooltip-${e}`,children:ta(n)}),children:s}):s},ZO=i=>{const{isInRoom:e}=i,{purse:n=null,hcDisabled:r=!1}=es(),s=o.useMemo(()=>X("system.currency.types",[]),[]),a=o.useMemo(()=>X("currency.display.number.short",!1),[]),l=o.useMemo(()=>{if(!n)return null;const d=n.clubPeriods*31+n.clubDays,g=n.minutesUntilExpiration;return n.clubLevel===sn.NO_CLUB?h("purse.clubdays.zero.amount.text"):g>-1&&g<60*24?bn.shortFormat(g*60):bn.shortFormat(d*86400)},[n]),u=o.useCallback((d,g=-1,m=!1)=>{if(!n||!n.activityPoints||!n.activityPoints.size)return null;const f=Array.from(n.activityPoints.keys()).filter(p=>s.indexOf(p)>=0);let I=0;for(;I<d;)f.shift(),I++;I=0;const C=[];for(const p of f){if(g>-1&&I===g)break;m?C.push(t(ul,{type:p,amount:n.activityPoints.get(p),short:!1},p)):C.push(t(ul,{type:p,amount:n.activityPoints.get(p),short:a},p)),I++}return C},[n,s,a]);return n?c(P,{className:"habbo-right-side-purse d-none d-sm-block mt-1",children:[t(ul,{type:-1,amount:n.credits,short:a}),u(0,2),u(2,-1,!0),!r&&c(P,{className:"habbo-right-side-purse-item icon-club",onClick:d=>Z("habboUI/open/hccenter"),children:[t(P,{className:"habbo-right-side-purse-item-left-side",children:t("p",{className:"habbo-right-side-purse-item-text-type",children:h("habbo.purse.club")})}),t(P,{className:"habbo-right-side-purse-item-right-side",children:t("p",{className:"habbo-right-side-purse-item-text",children:l})}),t(P,{className:"habbo-right-side-purse-item-type-container",children:t("i",{className:"habbo-right-side-purse-item-type-container-icon"})})]}),c(P,{className:"habbo-right-side-purse-buttons",style:{pointerEvents:"all"},children:[e&&t(P,{className:"cursor-pointer icon icon-chat-history",onClick:()=>Z("chat-history/toggle"),style:{marginRight:10,minWidth:17}}),c(w,{justifyContent:"between",alignItems:"center",fullWidth:!0,style:{marginTop:-4},children:[e&&t(P,{className:"habbo-right-side-purse-buttons-item",onClick:d=>Z("navigator/toggle-room-info"),children:"Rauminfo"}),t(P,{className:"habbo-right-side-purse-buttons-item",onClick:d=>Z("help/show"),children:"Hilfe"}),t(P,{className:"habbo-right-side-purse-buttons-item",onClick:d=>Z("user-settings/toggle"),children:"Settings"})]})]})]}):null},ey={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},ty=i=>{const[e,n]=o.useState(!0),[r,s]=o.useState(""),[a,l]=o.useState("");tS(z_.MYSTERY_BOX_KEYS_UPDATE,d=>{s(d.keyColor),l(d.boxColor)});const u=d=>{const g=ey[d];return an.int2rgb(g)};return r===""&&a===""?null:t(P,{className:"nitro-notification-bubble rounded mysterybox-extension",children:c(v,{children:[c(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:d=>n(g=>!g),children:[t(S,{variant:"white",children:h("mysterybox.tracker.title")}),e&&t(Zl,{className:"fa-icon"}),!e&&t(ec,{className:"fa-icon"})]}),e&&c(G,{children:[t(S,{variant:"white",children:h("mysterybox.tracker.description")}),c(w,{justifyContent:"center",alignItems:"center",gap:2,children:[t(Ne,{className:"mysterybox-container",children:t("div",{className:"box-image flex-shrink-0",style:{backgroundColor:u(a)},children:t("div",{className:"chain-overlay-image"})})}),t(Ne,{className:"mysterybox-container",children:t("div",{className:"key-image flex-shrink-0",style:{backgroundColor:u(r)},children:t("div",{className:"key-overlay-image"})})})]})]})]})})},ny=i=>{const{eventId:e=-1,eventName:n="",eventDescription:r="",setIsEditingPromote:s=null}=i,[a,l]=o.useState(n),[u,d]=o.useState(r),g=()=>{L(new $_(e,a,u)),s(!1)};return c(se,{className:"nitro-guide-tool",theme:"primary",children:[t(ae,{headerText:h("navigator.eventsettings.editcaption"),onCloseClick:()=>s(!1)}),c(re,{className:"text-black",children:[c(v,{children:[t(S,{bold:!0,children:h("navigator.eventsettings.name")}),t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("navigator.eventsettings.name"),maxLength:64,value:a,onChange:m=>l(m.target.value)})]}),c(v,{children:[t(S,{bold:!0,children:h("navigator.eventsettings.desc")}),t("textarea",{className:"form-control form-control-sm",placeholder:h("navigator.eventsettings.desc"),maxLength:64,value:u,onChange:m=>d(m.target.value)})]}),t(v,{children:t(M,{fullWidth:!0,disabled:!a||!u,variant:!a||!u?"danger":"success",onClick:m=>g(),children:h("navigator.eventsettings.edit")})})]})]})},ry=i=>{const{eventDescription:e="",setIsEditingPromote:n=null}=i,{setIsExtended:r}=Nc(),s=()=>{r(!0),Z("catalog/open/room_event")};return c(G,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),c(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t(M,{className:"btn btn-primary w-100 btn-sm",onClick:a=>n(!0),children:h("navigator.roominfo.editevent")}),t(M,{className:"btn btn-success w-100 btn-sm",onClick:a=>s(),children:h("roomad.extend.event")})]})]})},sy=i=>{const{eventDescription:e=""}=i;return c(G,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),t(v,{alignItems:"center",gap:1,children:c(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",center:!0,children:h("navigator.eventinprogress")})}),t(S,{children:" "})]})})]})},ay=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!0),{promoteInformation:a,setPromoteInformation:l}=Nc();return U(Cm,u=>{l(null)}),a?t(G,{children:a.data.adId!==-1&&t(P,{className:"nitro-notification-bubble rounded",children:c(v,{children:[c(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:u=>s(d=>!d),children:[t(S,{variant:"white",overflow:"hidden",children:a.data.eventName}),r&&t(Zl,{className:"fa-icon"}),!r&&t(ec,{className:"fa-icon"})]}),r&&H().userId!==a.data.ownerAvatarId&&t(sy,{eventDescription:a.data.eventDescription}),r&&H().userId===a.data.ownerAvatarId&&t(ry,{eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!0)}),e&&t(ny,{eventId:a.data.adId,eventName:a.data.eventName,eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!1)})]})})}):null},iy=i=>{const[e,n]=o.useState(!0);return Pe(Dt.CREATED,r=>n(!1)),Pe(Dt.ENDED,r=>n(r.openLandingView)),t("div",{className:"nitro-right-side",children:c(v,{position:"relative",gap:1,children:[t(JO,{}),t(ZO,{isInRoom:!e}),t(VO,{}),t(ty,{}),t(FO,{}),t(ay,{}),t(XO,{})]})})},oy=i=>t("div",{className:"room-spectator"}),ly=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),{chatStyleId:a=0}=_r(),{roomSession:l=null}=Le();U(K_,d=>{const g=d.getParser();if(!g)return;const m=l.userDataManager.getPetData(g.petId);m&&(n(m),s(g))});const u=(d,g)=>{!d||!g||l==null||l.sendChatMessage(`${d} ${g}`,a)};return!e||!r?null:c(se,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary",children:[t(ae,{headerText:h("widgets.pet.commands.title"),onCloseClick:()=>s(null)}),c(re,{className:"text-black",children:[t(w,{alignItems:"center",justifyContent:"center",gap:2,children:c(ne,{columnCount:2,children:[t(v,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(mr,{figure:e.figure,posture:"std",direction:2})}),t(S,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),t(ne,{columnCount:2,children:r.commands&&r.commands.length>0&&r.commands.map((d,g)=>t(M,{disabled:!r.enabledCommands.includes(d),onClick:()=>u(e.name,h(`pet.command.${d}`)),children:h(`pet.command.${d}`)},g))})]})]})},Qt=i=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],...s}=i,a=o.useMemo(()=>{const l=["menu-header","p-1"];return r.length&&l.push(...r),l},[r]);return t(w,{justifyContent:e,alignItems:n,classNames:a,...s})},cy=i=>{const{chatEvent:e=null,onClose:n=null}=i,[r,s]=o.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[a,l]=o.useState(e.automaticChat),[u,d]=o.useState(e.mixSentences),[g,m]=o.useState(e.chatDelay),f=o.useMemo(()=>lc(Te().roomId,e.objectId,e.category,1),[e]),I=p=>p.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),C=()=>{const p=I(r)+";#;"+a+";#;"+g+";#;"+u;L(new vr(e.botId,He.SETUP_CHAT,p)),n()};return t(Jr,{windowPosition:Ft.NOTHING,handleSelector:".drag-handler",dragStyle:{top:f.y,left:f.x},children:c(P,{className:"nitro-context-menu bot-chat",children:[t(Qt,{className:"drag-handler",children:h("bot.skill.chatter.configuration.title")}),c(v,{className:"p-1",children:[c(v,{gap:1,children:[t(S,{variant:"white",children:h("bot.skill.chatter.configuration.chat.text")}),t("textarea",{className:"form-control form-control-sm",placeholder:h("bot.skill.chatter.configuration.text.placeholder"),value:r,rows:7,onChange:p=>s(p.target.value)})]}),c(v,{gap:1,children:[c(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.automatic.chat")}),t("input",{type:"checkbox",className:"form-check-input",checked:a,onChange:p=>l(p.target.checked)})]}),c(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.markov")}),t("input",{type:"checkbox",className:"form-check-input",checked:u,onChange:p=>d(p.target.checked)})]}),c(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.chat.delay")}),t("input",{type:"number",className:"form-control form-control-sm",value:g,onChange:p=>m(p.target.valueAsNumber)})]})]}),c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"primary",onClick:n,children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:C,children:h("save")})]})]})]})})},rd=-1,sd=0,ad=1,id=2,od=3,ld=4,cd=5,ud=6,uy=i=>{const{item:e=null,onClose:n=null}=i,[r,s]=o.useState(rd),[a,l]=o.useState(null),[u,d]=o.useState(null),{roomSession:g=null}=Le(),m=()=>{a&&$().selectRoomObject(g.roomId,a.roomIndex,Q.UNIT)},f=()=>{g.usePetProduct(e.requestRoomObjectId,a.webID),n()},I=o.useMemo(()=>{if(!a||!u)return null;const C=new ea(a.figure),p=u.customParams.split(" "),_=parseInt(p[0]);switch(u.specialType){case ce.PET_SHAMPOO:{if(p.length<2)return null;const E=$().getPetColorResult(_,C.paletteId),b=$().getPetColorResultsForTag(_,p[1]);let N=-1;for(const T of b)if(T.breed===E.breed){N=parseInt(T.id);break}return t(mr,{typeId:C.typeId,paletteId:N,petColor:C.color,customParts:C.customParts,direction:2})}case ce.PET_CUSTOM_PART:{if(p.length<4)return null;const E=[],b=p[1].split(",").map(R=>parseInt(R)),N=p[2].split(",").map(R=>parseInt(R)),T=p[3].split(",").map(R=>parseInt(R));let y=0;for(;y<b.length;){const R=b[y],O=C.getCustomPart(R);let F=T[y];O!=null&&(F=O.paletteId),E.push(new Zo(R,N[y],F)),y++}return t(mr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:E,direction:2})}case ce.PET_CUSTOM_PART_SHAMPOO:{if(p.length<3)return null;const E=[],b=p[1].split(",").map(y=>parseInt(y)),N=p[2].split(",").map(y=>parseInt(y));let T=0;for(;T<b.length;){const y=b[T],R=C.getCustomPart(y);let O=-1;R!=null&&(O=R.partId),E.push(new Zo(b[T],O,N[T])),T++}return t(mr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:E,direction:2})}case ce.PET_SADDLE:{if(p.length<4)return null;const E=[],b=p[1].split(",").map(R=>parseInt(R)),N=p[2].split(",").map(R=>parseInt(R)),T=p[3].split(",").map(R=>parseInt(R));let y=0;for(;y<b.length;)E.push(new Zo(b[y],N[y],T[y])),y++;for(const R of C.customParts)b.indexOf(R.layerId)===-1&&E.push(R);return t(mr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:E,direction:2})}case ce.MONSTERPLANT_REBREED:case ce.MONSTERPLANT_REVIVAL:case ce.MONSTERPLANT_FERTILIZE:{let E="rip";const b=$().getRoomObject(g.roomId,a.roomIndex,Q.UNIT);if(b&&(E=b.model.getValue(te.FIGURE_POSTURE),E==="rip")){const N=a.petLevel;N<7?E=`grw${N}`:E="std"}return t(mr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:C.customParts,posture:E,direction:2})}}},[a,u,g]);return o.useEffect(()=>{const C=g.userDataManager.getUserDataByIndex(e.id);l(C);const p=Oo(g.roomId,e.requestRoomObjectId,Q.FLOOR);if(!p)return;d(p);let _=rd;switch(p.specialType){case ce.PET_SHAMPOO:_=sd;break;case ce.PET_CUSTOM_PART:_=ad;break;case ce.PET_CUSTOM_PART_SHAMPOO:_=id;break;case ce.PET_SADDLE:_=od;break;case ce.MONSTERPLANT_REVIVAL:_=ld;break;case ce.MONSTERPLANT_REBREED:_=cd;break;case ce.MONSTERPLANT_FERTILIZE:_=ud;break}s(_)},[g,e]),a?c(se,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title",["name"],[a.name]),onCloseClick:n}),t(re,{center:!0,children:c(w,{gap:2,overflow:"hidden",children:[t(v,{children:t(P,{pointer:!0,className:"product-preview",onClick:m,children:I})}),c(v,{justifyContent:"between",overflow:"auto",children:[c(v,{gap:2,children:[r===sd&&c(G,{children:[t(S,{children:h("useproduct.widget.text.shampoo",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.shampoo")})]}),r===ad&&c(G,{children:[t(S,{children:h("useproduct.widget.text.custompart",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.custompart")})]}),r===id&&c(G,{children:[t(S,{children:h("useproduct.widget.text.custompartshampoo",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.custompartshampoo")})]}),r===od&&c(G,{children:[t(S,{children:h("useproduct.widget.text.saddle",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.saddle")})]}),r===ld&&c(G,{children:[t(S,{children:h("useproduct.widget.text.revive_monsterplant",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.revive_monsterplant")})]}),r===cd&&c(G,{children:[t(S,{children:h("useproduct.widget.text.rebreed_monsterplant",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.rebreed_monsterplant")})]}),r===ud&&c(G,{children:[t(S,{children:h("useproduct.widget.text.fertilize_monsterplant",["productName"],[u.name])}),t(S,{children:h("useproduct.widget.info.fertilize_monsterplant")})]})]}),c(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:f,children:h("useproduct.widget.use")})]})]})]})})]}):null},j=i=>{const{disabled:e=!1,fullWidth:n=!0,justifyContent:r="center",alignItems:s="center",classNames:a=[],onClick:l=null,...u}=i,d=m=>{e||l&&l(m)},g=o.useMemo(()=>{const m=["menu-item","list-item"];return e&&m.push("disabled"),a.length&&m.push(...a),m},[e,a]);return t(w,{fullWidth:n,justifyContent:r,alignItems:s,classNames:g,onClick:d,...u})},dy=i=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],collapsed:s=!0,...a}=i,l=o.useMemo(()=>{const u=["menu-footer"];return r.length&&u.push(...r),u},[r]);return c(w,{justifyContent:e,alignItems:n,classNames:l,...a,children:[!s&&t($l,{className:"fa-icon align-self-center"}),s&&t(zl,{className:"fa-icon align-self-center"})]})},my=25,dd=3,hy=5e3,gy=75,xs=10;let dl=!1,yi=null,ki=-1e6,ml=1;const br=i=>{const{objectId:e=-1,category:n=-1,userType:r=-1,fades:s=!1,onClose:a=null,position:l="absolute",classNames:u=[],style:d={},children:g=null,collapsable:m=!1,...f}=i,[I,C]=o.useState({x:null,y:null}),[p,_]=o.useState(1),[E,b]=o.useState(!1),[N,T]=o.useState(dl),y=o.useRef(),R=o.useCallback(A=>{if(!E)return;ml+=A;let k=(1-ml/gy)*1;if(k<=0)return a(),!1;_(k)},[E,a]),O=o.useCallback((A,k)=>{if(!A||!k||!yi)return;let x=-y.current.offsetHeight;r>-1&&(r===ut.USER||r===ut.BOT||r===ut.RENTABLE_BOT)?x=x+(A.height>50?15:0):x=x-14,yi.addValue(k.y-A.top);let B=yi.getMax();B<ki-dd&&(B=ki-dd),ki=B;const V=k.y-B;let q=~~(k.x-y.current.offsetWidth/2),Y=~~(V+x);const z=pe().width-y.current.offsetWidth-xs,de=pe().height-y.current.offsetHeight-xs;q<xs?q=xs:q>z&&(q=z),Y<xs?Y=xs:Y>de&&(Y=de),C({x:q,y:Y})},[r]),F=o.useMemo(()=>{const A=["nitro-context-menu"];return N&&A.push("menu-hidden"),A.push(I.x!==null?"visible":"invisible"),u.length&&A.push(...u),A},[I,u,N]),D=o.useMemo(()=>{let A={};return A.left=I.x||0,A.top=I.y||0,A.opacity=p,Object.keys(d).length&&(A={...A,...d}),A},[I,p,d]);return o.useEffect(()=>{if(!y.current)return;const A=k=>{if(!y.current)return;R(k);const x=lc(Te().roomId,e,n),B=Pm(Te().roomId,e,n);O(x,B)};return zn().add(A),()=>{zn().remove(A)}},[e,n,R,O]),o.useEffect(()=>{if(!s)return;const A=setTimeout(()=>b(!0),hy);return()=>clearTimeout(A)},[s]),o.useEffect(()=>{dl=N},[N]),o.useEffect(()=>{yi=new X_(my),ki=-1e6,ml=1},[]),c(P,{innerRef:y,position:l,classNames:F,style:D,...f,children:[!(m&&dl)&&g,m&&t(dy,{onClick:()=>T(!N),collapsed:N})]})},md=0,hd=1,gd=2,fd=3,pd=4,Id=5,Ed=6,Cd=7,fy=i=>{const{item:e=null,updateConfirmingProduct:n=null,onClose:r=null}=i,[s,a]=o.useState(0),{roomSession:l=null}=Le(),u=d=>{if(d)switch(d){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":n(e);break}};return o.useEffect(()=>{if(!e)return;const d=Oo(l.roomId,e.requestRoomObjectId,Q.FLOOR);if(!d)return;let g=md;switch(d.specialType){case ce.PET_SHAMPOO:g=hd;break;case ce.PET_CUSTOM_PART:g=gd;break;case ce.PET_CUSTOM_PART_SHAMPOO:g=fd;break;case ce.PET_SADDLE:g=pd;break;case ce.MONSTERPLANT_REVIVAL:g=Id;break;case ce.MONSTERPLANT_REBREED:g=Ed;break;case ce.MONSTERPLANT_FERTILIZE:g=Cd;break}a(g)},[l,e]),c(br,{objectId:e.id,category:Q.UNIT,userType:ut.PET,onClose:r,collapsable:!0,children:[t(Qt,{children:e.name}),s===md&&t(j,{onClick:d=>u("use_product"),children:h("infostand.button.useproduct")}),s===hd&&t(j,{onClick:d=>u("use_product_shampoo"),children:h("infostand.button.useproduct_shampoo")}),s===gd&&t(j,{onClick:d=>u("use_product_custom_part"),children:h("infostand.button.useproduct_custom_part")}),s===fd&&t(j,{onClick:d=>u("use_product_custom_part_shampoo"),children:h("infostand.button.useproduct_custom_part_shampoo")}),s===pd&&c(G,{children:[e.replace&&t(j,{onClick:d=>u("replace_product_saddle"),children:h("infostand.button.replaceproduct_saddle")}),!e.replace&&t(j,{onClick:d=>u("use_product_saddle"),children:h("infostand.button.useproduct_saddle")})]}),s===Id&&t(j,{onClick:d=>u("revive_monsterplant"),children:h("infostand.button.revive_monsterplant")}),s===Ed&&t(j,{onClick:d=>u("rebreed_monsterplant"),children:h("infostand.button.rebreed_monsterplant")}),s===Cd&&t(j,{onClick:d=>u("fertilize_monsterplant"),children:h("infostand.button.fertilize_monsterplant")})]})},py=i=>{const{avatarInfo:e=null,onClose:n=null}=i;return e?t(v,{className:"nitro-infostand rounded",children:c(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[c(v,{gap:1,children:[c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Xn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{gap:1,children:[t(v,{fullWidth:!0,className:"body-image bot",children:t(it,{figure:e.figure,direction:4})}),t(v,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(r=>t(We,{badgeCode:r,showInfo:!0},r))})]}),t("hr",{className:"m-0"})]}),t(w,{alignItems:"center",className:"nitro-thumb-bg rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&c(v,{gap:1,children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]})}):null},hl=0,_d=1,bd=2,Iy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,{roomSession:r=null}=Le(),[s,a]=o.useState(0),[l,u]=o.useState(!1),[d,g]=o.useState(!1),[m,f]=o.useState(!1),[I,C]=o.useState([]),[p,_]=o.useState([]),[E,b]=o.useState([]),[N,T]=o.useState([]),[y,R]=o.useState(!1),[O,F]=o.useState(0),[D,A]=o.useState(0),[k,x]=o.useState(!1),[B,V]=o.useState(!1),[q,Y]=o.useState(null),[z,de]=o.useState(!1),[ee,Se]=o.useState(!1),[qe,dt]=o.useState(-1),[Ke,Vt]=o.useState(""),[Fe,qt]=o.useState("");hs(am.NPE_SONG_CHANGED,ue=>{dt(ue.id)},z||ee),hs(J_.SIR_TRAX_SONG_INFO_RECEIVED,ue=>{if(ue.id!==qe)return;const we=pe().soundManager.musicController.getSongInfo(ue.id);we&&(Vt(we.name),qt(we.creator))},z||ee),o.useEffect(()=>{let ue=hl,we=!1,et=!1,un=!1,ge=[],Oe=[],Rn=[],ns=[],dn=!1,ii=0,oa=0,rs=!1,ss=!1,As=!1,la=!1,Ur=-1;const as=e.roomControllerLevel>=Qe.GUEST;if((as||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(we=!0,et=!e.isWallItem,e.roomControllerLevel>=Qe.MODERATOR&&(rs=!0)),e.isAnyRoomController&&(ss=!0),(e.usagePolicy===tu.EVERYBODY||e.usagePolicy===tu.CONTROLLER&&as||e.extraParam===Tr.JUKEBOX&&as||e.extraParam===Tr.USABLE_PRODUCT&&as)&&(un=!0),e.extraParam){if(e.extraParam===Tr.CRACKABLE_FURNI){const Gt=e.stuffData;un=!0,dn=!0,ii=Gt.hits,oa=Gt.target}else if(e.extraParam===Tr.JUKEBOX){const Gt=pe().soundManager.musicController.getRoomItemPlaylist();Gt&&(Ur=Gt.nowPlayingSongId),As=!0}else e.extraParam.indexOf(Tr.SONGDISK)===0&&(Ur=parseInt(e.extraParam.substr(Tr.SONGDISK.length)),la=!0);if(rs){const Gt=e.extraParam.substr(Tr.BRANDING_OPTIONS.length);if(Gt){const Zn=Gt.split("	");for(const Ds of Zn){const er=Ds.split("=");er&&er.length===2&&(ge.push(er[0]),Oe.push(er[1]))}}}}if(rs){const Gt=$().getRoomObject(r.roomId,e.id,e.isWallItem?Q.WALL:Q.FLOOR);if(Gt){const Zn=Gt.model.getValue(te.FURNITURE_CUSTOM_VARIABLES),Ds=Gt.model.getValue(te.FURNITURE_DATA);if(Zn&&Zn.length)for(const er of Zn)Rn.push(er),ns.push(Ds[er]||"")}}e.isOwner||e.isAnyRoomController?ue=bd:(e.isRoomOwner||e.roomControllerLevel>=Qe.GUILD_ADMIN)&&(ue=_d),e.isStickie&&(ue=hl),a(ue),u(we),g(et),f(un),C(ge),_(Oe),b(Rn),T(ns),R(dn),F(ii),A(oa),x(rs),V(ss),Y(null),de(As),Se(la),dt(Ur),e.groupId&&L(new Pa(e.groupId,!1))},[r,e]),U(Xa,ue=>{const we=ue.getParser();!e||e.groupId!==we.id||we.flag||(q&&Y(null),Y(we.title))}),o.useEffect(()=>{const ue=pe().soundManager.musicController.getSongInfo(qe);Vt((ue==null?void 0:ue.name)??""),qt((ue==null?void 0:ue.creator)??"")},[qe]);const wn=o.useCallback((ue,we)=>{const et=Array.from(p);et[ue]=we,_(et)},[p]),De=o.useCallback((ue,we)=>{const et=Array.from(N);et[ue]=we,T(et)},[N]),fe=o.useCallback(()=>{if(I.length===0||p.length===0)return"";let ue="",we=0;for(;we<I.length;){const et=I[we],un=p[we];ue=ue+(et+"="+un+"	"),we++}return ue},[I,p]),Ge=o.useCallback(ue=>{if(!(!ue||ue===""))switch(ue){case"buy_one":Z(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"move":$().processRoomObjectOperation(e.id,e.category,Yn.OBJECT_MOVE);break;case"rotate":$().processRoomObjectOperation(e.id,e.category,Yn.OBJECT_ROTATE_POSITIVE);break;case"pickup":s===bd?$().processRoomObjectOperation(e.id,e.category,Yn.OBJECT_PICKUP):$().processRoomObjectOperation(e.id,e.category,Yn.OBJECT_EJECT);break;case"use":$().useRoomObject(e.id,e.category);break;case"save_branding_configuration":{const we=new Map,et=fe().split("	");if(et)for(const un of et){const[ge,Oe]=un.split("=",2);we.set(ge,Oe)}$().modifyRoomObjectDataWithMap(e.id,e.category,Yn.OBJECT_SAVE_STUFF_DATA,we);break}case"save_custom_variables":{const we=new Map;for(let et=0;et<E.length;et++){const un=E[et],ge=N[et];un&&un.length&&ge&&ge.length&&we.set(un,ge)}L(new Q_(e.id,we));break}}},[e,s,E,N,fe]),wt=o.useCallback(()=>{const ue=e.stuffData;return!ue||!(ue instanceof $a)?null:ue.getValue(2)},[e]);return e?c(v,{gap:1,alignItems:"end",children:[t(v,{className:"nitro-infostand rounded",children:c(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[c(v,{gap:1,children:[c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t("i",{className:"infostand-close"})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{position:"relative",gap:1,children:[e.stuffData.isUnique&&t("div",{className:"position-absolute end-0",children:t(Zm,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&t("div",{className:"position-absolute end-0",children:t(Ec,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&t("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:e.description}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:h("furni.owner",["name"],[e.ownerName])})]}),e.purchaseOfferId>0&&t(w,{children:t(S,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:ue=>Ge("buy_one"),children:h("infostand.button.buy")})})]}),(z||ee)&&c(v,{gap:1,children:[t("hr",{className:"m-0"}),qe===-1&&t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.jukebox.text.not.playing")}),!!Ke.length&&c(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-icon"}),t(S,{variant:"white",small:!0,wrap:!0,children:Ke})]}),!!Fe.length&&c(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-creator"}),t(S,{variant:"white",small:!0,wrap:!0,children:Fe})]})]}),c(v,{gap:1,children:[y&&c(G,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.crackable_furni.hits_remaining",["hits","target"],[O.toString(),D.toString()])})]}),e.groupId>0&&c(G,{children:[t("hr",{className:"m-0"}),c(w,{pointer:!0,alignItems:"center",gap:2,onClick:()=>Za(e.groupId),children:[t(We,{badgeCode:wt(),isGroup:!0}),t(S,{variant:"white",underline:!0,children:q})]})]}),k&&c(G,{children:[t("hr",{className:"m-0"}),B&&c(S,{small:!0,wrap:!0,variant:"white",children:["ID: ",e.id]}),I.length>0&&c(G,{children:[t("hr",{className:"m-0"}),t(v,{gap:1,children:I.map((ue,we)=>c(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:ue}),t("input",{type:"text",className:"form-control form-control-sm",value:p[we],onChange:et=>wn(we,et.target.value)})]},we))})]})]}),E.length>0&&c(G,{children:[t("hr",{className:"m-0 my-1"}),t(v,{gap:1,children:E.map((ue,we)=>c(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:ue}),t("input",{type:"text",className:"form-control form-control-sm",value:N[we],onChange:et=>De(we,et.target.value)})]},we))})]})]})]})}),c(w,{gap:1,justifyContent:"end",children:[l&&t(M,{className:"infostand-buttons",variant:"dark",onClick:ue=>Ge("move"),children:h("infostand.button.move")}),d&&t(M,{className:"infostand-buttons",variant:"dark",onClick:ue=>Ge("rotate"),children:h("infostand.button.rotate")}),s!==hl&&t(M,{className:"infostand-buttons",variant:"dark",onClick:ue=>Ge("pickup"),children:h(s===_d?"infostand.button.eject":"infostand.button.pickup")}),m&&t(M,{className:"infostand-buttons",variant:"dark",onClick:ue=>Ge("use"),children:h("infostand.button.use")}),I.length>0&&p.length>0&&I.length===p.length&&t(M,{className:"infostand-buttons",variant:"dark",onClick:()=>Ge("save_branding_configuration"),children:h("save")}),E.length>0&&N.length>0&&E.length===N.length&&t(M,{className:"infostand-buttons",variant:"dark",onClick:()=>Ge("save_custom_variables"),children:h("save")})]})]}):null},Ey=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(0),[a,l]=o.useState(0),{roomSession:u=null}=Le(),{petRespectRemaining:d=0,respectPet:g=null}=_r();if(o.useEffect(()=>{s(e.remainingGrowTime),l(e.remainingTimeToLive)},[e]),o.useEffect(()=>{if(e.petType!==Mt.MONSTERPLANT||e.dead)return;const f=setInterval(()=>{s(I=>I-1),l(I=>I-1)},1e3);return()=>clearInterval(f)},[e]),!e)return null;const m=f=>{let I=!0;if(!(!f||f=="")){switch(f){case"respect":g(e.id),d-1>=1&&(I=!1);break;case"buyfood":Z("catalog/open/"+X("catalog.links")["pets.buy_food"]);break;case"train":u==null||u.requestPetCommands(e.id);break;case"treat":L(new oc(e.id));break;case"compost":u==null||u.compostPlant(e.id);break;case"pick_up":u==null||u.pickupPet(e.id);break}I&&n()}};return c(v,{gap:1,alignItems:"end",children:[t(v,{className:"nitro-infostand rounded",children:c(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[c(v,{gap:1,children:[c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Xn,{className:"cursor-pointer fa-icon",onClick:n})]}),t(S,{variant:"white",small:!0,wrap:!0,children:h(`pet.breed.${e.petType}.${e.petBreed}`)}),t("hr",{className:"m-0"})]}),e.petType===Mt.MONSTERPLANT&&c(G,{children:[c(v,{center:!0,gap:1,children:[t(mr,{figure:e.petFigure,posture:e.posture,direction:4}),t("hr",{className:"m-0"})]}),c(v,{gap:2,children:[!e.dead&&t(v,{alignItems:"center",gap:1,children:t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:h("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])})}),c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.wellbeing")}),c(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.dead?"00:00:00":os(a==0?e.remainingTimeToLive:a).split(":")[1]+":"+os(a==null||a==null?0:a).split(":")[2]+":"+os(a==null||a==null?0:a).split(":")[3]})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.dead?"0":Math.round(e.maximumTimeToLive*100/a).toString()}})]})]}),r!=0&&r>0&&c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.growth")}),t(qN,{className:"top-2 end-2",day:os(r).split(":")[0],hour:os(r).split(":")[1],minutes:os(r).split(":")[2],seconds:os(r).split(":")[3]})]}),c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.raritylevel",["level"],[h(`infostand.pet.raritylevel.${e.rarityLevel}`)])}),t(Ec,{className:"top-2 end-2",level:e.rarityLevel})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:h("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),e.petType!==Mt.MONSTERPLANT&&c(G,{children:[c(v,{gap:1,children:[c(w,{gap:1,children:[t(v,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(mr,{figure:e.petFigure,posture:e.posture,direction:4})}),c(v,{grow:!0,gap:1,children:[t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:h("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.happiness")}),c(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),t(P,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.experience")}),c(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),t(P,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),c(v,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.energy")}),c(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[e.petType!==Mt.MONSTERPLANT&&t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.petrespect",["count"],[e.respect.toString()])}),t(S,{variant:"white",small:!0,wrap:!0,children:h("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),t(v,{gap:1,children:c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.petowner",["name"],[e.ownerName])})]})})]})}),c(w,{gap:1,justifyContent:"end",children:[e.petType!==Mt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("buyfood"),children:h("infostand.button.buyfood")}),e.isOwner&&e.petType!==Mt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("train"),children:h("infostand.button.train")}),!e.dead&&e.energy/e.maximumEnergy<.98&&e.petType===Mt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("treat"),children:h("infostand.button.pettreat")}),(u==null?void 0:u.isRoomOwner)&&e.petType===Mt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("compost"),children:h("infostand.button.compost")}),e.isOwner&&t(M,{variant:"dark",onClick:f=>m("pick_up"),children:h("inventory.pets.pickup")}),d>0&&e.petType!==Mt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[d.toString()])})]})]})},Cy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,r=o.useMemo(()=>!(e.botSkills.indexOf(He.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),s=()=>L(new _m(e.webID));if(e)return c(v,{gap:1,children:[t(v,{className:"nitro-infostand rounded",children:c(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[c(v,{gap:1,children:[c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Xn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{gap:1,children:[t(v,{fullWidth:!0,className:"body-image bot",children:t(it,{figure:e.figure,direction:4})}),t(v,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(a=>t(We,{badgeCode:a,showInfo:!0},a))})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&c(G,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]})]})}),r&&t(w,{justifyContent:"end",children:t(M,{variant:"dark",onClick:s,children:h("infostand.button.pickup")})})]})},gl=i=>{const{type:e=-1,relationship:n=null}=i;if(!n)return null;const r=qn.RELATIONSHIP_NAMES[e].toLocaleLowerCase();return c(w,{alignItems:"center",gap:1,children:[t("i",{className:`nitro-friends-spritesheet icon-${r}`}),t(w,{alignItems:"center",gap:0,children:c(S,{small:!0,variant:"white",onClick:s=>on(n.randomFriendId),children:[t("u",{children:n.randomFriendName}),n.friendCount>1&&" "+h(`extendedprofile.relstatus.others.${r}`,["count"],[(n.friendCount-1).toString()])]})})]})},_y=i=>{const{relationships:e=null}=i;return!e||!e.relationshipStatusMap.length?null:c(G,{children:[t(gl,{type:qn.HEART,relationship:e.relationshipStatusMap.getValue(qn.HEART)}),t(gl,{type:qn.SMILE,relationship:e.relationshipStatusMap.getValue(qn.SMILE)}),t(gl,{type:qn.BOBBA,relationship:e.relationshipStatusMap.getValue(qn.BOBBA)})]})},by=i=>{Z(`navigator/search/${i}`),L(new ic("hotel_view",`tag:${i}`))},Ny=i=>{const{tags:e=null}=i;return!e||!e.length?null:c(G,{children:[t("hr",{className:"m-0"}),t(w,{className:"flex-tags",children:e&&e.length>0&&e.map((n,r)=>t(S,{variant:"white",className:"text-tags",onClick:s=>by(n),children:n},r))})]})},Sy=i=>{const{avatarInfo:e=null,setAvatarInfo:n=null,onClose:r=null}=i,[s,a]=o.useState(null),[l,u]=o.useState(!1),[d,g]=o.useState(null),{roomSession:m=null}=Le(),f=p=>{!l||p.length>X("motto.max.length",38)||(m.sendMottoMessage(p),u(!1))},I=p=>f(p.target.value),C=p=>{switch(p.stopPropagation(),p.key){case"Enter":f(p.target.value);return}};return Pe(Z_.RSUBE_BADGES,p=>{!e||e.webID!==p.userId||e.badges.join("")===p.badges.join("")||n(E=>{const b=Jt(E);return b.badges=p.badges,b})}),Pe(eb.USER_FIGURE,p=>{!e||e.roomIndex!==p.roomIndex||n(_=>{const E=Jt(_);return E.figure=p.figure,E.motto=p.customInfo,E.achievementScore=p.activityPoints,E})}),Pe(tb.FAVOURITE_GROUP_UPDATE,p=>{!e||e.roomIndex!==p.roomIndex||n(_=>{const E=Jt(_),b=p.status===-1||p.habboGroupId<=0;return E.groupId=b?-1:p.habboGroupId,E.groupName=b?null:p.habboGroupName,E.groupBadgeId=b?null:H().getGroupBadge(p.habboGroupId),E})}),U(bm,p=>{const _=p.getParser();!e||e.webID!==_.userId||g(_)}),o.useEffect(()=>(u(!1),a(e.motto),L(new Nm(e.webID)),()=>{u(!1),a(null),g(null)}),[e]),e?t(v,{className:"nitro-infostand rounded",children:c(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[c(v,{gap:1,children:[c(w,{alignItems:"center",justifyContent:"between",children:[c(w,{alignItems:"center",gap:1,children:[t(xn,{userId:e.webID}),t(S,{variant:"white",small:!0,wrap:!0,children:e.name})]}),t("i",{className:"infostand-close",onClick:r})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{gap:1,children:[t(v,{fullWidth:!0,className:"body-image nitro-thumb-bg",onClick:p=>on(e.webID),children:t(it,{figure:e.figure,direction:4})}),c(v,{grow:!0,alignItems:"center",gap:0,children:[c(w,{gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[0]&&t(We,{badgeCode:e.badges[0],showInfo:!0})}),t(w,{center:!0,pointer:e.groupId>0,className:"badge-image",onClick:p=>Za(e.groupId),children:e.groupId>0&&t(We,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),c(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[1]&&t(We,{badgeCode:e.badges[1],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[2]&&t(We,{badgeCode:e.badges[2],showInfo:!0})})]}),c(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[3]&&t(We,{badgeCode:e.badges[3],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[4]&&t(We,{badgeCode:e.badges[4],showInfo:!0})})]})]})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",className:"nitro-thumb-bg rounded py-1 px-2",children:[e.type!==Ct.OWN_USER&&t(w,{grow:!0,alignItems:"center",className:"motto-content",children:t(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:s})}),e.type===Ct.OWN_USER&&c(w,{grow:!0,alignItems:"center",gap:2,children:[t(ng,{className:"small fa-icon"}),c(w,{grow:!0,alignItems:"center",className:"motto-content",children:[!l&&c(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:p=>u(!0),children:[s," "]}),l&&t("input",{type:"text",className:"motto-input",maxLength:X("motto.max.length",38),value:s,onChange:p=>a(p.target.value),onBlur:I,onKeyDown:C,autoFocus:!0})]})]})]}),t("hr",{className:"m-0"})]}),c(v,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&c(G,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]}),t(v,{gap:1,children:t(_y,{relationships:d})}),X("user.tags.enabled")&&t(v,{gap:1,className:"mt-1",children:t(Ny,{tags:H().tags})})]})}):null},Ai=0,fl=1,Nd=2,Sd=3,pl=4,vd=5,Td=6,vy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Ai),{canRequestFriend:a=null}=ln(),{report:l=null}=Fn(),{roomSession:u=null}=Le(),{userRespectRemaining:d=0,respectUser:g=null}=_r(),m=o.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<Qe.GUEST&&!e.isGuildRoom,[e]),f=o.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===Qe.GUEST&&!e.isGuildRoom,[e]),I=o.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||m||f,[m,f,e]),C=o.useMemo(()=>{let _=!1;const E=ys();if(E){const b=E.model.getValue(te.FIGURE_CARRY_OBJECT);b>0&&b<999999&&(_=!0)}return _},[]),p=_=>{let E=!0;if(_)switch(_){case"moderate":E=!1,s(fl);break;case"ban":E=!1,s(Nd);break;case"mute":E=!1,s(Sd);break;case"ambassador":E=!1,s(pl);break;case"ambassador_mute":E=!1,s(vd);break;case"back_moderate":E=!1,s(fl);break;case"back_ambassador":E=!1,s(pl);break;case"back":E=!1,s(Ai);break;case"whisper":Nt(new _s(_s.WHISPER,e.name));break;case"friend":Z(`friends/request/${e.webID}/${e.name}`);break;case"relationship":E=!1,s(Td);break;case"respect":{g(e.webID),d-1>=1&&(E=!1);break}case"ignore":H().ignoreUser(e.name);break;case"unignore":H().unignoreUser(e.name);break;case"kick":u.sendKickMessage(e.webID);break;case"ban_hour":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":u.sendMuteMessage(e.webID,2);break;case"mute_5min":u.sendMuteMessage(e.webID,5);break;case"mute_10min":u.sendMuteMessage(e.webID,10);break;case"give_rights":u.sendGiveRightsMessage(e.webID);break;case"remove_rights":u.sendTakeRightsMessage(e.webID);break;case"trade":L(new rb(e.roomIndex));break;case"report":l(Je.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":L(new nb(e.webID));break;case"ambassador_alert":u.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":u.sendKickMessage(e.webID);break;case"ambassador_mute_2min":u.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":u.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":u.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":u.sendMuteMessage(e.webID,1080);break;case"rship_heart":L(new ma(e.webID,nn.RELATIONSHIP_HEART));break;case"rship_smile":L(new ma(e.webID,nn.RELATIONSHIP_SMILE));break;case"rship_bobba":L(new ma(e.webID,nn.RELATIONSHIP_BOBBA));break;case"rship_none":L(new ma(e.webID,nn.RELATIONSHIP_NONE));break}E&&n()};return o.useEffect(()=>{s(Ai)},[e]),c(br,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:n,collapsable:!0,children:[t(Qt,{className:"cursor-pointer",onClick:_=>on(e.webID),children:e.name}),r===Ai&&c(G,{children:[a(e.webID)&&t(j,{onClick:_=>p("friend"),children:h("infostand.button.friend")}),t(j,{onClick:_=>p("trade"),children:h("infostand.button.trade")}),t(j,{onClick:_=>p("whisper"),children:h("infostand.button.whisper")}),d>0&&t(j,{onClick:_=>p("respect"),children:h("infostand.button.respect",["count"],[d.toString()])}),!a(e.webID)&&c(j,{onClick:_=>p("relationship"),children:[h("infostand.link.relationship"),t(En,{className:"right fa-icon"})]}),!e.isIgnored&&t(j,{onClick:_=>p("ignore"),children:h("infostand.button.ignore")}),e.isIgnored&&t(j,{onClick:_=>p("unignore"),children:h("infostand.button.unignore")}),t(j,{onClick:_=>p("report"),children:h("infostand.button.report")}),I&&c(j,{onClick:_=>p("moderate"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.moderate")]}),e.isAmbassador&&c(j,{onClick:_=>p("ambassador"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.ambassador")]}),C&&t(j,{onClick:_=>p("pass_hand_item"),children:h("avatar.widget.pass_hand_item")})]}),r===fl&&c(G,{children:[t(j,{onClick:_=>p("kick"),children:h("infostand.button.kick")}),c(j,{onClick:_=>p("mute"),children:[t(En,{className:"right fa-icon"}),h("infostand.button.mute")]}),c(j,{onClick:_=>p("ban"),children:[t(En,{className:"right fa-icon"}),h("infostand.button.ban")]}),m&&t(j,{onClick:_=>p("give_rights"),children:h("infostand.button.giverights")}),f&&t(j,{onClick:_=>p("remove_rights"),children:h("infostand.button.removerights")}),c(j,{onClick:_=>p("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Nd&&c(G,{children:[t(j,{onClick:_=>p("ban_hour"),children:h("infostand.button.ban_hour")}),t(j,{onClick:_=>p("ban_day"),children:h("infostand.button.ban_day")}),t(j,{onClick:_=>p("perm_ban"),children:h("infostand.button.perm_ban")}),c(j,{onClick:_=>p("back_moderate"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Sd&&c(G,{children:[t(j,{onClick:_=>p("mute_2min"),children:h("infostand.button.mute_2min")}),t(j,{onClick:_=>p("mute_5min"),children:h("infostand.button.mute_5min")}),t(j,{onClick:_=>p("mute_10min"),children:h("infostand.button.mute_10min")}),c(j,{onClick:_=>p("back_moderate"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===pl&&c(G,{children:[t(j,{onClick:_=>p("ambassador_alert"),children:h("infostand.button.alert")}),t(j,{onClick:_=>p("ambassador_kick"),children:h("infostand.button.kick")}),c(j,{onClick:_=>p("ambassador_mute"),children:[h("infostand.button.mute"),t(En,{className:"right fa-icon"})]}),c(j,{onClick:_=>p("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===vd&&c(G,{children:[t(j,{onClick:_=>p("ambassador_mute_2min"),children:h("infostand.button.mute_2min")}),t(j,{onClick:_=>p("ambassador_mute_10min"),children:h("infostand.button.mute_10min")}),t(j,{onClick:_=>p("ambassador_mute_60min"),children:h("infostand.button.mute_60min")}),t(j,{onClick:_=>p("ambassador_mute_18hr"),children:h("infostand.button.mute_18hour")}),c(j,{onClick:_=>p("back_ambassador"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Td&&c(G,{children:[c(w,{className:"menu-list-split-3",children:[t(j,{onClick:_=>p("rship_heart"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),t(j,{onClick:_=>p("rship_smile"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),t(j,{onClick:_=>p("rship_bobba"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),t(j,{onClick:_=>p("rship_none"),children:h("avatar.widget.clear_relationship")}),c(j,{onClick:_=>p("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]})]})},xh=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["menu-list"];return e.length&&s.push(...e),s},[e]);return t(v,{classNames:r,...n})},Ty=i=>{const{userId:e=-1,userName:n="",roomIndex:r=-1,setIsDecorating:s=null}=i;return t(br,{objectId:r,category:Q.UNIT,onClose:null,children:t(xh,{children:t(j,{onClick:a=>s(!1),children:h("widget.avatar.stop_decorating")})})})},wy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,r=s=>{if(s)switch(s){case"move":Us(e.id,e.category,Yn.OBJECT_MOVE);break;case"rotate":Us(e.id,e.category,Yn.OBJECT_ROTATE_POSITIVE);break;case"pickup":Us(e.id,e.category,Yn.OBJECT_PICKUP);break;case"eject":Us(e.id,e.category,Yn.OBJECT_EJECT);break}};return c(br,{objectId:e.id,category:e.category,onClose:n,collapsable:!0,children:[t(Qt,{children:e.name}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:s=>r("move"),children:t(rg,{className:"center fa-icon"})}),t(j,{onClick:s=>r("rotate"),disabled:e.isWallItem,children:t(sg,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&t(j,{onClick:s=>r("pickup"),children:t(xc,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=Qe.GUILD_ADMIN)&&t(j,{onClick:s=>r("eject"),children:t(xc,{className:"center fa-icon"})})]})]})},wd=i=>{const{nameInfo:e=null,onClose:n=null}=i,r=o.useMemo(()=>{const s=["name-only"];return e.isFriend&&s.push("is-friend"),s},[e]);return t(br,{objectId:e.roomIndex,category:e.category,userType:e.userType,fades:e.id!==H().userId,classNames:r,onClose:n,children:t("div",{className:"text-shadow",children:e.name})})},Il=0,El=1,Rd=3,Od=4,Ry=i=>{const{avatarInfo:e=null,isDancing:n=!1,setIsDecorating:r=null,onClose:s=null}=i,[a,l]=o.useState(n&&Cs()?El:Il),{roomSession:u=null}=Le(),d=f=>{let I=!0;if(f)if(f.startsWith("sign_")){const C=parseInt(f.split("_")[1]);u.sendSignMessage(C)}else switch(f){case"decorate":r(!0);break;case"change_name":Nt(new qa(qa.INIT));break;case"change_looks":Z("avatar-editor/show");break;case"expressions":I=!1,l(Rd);break;case"sit":u.sendPostureMessage(Ji.POSTURE_SIT);break;case"stand":u.sendPostureMessage(Ji.POSTURE_STAND);break;case"wave":u.sendExpressionMessage(lr.WAVE.ordinal);break;case"blow":u.sendExpressionMessage(lr.BLOW.ordinal);break;case"laugh":u.sendExpressionMessage(lr.LAUGH.ordinal);break;case"idle":u.sendExpressionMessage(lr.IDLE.ordinal);break;case"dance_menu":I=!1,l(El);break;case"dance":u.sendDanceMessage(1);break;case"dance_stop":u.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":u.sendDanceMessage(parseInt(f.charAt(f.length-1)));break;case"signs":I=!1,l(Od);break;case"back":I=!1,l(Il);break;case"drop_carry_item":L(new sb);break}I&&s()},g=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>Qe.GUEST,m=Bb();return c(br,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:s,collapsable:!0,children:[t(Qt,{className:"cursor-pointer",onClick:f=>on(e.webID),children:e.name}),a===Il&&c(G,{children:[e.allowNameChange&&t(j,{onClick:f=>d("change_name"),children:h("widget.avatar.change_name")}),g()&&t(j,{onClick:f=>d("decorate"),children:h("widget.avatar.decorate")}),t(j,{onClick:f=>d("change_looks"),children:h("widget.memenu.myclothes")}),Cs()&&!m&&c(j,{onClick:f=>d("dance_menu"),children:[t(En,{className:"right fa-icon"}),h("widget.memenu.dance")]}),!n&&!Cs()&&!m&&t(j,{onClick:f=>d("dance"),children:h("widget.memenu.dance")}),n&&!Cs()&&!m&&t(j,{onClick:f=>d("dance_stop"),children:h("widget.memenu.dance.stop")}),c(j,{onClick:f=>d("expressions"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.expressions")]}),c(j,{onClick:f=>d("signs"),children:[t(En,{className:"right fa-icon"}),h("infostand.show.signs")]}),e.carryItem>0&&t(j,{onClick:f=>d("drop_carry_item"),children:h("avatar.widget.drop_hand_item")})]}),a===El&&c(G,{children:[n&&t(j,{onClick:f=>d("dance_stop"),children:h("widget.memenu.dance.stop")}),t(j,{onClick:f=>d("dance_1"),children:h("widget.memenu.dance1")}),t(j,{onClick:f=>d("dance_2"),children:h("widget.memenu.dance2")}),t(j,{onClick:f=>d("dance_3"),children:h("widget.memenu.dance3")}),t(j,{onClick:f=>d("dance_4"),children:h("widget.memenu.dance4")}),c(j,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),a===Rd&&c(G,{children:[Vb()===Xs.POSTURE_STAND&&t(j,{onClick:f=>d("sit"),children:h("widget.memenu.sit")}),Rb()&&t(j,{onClick:f=>d("stand"),children:h("widget.memenu.stand")}),nl()&&t(j,{onClick:f=>d("wave"),children:h("widget.memenu.wave")}),nl()&&c(j,{disabled:!Ci(),onClick:f=>d("laugh"),children:[!Ci()&&t(st,{type:"hc"}),h("widget.memenu.laugh")]}),nl()&&c(j,{disabled:!Ci(),onClick:f=>d("blow"),children:[!Ci()&&t(st,{type:"hc"}),h("widget.memenu.blow")]}),t(j,{onClick:f=>d("idle"),children:h("widget.memenu.idle")}),c(j,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),a===Od&&c(G,{children:[c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_1"),children:"1"}),t(j,{onClick:f=>d("sign_2"),children:"2"}),t(j,{onClick:f=>d("sign_3"),children:"3"})]}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_4"),children:"4"}),t(j,{onClick:f=>d("sign_5"),children:"5"}),t(j,{onClick:f=>d("sign_6"),children:"6"})]}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_7"),children:"7"}),t(j,{onClick:f=>d("sign_8"),children:"8"}),t(j,{onClick:f=>d("sign_9"),children:"9"})]}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_10"),children:"10"}),t(j,{onClick:f=>d("sign_11"),children:t("i",{className:"icon icon-sign-heart"})}),t(j,{onClick:f=>d("sign_12"),children:t("i",{className:"icon icon-sign-skull"})})]}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_0"),children:"0"}),t(j,{onClick:f=>d("sign_13"),children:t("i",{className:"icon icon-sign-exclamation"})}),t(j,{onClick:f=>d("sign_15"),children:t("i",{className:"icon icon-sign-smile"})})]}),c(w,{className:"menu-list-split-3",children:[t(j,{onClick:f=>d("sign_14"),children:t("i",{className:"icon icon-sign-soccer"})}),t(j,{onClick:f=>d("sign_17"),children:t("i",{className:"icon icon-sign-yellow"})}),t(j,{onClick:f=>d("sign_16"),children:t("i",{className:"icon icon-sign-red"})})]}),c(j,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]})]})},Cl=0,yd=1,kd=2,Ad=3,Oy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Cl),{roomSession:a=null}=Le(),{petRespectRemaining:l=0,respectPet:u=null}=_r(),d=o.useMemo(()=>{let m=!1;const f=ys();if(f){const I=f.model.getValue(te.FIGURE_CARRY_OBJECT);I>0&&I<999999&&(m=!0)}return m},[]),g=m=>{let f=!0;if(m)switch(m){case"respect":u(e.id),l-1>=1&&(f=!1);break;case"treat":L(new oc(e.id));break;case"pass_handitem":L(new Sm(e.id));break;case"train":a.requestPetCommands(e.id);break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"toggle_riding_permission":a.togglePetRiding(e.id);break;case"toggle_breeding_permission":a.togglePetBreeding(e.id);break;case"dismount":a.dismountPet(e.id);break;case"saddle_off":a.removePetSaddle(e.id);break;case"breed":break;case"harvest":a.harvestPet(e.id);break;case"revive":break;case"compost":a.compostPlant(e.id);break;case"buy_saddle":Z("catalog/open/"+X("catalog.links")["pets.buy_saddle"]);break}f&&n()};return o.useEffect(()=>{s(m=>e.petType===Mt.MONSTERPLANT?Ad:e.saddle&&!e.rider?yd:e.rider?kd:Cl)},[e]),c(br,{objectId:e.roomIndex,category:Q.UNIT,userType:ut.PET,onClose:n,collapsable:!0,children:[t(Qt,{children:e.name}),r===Cl&&c(G,{children:[l>0&&t(j,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])}),t(j,{onClick:m=>g("train"),children:h("infostand.button.train")}),t(j,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),e.petType===Mt.HORSE&&t(j,{onClick:m=>g("buy_saddle"),children:h("infostand.button.buy_saddle")}),[Mt.BEAR,Mt.TERRIER,Mt.CAT,Mt.DOG,Mt.PIG].indexOf(e.petType)>-1&&t(j,{onClick:m=>g("breed"),children:h("infostand.button.breed")})]}),r===yd&&c(G,{children:[t(j,{onClick:m=>g("mount"),children:h("infostand.button.mount")}),c(j,{onClick:m=>g("toggle_riding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),h("infostand.button.toggle_riding_permission")]}),l>0&&t(j,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])}),t(j,{onClick:m=>g("train"),children:h("infostand.button.train")}),t(j,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),t(j,{onClick:m=>g("saddle_off"),children:h("infostand.button.saddleoff")})]}),r===kd&&c(G,{children:[t(j,{onClick:m=>g("dismount"),children:h("infostand.button.dismount")}),l>0&&t(j,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])})]}),r===Ad&&c(G,{children:[t(j,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),e.dead&&t(j,{onClick:m=>g("revive"),children:h("infostand.button.revive")}),a.isRoomOwner&&t(j,{onClick:m=>g("compost"),children:h("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&t(j,{onClick:m=>g("treat"),children:h("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&c(G,{children:[c(j,{onClick:m=>g("toggle_breeding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),h("infostand.button.toggle_breeding_permission")]}),t(j,{onClick:m=>g("breed"),children:h("infostand.button.breed")})]})]}),d&&t(j,{onClick:m=>g("pass_hand_item"),children:h("infostand.button.pass_hand_item")})]})},_l=0,Dd=1,Pd=2,Ld=3,yy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(_l),{roomSession:a=null}=Le(),{petRespectRemaining:l=0,respectPet:u=null}=_r(),d=o.useMemo(()=>a.isRoomOwner||a.controllerLevel>=Qe.GUEST||H().isModerator,[a]),g=o.useMemo(()=>{let f=!1;const I=ys();if(I){const C=I.model.getValue(te.FIGURE_CARRY_OBJECT);C>0&&C<999999&&(f=!0)}return f},[]),m=f=>{let I=!0;if(f)switch(f){case"respect":u(e.id),l-1>=1&&(I=!1);break;case"treat":L(new oc(e.id));break;case"pass_handitem":L(new Sm(e.id));break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"dismount":a.dismountPet(e.id);break}I&&n()};return o.useEffect(()=>{s(f=>e.petType===Mt.MONSTERPLANT?Ld:e.saddle&&!e.rider?Dd:e.rider?Pd:_l)},[e]),c(br,{objectId:e.roomIndex,category:Q.UNIT,userType:ut.PET,onClose:n,collapsable:!0,children:[t(Qt,{children:e.name}),r===_l&&l>0&&t(j,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])}),r===Dd&&c(G,{children:[!!e.publiclyRideable&&t(j,{onClick:f=>m("mount"),children:h("infostand.button.mount")}),l>0&&t(j,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])})]}),r===Pd&&c(G,{children:[t(j,{onClick:f=>m("dismount"),children:h("infostand.button.dismount")}),l>0&&t(j,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[l.toString()])})]}),r===Ld&&!e.dead&&e.energy/e.maximumEnergy<.98&&t(j,{onClick:f=>m("treat"),children:h("infostand.button.pettreat")}),d&&t(j,{onClick:f=>m("pick_up"),children:h("infostand.button.pickup")}),g&&t(j,{onClick:f=>m("pass_hand_item"),children:h("infostand.button.pass_hand_item")})]})},bl=0,Md=1,xd=2,ky=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(bl),[a,l]=o.useState(""),[u,d]=o.useState("");U(ab,I=>{const C=I.getParser();if(C.botId===e.webID)switch(C.commandId){case He.CHANGE_BOT_NAME:l(C.data),s(Md);return;case He.CHANGE_BOT_MOTTO:d(C.data),s(xd);return;case He.SETUP_CHAT:{const p=C.data,_=p.split(p.indexOf(";#;")===-1?";":";#;");(_.length===3||_.length===4)&&(Nt(new Qi(e.roomIndex,Q.UNIT,e.webID,_[0],_[1].toLowerCase()==="true"||_[1]==="1",parseInt(_[2]),_[3]?_[3].toLowerCase()==="true"||_[3]==="1":!1)),n());return}}});const g=I=>L(new ib(e.webID,I)),m=I=>{let C=!0;if(I)switch(I){case"donate_to_all":g(He.DONATE_TO_ALL),L(new vr(e.webID,He.DONATE_TO_ALL,""));break;case"donate_to_user":g(He.DONATE_TO_USER),L(new vr(e.webID,He.DONATE_TO_USER,""));break;case"change_bot_name":g(He.CHANGE_BOT_NAME),C=!1;break;case"save_bot_name":L(new vr(e.webID,He.CHANGE_BOT_NAME,a));break;case"change_bot_motto":g(He.CHANGE_BOT_MOTTO),C=!1;break;case"save_bot_motto":L(new vr(e.webID,He.CHANGE_BOT_MOTTO,u));break;case"dress_up":L(new vr(e.webID,He.DRESS_UP,""));break;case"random_walk":L(new vr(e.webID,He.RANDOM_WALK,""));break;case"setup_chat":g(He.SETUP_CHAT),C=!1;break;case"dance":L(new vr(e.webID,He.DANCE,""));break;case"nux_take_tour":pe().createLinkEvent("help/tour"),L(new vr(e.webID,He.NUX_TAKE_TOUR,""));break;case"pick":L(new _m(e.webID));break}C&&n()};o.useEffect(()=>{s(bl)},[e]);const f=e.amIOwner||e.amIAnyRoomController;return c(br,{objectId:e.roomIndex,category:Q.UNIT,userType:ut.RENTABLE_BOT,onClose:n,collapsable:!0,children:[t(Qt,{children:e.name}),r===bl&&f&&c(G,{children:[e.botSkills.indexOf(He.DONATE_TO_ALL)>=0&&t(j,{onClick:I=>m("donate_to_all"),children:h("avatar.widget.donate_to_all")}),e.botSkills.indexOf(He.DONATE_TO_USER)>=0&&t(j,{onClick:I=>m("donate_to_user"),children:h("avatar.widget.donate_to_user")}),e.botSkills.indexOf(He.CHANGE_BOT_NAME)>=0&&t(j,{onClick:I=>m("change_bot_name"),children:h("avatar.widget.change_bot_name")}),e.botSkills.indexOf(He.CHANGE_BOT_MOTTO)>=0&&t(j,{onClick:I=>m("change_bot_motto"),children:h("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(He.DRESS_UP)>=0&&t(j,{onClick:I=>m("dress_up"),children:h("avatar.widget.dress_up")}),e.botSkills.indexOf(He.RANDOM_WALK)>=0&&t(j,{onClick:I=>m("random_walk"),children:h("avatar.widget.random_walk")}),e.botSkills.indexOf(He.SETUP_CHAT)>=0&&t(j,{onClick:I=>m("setup_chat"),children:h("avatar.widget.setup_chat")}),e.botSkills.indexOf(He.DANCE)>=0&&t(j,{onClick:I=>m("dance"),children:h("avatar.widget.dance")}),e.botSkills.indexOf(He.NO_PICK_UP)===-1&&t(j,{onClick:I=>m("pick"),children:h("avatar.widget.pick_up")})]}),r===Md&&c(v,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:h("bot.skill.name.configuration.new.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:a,maxLength:X("bot.name.max.length",15),onChange:I=>l(I.target.value)}),c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"secondary",onClick:I=>m(null),children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:I=>m("save_bot_name"),children:h("save")})]})]}),r===xd&&c(v,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:h("bot.skill.name.configuration.new.motto")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:X("motto.max.length",38),onChange:I=>d(I.target.value)}),c(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"secondary",onClick:I=>m(null),children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:I=>m("save_bot_motto"),children:h("save")})]})]})]})},Ay=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,l]=o.useState(null),{avatarInfo:u=null,setAvatarInfo:d=null,activeNameBubble:g=null,setActiveNameBubble:m=null,nameBubbles:f=[],removeNameBubble:I=null,productBubbles:C=[],confirmingProduct:p=null,updateConfirmingProduct:_=null,removeProductBubble:E=null,isDecorating:b=!1,setIsDecorating:N=null}=Mv(),{roomSession:T=null}=Le();Ee(_n.NORMAL_MODE,O=>{e&&n(!1)}),Ee(_n.GAME_MODE,O=>{e||n(!0)}),Pe(ob.RSDE_DANCE,O=>{O.roomIndex===T.ownRoomIndex&&s(O.danceId!==0)}),at(Qi.UPDATE_CHAT,O=>l(O));const y=()=>{if(!T||e)return null;if(g)return t(wd,{nameInfo:g,onClose:()=>m(null)});if(u)switch(u.type){case Ns.FURNI:{const O=u;return b?t(wy,{avatarInfo:O,onClose:()=>d(null)}):null}case Ct.OWN_USER:case Ct.PEER:{const O=u;return X("user.tags.enabled")&&H().getUserTags(O.roomIndex),O.isSpectatorMode?null:O.isOwnUser?Rl.isRunning()?null:t(Ry,{avatarInfo:O,isDancing:r,setIsDecorating:N,onClose:()=>d(null)}):t(vy,{avatarInfo:O,onClose:()=>d(null)})}case Ss.PET_INFO:{const O=u;return O.isOwner?t(Oy,{avatarInfo:O,onClose:()=>d(null)}):t(yy,{avatarInfo:O,onClose:()=>d(null)})}case vs.RENTABLE_BOT:return t(ky,{avatarInfo:u,onClose:()=>d(null)})}return null},R=()=>{if(!u)return null;switch(u.type){case Ns.FURNI:return t(Iy,{avatarInfo:u,onClose:()=>d(null)});case Ct.OWN_USER:case Ct.PEER:return t(Sy,{avatarInfo:u,setAvatarInfo:d,onClose:()=>d(null)});case Ct.BOT:return t(py,{avatarInfo:u,onClose:()=>d(null)});case vs.RENTABLE_BOT:return t(Cy,{avatarInfo:u,onClose:()=>d(null)});case Ss.PET_INFO:return t(Ey,{avatarInfo:u,onClose:()=>d(null)})}};return c(G,{children:[b&&t(Ty,{userId:H().userId,userName:H().userName,roomIndex:T.ownRoomIndex,setIsDecorating:N}),y(),u&&t(v,{alignItems:"end",className:"nitro-infostand-container",children:R()}),f.length>0&&f.map((O,F)=>t(wd,{nameInfo:O,onClose:()=>I(F)},F)),C.length>0&&C.map((O,F)=>t(fy,{item:O,updateConfirmingProduct:_,onClose:()=>E(F)},O.id)),a&&t(cy,{chatEvent:a,onClose:()=>l(null)}),p&&t(uy,{item:p,onClose:()=>_(null)}),t(ly,{})]})},Dy=i=>{const{chatStyleId:e=0,chatStyleIds:n=null,selectChatStyleId:r=null}=i,[s,a]=o.useState(null),[l,u]=o.useState(!1),d=m=>{r(m),u(!1)},g=m=>{let f=!1;u(I=>(f=!I,f)),f&&a(m.target)};return o.useEffect(()=>{l||a(null)},[l]),c(G,{children:[t(P,{pointer:!0,className:"icon chatstyles-icon",onClick:g}),t(ag,{show:l,target:s,placement:"top",children:t(wl,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:t(re,{overflow:"hidden",className:"bg-transparent",children:t(ne,{columnCount:3,overflow:"auto",children:n&&n.length>0&&n.map(m=>t(w,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:f=>d(m),children:t(P,{className:"bubble-container",children:t(P,{className:`chat-bubble bubble-${m}`,children:" "})},m)},m))})})})})]})},Py=i=>{const[e,n]=o.useState(""),{chatStyleId:r=0,updateChatStyleId:s=null}=_r(),{selectedUsername:a="",floodBlocked:l=!1,floodBlockedSeconds:u=0,setIsTyping:d=null,setIsIdle:g=null,sendChat:m=null}=Uv(),{roomSession:f=null}=Le(),I=o.useRef(),C=o.useMemo(()=>h("widgets.chatinput.mode.whisper"),[]),p=o.useMemo(()=>h("widgets.chatinput.mode.shout"),[]),_=o.useMemo(()=>h("widgets.chatinput.mode.speak"),[]),E=o.useMemo(()=>X("chat.input.maxlength",100),[]),b=o.useCallback(()=>{const D=document.activeElement;return!(!D||I&&I.current===D||!(D instanceof HTMLInputElement)&&!(D instanceof HTMLTextAreaElement))},[I]),N=o.useCallback(()=>{I.current.focus(),I.current.setSelectionRange(I.current.value.length*2,I.current.value.length*2)},[I]),T=o.useCallback(()=>{n(D=>D!==C||!a.length?D:`${D} ${a}`)},[a,C]),y=o.useCallback((D,A=!1)=>{if(!D||D==="")return;let k=A?dr.CHAT_SHOUT:dr.CHAT_DEFAULT,x=D;const B=x.split(" ");let V="",q="";switch(B[0]){case C:k=dr.CHAT_WHISPER,V=B[1],q=C+" "+V+" ",B.shift(),B.shift();break;case p:k=dr.CHAT_SHOUT,B.shift();break;case _:k=dr.CHAT_DEFAULT,B.shift();break}x=B.join(" "),d(!1),g(!1),x.length<=E&&(/%CC%/g.test(encodeURIComponent(x))?n(""):(n(""),m(x,k,V,r))),n(q)},[C,p,_,E,r,d,g,m]),R=o.useCallback(D=>{!D||!D.length?d(!1):(d(!0),g(!0)),n(D)},[d,g]),O=o.useCallback(D=>{if(l||!I.current||b())return;document.activeElement!==I.current&&N();const A=D.target.value;switch(D.key){case" ":case"Space":T();return;case"NumpadEnter":case"Enter":y(A,D.shiftKey);return;case"Backspace":if(A){const k=A.split(" ");k[0]===C&&k.length===3&&k[2]===""&&n("")}return}},[l,I,C,b,N,T,y]);at(_s.CHAT_INPUT_CONTENT,D=>{switch(D.chatMode){case _s.WHISPER:{n(`${C} ${D.userName} `);return}case _s.SHOUT:return}});const F=o.useMemo(()=>{let D=[];const A=X("chat.styles");for(const k of A)if(k){if(k.minRank>0){H().hasSecurity(k.minRank)&&D.push(k.styleId);continue}if(k.isSystemStyle&&H().hasSecurity(Qe.MODERATOR)){D.push(k.styleId);continue}if(!(X("chat.styles.disabled").indexOf(k.styleId)>=0)){if(k.isHcOnly&&Nn()>=sn.CLUB){D.push(k.styleId);continue}if(k.isAmbassadorOnly&&H().isAmbassador){D.push(k.styleId);continue}!k.isHcOnly&&!k.isAmbassadorOnly&&D.push(k.styleId)}}return D},[]);return o.useEffect(()=>(document.body.addEventListener("keydown",O),()=>{document.body.removeEventListener("keydown",O)}),[O]),o.useEffect(()=>{I.current&&(I.current.parentElement.dataset.value=e)},[e]),!f||f.isSpectator?null:Xl.createPortal(c("div",{className:"nitro-chat-input-container",children:[c("div",{className:"input-sizer align-items-center",children:[!l&&t("input",{ref:I,type:"text",className:"chat-input",placeholder:h("widgets.chatinput.default"),value:e,maxLength:E,onChange:D=>R(D.target.value),onMouseDown:D=>N()}),l&&c(S,{variant:"danger",children:[h("chat.input.alert.flood",["time"],[u.toString()])," "]})]}),t(Dy,{chatStyleId:r,chatStyleIds:F,selectChatStyleId:s})]}),document.getElementById("toolbar-chat-input-container"))},Ly=()=>{let i=null;self.onmessage=e=>{if(!e)return;const n=e.data;switch(n.action){case"START":i=setInterval(()=>postMessage(null),n.content);break;case"STOP":i&&(clearInterval(i),i=null);break}}};class My extends Worker{constructor(e){const n=e.toString(),r=new Blob([`(${n})()`]);super(URL.createObjectURL(r))}}const xy=i=>{const{chat:e=null,makeRoom:n=null,bubbleWidth:r=gt.CHAT_BUBBLE_WIDTH_NORMAL}=i,[s,a]=o.useState(!1),[l,u]=o.useState(!1),d=o.useRef(),g=o.useMemo(()=>{switch(r){case gt.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case gt.CHAT_BUBBLE_WIDTH_THIN:return 240;case gt.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[r]);return o.useEffect(()=>{a(!1);const m=d.current;if(!m)return;const f=m.offsetWidth,I=m.offsetHeight;e.width=f,e.height=I,e.elementRef=m;let C=e.left,p=e.top;return!C&&!p&&(C=e.location.x-f/2,p=m.parentElement.offsetHeight-I,e.left=C,e.top=p),u(!0),()=>{e.elementRef=null,u(!1)}},[e]),o.useEffect(()=>{!l||!e||s||(n&&n(e),a(!0))},[e,l,s,n]),c("div",{ref:d,className:`bubble-container ${s?"visible":"invisible"}`,onClick:m=>$().selectRoomObject(e.roomId,e.senderId,Q.UNIT),children:[e.styleId===0&&t("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),c("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:g},children:[t("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),c("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${e.username}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${e.formattedText}`}})]}),t("div",{className:"pointer"})]})]})},Uy=i=>{const{chatMessages:e=[],setChatMessages:n=null,chatSettings:r=null,getScrollSpeed:s=6e3}=Vv(),a=o.useRef(),l=o.useCallback(()=>{n(g=>{if(g){const m=g.filter(f=>f.top>-f.height*2);if(m.length!==g.length)return m}return g})},[n]),u=o.useCallback((g,m,f)=>{for(let I=e.indexOf(g)-1;I>=0;I--){const C=e[I];if(!(!C||g===C||f.indexOf(C)>=0||C.top+C.height-m>g.top+g.height)&&RN(g,C,-m,0)){const p=Math.abs(C.top+C.height-g.top);f.push(C),C.top-=p,C.skipMovement=!0,u(C,p,f)}}},[e]),d=o.useCallback(g=>{if(r.mode===gt.CHAT_MODE_FREE_FLOW)g.skipMovement=!0,u(g,0,[g]),l();else{const m=g.top+g.height,f=g.height,I=a.current.offsetHeight-m,C=f-I;I<f&&(n(p=>(p.forEach(_=>{_!==g&&(_.top-=C)}),p)),l())}},[r,u,l,n]);return o.useEffect(()=>{const g=(m=null)=>{if(!a||!a.current)return;const f=a.current.offsetHeight,I=Math.round(document.body.offsetHeight*X("chat.viewer.height.percentage"));a.current.style.height=`${I}px`,n(C=>(C&&C.forEach(p=>p.top-=f-I),C))};return window.addEventListener("resize",g),g(),()=>{window.removeEventListener("resize",g)}},[n]),o.useEffect(()=>{const g=f=>{n(I=>(I.forEach(C=>{if(C.skipMovement){C.skipMovement=!1;return}C.top-=f}),I)),l()},m=new My(Ly);return m.onmessage=()=>g(15),m.postMessage({action:"START",content:s}),()=>{m.postMessage({action:"STOP"})}},[s,l,n]),t("div",{ref:a,className:"nitro-chat-widget",children:e.map(g=>t(xy,{chat:g,makeRoom:d,bubbleWidth:r.weight},g.id))})},Uh=i=>{const{title:e=null,items:n=[],selectItem:r=null,onClose:s=null}=i,[a,l]=o.useState(null),[u,d]=o.useState(""),g=H().isModerator,m=o.useMemo(()=>{const f=u.toLocaleLowerCase();return n.filter(I=>{var C;return(C=I.name)==null?void 0:C.toLocaleLowerCase().includes(f)})},[n,u]);return o.useEffect(()=>{a&&r(a)},[a,r]),c(se,{className:"nitro-chooser-widget",theme:"primary",children:[t(ae,{headerText:e,onCloseClick:s}),c(re,{overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:u,onChange:f=>d(f.target.value)}),t(Lo,{rows:m,rowRender:f=>t(w,{alignItems:"center",className:Ts("rounded p-1",a===f&&"bg-muted"),pointer:!0,onClick:I=>l(f),children:c(S,{truncate:!0,children:[f.name," ",g&&" - "+f.id]})})})]})]})},Fy=i=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=zv();return o.useEffect(()=>{const a={linkReceived:l=>{l.split("/"),s()},eventUrlPrefix:"furni-chooser/"};return pt(a),()=>It(a)},[s]),e?t(Uh,{title:h("widget.chooser.furni.title"),items:e,selectItem:r,onClose:n}):null},Vy=i=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=Zv();return o.useEffect(()=>{const a={linkReceived:l=>{l.split("/"),s()},eventUrlPrefix:"user-chooser/"};return pt(a),()=>It(a)},[s]),e?t(Uh,{title:h("widget.chooser.user.title"),items:e,selectItem:r,onClose:n}):null},Gy=i=>{const[e,n]=o.useState(!1),{users:r=[],answer:s=null}=Bv();return o.useEffect(()=>{n(!!r.length)},[r]),e?c(se,{className:"nitro-widget-doorbell",theme:"primary",children:[t(ae,{headerText:h("navigator.doorbell.title"),onCloseClick:a=>n(!1)}),c(re,{overflow:"hidden",gap:0,children:[t(v,{gap:2,children:c(ne,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[t(P,{className:"g-col-6",children:h("generic.username")}),t(P,{className:"g-col-6"})]})}),t(v,{overflow:"auto",className:"striped-children",gap:0,children:r&&r.length>0&&r.map(a=>c(ne,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[t(P,{className:"g-col-6",children:a}),t(P,{className:"g-col-6",children:c(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(M,{variant:"success",onClick:()=>s(a,!0),children:h("generic.accept")}),t(M,{variant:"danger",onClick:()=>s(a,!1),children:h("generic.deny")})]})})]},a))})]})]}):null},Rc=i=>{const{objectId:e=-1,category:n=-1,noFollow:r=!1,position:s="absolute",...a}=i,[l,u]=o.useState({x:-1,y:-1}),d=o.useRef();return o.useEffect(()=>{let g=!1;const m=()=>{const I=Te();return lc(I.roomId,e,n,1)},f=()=>{const I=m();!I||!d.current||u({x:Math.round(I.left+I.width/2-d.current.offsetWidth/2),y:Math.round(I.top-d.current.offsetHeight+10)})};return r?f():(g=!0,zn().add(f)),()=>{g&&zn().remove(f)}},[e,n,r]),t(P,{innerRef:d,position:s,visible:l.x+(d.current?d.current.offsetWidth:0)>-1,className:"object-location",style:{left:l.x,top:l.y},...a})},By=i=>{const{roomIndex:e=-1,request:n=null,hideFriendRequest:r=null,requestResponse:s=null}=i;return t(Rc,{objectId:e,category:Q.UNIT,children:t(P,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:c(v,{children:[c(w,{alignItems:"center",justifyContent:"between",gap:2,children:[t(S,{variant:"white",fontSize:6,children:h("widget.friendrequest.from",["username"],[n.name])}),t(w,{center:!0,position:"absolute",className:"end-2 top-2 nitro-card-header-close",onClick:a=>r(n.requesterUserId),children:t(Xn,{className:"fa-icon w-12 h-12"})})]}),c(w,{justifyContent:"between",alignItems:"center",gap:1,children:[t(w,{style:{textDecoration:"underline"},onClick:a=>s(n.requesterUserId,!1),children:h("widget.friendrequest.decline")}),t(M,{variant:"success",onClick:a=>s(n.requesterUserId,!0),children:h("widget.friendrequest.accept")})]})]})})})},Hy=i=>{const{displayedRequests:e=[],hideFriendRequest:n=null}=qv(),{requestResponse:r=null}=ln();return e.length?t(G,{children:e.map((s,a)=>t(By,{roomIndex:s.roomIndex,request:s.request,hideFriendRequest:n,requestResponse:r},a))}):null},Wy=i=>{const{productType:e=he.FLOOR,classId:n=-1,extraParam:r=void 0}=i;switch(e){case he.WALL:case he.FLOOR:return t(fc,{productType:e,productClassId:n});case he.BADGE:return t(We,{badgeCode:r});case he.HABBO_CLUB:return t(st,{type:"hc"})}return null},jy=i=>{const{ownerId:e=-1}=i,[n,r]=o.useState(0),[s,a]=o.useState(void 0),l=()=>{n===1&&L(new db(e)),r(0),a(void 0)};U(lb,d=>{r(1)}),U(cb,d=>{r(0),a(void 0)}),U(ub,d=>{const g=d.getParser();a({contentType:g.contentType,classId:g.classId}),r(2)});const u=H().userId===e;return n===0?null:c(se,{className:"nitro-mysterybox-dialog",theme:"primary",children:[t(ae,{headerText:h(n===1?`mysterybox.dialog.${u?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:l}),c(re,{children:[n===1&&c(G,{children:[c(S,{variant:"primary",children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.subtitle`)," "]}),c(S,{children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.description`)," "]}),c(S,{children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.waiting`)]}),c(M,{variant:"danger",onClick:l,className:"mt-auto",children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.cancel`)," "]})]}),n===2&&s&&c(G,{children:[c(S,{variant:"black",children:[" ",h("mysterybox.reward.text")," "]}),t(w,{className:"prize-container justify-content-center mx-auto",children:t(Wy,{classId:s.classId,productType:s.contentType})}),c(M,{variant:"success",onClick:l,className:"mt-auto",children:[" ",h("mysterybox.reward.close")," "]})]})]})]})},qy=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(""),a=()=>{L(new mb(e,r)),n()};return e===-1?null:c(se,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary",children:[t(ae,{center:!0,headerText:h("mysterytrophy.header.title"),onCloseClick:n}),c(re,{children:[c(w,{className:"mysterytrophy-dialog-top p-3",children:[t("div",{className:"mysterytrophy-image flex-shrink-0"}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"mysterytrophy-text-big",children:h("mysterytrophy.header.description")})})]}),t(w,{className:"mysterytrophy-dialog-bottom p-2",children:c(v,{gap:1,children:[c(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[t("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:r,onChange:l=>s(l.target.value)}),t("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),c(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>n(),children:h("cancel")}),t(M,{variant:"success",onClick:()=>a(),children:h("generic.ok")})]})]})})]})]})},Yy=i=>{const{objectId:e=-1,onClose:n=null}=i,{roomSession:r=null}=Le(),s=()=>{r.useMultistateItem(e),n()};return c(se,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("effectbox.header.title"),onCloseClick:n}),t(re,{center:!0,children:t(w,{gap:2,children:c(v,{justifyContent:"between",children:[t(S,{children:h("effectbox.header.description")}),c(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("generic.cancel")}),t(M,{variant:"success",onClick:s,children:h("generic.ok")})]})]})})})]})},Di=-1,zy=0,$y=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(null),[a,l]=o.useState(Di),{roomSession:u=null}=Le(),d=()=>{u.useMultistateItem(e),n()};return o.useEffect(()=>{if(!u||e===-1)return;const g=Oo(u.roomId,e,Q.FLOOR);if(!g)return;s(g);let m=Di;switch(g.specialType){case ce.MONSTERPLANT_SEED:m=zy;break}if(m===Di){n();return}l(m)},[u,e,n]),a===Di?null:c(se,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title.plant_seed",["name"],[r.name]),onCloseClick:n}),t(re,{center:!0,children:c(w,{gap:2,overflow:"hidden",children:[t(v,{children:t(P,{className:"product-preview",children:t(P,{className:"monsterplant-image"})})}),c(v,{justifyContent:"between",overflow:"auto",children:[c(v,{gap:2,children:[t(S,{children:h("useproduct.widget.text.plant_seed",["productName"],[r.name])}),t(S,{children:h("useproduct.widget.info.plant_seed")})]}),c(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:d,children:h("widget.monsterplant_seed.button.use")})]})]})]})})]})},Pi=-1,Ky=0,Xy=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(Pi),[a,l]=o.useState(be.MALE),[u,d]=o.useState(null),{roomSession:g=null}=Le(),m=()=>{Dl().send(new hb(e)),Dl().send(new dm(a,u)),n()};return o.useEffect(()=>{let f=Pi;const I=H().figure,C=H().gender,p=[];if(g&&e>=0){const _=Oo(g.roomId,e,Q.FLOOR);if(_)switch(_.specialType){case ce.FIGURE_PURCHASABLE_SET:f=Ky;const E=_.customParams.split(",").map(b=>parseInt(b));for(const b of E)St().isValidFigureSetForGender(b,C)&&p.push(b);break}}if(f===Pi){n();return}l(C),d(St().getFigureStringWithFigureIds(I,C,p)),s(f)},[g,e,n]),r===Pi?null:c(se,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title.bind_clothing"),onCloseClick:n}),t(re,{center:!0,children:c(w,{gap:2,overflow:"hidden",children:[t(v,{children:t(P,{className:"mannequin-preview",children:t(it,{figure:u,direction:2})})}),c(v,{justifyContent:"between",overflow:"auto",children:[c(v,{gap:2,children:[t(S,{children:h("useproduct.widget.text.bind_clothing")}),t(S,{children:h("useproduct.widget.info.bind_clothing")})]}),c(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:m,children:h("useproduct.widget.bind_clothing")})]})]})]})})]})},Qy=i=>{const{closeConfirm:e=null,processAction:n=null,onClose:r=null,objectId:s=-1,mode:a=null,confirmMode:l=null,confirmingObjectId:u=-1,groupData:d=null,isGroupMember:g=!1,objectOwnerId:m=-1}=jS(),{simpleAlert:f=null}=je();U(gb,C=>{const p=C.getParser();if(p)switch(p.count){case 1:f(h("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",h("costumehopper.costumerequired.buy"),h("costumehopper.costumerequired.header"),null);break;case 2:f(h("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",h("viprequired.buy.vip"),h("viprequired.header"),null);break;case 3:f(h("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",h("viprequired.buy.vip"),h("gate.viprequired.title"),null);break}});const I=H().userId===m;return c(G,{children:[l===Wl&&t($y,{objectId:u,onClose:e}),l===jl&&t(Xy,{objectId:u,onClose:e}),l===mh&&t(Yy,{objectId:u,onClose:e}),l===ql&&t(qy,{objectId:u,onClose:e}),t(jy,{ownerId:m}),s>=0&&a&&c(br,{objectId:s,category:Q.FLOOR,onClose:r,fades:!0,children:[a===Lt.FRIEND_FURNITURE&&c(G,{children:[t(Qt,{children:h("friendfurni.context.title")}),t(j,{onClick:C=>n("use_friend_furni"),children:h("friendfurni.context.use")})]}),a===Lt.MONSTERPLANT_SEED&&c(G,{children:[t(Qt,{children:h("furni.mnstr_seed.name")}),t(j,{onClick:C=>n("use_monsterplant_seed"),children:h("widget.monsterplant_seed.button.use")})]}),a===Lt.RANDOM_TELEPORT&&c(G,{children:[t(Qt,{children:h("furni.random_teleport.name")}),t(j,{onClick:C=>n("use_random_teleport"),children:h("widget.random_teleport.button.use")})]}),a===Lt.PURCHASABLE_CLOTHING&&c(G,{children:[t(Qt,{children:h("furni.generic_usable.name")}),t(j,{onClick:C=>n("use_purchaseable_clothing"),children:h("widget.generic_usable.button.use")})]}),a===Lt.MYSTERY_BOX&&c(G,{children:[t(Qt,{children:h("mysterybox.context.title")}),t(j,{onClick:C=>n("use_mystery_box"),children:h("mysterybox.context."+(I?"owner":"other")+".use")})]}),a===Lt.MYSTERY_TROPHY&&c(G,{children:[t(Qt,{children:h("mysterytrophy.header.title")}),t(j,{onClick:C=>n("use_mystery_trophy"),children:h("friendfurni.context.use")})]}),a===dh&&d&&c(G,{children:[t(Qt,{className:"cursor-pointer text-truncate",onClick:()=>Za(d.guildId),children:d.guildName}),!g&&t(j,{onClick:C=>n("join_group"),children:h("widget.furniture.button.join.group")}),t(j,{onClick:C=>n("go_to_group_homeroom"),children:h("widget.furniture.button.go.to.group.home.room")}),d.guildHasReadableForum&&t(j,{onClick:C=>n("open_forum"),children:h("widget.furniture.button.open_group_forum")})]})]})]})},Jy=i=>{const{objectId:e=-1,color:n=0,setColor:r=null,applyToner:s=null,toggleToner:a=null,onClose:l=null}=GS();return e===-1?null:c(se,{theme:"primary",className:"nitro-room-widget-toner",children:[t(ae,{headerText:h("widget.backgroundcolor.title"),onCloseClick:l}),c(re,{overflow:"hidden",justifyContent:"between",children:[t(v,{overflow:"auto",gap:1,children:t("input",{type:"color",className:"form-control",value:an.makeColorNumberHex(n),onChange:u=>r(an.convertFromHex(u.target.value))})}),c(v,{gap:1,children:[t(M,{fullWidth:!0,variant:"primary",onClick:a,children:h("widget.backgroundcolor.button.on")}),t(M,{fullWidth:!0,variant:"primary",onClick:s,children:h("widget.backgroundcolor.button.apply")})]})]})]})},Zy=i=>{const{objectId:e=-1,color:n="1",badgeName:r="",badgeDesc:s="",date:a="",senderName:l="",onClose:u=null}=HS();return e===-1?null:t(nh,{color:n,message:s,date:a,senderName:l,customTitle:r,onCloseClick:u})},e1=i=>{const{objectId:e=-1,recipes:n=[],ingredients:r=[],selectedRecipe:s=null,requiredIngredients:a=null,isCrafting:l=!1,craft:u=null,selectRecipe:d=null,onClose:g=null}=YS(),{roomSession:m=null}=Le(),[f,I]=o.useState(!1),C=o.useMemo(()=>{const E=$().getRoomObject(m.roomId,e,Q.FLOOR);return Wt(E)},[e,m.roomId]),p=o.useMemo(()=>{if(!a||!a.length)return!1;for(const E of a){const b=r.find(N=>N.name===E.itemName);if(!b||b.count<E.count)return!1}return!0},[r,a]),_=()=>{if(!f){I(!0);return}u(),I(!1)};return o.useEffect(()=>{I(!1)},[s]),e===-1?null:c(se,{className:"nitro-widget-crafting",theme:"primary",children:[t(ae,{headerText:h("crafting.title"),onCloseClick:g}),t(re,{children:c(w,{grow:!0,overflow:"hidden",gap:2,children:[c(w,{column:!0,fullWidth:!0,gap:2,children:[c(v,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.title.products")}),t(ye,{columnCount:5,children:n.length>0&&n.map(E=>t(Ne,{itemImage:E.iconUrl,itemActive:s&&s.name===E.name,onClick:()=>d(E)},E.name))})]}),c(v,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.title.mixer")}),t(ye,{columnCount:5,children:r.length>0&&r.map(E=>t(Ne,{itemImage:E.iconUrl,itemCount:E.count,itemCountMinimum:0,className:(E.count?"":"opacity-0-5 ")+"cursor-default"},E.name))})]})]}),c(w,{column:!0,fullWidth:!0,gap:2,children:[!s&&t(v,{center:!0,fullHeight:!0,className:"text-black text-center",children:h("crafting.info.start")}),s&&c(G,{children:[c(v,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.current_recipe")}),t(ye,{columnCount:5,children:!!a&&a.length>0&&a.map(E=>{const b=r.find(T=>T.name===E.itemName),N=[];for(let T=0;T<E.count;T++)N.push(t(Ne,{itemImage:b.iconUrl,className:(b.count-T<=0?"opacity-0-5 ":"")+"cursor-default"},T));return N})})]}),c(w,{gap:2,column:!0,fullHeight:!0,children:[c(w,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[t("div",{className:"py-1 text-center",children:h("crafting.result")}),c(w,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[t(v,{fullHeight:!0,children:t("img",{src:s.iconUrl})}),t("div",{className:"text-black",children:s.localizedName})]})]}),c(M,{variant:!C||!p?"danger":f?"warning":l?"primary":"success",disabled:!C||!p||l,onClick:_,children:[!l&&h(C?p?f?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),l&&t(pc,{})]})]})]})]})]})})]})},t1=i=>{const[e,n]=o.useState(!1),{presets:r=[],dimmerState:s=0,selectedPresetId:a=0,color:l=16777215,brightness:u=255,effectId:d=0,selectedColor:g=0,setSelectedColor:m=null,selectedBrightness:f=0,setSelectedBrightness:I=null,selectedEffectId:C=0,setSelectedEffectId:p=null,selectPresetId:_=null,applyChanges:E}=$S(),b=()=>{Pn.previewDimmer(l,u,d===2),n(!1)};Ee(_e.REMOVE_DIMMER,T=>n(!1)),o.useEffect(()=>{!r||!r.length||n(!0)},[r]);const N=o.useMemo(()=>X("widget.dimmer.colorwheel",!1),[]);return e?c(se,{className:"nitro-room-widget-dimmer",children:[t(ae,{headerText:h("widget.dimmer.title"),onCloseClick:b}),s===1&&t(Zr,{children:r.map(T=>t(Ir,{isActive:a===T.id,onClick:y=>_(T.id),children:h(`widget.dimmer.tab.${T.id}`)},T.id))}),c(re,{children:[s===0&&c(v,{alignItems:"center",children:[t(P,{className:"dimmer-banner"}),t(S,{center:!0,className:"bg-muted rounded p-1",children:h("widget.dimmer.info.off")}),t(M,{fullWidth:!0,variant:"success",onClick:()=>Pn.changeState(),children:h("widget.dimmer.button.on")})]}),s===1&&c(G,{children:[c(v,{gap:1,children:[t(S,{fontWeight:"bold",children:h("widget.backgroundcolor.hue")}),N&&t("input",{type:"color",className:"form-control",value:an.makeColorNumberHex(g),onChange:T=>m(an.convertFromHex(T.target.value))}),!N&&t(ne,{gap:1,columnCount:7,children:Pn.AVAILABLE_COLORS.map((T,y)=>t(v,{fullWidth:!0,pointer:!0,className:Ts("color-swatch rounded",T===g&&"active"),onClick:()=>m(T),style:{backgroundColor:Pn.HTML_COLORS[y]}},y))})]}),c(v,{gap:1,children:[t(S,{fontWeight:"bold",children:h("widget.backgroundcolor.lightness")}),t(At,{className:"nitro-slider",min:Pn.MIN_BRIGHTNESS,max:Pn.MAX_BRIGHTNESS,value:f,onChange:T=>I(T),thumbClassName:"thumb percent",renderThumb:(T,y)=>t("div",{...T,children:Pn.scaleBrightness(y.valueNow)})})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:C===2,onChange:T=>p(T.target.checked?2:1)}),t(S,{children:h("widget.dimmer.type.checkbox")})]}),c(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",onClick:()=>Pn.changeState(),children:h("widget.dimmer.button.off")}),t(M,{fullWidth:!0,variant:"success",onClick:E,children:h("widget.dimmer.button.apply")})]})]})]})]}):null},n1=i=>{const{objectId:e=-1,value:n=0,onClose:r=null,redeem:s=null}=XS();return e===-1?null:c(se,{className:"nitro-widget-exchange-credit",theme:"primary",children:[t(ae,{headerText:h("catalog.redeem.dialog.title"),onCloseClick:r}),t(re,{center:!0,children:c(w,{overflow:"hidden",gap:2,children:[t(v,{center:!0,children:t(P,{className:"exchange-image"})}),c(v,{grow:!0,justifyContent:"between",overflow:"hidden",children:[c(v,{gap:1,overflow:"auto",children:[t(S,{fontWeight:"bold",children:h("creditfurni.description",["credits"],[n.toString()])}),t(S,{children:h("creditfurni.prompt")})]}),t(M,{variant:"success",onClick:s,children:h("catalog.redeem.dialog.button.exchange")})]})]})})]})},r1=i=>{const{currentIndex:e=-1,currentPhotos:n=null}=i,[r,s]=o.useState(0),a=n&&n.length?n[r]:null,l=()=>{s(d=>{let g=d+1;return g>=n.length&&(g=0),g})},u=()=>{s(d=>{let g=d-1;return g<0&&(g=n.length-1),g})};return o.useEffect(()=>{s(e)},[e]),a?c(ne,{style:{display:"flex",flexDirection:"column"},children:[t(w,{center:!0,className:"picture-preview border border-black",style:a.w?{backgroundImage:"url("+a.w+")"}:{},children:!a.w&&t(S,{bold:!0,children:h("camera.loading")})}),a.m&&a.m.length&&t(S,{center:!0,children:a.m}),c(w,{alignItems:"center",justifyContent:"between",children:[t(S,{children:a.n||""}),t(S,{children:new Date(a.t*1e3).toLocaleDateString()})]}),n.length>1&&c(w,{className:"picture-preview-buttons",children:[t(Bd,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:u}),t(S,{underline:!0,className:"cursor-pointer",onClick:d=>on(a.oi),children:a.o}),t(Hd,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:l})]})]}):null},s1=i=>{const{objectId:e=-1,currentPhotoIndex:n=-1,currentPhotos:r=null,onClose:s=null}=JS(),{report:a=null}=Fn();return e===-1||n===-1?null:c(se,{className:"nitro-external-image-widget",theme:"primary",children:[t(ae,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>a(Je.PHOTO,{extraData:r[n].w,roomId:r[n].s,reportedUserId:H().userId,roomObjectId:Number(r[n].u)}),onCloseClick:s}),t(re,{children:t(r1,{currentIndex:n,currentPhotos:r})})]})},a1=i=>{const{objectId:e=-1,type:n=0,stage:r=0,usernames:s=[],figures:a=[],date:l=null,onClose:u=null,respond:d=null}=ev();if(e===-1)return null;if(r>0)return c(se,{className:"nitro-engraving-lock",theme:"primary",children:[t(ae,{headerText:h("friend.furniture.confirm.lock.caption"),onCloseClick:u}),c(re,{children:[t("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:h("friend.furniture.confirm.lock.subtitle")}),t("div",{className:"d-flex justify-content-center mb-2",children:t("div",{className:`engraving-lock-stage-${r}`})}),r===2&&t("div",{className:"text-small text-black text-center mb-2",children:h("friend.furniture.confirm.lock.other.locked")}),c(w,{gap:1,children:[t(M,{fullWidth:!0,onClick:g=>d(!1),children:h("friend.furniture.confirm.lock.button.cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:g=>d(!0),children:h("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(s.length>0)return t(Jr,{handleSelector:".nitro-engraving-lock-view",children:c("div",{className:`nitro-engraving-lock-view engraving-lock-${n}`,children:[t("div",{className:"engraving-lock-close",onClick:u}),c(w,{justifyContent:"center",children:[t("div",{className:"engraving-lock-avatar",children:t(it,{figure:a[0],direction:2})}),t("div",{className:"engraving-lock-avatar",children:t(it,{figure:a[1],direction:4})})]}),c(v,{justifyContent:"between",className:"mt-1",children:[c(v,{alignItems:"center",justifyContent:"center",gap:1,children:[c("div",{children:[n===0&&h("lovelock.engraving.caption"),n===3&&h("wildwest.engraving.caption")]}),t("div",{children:l})]}),c(w,{justifyContent:"center",gap:4,children:[t("div",{children:s[0]}),t("div",{children:s[1]})]})]})]})})},i1=i=>{const{objectId:e=-1,classId:n=-1,itemType:r=null,text:s=null,isOwnerOfFurniture:a=!1,senderName:l=null,senderFigure:u=null,placedItemId:d=-1,placedItemType:g=null,placedInRoom:m=!1,imageUrl:f=null,openPresent:I=null,onClose:C=null}=fv(),{groupItems:p=[]}=ks();if(e===-1)return null;const _=E=>{const b=p.find(N=>{var T;return((T=N.getItemById(E))==null?void 0:T.id)===E});b&&ra(b),C()};return c(se,{className:"nitro-gift-opening",theme:"primary",children:[t(ae,{headerText:h(l?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[l]),onCloseClick:C}),c(re,{children:[d===-1&&c(v,{overflow:"hidden",children:[t(w,{center:!0,overflow:"auto",children:t(Jm,{userName:l,figure:u,message:s})}),a&&c(w,{gap:1,children:[l&&t(M,{fullWidth:!0,onClick:E=>Z("catalog/open"),children:h("widget.furni.present.give_gift",["name"],[l])}),t(M,{fullWidth:!0,variant:"success",onClick:I,children:h("widget.furni.present.open_gift")})]})]}),d>-1&&c(w,{gap:2,overflow:"hidden",children:[t(v,{center:!0,className:"p-2",children:t(Cr,{imageUrl:f})}),c(v,{grow:!0,children:[c(v,{center:!0,gap:1,children:[t(S,{wrap:!0,small:!0,children:h("widget.furni.present.message_opened")}),t(S,{bold:!0,fontSize:5,children:s})]}),c(v,{grow:!0,gap:1,children:[c(w,{gap:1,children:[m&&t(M,{fullWidth:!0,onClick:null,children:h("widget.furni.present.put_in_inventory")}),t(M,{fullWidth:!0,variant:"success",onClick:E=>_(d),children:h(m?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),l&&l.length&&t(M,{fullWidth:!0,onClick:E=>Z("catalog/open"),children:h("widget.furni.present.give_gift",["name"],[l])})]})]})]})]})]})},o1=i=>{const{stuffDatas:e=null,getScoreType:n=null,getClearType:r=null}=sv();return!e||!e.size?null:t(G,{children:Array.from(e.entries()).map(([s,a],l)=>t(Rc,{objectId:s,category:Q.FLOOR,children:c(v,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[t(Qt,{children:h("high.score.display.caption",["scoretype","cleartype"],[h(`high.score.display.scoretype.${n(a.scoreType)}`),h(`high.score.display.cleartype.${r(a.clearType)}`)])}),c(xh,{overflow:"hidden",gap:1,className:"h-100",children:[c(v,{gap:1,children:[c(w,{alignItems:"center",children:[t(S,{center:!0,bold:!0,variant:"white",className:"col-8",children:h("high.score.display.users.header")}),t(S,{center:!0,bold:!0,variant:"white",className:"col-4",children:h("high.score.display.score.header")})]}),t("hr",{className:"m-0"})]}),t(v,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:a.entries.map((u,d)=>c(w,{alignItems:"center",children:[t(S,{center:!0,variant:"white",className:"col-8",children:u.users.join(", ")}),t(S,{center:!0,variant:"white",className:"col-4",children:u.score})]},d))})]})]})},l))})},l1=i=>(ov(),null),c1=-1,Li=0,Nl=1,Sl=2,vl=3,Tl=4,u1=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(c1),{objectId:a=-1,figure:l=null,gender:u=null,clubLevel:d=sn.NO_CLUB,name:g=null,setName:m=null,saveFigure:f=null,wearFigure:I=null,saveName:C=null,onClose:p=null}=cv();return o.useEffect(()=>{if(a===-1)return;const _=Te();if(_.isRoomOwner||_.controllerLevel>=Qe.GUEST||H().isModerator){s(Li);return}if(H().gender.toLowerCase()!==u.toLowerCase()){s(Tl);return}if(Nn()<d){s(vl);return}s(Sl)},[a,u,d]),o.useEffect(()=>{switch(r){case Li:case Tl:{const _=St().createFigureContainer(l);Zs.transformAsMannequinFigure(_),n(_.getFigureString());break}case Nl:{const _=St().createFigureContainer(H().figure);Zs.transformAsMannequinFigure(_),n(_.getFigureString());break}case Sl:case vl:{const _=Zs.getMergedMannequinFigureContainer(H().figure,l);n(_.getFigureString());break}}},[r,l,d]),a===-1?null:c(se,{className:"nitro-mannequin no-resize",theme:"primary",children:[t(ae,{headerText:h("mannequin.widget.title"),onCloseClick:p}),t(re,{center:!0,children:c(w,{fullWidth:!0,gap:2,overflow:"hidden",children:[t(v,{children:c(P,{position:"relative",className:"mannequin-preview",children:[t(it,{position:"absolute",figure:e,direction:2}),d>0&&t(st,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),c(v,{grow:!0,justifyContent:"between",overflow:"auto",children:[r===Li&&c(G,{children:[t("input",{type:"text",className:"form-control form-control-sm",value:g,onChange:_=>m(_.target.value),onBlur:C}),c(v,{gap:1,children:[t(M,{variant:"success",onClick:_=>s(Nl),children:h("mannequin.widget.style")}),t(M,{variant:"success",onClick:I,children:h("mannequin.widget.wear")})]})]}),r===Nl&&c(G,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:g}),t(S,{wrap:!0,children:h("mannequin.widget.savetext")})]}),c(w,{alignItems:"center",justifyContent:"between",children:[t(S,{underline:!0,pointer:!0,onClick:_=>s(Li),children:h("mannequin.widget.back")}),t(M,{variant:"success",onClick:f,children:h("mannequin.widget.save")})]})]}),r===Sl&&c(G,{children:[c(v,{gap:1,children:[t(S,{bold:!0,children:g}),t(S,{children:h("mannequin.widget.weartext")})]}),t(M,{variant:"success",onClick:I,children:h("mannequin.widget.wear")})]}),r===vl&&t(w,{center:!0,grow:!0,children:t(S,{children:h("mannequin.widget.clubnotification")})}),r===Tl&&t(S,{children:h("mannequin.widget.wronggender")})]})]})})]})},d1=i=>(Ev(),null),Fh=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],m1=["blue","pink","green","yellow"],h1=i=>{let e=Fh.indexOf(i);return e===-1&&(e=0),m1[e]},g1=i=>{const{objectId:e=-1,color:n="0",setColor:r=null,text:s="",setText:a=null,canModify:l=!1,onClose:u=null}=_v();return e===-1?null:t(Jr,{handleSelector:".drag-handler",windowPosition:Ft.TOP_LEFT,children:c("div",{className:"nitro-stickie nitro-stickie-image stickie-"+h1(n),children:[c("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:l&&c(G,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:u}),Fh.map(d=>t("div",{className:"stickie-color ms-1",onClick:g=>r(d),style:{backgroundColor:an.makeColorHex(d)}},d))]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),t("div",{className:"stickie-context",children:t("textarea",{className:"context-text",value:s,onChange:d=>a(d.target.value),tabIndex:0,autoFocus:!0})})]})})},f1=i=>{const{objectId:e=-1,height:n=0,maxHeight:r=40,onClose:s=null,updateHeight:a=null}=Nv(),[l,u]=o.useState(""),d=g=>{u(g);const m=parseFloat(g);isNaN(m)||m===n||a(m)};return o.useEffect(()=>{u(n.toString())},[n]),e===-1?null:c(se,{className:"nitro-widget-custom-stack-height",theme:"primary",children:[t(ae,{headerText:h("widget.custom.stack.height.title"),onCloseClick:s}),c(re,{justifyContent:"between",children:[t(S,{children:h("widget.custom.stack.height.text")}),c(w,{gap:2,children:[t(At,{className:"nitro-slider",min:0,max:r,step:.01,value:n,onChange:g=>a(g),renderThumb:(g,m)=>t("div",{...g,children:m.valueNow})}),t("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:r,value:l,onChange:g=>d(g.target.value)})]}),c(v,{gap:1,children:[t(M,{onClick:g=>L(new kl(e,-100)),children:h("furniture.above.stack")}),t(M,{onClick:g=>L(new kl(e,0)),children:h("furniture.floor.level")})]})]})]})},Vh=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],p1=["blue","pink","green","yellow"],I1=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],E1=["post_it","shakesp","dreams","christmas","heart","juninas"],C1=i=>{let e=Vh.indexOf(i);return e===-1&&(e=0),p1[e]},_1=i=>{let e=I1.indexOf(i);return e===-1&&(e=0),E1[e]},b1=i=>{const{objectId:e=-1,color:n="0",text:r="",type:s="",canModify:a=!1,updateColor:l=null,updateText:u=null,trash:d=null,onClose:g=null}=vv(),[m,f]=o.useState(!1);return o.useEffect(()=>{f(!1)},[e,n,r,s]),e===-1?null:t(Jr,{handleSelector:".drag-handler",windowPosition:Ft.TOP_LEFT,children:c("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(s=="post_it"?C1(n):_1(s)),children:[c("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:a&&c(G,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:d}),s=="post_it"&&t(G,{children:Vh.map(I=>t("div",{className:"stickie-color ms-1",onClick:C=>l(I),style:{backgroundColor:an.makeColorHex(I)}},I))})]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:g})]}),t("div",{className:"stickie-context",children:!m||!a?t("div",{className:"context-text",onClick:I=>a&&f(!0),children:r}):t("textarea",{className:"context-text",defaultValue:r,tabIndex:0,onBlur:I=>u(I.target.value),autoFocus:!0})})]})})},N1=i=>{const{objectId:e=-1,color:n="1",senderName:r="",date:s="",message:a="",onClose:l=null}=wv();return e===-1?null:t(nh,{color:n,message:a,date:s,senderName:r,onCloseClick:l})},S1=i=>{const[e,n]=o.useState(null),{objectId:r=-1,videoId:s=null,videoStart:a=0,videoEnd:l=0,currentVideoState:u=null,selectedVideo:d=null,playlists:g=[],onClose:m=null,previous:f=null,next:I=null,pause:C=null,play:p=null,selectVideo:_=null}=Dv(),E=N=>{if(n(N.target),r!==-1)switch(N.target.getPlayerState()){case-1:case 1:u!==1&&p();return;case 2:u!==2&&C()}};if(o.useEffect(()=>{if(!(u===null||!e)){if(u===Yr.PLAYING&&e.getPlayerState()!==Yr.PLAYING){e.playVideo();return}if(u===Yr.PAUSED&&e.getPlayerState()!==Yr.PAUSED){e.pauseVideo();return}}},[u,e]),r===-1)return null;const b={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:a,end:l}};return c(se,{className:"youtube-tv-widget",children:[t(ae,{headerText:h("catalog.page.youtube_tvs"),onCloseClick:m}),t(re,{children:c("div",{className:"row w-100 h-100",children:[c("div",{className:"youtube-video-container col-9 overflow-hidden",children:[s&&s.length>0&&t(ig,{videoId:s,opts:b,onReady:N=>n(N.target),onStateChange:E,containerClassName:"youtubeContainer"}),(!s||s.length===0)&&t("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:h("widget.furni.video_viewer.no_videos")})]}),c("div",{className:"playlist-container col-3 d-flex flex-column",children:[c("span",{className:"playlist-controls justify-content-center d-flex",children:[t("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:f}),t("i",{className:"icon icon-youtube-next cursor-pointer",onClick:I})]}),t("div",{className:"mb-1",children:h("widget.furni.video_viewer.playlists")}),t(ye,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:g&&g.map((N,T)=>t(Ne,{onClick:y=>_(N.video),itemActive:N.video===d,children:t("b",{children:N.title})},T))})]})]})})]})},v1=i=>{const{diskInventory:e=null,addToPlaylist:n=null}=i,[r,s]=o.useState(-1),[a,l]=o.useState(-1),u=o.useCallback((m,f)=>{m.stopPropagation(),l(I=>I===f?-1:f)},[]),d=o.useCallback((m,f)=>{var I,C;m.stopPropagation(),n(f,(C=(I=pe().soundManager.musicController)==null?void 0:I.getRoomItemPlaylist())==null?void 0:C.length)},[n]),g=()=>{Z("catalog/open/"+qi.TRAX_SONGS)};return o.useEffect(()=>{var m;if(a!==-1)return(m=pe().soundManager.musicController)==null||m.playSong(a,ha.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var f;(f=pe().soundManager.musicController)==null||f.stop(ha.PRIORITY_SONG_PLAY)}},[a]),o.useEffect(()=>()=>l(-1),[]),c(G,{children:[c("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:X("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),t("h2",{className:"ms-4",children:h("playlist.editor.my.music")})]}),t("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:t(ye,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((m,f)=>{var _;const I=e.getKey(f),C=e.getWithIndex(f),p=(_=pe().soundManager.musicController)==null?void 0:_.getSongInfo(C);return c(Ne,{itemActive:r===f,onClick:()=>s(E=>E===f?-1:f),classNames:["text-black"],children:[t("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:Ym(p==null?void 0:p.songData)}}),t(S,{truncate:!0,fullWidth:!0,className:"text-center",children:p==null?void 0:p.name}),r===f&&c(w,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[t(M,{onClick:E=>u(E,C),variant:"light",children:t(P,{className:a===C?"pause-btn":"preview-song"})}),t(M,{onClick:E=>d(E,I),variant:"light",children:t(P,{className:"move-disk"})})]})]},f)})})}),c("div",{className:"playlist-bottom text-black p-1",children:[t("h5",{children:h("playlist.editor.text.get.more.music")}),t("div",{children:h("playlist.editor.text.you.have.no.songdisks.available")}),t("div",{children:h("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),t("button",{className:"btn btn-primary btn-sm",onClick:()=>g(),children:h("playlist.editor.button.open.catalogue")})]}),t("img",{src:X("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},T1=i=>{var m,f;const{furniId:e=-1,playlist:n=null,currentPlayingIndex:r=-1,removeFromPlaylist:s=null,togglePlayPause:a=null}=i,[l,u]=o.useState(-1),d=I=>{l===I&&s(I)},g=(I,C)=>{a(I,C!==-1?C:0)};return c(G,{children:[c("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:X("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),t("h2",{className:"ms-4",children:h("playlist.editor.playlist")})]}),t("div",{className:"h-100 overflow-y-scroll py-2",children:t(w,{column:!0,gap:2,children:n&&n.map((I,C)=>c(w,{gap:1,className:"text-black cursor-pointer "+(l===C?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>u(p=>p===C?-1:C),children:[t(P,{onClick:()=>d(C),className:"disk-2 "+(l===C?"selected-song":""),style:{backgroundColor:l===C?"":Ym(I.songData)}}),I.name]},C))})}),(!n||n.length===0)&&c(G,{children:[c("div",{className:"playlist-bottom text-black p-1 ms-5",children:[t("h5",{children:h("playlist.editor.add.songs.to.your.playlist")}),t("div",{children:h("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),t("img",{src:X("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),n&&n.length>0&&c(G,{children:[r===-1&&t(M,{variant:"success",size:"lg",onClick:()=>g(e,l),children:h("playlist.editor.button.play.now")}),r!==-1&&c(w,{gap:1,children:[t(M,{variant:"danger",onClick:()=>g(e,l),children:t(P,{className:"pause-song"})}),c(w,{column:!0,children:[t(S,{bold:!0,display:"block",children:h("playlist.editor.text.now.playing.in.your.room")}),t(S,{children:((m=n[r])==null?void 0:m.name)+" - "+((f=n[r])==null?void 0:f.creator)})]})]})]})]})},w1=i=>{const{objectId:e=-1,currentPlayingIndex:n=-1,playlist:r=null,diskInventory:s=null,onClose:a=null,togglePlayPause:l=null,removeFromPlaylist:u=null,addToPlaylist:d=null}=dv();return e===-1?null:c(se,{className:"nitro-playlist-editor-widget",theme:"primary",children:[t(ae,{headerText:h("playlist.editor.title"),onCloseClick:a}),t(re,{children:c("div",{className:"d-flex flex-row gap-1 h-100",children:[t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(v1,{addToPlaylist:d,diskInventory:s})}),t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(T1,{furniId:e,removeFromPlaylist:u,playlist:r,togglePlayPause:l,currentPlayingIndex:n})})]})})]})},R1=i=>c(P,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[t(Jy,{}),t(Zy,{}),t(e1,{}),t(t1,{}),t(n1,{}),t(s1,{}),t(a1,{}),t(i1,{}),t(o1,{}),t(l1,{}),t(u1,{}),t(w1,{}),t(d1,{}),t(g1,{}),t(f1,{}),t(b1,{}),t(N1,{}),t(Qy,{}),t(S1,{})]}),O1=i=>{const{isVisible:e=!1,errorResult:n=null,petName:r=null,objectType:s=null,onChangePetName:a=null,onConfirm:l=null,onClose:u=null}=Kv();return t(G,{children:e&&c(se,{className:"nitro-pet-package no-resize",theme:"primary",children:[t(ae,{center:!0,headerText:h(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>u()}),c(re,{children:[c(w,{className:"pet-package-container-top p-3",children:[t("div",{className:`package-image-${s} flex-shrink-0`}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"package-text-big",children:h(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),t(w,{className:"pet-package-container-bottom p-2",children:c(v,{gap:1,children:[c(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[t("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:X("pet.package.name.max.length"),placeholder:h(s==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:r,onChange:d=>a(d.target.value)}),t("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),n.length>0&&t(P,{className:"invalid-feedback d-block m-0",children:n}),c(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>u(),children:h("cancel")}),t(og,{variant:r.length<3?"danger":"success",disabled:r.length<3,onClick:()=>l(),children:h(s==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},y1=i=>{const[e,n]=o.useState("bobba"),[r,s]=o.useState(""),[a,l]=o.useState(!1),{wordsFilter:u=[],isVisible:d=null,setWordsFilter:g,onClose:m=null}=Wv(),{navigatorData:f=null}=Qn(),I=_=>{(a?!r:!e)||(L(new fb(f.enteredGuestRoom.roomId,_,a?r:e)),s(""),n("bobba"),l(!1),!(_&&u.includes(a?r:e))&&g(E=>{const b=[...E];return _?b.push(a?r:e):b.splice(b.indexOf(a?r:e),1),b}))},C=_=>{n(_),l(!1)},p=_=>{s(_),l(!0)};return d?c(se,{className:"nitro-guide-tool no-resize",theme:"primary",children:[t(ae,{headerText:h("navigator.roomsettings.roomfilter"),onCloseClick:()=>m()}),c(re,{className:"text-black",children:[c(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:_=>C(_.target.value)}),t(M,{onClick:()=>I(!0),children:h("navigator.roomsettings.roomfilter.addword")})]}),t(v,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:u&&u.length>0&&u.map((_,E)=>t(w,{alignItems:"center",className:Ts("rounded p-1",r===_&&"bg-muted"),pointer:!0,onClick:b=>p(_),children:t(S,{truncate:!0,children:_})},E))}),t(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:t(M,{variant:"danger",onClick:()=>I(!1),disabled:u.length===0||!a,children:h("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},k1=i=>{const[e,n]=o.useState(!1),{roomSession:r=null}=Le();at([cr.SHOW_THUMBNAIL,cr.HIDE_THUMBNAIL,cr.TOGGLE_THUMBNAIL],a=>{switch(a.type){case cr.SHOW_THUMBNAIL:n(!0);return;case cr.HIDE_THUMBNAIL:n(!1);return;case cr.TOGGLE_THUMBNAIL:n(l=>!l);return}});const s=a=>{$().saveTextureAsScreenshot(a,!0),n(!1)};return e?t(zN,{roomId:r.roomId,textureReceiver:s,onClose:()=>n(!1)}):null},A1=i=>{const{question:e=null,canVote:n=null,vote:r=null,noVotes:s=null,yesVotes:a=null}=i;return c(v,{gap:2,className:"wordquiz-question p-2",children:[!n&&c(w,{fullWidth:!0,alignItems:"center",gap:2,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:t(S,{variant:"white",children:s})}),t(S,{variant:"white",center:!0,textBreak:!0,children:e}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:t(S,{variant:"white",children:a})})]}),n&&c(v,{children:[t(S,{variant:"white",center:!0,textBreak:!0,children:e}),c(w,{fullWidth:!0,justifyContent:"center",gap:1,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:l=>r(Zi),children:t(P,{className:"word-quiz-dislike"})}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:l=>r(zm),children:t(P,{className:"word-quiz-like"})})]})]})]})},D1=i=>{const{userIndex:e=null,vote:n=null,...r}=i;return t(Rc,{objectId:e,category:Q.UNIT,...r,children:t(w,{center:!0,pointer:!0,className:`bg-${n===Zi?"danger":"success"} rounded p-1`,children:t(P,{className:`word-quiz-${n===Zi?"dislike":"like"}-sm`})})})},P1=i=>{const{question:e=null,answerSent:n=!1,answerCounts:r=null,userAnswers:s=null,vote:a=null}=nT();return c(G,{children:[e&&t(A1,{question:e.content,canVote:!n,vote:a,noVotes:r.get(Zi)||0,yesVotes:r.get(zm)||0}),s&&Array.from(s.entries()).map(([l,u],d)=>t(D1,{userIndex:l,vote:u.value},d))]})},L1=i=>{const{roomSession:e=null}=Le(),{simpleAlert:n=null}=je();return Ee(Al.ROOM_ZOOM,r=>$().setRoomInstanceRenderingCanvasScale(r.roomId,1,r.level,null,null,!1,r.asDelta)),Ee([_e.REQUEST_TEASER,_e.REQUEST_ECOTRONBOX,_e.REQUEST_CLOTHING_CHANGE,_e.REQUEST_PLAYLIST_EDITOR,_e.OPEN_WIDGET,_e.CLOSE_WIDGET,di.FURNI_CLICK,di.FURNI_DOUBLE_CLICK,di.TOOLTIP_SHOW,di.TOOLTIP_HIDE],r=>{if(e)switch(r.objectId,r.category,r.type){}}),Pe([ct.RSEME_KICKED,ct.RSEME_PETS_FORBIDDEN_IN_HOTEL,ct.RSEME_PETS_FORBIDDEN_IN_FLAT,ct.RSEME_MAX_PETS,ct.RSEME_MAX_NUMBER_OF_OWN_PETS,ct.RSEME_NO_FREE_TILES_FOR_PET,ct.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,ct.RSEME_BOTS_FORBIDDEN_IN_HOTEL,ct.RSEME_BOTS_FORBIDDEN_IN_FLAT,ct.RSEME_BOT_LIMIT_REACHED,ct.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,ct.RSEME_BOT_NAME_NOT_ACCEPTED],r=>{let s=h("error.title"),a="";switch(r.type){case ct.RSEME_MAX_PETS:a=h("room.error.max_pets");break;case ct.RSEME_MAX_NUMBER_OF_OWN_PETS:a=h("room.error.max_own_pets");break;case ct.RSEME_KICKED:a=h("room.error.kicked"),s=h("generic.alert.title");break;case ct.RSEME_PETS_FORBIDDEN_IN_HOTEL:a=h("room.error.pets.forbidden_in_hotel");break;case ct.RSEME_PETS_FORBIDDEN_IN_FLAT:a=h("room.error.pets.forbidden_in_flat");break;case ct.RSEME_NO_FREE_TILES_FOR_PET:a=h("room.error.pets.no_free_tiles");break;case ct.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:a=h("room.error.pets.selected_tile_not_free");break;case ct.RSEME_BOTS_FORBIDDEN_IN_HOTEL:a=h("room.error.bots.forbidden_in_hotel");break;case ct.RSEME_BOTS_FORBIDDEN_IN_FLAT:a=h("room.error.bots.forbidden_in_flat");break;case ct.RSEME_BOT_LIMIT_REACHED:a=h("room.error.max_bots");break;case ct.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:a=h("room.error.bots.selected_tile_not_free");break;case ct.RSEME_BOT_NAME_NOT_ACCEPTED:a=h("room.error.bots.name.not.accepted");break;default:return}n(a,me.DEFAULT,null,null,s)}),c(G,{children:[t(Ay,{}),t(Uy,{}),t(Py,{}),t(Gy,{}),t(R1,{}),t(y1,{}),t(k1,{}),t(Fy,{}),t(O1,{}),t(Vy,{}),t(P1,{}),t(Hy,{})]})},M1=i=>{const{roomSession:e=null}=Le(),n=o.useRef();return o.useEffect(()=>{const r=pe().application.renderer.view;if(!r)return;r.onclick=a=>fi(a),r.onmousemove=a=>fi(a),r.onmousedown=a=>fi(a),r.onmouseup=a=>fi(a),r.ontouchstart=a=>Ei(a),r.ontouchmove=a=>Ei(a),r.ontouchend=a=>Ei(a),r.ontouchcancel=a=>Ei(a);const s=n.current;s&&s.appendChild(r)},[]),t(P,{fit:!0,innerRef:n,className:!e&&"d-none",children:e&&c(G,{children:[t(L1,{}),e.isSpectator&&t(oy,{})]})})},Gh=i=>{const{useGuideTool:e=!1,unseenAchievementCount:n=0,setMeExpanded:r=null,children:s=null,...a}=i,l=o.useRef();return o.useEffect(()=>{const u=Te();u&&$().selectRoomObject(u.roomId,u.ownRoomIndex,Q.UNIT)},[]),o.useEffect(()=>{const u=d=>r(!1);return document.addEventListener("click",u),()=>document.removeEventListener(ve.MOUSE_CLICK,u)},[r]),c(w,{innerRef:l,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[X("guides.enabled")&&e&&t(P,{pointer:!0,className:"navigation-item icon icon-me-helper-tool",onClick:u=>Nt(new mn(mn.TOGGLE_GUIDE_TOOL))}),t(P,{pointer:!0,className:"navigation-item icon icon-me-achievements",onClick:u=>Z("achievements/toggle"),children:n>0&&t(Sn,{count:n})}),t(P,{pointer:!0,className:"navigation-item icon icon-me-profile",onClick:u=>on(H().userId)}),t(P,{pointer:!0,className:"navigation-item icon icon-me-rooms",onClick:u=>Z("navigator/search/myworld_view")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-clothing",onClick:u=>Z("avatar-editor/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-settings",onClick:u=>Z("user-settings/toggle")}),s]})},x1=i=>{const{isInRoom:e}=i,[n,r]=o.useState(!1),[s,a]=o.useState(!1),{userFigure:l=null}=_r(),{getFullCount:u=0}=gn(),{getTotalUnseen:d=0}=ri();return ln(),_c(),H().isModerator,U(ac,g=>{const m=g.getParser();a(m.isAllowed(sc.USE_GUIDE_TOOL))}),Ee(vm.ANIMATE_ICON,g=>{((f,I,C,p)=>{const _=document.body.getElementsByClassName(f)[0];if(!_)return;I.className="toolbar-icon-animation",I.style.visibility="visible",I.style.left=C+"px",I.style.top=p+"px",document.body.append(I);const E=_.getBoundingClientRect(),b=I.getBoundingClientRect(),N=b.x-E.x,T=b.y-E.y,y=Math.sqrt(N*N+T*T),R=500-Math.abs(1/y*100*500*.5),O=20,F=`ToolbarBouncing[${f}]`;Qs.getMotionByTag(F)||(Qs.runMotion(new Wi(new Tm(R+8),new wm(_,400,12))).tag=F);const D=new Wi(new Rm(new Om(I,R,E.x-b.x+O,E.y-b.y,100,1),1),new ym(I));Qs.runMotion(D)})("icon-inventory",g.image,g.x,g.y)}),c(G,{children:[t(ni,{type:tn.SLIDE_LEFT,inProp:n,timeout:3e3,children:t(Gh,{useGuideTool:s,unseenAchievementCount:d,setMeExpanded:r})}),c(v,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar-leftside d-none d-sm-flex",children:[c(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",children:[e&&t(P,{pointer:!0,className:"navigation-item icon icon-habbo -mx1",onClick:g=>yo()}),!e&&t(P,{pointer:!0,className:"navigation-item icon icon-house -mx1",onClick:g=>Z("navigator/goto/home")})]}),t(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",children:t(P,{pointer:!0,className:"navigation-item icon icon-rooms -mx1",onClick:g=>Z("navigator/toggle")})}),t(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",children:t(P,{pointer:!0,className:"navigation-item icon icon-catalog -mx1",onClick:g=>Z("catalog/toggle")})}),t(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",children:t(P,{pointer:!0,className:"navigation-item icon icon-inventory -mx1",onClick:g=>Z("inventory/toggle"),children:u>0&&t(Sn,{count:u})})}),e&&t(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",children:t(P,{pointer:!0,className:"navigation-item icon icon-camera -mx1",onClick:g=>Z("camera/toggle")})}),t(v,{className:"leftsideToolbarItem",justifyContent:"center",alignItems:"center",onClick:g=>r(!n),children:c(w,{center:!0,pointer:!0,className:"navigation-item item-avatar -mx1 "+(n?"active ":""),onClick:g=>r(!n),children:[t(it,{figure:l,direction:2,position:"absolute"}),d>0&&t(Sn,{count:d})]})})]})]})},U1=i=>{const{isInRoom:e}=i,[n,r]=o.useState(!1),[s,a]=o.useState(!1),{userFigure:l=null}=_r(),{getFullCount:u=0}=gn(),{getTotalUnseen:d=0}=ri(),{requests:g=[]}=ln(),{iconState:m=hr.HIDDEN}=_c(),f=H().isModerator;return U(ac,I=>{const C=I.getParser();a(C.isAllowed(sc.USE_GUIDE_TOOL))}),Ee(vm.ANIMATE_ICON,I=>{((p,_,E,b)=>{const N=document.body.getElementsByClassName(p)[0];if(!N)return;_.className="toolbar-icon-animation",_.style.visibility="visible",_.style.left=E+"px",_.style.top=b+"px",document.body.append(_);const T=N.getBoundingClientRect(),y=_.getBoundingClientRect(),R=y.x-T.x,O=y.y-T.y,F=Math.sqrt(R*R+O*O),D=500-Math.abs(1/F*100*500*.5),A=20,k=`ToolbarBouncing[${p}]`;Qs.getMotionByTag(k)||(Qs.runMotion(new Wi(new Tm(D+8),new wm(N,400,12))).tag=k);const x=new Wi(new Rm(new Om(_,D,T.x-y.x+A,T.y-y.y,100,1),1),new ym(_));Qs.runMotion(x)})("icon-inventory",I.image,I.x,I.y)}),c(G,{children:[t(ni,{type:tn.FADE_IN,inProp:n,timeout:300,children:t(Gh,{useGuideTool:s,unseenAchievementCount:d,setMeExpanded:r})}),c(w,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[c(w,{gap:2,alignItems:"center",children:[c(w,{alignItems:"center",className:"d-block d-sm-none",gap:2,children:[c(w,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(n?"active ":""),onClick:I=>r(!n),children:[t(it,{figure:l,direction:2,position:"absolute"}),d>0&&t(Sn,{count:d})]}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:I=>yo()}),!e&&t(P,{pointer:!0,className:"navigation-item icon icon-house",onClick:I=>Z("navigator/goto/home")}),t(P,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:I=>Z("navigator/toggle")}),X("game.center.enabled")&&t(P,{pointer:!0,className:"navigation-item icon icon-game",onClick:I=>Z("games/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:I=>Z("catalog/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:I=>Z("inventory/toggle"),children:u>0&&t(Sn,{count:u})}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-camera",onClick:I=>Z("camera/toggle")}),f&&t(P,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:I=>Z("mod-tools/toggle")})]}),t(w,{className:"LariesseToolbarChatView",children:t(w,{alignItems:"center",id:"toolbar-chat-input-container"})})]}),c(w,{alignItems:"center",className:"mx-auto",gap:2,children:[f&&t(P,{pointer:!0,className:"navigation-item icon icon-modtools d-none d-sm-flex",onClick:I=>Z("mod-tools/toggle")}),t(w,{gap:2,children:t(P,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:I=>Z("friends/toggle"),children:g.length>0&&t(Sn,{count:g.length})})}),t(P,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"}),(m===hr.SHOW||m===hr.UNREAD)&&t(P,{pointer:!0,className:`navigation-item icon icon-message ${m===hr.UNREAD&&"is-unseen"}`,onClick:I=>Do()})]})]})]})},F1=i=>{const{badges:e=null,gap:n=1,justifyContent:r="between",...s}=i;return t(G,{children:e&&e.length>0&&e.map((a,l)=>t(v,{center:!0,children:t(We,{badgeCode:a},a)},a))})},V1=i=>{const{relationships:e=null}=i,n=({type:r})=>{const s=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null,a=qn.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return c(w,{fullWidth:!0,gap:1,children:[t(w,{center:!0,className:"user-relationship",children:t("i",{className:`nitro-friends-spritesheet icon-${a}`})}),c(v,{grow:!0,gap:0,children:[c(w,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[c(S,{small:!0,underline:!0,pointer:!0,onClick:l=>s&&s.randomFriendId>=1&&on(s.randomFriendId),children:[(!s||s.friendCount===0)&&h("extendedprofile.add.friends"),s&&s.friendCount>=1&&s.randomFriendName]}),s&&s.friendCount>=1&&t(w,{center:!0,position:"relative",className:"avatar-image-container",children:t(it,{figure:s.randomFriendFigure,headOnly:!0,direction:4})})]}),c(S,{small:!0,italics:!0,className:"user-relationship-count",children:[(!s||s.friendCount===0)&&h("extendedprofile.no.friends.in.this.category"),s&&s.friendCount>1&&h(`extendedprofile.relstatus.others.${a}`,["count"],[(s.friendCount-1).toString()])," "]})]})]})};return c(G,{children:[t(n,{type:qn.HEART}),t(n,{type:qn.SMILE}),t(n,{type:qn.BOBBA})]})},G1=i=>{const{relationships:e=null,friendsCount:n=null}=i;return c(v,{gap:1,children:[c(S,{small:!0,children:[t("b",{children:h("extendedprofile.friends.count")})," ",n]}),t(S,{bold:!0,small:!0,children:h("extendedprofile.relstatus")}),t(v,{children:t(V1,{relationships:e})})]})},B1=i=>{const{itsMe:e=null,groups:n=null,onLeaveGroup:r=null,overflow:s="hidden",gap:a=2,...l}=i,[u,d]=o.useState(null),[g,m]=o.useState(null);return U(Xa,f=>{const I=f.getParser();!u||u!==I.id||I.flag||m(I)}),o.useEffect(()=>{u&&L(new Pa(u,!1))},[u]),o.useEffect(()=>{m(null),n.length>0&&d(f=>(f===n[0].groupId&&L(new Pa(n[0].groupId,!1)),n[0].groupId))},[n]),!n||!n.length?t(v,{center:!0,fullHeight:!0,children:c(w,{justifyContent:"center",gap:2,children:[t(P,{className:"no-group-spritesheet image-1"}),t(P,{className:"no-group-spritesheet image-2"}),t(P,{className:"no-group-spritesheet image-3"})]})}):c(ne,{overflow:s,gap:2,...l,children:[t(v,{alignItems:"center",size:2,overflow:"auto",children:t(ye,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:n.map((f,I)=>c(Ne,{overflow:"unset",itemActive:u===f.groupId,onClick:()=>d(f.groupId),className:"p-1",children:[e&&t("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(f.favourite?"favorite":"not-favorite"),onClick:()=>_N(f)}),t(We,{badgeCode:f.badgeCode,isGroup:!0})]},I))})}),t(v,{size:10,overflow:"hidden",children:g&&t(Ah,{groupInformation:g,onClose:r})})]})},H1=i=>{const{userProfile:e=null}=i,[n,r]=o.useState(e.requestSent),s=e.id===H().userId,a=!n&&!s&&!e.isMyFriend&&!e.requestSent,l=()=>{r(!0),L(new Zd(e.username))};return o.useEffect(()=>{r(e.requestSent)},[e]),c(w,{gap:2,children:[t(v,{center:!0,className:"avatar-container",children:t(it,{figure:e.figure,direction:2})}),c(v,{children:[c(v,{gap:0,children:[t(S,{bold:!0,children:e.username}),c(S,{italics:!0,textBreak:!0,small:!0,children:[e.motto," "]})]}),c(v,{gap:1,children:[c(S,{small:!0,children:[t("b",{children:h("extendedprofile.created")})," ",e.registration]}),c(S,{small:!0,children:[t("b",{children:h("extendedprofile.last.login")})," ",bn.format(e.secondsSinceLastVisit,".ago",2)]}),c(S,{small:!0,children:[t("b",{children:h("extendedprofile.achievementscore")})," ",e.achievementPoints]})]}),c(w,{gap:1,children:[e.isOnline&&t("i",{className:"icon icon-pf-online"}),!e.isOnline&&t("i",{className:"icon icon-pf-offline"}),c(w,{alignItems:"center",gap:1,children:[a&&t(S,{small:!0,underline:!0,pointer:!0,onClick:l,children:h("extendedprofile.addasafriend")}),!a&&c(G,{children:[t("i",{className:"icon icon-pf-tick"}),s&&t(S,{children:h("extendedprofile.me")}),e.isMyFriend&&t(S,{children:h("extendedprofile.friend")}),(n||e.requestSent)&&t(S,{children:h("extendedprofile.friendrequestsent")})]})]})]})]})]})},W1=i=>{const[e,n]=o.useState(null),[r,s]=o.useState([]),[a,l]=o.useState(null),u=()=>{n(null),s([]),l(null)},d=()=>{!e||e.id!==H().userId||on(e.id)};return U(pb,g=>{const m=g.getParser();!e||m.userId!==e.id||s(m.badges)}),U(bm,g=>{const m=g.getParser();!e||m.userId!==e.id||l(m)}),U(Eb,g=>{const m=g.getParser();let f=!1;n(I=>(I&&I.id&&(f=I.id===m.id),m)),f||(s([]),l(null)),L(new Ib(m.id)),L(new Nm(m.id))}),U(Cb,g=>{const m=g.getParser();m.userId==(e==null?void 0:e.id)&&on(m.userId)}),Ee(ht.SELECTED,g=>{if(!e||g.category!==Q.UNIT)return;const m=Te().userDataManager.getUserDataByIndex(g.objectId);m.type===ut.USER&&on(m.webID)}),e?c(se,{uniqueKey:"nitro-user-profile",theme:"primary",className:"user-profile",children:[t(ae,{headerText:h("extendedprofile.caption"),onCloseClick:u}),c(re,{overflow:"hidden",children:[c(ne,{fullHeight:!1,gap:2,children:[c(v,{size:7,gap:1,className:"user-container pe-2",children:[t(H1,{userProfile:e}),t(ne,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:t(F1,{fullWidth:!0,center:!0,badges:r})})]}),t(v,{size:5,children:a&&t(G1,{relationships:a,friendsCount:e.friendsCount})})]}),t(w,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:c(w,{alignItems:"center",gap:1,onClick:g=>Z(`navigator/search/hotel_view/owner:${e.username}`),children:[t("i",{className:"icon icon-rooms"}),t(S,{bold:!0,underline:!0,pointer:!0,children:h("extendedprofile.rooms")})]})}),t(B1,{fullWidth:!0,itsMe:e.id===H().userId,groups:e.groups,onLeaveGroup:d})]})]}):null},j1=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,l]=sh(),[u,d]=ah(),g=(f,I)=>{let C=!0;const p=r.clone();switch(f){case"close_view":n(!1),C=!1;return;case"oldchat":p.oldChat=I,L(new Nb(p.oldChat));break;case"room_invites":p.roomInvites=I,L(new bb(p.roomInvites));break;case"camera_follow":p.cameraFollow=I,L(new _b(p.cameraFollow));break;case"system_volume":p.volumeSystem=I,p.volumeSystem=Math.max(0,p.volumeSystem),p.volumeSystem=Math.min(100,p.volumeSystem);break;case"furni_volume":p.volumeFurni=I,p.volumeFurni=Math.max(0,p.volumeFurni),p.volumeFurni=Math.min(100,p.volumeFurni);break;case"trax_volume":p.volumeTrax=I,p.volumeTrax=Math.max(0,p.volumeTrax),p.volumeTrax=Math.min(100,p.volumeTrax);break}C&&s(p),Ml(p)},m=f=>{switch(f){case"volume":L(new Sb(Math.round(r.volumeSystem),Math.round(r.volumeFurni),Math.round(r.volumeTrax)));break}};return U(um,f=>{const I=f.getParser(),C=new vb;C.volumeSystem=I.volumeSystem,C.volumeFurni=I.volumeFurni,C.volumeTrax=I.volumeTrax,C.oldChat=I.oldChat,C.roomInvites=I.roomInvites,C.cameraFollow=I.cameraFollow,C.flags=I.flags,C.chatType=I.chatType,s(C),Ml(C)}),o.useEffect(()=>{const f={linkReceived:I=>{const C=I.split("/");if(!(C.length<2))switch(C[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(p=>!p);return}},eventUrlPrefix:"user-settings/"};return pt(f),()=>It(f)},[]),o.useEffect(()=>{r&&Nt(r)},[r]),!e||!r?null:c(se,{uniqueKey:"user-settings",className:"user-settings-window",theme:"user-settings",children:[t(ae,{headerText:h("widget.memenu.settings.title"),onCloseClick:f=>g("close_view")}),c(re,{className:"text-black",overflow:"hidden",children:[c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"flash-form-check-input",type:"checkbox",checked:r.oldChat,onChange:f=>g("oldchat",f.target.checked)}),t(S,{variant:"white",children:h("memenu.settings.chat.prefer.old.chat")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"flash-form-check-input",type:"checkbox",checked:r.roomInvites,onChange:f=>g("room_invites",f.target.checked)}),t(S,{variant:"white",children:h("memenu.settings.other.ignore.room.invites")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"flash-form-check-input",type:"checkbox",checked:r.cameraFollow,onChange:f=>g("camera_follow",f.target.checked)}),t(S,{variant:"white",children:h("memenu.settings.other.disable.room.camera.follow")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"flash-form-check-input",type:"checkbox",checked:a,onChange:f=>l(f.target.checked)}),t(S,{variant:"white",children:h("memenu.settings.other.place.multiple.objects")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"flash-form-check-input",type:"checkbox",checked:u,onChange:f=>d(f.target.checked)}),t(S,{variant:"white",children:h("memenu.settings.other.skip.purchase.confirmation")})]})]}),c(v,{children:[t(S,{variant:"white",className:"mx-auto mt-1",children:h("widget.memenu.settings.volume")}),c(w,{gap:2,children:[t(S,{className:"w-25",children:h("widget.memenu.settings.volume.ui")}),c(w,{alignItems:"center",gap:1,children:[t("i",{className:r.volumeSystem>1?"icon icon-sound-off":"icon icon-sound-off-active"}),c(v,{gap:0,children:[t(w,{className:"number-range"}),t("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeSystem",value:r.volumeSystem,onChange:f=>g("system_volume",f.target.value),onMouseUp:()=>m("volume")})]}),t("i",{className:r.volumeSystem<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]}),c(w,{gap:2,children:[t(S,{className:"w-25",children:h("widget.memenu.settings.volume.furni")}),c(w,{alignItems:"center",gap:1,children:[t("i",{className:r.volumeFurni>1?"icon icon-sound-off":"icon icon-sound-off-active"}),c(v,{gap:0,children:[t(w,{className:"number-range"}),t("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeFurni",value:r.volumeFurni,onChange:f=>g("furni_volume",f.target.value),onMouseUp:()=>m("volume")})]}),t("i",{className:r.volumeFurni<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]}),c(w,{gap:2,children:[t(S,{className:"w-25",children:h("widget.memenu.settings.volume.trax")}),c(w,{alignItems:"center",gap:1,children:[t("i",{className:r.volumeTrax>1?"icon icon-sound-off":"icon icon-sound-off-active"}),c(v,{gap:0,children:[t(w,{className:"number-range"}),t("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeTrax",value:r.volumeTrax,onChange:f=>g("trax_volume",f.target.value),onMouseUp:()=>m("volume")})]}),t("i",{className:r.volumeTrax<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]})]})]})]})},q1=i=>{const{trigger:e=null,furniIds:n=[]}=Ce();return c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.pickfurnis.caption",["count","limit"],[n.length.toString(),e.maximumItemSelectionCount.toString()])}),t(S,{small:!0,children:h("wiredfurni.pickfurnis.desc")})]})},Oc=i=>{const{wiredType:e="",requiresFurni:n=le.STUFF_SELECTION_OPTION_NONE,save:r=null,validate:s=null,children:a=null,hasSpecialInput:l=!1}=i,[u,d]=o.useState(null),[g,m]=o.useState(null),[f,I]=o.useState(!1),{trigger:C=null,setTrigger:p=null,setIntParams:_=null,setStringParam:E=null,setFurniIds:b=null,setAllowsFurni:N=null,saveWired:T=null}=Ce(),y=()=>p(null),R=()=>{s&&!s()||(r&&r(),I(!0))};return o.useEffect(()=>{f&&(T(),I(!1))},[f,T]),o.useEffect(()=>{if(!C)return;const O=C.spriteId||-1,F=H().getFloorItemData(O);F?(d(F.name),m(F.description)):(d("NAME: "+O),m("NAME: "+O)),l&&(_(C.intData),E(C.stringData)),n>le.STUFF_SELECTION_OPTION_NONE&&b(D=>(D&&D.length&&bs.clearSelectionShaderFromFurni(D),C.selectedItems&&C.selectedItems.length?(bs.applySelectionShaderToFurni(C.selectedItems),C.selectedItems):[])),N(n)},[C,l,n,_,E,b,N]),c(se,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary",children:[t(ae,{headerText:h("wiredfurni.title"),onCloseClick:y}),c(re,{children:[c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("i",{className:`icon icon-wired-${e}`}),t(S,{bold:!0,children:u})]}),t(S,{small:!0,children:g})]}),!!a&&t("hr",{className:"m-0 bg-dark"}),a,n>le.STUFF_SELECTION_OPTION_NONE&&c(G,{children:[t("hr",{className:"m-0 bg-dark"}),t(q1,{})]}),c(w,{alignItems:"center",gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:R,children:h("wiredfurni.ready")}),t(M,{fullWidth:!0,variant:"secondary",onClick:y,children:h("cancel")})]})]})]})},lt=i=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i,{trigger:a=null,actionDelay:l=0,setActionDelay:u=null}=Ce();return o.useEffect(()=>{u(a.delayInPulses)},[a,u]),c(Oc,{wiredType:"action",requiresFurni:e,save:n,hasSpecialInput:r,children:[s,!!s&&t("hr",{className:"m-0 bg-dark"}),c(v,{children:[t(S,{bold:!0,children:h("wiredfurni.params.delay",["seconds"],[ti(l)])}),t(At,{className:"nitro-slider",min:0,max:20,value:l,onChange:d=>u(d)})]})]})},Y1="hd-180-1.ch-210-66.lg-270-82.sh-290-81",z1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),{trigger:a=null,setStringParam:l=null}=Ce(),u=()=>l(e+aa+r);return o.useEffect(()=>{const d=a.stringData.split(aa);d.length>0&&n(d[0]),d.length>1&&s(d[1].length>0?d[1]:Y1)},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:d=>n(d.target.value)})]}),c(w,{center:!0,children:[t(it,{figure:r,direction:4}),t(M,{onClick:d=>s(H().figure),children:h("wiredfurni.params.capture.figure")})]})]})},$1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:l=null,setIntParams:u=null}=Ce(),d=()=>{l(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>n(g.target.value)})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:r===1,onChange:g=>s(1)}),t(S,{children:h("wiredfurni.params.start.following")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:r===0,onChange:g=>s(0)}),t(S,{children:h("wiredfurni.params.stop.following")})]})]})]})},K1=[2,5,7,8,9,10,27],X1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:l=null,setIntParams:u=null}=Ce(),d=()=>{l(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>n(g.target.value)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.handitem")}),c("select",{className:"form-select form-select-sm",value:r,onChange:g=>s(parseInt(g.target.value)),children:[t("option",{value:"0",children:"------"}),K1.map(g=>t("option",{value:g,children:h(`handitem${g}`)},g))]})]})]})},Q1=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:l=>n(l.target.value)})]})})},J1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),[a,l]=o.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:g=null}=Ce(),m=()=>{d(e+aa+r),g([a])};return o.useEffect(()=>{const f=u.stringData.split(aa);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),l(u.intData.length>0?u.intData[0]:0)},[u]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:X("wired.action.bot.talk.to.avatar.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>l(0)}),t(S,{children:h("wiredfurni.params.talk")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>l(1)}),t(S,{children:h("wiredfurni.params.whisper")})]})]})]})},Z1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),[a,l]=o.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:g=null}=Ce(),m=()=>{d(e+aa+r),g([a])};return o.useEffect(()=>{const f=u.stringData.split(aa);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),l(u.intData.length>0?u.intData[0]:0)},[u]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:X("wired.action.bot.talk.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),c(v,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>l(0)}),t(S,{children:h("wiredfurni.params.talk")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>l(1)}),t(S,{children:h("wiredfurni.params.shout")})]})]})]})},ek=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:l=>n(l.target.value)})]})})},tk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),nk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),rk=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:l=>n(l.target.value),maxLength:X("wired.action.chat.max.length",100)})]})})},sk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),ak=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(1),[a,l]=o.useState(!1),[u,d]=o.useState(1),[g,m]=o.useState(1),[f,I]=o.useState([]),{trigger:C=null,setIntParams:p=null,setStringParam:_=null}=Ce(),E=()=>I(y=>[...y,{isBadge:!1,itemCode:"",probability:null}]),b=y=>{I(R=>{const O=Array.from(R);return O.splice(y,1),O})},N=(y,R,O,F)=>{const D=Array.from(f),A=D[y];A&&(A.isBadge=R,A.itemCode=O,A.probability=F,I(D))},T=()=>{let y=[];for(const R of f){if(!R.itemCode)continue;const O=[R.isBadge?"0":"1",R.itemCode,R.probability.toString()];y.push(O.join(","))}y.length>0&&(_(y.join(";")),p([r,a?1:0,u,g]))};return o.useEffect(()=>{const y=[];if(C.stringData.length>0&&C.stringData.includes(";")){const R=C.stringData.split(";");for(const O of R){const F=O.split(",");F.length===3&&y.push({isBadge:F[0]==="0",itemCode:F[1],probability:Number(F[2])})}}y.length===0&&y.push({isBadge:!1,itemCode:"",probability:null}),s(C.intData.length>0?C.intData[0]:0),l(C.intData.length>1?C.intData[1]===1:!1),d(C.intData.length>2?C.intData[2]:0),m(C.intData.length>3?C.intData[3]:0),n(C.intData.length>3?C.intData[3]>0:!1),I(y)},[C]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:T,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:y=>n(y.target.checked)}),t(S,{children:h("wiredfurni.params.prizelimit",["amount"],[e?u.toString():""])})]}),!e&&t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&t(At,{className:"nitro-slider",min:1,max:1e3,value:u,onChange:y=>d(y)}),t("hr",{className:"m-0 bg-dark"}),c(v,{gap:1,children:[t(S,{bold:!0,children:"How often can a user be rewarded?"}),c(w,{gap:1,children:[c("select",{className:"form-select form-select-sm w-100",value:r,onChange:y=>s(Number(y.target.value)),children:[t("option",{value:"0",children:"Once"}),c("option",{value:"3",children:["Once every ",g," minutes"]}),c("option",{value:"2",children:["Once every ",g," hours"]}),c("option",{value:"1",children:["Once every ",g," days"]})]}),r>0&&t("input",{type:"number",className:"form-control form-control-sm",value:g,onChange:y=>m(Number(y.target.value))})]})]}),t("hr",{className:"m-0 bg-dark"}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:a,onChange:y=>l(y.target.checked)}),t(S,{children:"Unique rewards"})]}),t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),t("hr",{className:"m-0 bg-dark"}),c(w,{justifyContent:"between",alignItems:"center",children:[t(S,{bold:!0,children:"Rewards"}),t(M,{variant:"success",onClick:E,children:t(wo,{className:"fa-icon"})})]}),t(v,{gap:1,children:f&&f.map((y,R)=>c(w,{gap:1,children:[c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:y.isBadge,onChange:O=>N(R,O.target.checked,y.itemCode,y.probability)}),t(S,{small:!0,children:"Badge?"})]}),t("input",{type:"text",className:"form-control form-control-sm",value:y.itemCode,onChange:O=>N(R,y.isBadge,O.target.value,y.probability),placeholder:"Item Code"}),t("input",{type:"number",className:"form-control form-control-sm",value:y.probability,onChange:O=>N(R,y.isBadge,y.itemCode,Number(O.target.value)),placeholder:"Probability"}),R>0&&t(M,{variant:"danger",onClick:O=>b(R),children:t(Ql,{className:"fa-icon"})})]},R))})]})},ik=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),[a,l]=o.useState(1),{trigger:u=null,setIntParams:d=null}=Ce(),g=()=>d([e,r,a]);return o.useEffect(()=>{u.intData.length>=2?(n(u.intData[0]),s(u.intData[1]),l(u.intData[2])):(n(1),s(1),l(1))},[u]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:100,value:e,onChange:m=>n(m)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(At,{className:"nitro-slider",min:1,max:10,value:r,onChange:m=>s(m)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.team")}),[1,2,3,4].map(m=>c(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${m}`,checked:a===m,onChange:f=>l(m)}),t(S,{children:h("wiredfurni.params.team."+m)})]},m))]})]})},ok=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>l([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:100,value:e,onChange:d=>n(d)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(At,{className:"nitro-slider",min:1,max:10,value:r,onChange:d=>s(d)})]})]})},lk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.team")}),[1,2,3,4].map(l=>c(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${l}`,checked:e===l,onChange:u=>n(l)}),t(S,{children:h(`wiredfurni.params.team.${l}`)})]},l))]})})},ck=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:l=>n(l.target.value),maxLength:X("wired.action.kick.from.room.max.length",100)})]})})},uk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),dk=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],mk=[0,1,2,3,4,5,6],hk=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>l([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.startdir")}),t(w,{gap:1,children:dk.map(d=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:g=>n(d.value)}),t(S,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.turn")}),mk.map(d=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:g=>s(d)}),t(S,{children:h(`wiredfurni.params.turn.${d}`)})]},d))]})]})},gk=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],fk=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>l([r,e]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[1]),s(a.intData[0])):(n(-1),s(-1))},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:5,value:e,onChange:d=>n(d)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.startdir")}),t(w,{gap:1,children:gk.map(d=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:r===d.value,onChange:g=>s(d.value)}),t(S,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]})]})},pk=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],Ik=[0,1,2,3],Ek=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>l([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.movefurni")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===0,onChange:d=>n(0)}),t(S,{children:h("wiredfurni.params.movefurni.0")})]}),c(w,{gap:1,children:[pk.map(d=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:g=>n(d.value)}),t("i",{className:`icon icon-${d.icon}`})]},d.value)),t("div",{className:"col"})]})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.rotatefurni")}),Ik.map(d=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:g=>s(d)}),c(S,{children:[[1,2].includes(d)&&t("i",{className:`icon icon-rot-${d}`}),h(`wiredfurni.params.rotatefurni.${d}`)]})]},d))]})]})},Ck=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(""),{trigger:a=null,setIntParams:l=null,setStringParam:u=null}=Ce(),d=()=>{l([e]),u(r)};return o.useEffect(()=>{n(a.intData.length>0?a.intData[0]:0),s(a.stringData)},[a]),c(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:10,value:e,onChange:g=>n(g)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:g=>s(g.target.value),maxLength:X("wired.action.mute.user.max.length",100)})]})]})},_k=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),bk=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(0),[a,l]=o.useState(0),{trigger:u=null,setIntParams:d=null}=Ce(),g=()=>d([e,r,a]);return o.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),l(u.getBoolean(2)?1:0)},[u]),t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.conditions")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:m=>n(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.state")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:m=>s(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.direction")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:m=>l(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.position")})]})]})})},Nk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Sk=i=>t(lt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),vk=i=>{switch(i){case Xe.BOT_CHANGE_FIGURE:return t(z1,{});case Xe.BOT_FOLLOW_AVATAR:return t($1,{});case Xe.BOT_GIVE_HAND_ITEM:return t(X1,{});case Xe.BOT_MOVE:return t(Q1,{});case Xe.BOT_TALK:return t(Z1,{});case Xe.BOT_TALK_DIRECT_TO_AVTR:return t(J1,{});case Xe.BOT_TELEPORT:return t(ek,{});case Xe.CALL_ANOTHER_STACK:return t(tk,{});case Xe.CHASE:return t(nk,{});case Xe.CHAT:return t(rk,{});case Xe.FLEE:return t(sk,{});case Xe.GIVE_REWARD:return t(ak,{});case Xe.GIVE_SCORE:return t(ok,{});case Xe.GIVE_SCORE_TO_PREDEFINED_TEAM:return t(ik,{});case Xe.JOIN_TEAM:return t(lk,{});case Xe.KICK_FROM_ROOM:return t(ck,{});case Xe.LEAVE_TEAM:return t(uk,{});case Xe.MOVE_FURNI:return t(Ek,{});case Xe.MOVE_AND_ROTATE_FURNI:return t(hk,{});case Xe.MOVE_FURNI_TO:return t(fk,{});case Xe.MUTE_USER:return t(Ck,{});case Xe.RESET:return t(_k,{});case Xe.SET_FURNI_STATE:return t(bk,{});case Xe.TELEPORT:return t(Nk,{});case Xe.TOGGLE_FURNI_STATE:return t(Sk,{})}return null},cn=i=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i;return t(Oc,{wiredType:"condition",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},Tk=[2,5,7,8,9,10,27],wk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.handitem")}),t("select",{className:"form-select form-select-sm",value:e,onChange:l=>n(parseInt(l.target.value)),children:Tk.map(l=>t("option",{value:l,children:h(`handitem${l}`)},l))})]})})},Rk=i=>t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Ok=i=>t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),yk=[1,2,3,4],kk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.team")}),yk.map(l=>c(w,{gap:1,alignItems:"center",children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${l}`,checked:e===l,onChange:u=>n(l)}),t(S,{children:h(`wiredfurni.params.team.${l}`)})]},l))]})})},Ak=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.badgecode")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:l=>n(l.target.value)})]})})},Dk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n((r==null?void 0:r.intData[0])??0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.tooltip.effectid")}),t("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:l=>n(parseInt(l.target.value))})]})})},Pk=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>{let d=0,g=0;const m=new Date(e),f=new Date(r);m&&f&&(d=m.getTime()/1e3,g=f.getTime()/1e3),l([d,g])};return o.useEffect(()=>{if(a.intData.length>=2){let d=new Date,g=new Date;a.intData[0]>0&&(d=new Date(a.intData[0]*1e3)),a.intData[1]>0&&(g=new Date(a.intData[1]*1e3)),n(Nu(d)),s(Nu(g))}},[a]),c(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.startdate")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.enddate")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:d=>s(d.target.value)})]})]})},Lk=i=>t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),Mk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.requireall")}),[0,1].map(l=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${l}`,checked:e===l,onChange:u=>n(l)}),t(S,{children:h("wiredfurni.params.requireall."+l)})]},l))]})})},xk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.not_requireall")}),[0,1].map(l=>c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${l}`,checked:e===l,onChange:u=>n(l)}),t(S,{children:h(`wiredfurni.params.not_requireall.${l}`)})]},l))]})})},Uk=i=>t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Fk=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(0),[a,l]=o.useState(0),{trigger:u=null,setIntParams:d=null}=Ce(),g=()=>d([e,r,a]);return o.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),l(u.getBoolean(2)?1:0)},[u]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.conditions")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:m=>n(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.state")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:m=>s(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.direction")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:m=>l(m.target.checked?1:0)}),t(S,{children:h("wiredfurni.params.condition.position")})]})]})})},Vk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.allowbefore",["seconds"],[ti(e)])}),t(At,{className:"nitro-slider",min:1,max:1200,value:e,onChange:l=>n(l)})]})})},Gk=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.allowafter",["seconds"],[ti(e)])}),t(At,{className:"nitro-slider",min:1,max:1200,value:e,onChange:l=>n(l)})]})})},Bk=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),{trigger:a=null,setIntParams:l=null}=Ce(),u=()=>l([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),c(cn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.usercountmin",["value"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:50,value:e,onChange:d=>n(d)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.usercountmax",["value"],[r.toString()])}),t(At,{className:"nitro-slider",min:1,max:50,value:r,onChange:d=>s(d)})]})]})},Hk=i=>{switch(i){case tt.ACTOR_HAS_HANDITEM:return t(wk,{});case tt.ACTOR_IS_GROUP_MEMBER:case tt.NOT_ACTOR_IN_GROUP:return t(Rk,{});case tt.ACTOR_IS_ON_FURNI:case tt.NOT_ACTOR_ON_FURNI:return t(Ok,{});case tt.ACTOR_IS_IN_TEAM:case tt.NOT_ACTOR_IN_TEAM:return t(kk,{});case tt.ACTOR_IS_WEARING_BADGE:case tt.NOT_ACTOR_WEARS_BADGE:return t(Ak,{});case tt.ACTOR_IS_WEARING_EFFECT:case tt.NOT_ACTOR_WEARING_EFFECT:return t(Dk,{});case tt.DATE_RANGE_ACTIVE:return t(Pk,{});case tt.FURNIS_HAVE_AVATARS:case tt.FURNI_NOT_HAVE_HABBO:return t(Lk,{});case tt.HAS_STACKED_FURNIS:return t(Mk,{});case tt.NOT_HAS_STACKED_FURNIS:return t(xk,{});case tt.STUFF_TYPE_MATCHES:case tt.NOT_FURNI_IS_OF_TYPE:return t(Uk,{});case tt.STATES_MATCH:case tt.NOT_STATES_MATCH:return t(Fk,{});case tt.TIME_ELAPSED_LESS:return t(Vk,{});case tt.TIME_ELAPSED_MORE:return t(Gk,{});case tt.USER_COUNT_IN:case tt.NOT_USER_COUNT_IN:return t(Bk,{})}return null},fn=i=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i;return t(Oc,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},Wk=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(0),{trigger:a=null,setStringParam:l=null}=Ce(),u=()=>l(r===1?e:"");return o.useEffect(()=>{n(a.stringData),s(a.stringData?1:0)},[a]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.picktriggerer")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:d=>s(0)}),t(S,{children:h("wiredfurni.params.anyavatar")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:d=>s(1)}),t(S,{children:h("wiredfurni.params.certainavatar")})]}),r===1&&t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]})})},jk=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:l=null,setIntParams:u=null}=Ce(),d=()=>{l(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),c(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.whatissaid")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:g=>n(g.target.value)})]}),c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.picktriggerer")}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:r===0,onChange:g=>s(0)}),t(S,{children:h("wiredfurni.params.anyavatar")})]}),c(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:r===1,onChange:g=>s(1)}),t(S,{children:H().userName})]})]})]})},qk=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Yk=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),zk=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:l=>n(l.target.value)})]})})},$k=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Ce(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:l=>n(l.target.value)})]})})},Kk=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Xk=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.settime",["seconds"],[ti(e)])}),t(At,{className:"nitro-slider",min:1,max:1200,value:e,onChange:l=>n(l)})]})})},Qk=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.setlongtime",["time"],[bn.format(e*5).toString()])}),t(At,{className:"nitro-slider",min:1,max:120,value:e,onChange:l=>n(l)})]})})},Jk=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.settime",["seconds"],[ti(e)])}),t(At,{className:"nitro-slider",min:1,max:60,value:e,onChange:l=>n(l)})]})})},Zk=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),eA=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),tA=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Ce(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:c(v,{gap:1,children:[t(S,{bold:!0,children:h("wiredfurni.params.setscore",["points"],[e.toString()])}),t(At,{className:"nitro-slider",min:1,max:1e3,value:e,onChange:l=>n(l)})]})})},nA=i=>t(fn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),rA=i=>{switch(i){case Yt.AVATAR_ENTERS_ROOM:return t(Wk,{});case Yt.AVATAR_SAYS_SOMETHING:return t(jk,{});case Yt.AVATAR_WALKS_OFF_FURNI:return t(qk,{});case Yt.AVATAR_WALKS_ON_FURNI:return t(Yk,{});case Yt.BOT_REACHED_AVATAR:return t(zk,{});case Yt.BOT_REACHED_STUFF:return t($k,{});case Yt.COLLISION:return t(Kk,{});case Yt.EXECUTE_ONCE:return t(Xk,{});case Yt.EXECUTE_PERIODICALLY:return t(Jk,{});case Yt.EXECUTE_PERIODICALLY_LONG:return t(Qk,{});case Yt.GAME_ENDS:return t(Zk,{});case Yt.GAME_STARTS:return t(eA,{});case Yt.SCORE_ACHIEVED:return t(tA,{});case Yt.TOGGLE_FURNI:return t(nA,{})}return null},sA=i=>{const{trigger:e=null}=Ce();return e?e instanceof im?vk(e.code):e instanceof om?rA(e.code):e instanceof lm?Hk(e.code):null:null},aA=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!0);return Pe(Dt.CREATED,a=>s(!1)),Pe(Dt.ENDED,a=>s(a.openLandingView)),o.useEffect(()=>{n(!0),Ma().connection.onReady()},[]),o.useEffect(()=>{const a={linkReceived:l=>{const u=l.split("/");if(!(u.length<2))switch(u[1]){case"open":if(u.length>2)switch(u[2]){case"credits":break;default:{const d=u[2];za.openHabblet(d)}}return}},eventUrlPrefix:"habblet/"};return pt(a),()=>It(a)},[]),c(P,{fit:!0,children:[t(ni,{type:tn.FADE_IN,inProp:r,timeout:300,children:t(jR,{})}),t(x1,{isInRoom:!r}),t(U1,{isInRoom:!r}),t(IO,{}),t(M1,{}),t(Iw,{}),t(sA,{}),t(bT,{}),t(dT,{}),t(PO,{}),t(nO,{}),t(pw,{}),t(jw,{}),t(iy,{}),t(j1,{}),t(W1,{}),t(oR,{}),t(OT,{}),t(UR,{}),t(MO,{}),t(ER,{}),t(CR,{}),t(AT,{}),t($w,{}),t(Ow,{})]})};jd.UI_VERSION=Wm();const iA=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,l]=o.useState("Getting Ready"),[u,d]=o.useState(0),[g,m]=o.useState(!0);if(!pe()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");ds.bootstrap()}const f=o.useCallback(async I=>{switch(I.type){case mi.LOADED:pe().localization.init(),d(C=>C+20);return;case mi.FAILED:s(!0),l("Configuration Failed");return;case ds.WEBGL_UNAVAILABLE:s(!0),l("WebGL Required");return;case ds.WEBGL_CONTEXT_LOST:s(!0),l("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case tr.CONNECTION_HANDSHAKING:d(C=>C+20);return;case tr.CONNECTION_HANDSHAKE_FAILED:s(!0),l("Handshake Failed");return;case tr.CONNECTION_AUTHENTICATED:d(C=>C+20),pe().init(),La.available&&La.call("legacyTrack","authentication","authok",[]);return;case tr.CONNECTION_ERROR:s(!0),l("Connection Error");return;case tr.CONNECTION_CLOSED:l("Connection Error"),za.send(-1,"client.init.handshake.fail");return;case _n.ENGINE_INITIALIZED:d(C=>C+20),setTimeout(()=>n(!0),300);return;case nu.LOADED:{const C=X("preload.assets.urls"),p=[];if(C&&C.length)for(const E of C)p.push(Ar.interpolate(E));await hm().downloadAssets(p)?(Ma().init(),d(E=>E+20)):(s(!0),l("Assets Failed"));return}}},[]);return ls(ds.WEBGL_UNAVAILABLE,f),ls(ds.WEBGL_CONTEXT_LOST,f),ls(tr.CONNECTION_HANDSHAKING,f),ls(tr.CONNECTION_HANDSHAKE_FAILED,f),ls(tr.CONNECTION_AUTHENTICATED,f),ls(tr.CONNECTION_ERROR,f),ls(tr.CONNECTION_CLOSED,f),Ee(_n.ENGINE_INITIALIZED,f),eS(nu.LOADED,f),Tu(mi.LOADED,f),Tu(mi.FAILED,f),o.useEffect(()=>{pe().core.configuration.init();const I=C=>m(!(window.devicePixelRatio%1));return window.addEventListener("resize",I),I(),()=>{window.removeEventListener("resize",I)}},[]),c(P,{fit:!0,overflow:"hidden",className:g&&"image-rendering-pixelated",children:[(!e||r)&&t(JN,{isError:r,message:a,percent:u}),t(ni,{type:tn.FADE_IN,inProp:e,children:t(aA,{})}),t(P,{id:"draggable-windows-container"})]})};lg(document.getElementById("root")).render(t(iA,{}));
